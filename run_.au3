Global Const $symopt_allow_absolute_symbols = 2048
Global Const $symopt_allow_zero_address = 16777216
Global Const $symopt_auto_publics = 65536
Global Const $symopt_case_insensitive = 1
Global Const $symopt_debug = -2147483648
Global Const $symopt_deferred_loads = 4
Global Const $symopt_disable_symsrv_autodetect = 33554432
Global Const $symopt_exact_symbols = 1024
Global Const $symopt_fail_critical_errors = 512
Global Const $symopt_favor_compressed = 8388608
Global Const $symopt_flat_directory = 4194304
Global Const $symopt_ignore_cvrec = 128
Global Const $symopt_ignore_imagedir = 2097152
Global Const $symopt_ignore_nt_sympath = 4096
Global Const $symopt_include_32bit_modules = 8192
Global Const $symopt_load_anything = 64
Global Const $symopt_load_lines = 16
Global Const $symopt_no_cpp = 8
Global Const $symopt_no_image_search = 131072
Global Const $symopt_no_prompts = 524288
Global Const $symopt_no_publics = 32768
Global Const $symopt_no_unqualified_loads = 256
Global Const $symopt_overwrite = 1048576
Global Const $symopt_publics_only = 16384
Global Const $symopt_secure = 262144
Global Const $symopt_undname = 2
Global Const $sem_failcriticalerrors = 1
Global Const $sem_noalignmentfaultexcept = 4
Global Const $sem_nogpfaulterrorbox = 2
Global Const $sem_noopenfileerrorbox = 32768
Global Const $network_alive_lan = 1
Global Const $network_alive_wan = 2
Global Const $network_alive_aol = 4
Global Const $restart_no_crash = 1
Global Const $restart_no_hang = 2
Global Const $restart_no_patch = 4
Global Const $restart_no_reboot = 8
Global Const $uhid_mb = 0
Global Const $uhid_bios = 1
Global Const $uhid_cpu = 2
Global Const $uhid_hdd = 4
Global Const $uhid_all = BitOR($uhid_mb, $uhid_bios, $uhid_cpu, $uhid_hdd)
#NoTrayIcon
#Region
	#AutoIt3Wrapper_Icon=icon.ico
	#AutoIt3Wrapper_Add_Constants=n
#EndRegion
Global Const $dts_shortdateformat = 0
Global Const $dts_updown = 1
Global Const $dts_shownone = 2
Global Const $dts_longdateformat = 4
Global Const $dts_timeformat = 9
Global Const $dts_rightalign = 32
Global Const $dts_shortdatecenturyformat = 12
Global Const $dts_appcanparse = 16
Global Const $dmw_longname = 0
Global Const $dmw_shortname = 1
Global Const $dmw_locale_longname = 2
Global Const $dmw_locale_shortname = 3
Global Const $gdt_error = -1
Global Const $gdt_valid = 0
Global Const $gdt_none = 1
Global Const $gdtr_min = 1
Global Const $gdtr_max = 2
Global Const $mcht_nowhere = 0
Global Const $mcht_title = 65536
Global Const $mcht_calendar = 131072
Global Const $mcht_todaylink = 196608
Global Const $mcht_next = 16777216
Global Const $mcht_prev = 33554432
Global Const $mcht_titlebk = 65536
Global Const $mcht_titlemonth = 65537
Global Const $mcht_titleyear = 65538
Global Const $mcht_titlebtnnext = 16842755
Global Const $mcht_titlebtnprev = 33619971
Global Const $mcht_calendarbk = 131072
Global Const $mcht_calendardate = 131073
Global Const $mcht_calendarday = 131074
Global Const $mcht_calendarweeknum = 131075
Global Const $mcht_calendardatenext = 16908288
Global Const $mcht_calendardateprev = 33685504
Global Const $mcs_daystate = 1
Global Const $mcs_multiselect = 2
Global Const $mcs_weeknumbers = 4
Global Const $mcs_notodaycircle = 8
Global Const $mcs_notoday = 16
Global Const $mcs_notrailingdates = 64
Global Const $mcs_shortdaysofweek = 128
Global Const $mcs_noselchangeonnav = 256
Global Const $mcm_first = 4096
Global Const $mcm_getcalendarborder = ($mcm_first + 31)
Global Const $mcm_getcalendarcount = ($mcm_first + 23)
Global Const $mcm_getcalendargridinfo = ($mcm_first + 24)
Global Const $mcm_getcalid = ($mcm_first + 27)
Global Const $mcm_getcolor = ($mcm_first + 11)
Global Const $mcm_getcurrentview = ($mcm_first + 22)
Global Const $mcm_getcursel = ($mcm_first + 1)
Global Const $mcm_getfirstdayofweek = ($mcm_first + 16)
Global Const $mcm_getmaxselcount = ($mcm_first + 3)
Global Const $mcm_getmaxtodaywidth = ($mcm_first + 21)
Global Const $mcm_getminreqrect = ($mcm_first + 9)
Global Const $mcm_getmonthdelta = ($mcm_first + 19)
Global Const $mcm_getmonthrange = ($mcm_first + 7)
Global Const $mcm_getrange = ($mcm_first + 17)
Global Const $mcm_getselrange = ($mcm_first + 5)
Global Const $mcm_gettoday = ($mcm_first + 13)
Global Const $mcm_getunicodeformat = 8192 + 6
Global Const $mcm_hittest = ($mcm_first + 14)
Global Const $mcm_setcalendarborder = ($mcm_first + 30)
Global Const $mcm_setcalid = ($mcm_first + 28)
Global Const $mcm_setcolor = ($mcm_first + 10)
Global Const $mcm_setcurrentview = ($mcm_first + 32)
Global Const $mcm_setcursel = ($mcm_first + 2)
Global Const $mcm_setdaystate = ($mcm_first + 8)
Global Const $mcm_setfirstdayofweek = ($mcm_first + 15)
Global Const $mcm_setmaxselcount = ($mcm_first + 4)
Global Const $mcm_setmonthdelta = ($mcm_first + 20)
Global Const $mcm_setrange = ($mcm_first + 18)
Global Const $mcm_setselrange = ($mcm_first + 6)
Global Const $mcm_settoday = ($mcm_first + 12)
Global Const $mcm_setunicodeformat = 8192 + 5
Global Const $mcm_sizerecttomin = ($mcm_first + 29)
Global Const $mcn_first = -746
Global Const $mcn_selchange = ($mcn_first - 3)
Global Const $mcn_getdaystate = ($mcn_first - 1)
Global Const $mcn_select = ($mcn_first)
Global Const $mcn_viewchange = ($mcn_first - 4)
Global Const $mcsc_background = 0
Global Const $mcsc_monthbk = 4
Global Const $mcsc_text = 1
Global Const $mcsc_titlebk = 2
Global Const $mcsc_titletext = 3
Global Const $mcsc_trailingtext = 5
Global Const $dtm_first = 4096
Global Const $dtm_getsystemtime = $dtm_first + 1
Global Const $dtm_setsystemtime = $dtm_first + 2
Global Const $dtm_getrange = $dtm_first + 3
Global Const $dtm_setrange = $dtm_first + 4
Global Const $dtm_setformat = $dtm_first + 5
Global Const $dtm_setmccolor = $dtm_first + 6
Global Const $dtm_getmccolor = $dtm_first + 7
Global Const $dtm_getmonthcal = $dtm_first + 8
Global Const $dtm_setmcfont = $dtm_first + 9
Global Const $dtm_getmcfont = $dtm_first + 10
Global Const $dtm_setformatw = $dtm_first + 50
Global Const $dtn_first = -740
Global Const $dtn_first2 = -753
Global Const $dtn_datetimechange = $dtn_first2 - 6
Global Const $dtn_userstring = $dtn_first2 - 5
Global Const $dtn_wmkeydown = $dtn_first2 - 4
Global Const $dtn_format = $dtn_first2 - 3
Global Const $dtn_formatquery = $dtn_first2 - 2
Global Const $dtn_dropdown = $dtn_first2 - 1
Global Const $dtn_closeup = $dtn_first2 + 0
Global Const $dtn_userstringw = $dtn_first - 5
Global Const $dtn_wmkeydownw = $dtn_first - 4
Global Const $dtn_formatw = $dtn_first - 3
Global Const $dtn_formatqueryw = $dtn_first - 2
Global Const $gui_ss_default_date = $dts_longdateformat
Global Const $gui_ss_default_monthcal = 0
Global Const $gui_event_single = 0
Global Const $gui_event_array = 1
Global Const $gui_event_none = 0
Global Const $gui_event_close = -3
Global Const $gui_event_minimize = -4
Global Const $gui_event_restore = -5
Global Const $gui_event_maximize = -6
Global Const $gui_event_primarydown = -7
Global Const $gui_event_primaryup = -8
Global Const $gui_event_secondarydown = -9
Global Const $gui_event_secondaryup = -10
Global Const $gui_event_mousemove = -11
Global Const $gui_event_resized = -12
Global Const $gui_event_dropped = -13
Global Const $gui_rundefmsg = "GUI_RUNDEFMSG"
Global Const $gui_avistop = 0
Global Const $gui_avistart = 1
Global Const $gui_aviclose = 2
Global Const $gui_checked = 1
Global Const $gui_indeterminate = 2
Global Const $gui_unchecked = 4
Global Const $gui_dropaccepted = 8
Global Const $gui_nodropaccepted = 4096
Global Const $gui_acceptfiles = $gui_dropaccepted
Global Const $gui_show = 16
Global Const $gui_hide = 32
Global Const $gui_enable = 64
Global Const $gui_disable = 128
Global Const $gui_focus = 256
Global Const $gui_nofocus = 8192
Global Const $gui_defbutton = 512
Global Const $gui_expand = 1024
Global Const $gui_ontop = 2048
Global Const $gui_fontnormal = 0
Global Const $gui_fontitalic = 2
Global Const $gui_fontunder = 4
Global Const $gui_fontstrike = 8
Global Const $gui_dockauto = 1
Global Const $gui_dockleft = 2
Global Const $gui_dockright = 4
Global Const $gui_dockhcenter = 8
Global Const $gui_docktop = 32
Global Const $gui_dockbottom = 64
Global Const $gui_dockvcenter = 128
Global Const $gui_dockwidth = 256
Global Const $gui_dockheight = 512
Global Const $gui_docksize = 768
Global Const $gui_dockmenubar = 544
Global Const $gui_dockstatebar = 576
Global Const $gui_dockall = 802
Global Const $gui_dockborders = 102
Global Const $gui_gr_close = 1
Global Const $gui_gr_line = 2
Global Const $gui_gr_bezier = 4
Global Const $gui_gr_move = 6
Global Const $gui_gr_color = 8
Global Const $gui_gr_rect = 10
Global Const $gui_gr_ellipse = 12
Global Const $gui_gr_pie = 14
Global Const $gui_gr_dot = 16
Global Const $gui_gr_pixel = 18
Global Const $gui_gr_hint = 20
Global Const $gui_gr_refresh = 22
Global Const $gui_gr_pensize = 24
Global Const $gui_gr_nobkcolor = -2
Global Const $gui_bkcolor_default = -1
Global Const $gui_bkcolor_transparent = -2
Global Const $gui_bkcolor_lv_alternate = -33554432
Global Const $gui_read_default = 0
Global Const $gui_read_extended = 1
Global Const $gui_cursor_nooverride = 0
Global Const $gui_cursor_override = 1
Global Const $gui_ws_ex_parentdrag = 1048576
Global Const $ss_left = 0
Global Const $ss_center = 1
Global Const $ss_right = 2
Global Const $ss_icon = 3
Global Const $ss_blackrect = 4
Global Const $ss_grayrect = 5
Global Const $ss_whiterect = 6
Global Const $ss_blackframe = 7
Global Const $ss_grayframe = 8
Global Const $ss_whiteframe = 9
Global Const $ss_simple = 11
Global Const $ss_leftnowordwrap = 12
Global Const $ss_bitmap = 14
Global Const $ss_enhmetafile = 15
Global Const $ss_etchedhorz = 16
Global Const $ss_etchedvert = 17
Global Const $ss_etchedframe = 18
Global Const $ss_realsizecontrol = 64
Global Const $ss_noprefix = 128
Global Const $ss_notify = 256
Global Const $ss_centerimage = 512
Global Const $ss_rightjust = 1024
Global Const $ss_sunken = 4096
Global Const $gui_ss_default_label = 0
Global Const $gui_ss_default_graphic = 0
Global Const $gui_ss_default_icon = $ss_notify
Global Const $gui_ss_default_pic = $ss_notify
Global Const $stm_seticon = 368
Global Const $stm_geticon = 369
Global Const $stm_setimage = 370
Global Const $stm_getimage = 371
Global Const $wc_animate = "SysAnimate32"
Global Const $wc_button = "Button"
Global Const $wc_combobox = "ComboBox"
Global Const $wc_comboboxex = "ComboBoxEx32"
Global Const $wc_datetimepick = "SysDateTimePick32"
Global Const $wc_edit = "Edit"
Global Const $wc_header = "SysHeader32"
Global Const $wc_hotkey = "msctls_hotkey32"
Global Const $wc_ipaddress = "SysIPAddress32"
Global Const $wc_link = "SysLink"
Global Const $wc_listbox = "ListBox"
Global Const $wc_listview = "SysListView32"
Global Const $wc_monthcal = "SysMonthCal32"
Global Const $wc_nativefontctl = "NativeFontCtl"
Global Const $wc_pagescroller = "SysPager"
Global Const $wc_progress = "msctls_progress32"
Global Const $wc_rebar = "ReBarWindow32"
Global Const $wc_scrollbar = "ScrollBar"
Global Const $wc_static = "Static"
Global Const $wc_statusbar = "msctls_statusbar32"
Global Const $wc_tabcontrol = "SysTabControl32"
Global Const $wc_toolbar = "ToolbarWindow32"
Global Const $wc_tooltips = "tooltips_class32"
Global Const $wc_trackbar = "msctls_trackbar32"
Global Const $wc_treeview = "SysTreeView32"
Global Const $wc_updown = "msctls_updown32"
Global Const $ws_overlapped = 0
Global Const $ws_tiled = $ws_overlapped
Global Const $ws_maximizebox = 65536
Global Const $ws_minimizebox = 131072
Global Const $ws_tabstop = 65536
Global Const $ws_group = 131072
Global Const $ws_sizebox = 262144
Global Const $ws_thickframe = $ws_sizebox
Global Const $ws_sysmenu = 524288
Global Const $ws_hscroll = 1048576
Global Const $ws_vscroll = 2097152
Global Const $ws_dlgframe = 4194304
Global Const $ws_border = 8388608
Global Const $ws_caption = 12582912
Global Const $ws_overlappedwindow = BitOR($ws_caption, $ws_maximizebox, $ws_minimizebox, $ws_overlapped, $ws_sysmenu, $ws_thickframe)
Global Const $ws_tiledwindow = $ws_overlappedwindow
Global Const $ws_maximize = 16777216
Global Const $ws_clipchildren = 33554432
Global Const $ws_clipsiblings = 67108864
Global Const $ws_disabled = 134217728
Global Const $ws_visible = 268435456
Global Const $ws_minimize = 536870912
Global Const $ws_iconic = $ws_minimize
Global Const $ws_child = 1073741824
Global Const $ws_childwindow = $ws_child
Global Const $ws_popup = -2147483648
Global Const $ws_popupwindow = -2138570752
Global Const $ds_3dlook = 4
Global Const $ds_absalign = 1
Global Const $ds_center = 2048
Global Const $ds_centermouse = 4096
Global Const $ds_contexthelp = 8192
Global Const $ds_control = 1024
Global Const $ds_fixedsys = 8
Global Const $ds_localedit = 32
Global Const $ds_modalframe = 128
Global Const $ds_nofailcreate = 16
Global Const $ds_noidlemsg = 256
Global Const $ds_setfont = 64
Global Const $ds_setforeground = 512
Global Const $ds_shellfont = BitOR($ds_fixedsys, $ds_setfont)
Global Const $ds_sysmodal = 2
Global Const $ws_ex_acceptfiles = 16
Global Const $ws_ex_appwindow = 262144
Global Const $ws_ex_composited = 33554432
Global Const $ws_ex_controlparent = 65536
Global Const $ws_ex_clientedge = 512
Global Const $ws_ex_contexthelp = 1024
Global Const $ws_ex_dlgmodalframe = 1
Global Const $ws_ex_layered = 524288
Global Const $ws_ex_layoutrtl = 4194304
Global Const $ws_ex_left = 0
Global Const $ws_ex_leftscrollbar = 16384
Global Const $ws_ex_ltrreading = 0
Global Const $ws_ex_mdichild = 64
Global Const $ws_ex_noactivate = 134217728
Global Const $ws_ex_noinheritlayout = 1048576
Global Const $ws_ex_noparentnotify = 4
Global Const $ws_ex_right = 4096
Global Const $ws_ex_rightscrollbar = 0
Global Const $ws_ex_rtlreading = 8192
Global Const $ws_ex_staticedge = 131072
Global Const $ws_ex_toolwindow = 128
Global Const $ws_ex_topmost = 8
Global Const $ws_ex_transparent = 32
Global Const $ws_ex_windowedge = 256
Global Const $ws_ex_overlappedwindow = BitOR($ws_ex_clientedge, $ws_ex_windowedge)
Global Const $ws_ex_palettewindow = BitOR($ws_ex_toolwindow, $ws_ex_topmost, $ws_ex_windowedge)
Global Const $wm_null = 0
Global Const $wm_create = 1
Global Const $wm_destroy = 2
Global Const $wm_move = 3
Global Const $wm_sizewait = 4
Global Const $wm_size = 5
Global Const $wm_activate = 6
Global Const $wm_setfocus = 7
Global Const $wm_killfocus = 8
Global Const $wm_setvisible = 9
Global Const $wm_enable = 10
Global Const $wm_setredraw = 11
Global Const $wm_settext = 12
Global Const $wm_gettext = 13
Global Const $wm_gettextlength = 14
Global Const $wm_paint = 15
Global Const $wm_close = 16
Global Const $wm_queryendsession = 17
Global Const $wm_quit = 18
Global Const $wm_erasebkgnd = 20
Global Const $wm_queryopen = 19
Global Const $wm_syscolorchange = 21
Global Const $wm_endsession = 22
Global Const $wm_systemerror = 23
Global Const $wm_showwindow = 24
Global Const $wm_ctlcolor = 25
Global Const $wm_settingchange = 26
Global Const $wm_wininichange = 26
Global Const $wm_devmodechange = 27
Global Const $wm_activateapp = 28
Global Const $wm_fontchange = 29
Global Const $wm_timechange = 30
Global Const $wm_cancelmode = 31
Global Const $wm_setcursor = 32
Global Const $wm_mouseactivate = 33
Global Const $wm_childactivate = 34
Global Const $wm_queuesync = 35
Global Const $wm_getminmaxinfo = 36
Global Const $wm_logoff = 37
Global Const $wm_painticon = 38
Global Const $wm_iconerasebkgnd = 39
Global Const $wm_nextdlgctl = 40
Global Const $wm_alttabactive = 41
Global Const $wm_spoolerstatus = 42
Global Const $wm_drawitem = 43
Global Const $wm_measureitem = 44
Global Const $wm_deleteitem = 45
Global Const $wm_vkeytoitem = 46
Global Const $wm_chartoitem = 47
Global Const $wm_setfont = 48
Global Const $wm_getfont = 49
Global Const $wm_sethotkey = 50
Global Const $wm_gethotkey = 51
Global Const $wm_filesyschange = 52
Global Const $wm_isactiveicon = 53
Global Const $wm_queryparkicon = 54
Global Const $wm_querydragicon = 55
Global Const $wm_winhelp = 56
Global Const $wm_compareitem = 57
Global Const $wm_fullscreen = 58
Global Const $wm_clientshutdown = 59
Global Const $wm_ddemlevent = 60
Global Const $wm_getobject = 61
Global Const $wm_calcscroll = 63
Global Const $wm_testing = 64
Global Const $wm_compacting = 65
Global Const $wm_otherwindowcreated = 66
Global Const $wm_otherwindowdestroyed = 67
Global Const $wm_commnotify = 68
Global Const $wm_mediastatuschange = 69
Global Const $wm_windowposchanging = 70
Global Const $wm_windowposchanged = 71
Global Const $wm_power = 72
Global Const $wm_copyglobaldata = 73
Global Const $wm_copydata = 74
Global Const $wm_canceljournal = 75
Global Const $wm_logonnotify = 76
Global Const $wm_keyf1 = 77
Global Const $wm_notify = 78
Global Const $wm_access_window = 79
Global Const $wm_inputlangchangerequest = 80
Global Const $wm_inputlangchange = 81
Global Const $wm_tcard = 82
Global Const $wm_help = 83
Global Const $wm_userchanged = 84
Global Const $wm_notifyformat = 85
Global Const $wm_qm_activate = 96
Global Const $wm_hook_do_callback = 97
Global Const $wm_syscopydata = 98
Global Const $wm_finaldestroy = 112
Global Const $wm_measureitem_clientdata = 113
Global Const $wm_contextmenu = 123
Global Const $wm_stylechanging = 124
Global Const $wm_stylechanged = 125
Global Const $wm_displaychange = 126
Global Const $wm_geticon = 127
Global Const $wm_seticon = 128
Global Const $wm_nccreate = 129
Global Const $wm_ncdestroy = 130
Global Const $wm_nccalcsize = 131
Global Const $wm_nchittest = 132
Global Const $wm_ncpaint = 133
Global Const $wm_ncactivate = 134
Global Const $wm_getdlgcode = 135
Global Const $wm_syncpaint = 136
Global Const $wm_synctask = 137
Global Const $wm_kludgeminrect = 139
Global Const $wm_lpkdrawswitchwnd = 140
Global Const $wm_uahdestroywindow = 144
Global Const $wm_uahdrawmenu = 145
Global Const $wm_uahdrawmenuitem = 146
Global Const $wm_uahinitmenu = 147
Global Const $wm_uahmeasuremenuitem = 148
Global Const $wm_uahncpaintmenupopup = 149
Global Const $wm_ncmousemove = 160
Global Const $wm_nclbuttondown = 161
Global Const $wm_nclbuttonup = 162
Global Const $wm_nclbuttondblclk = 163
Global Const $wm_ncrbuttondown = 164
Global Const $wm_ncrbuttonup = 165
Global Const $wm_ncrbuttondblclk = 166
Global Const $wm_ncmbuttondown = 167
Global Const $wm_ncmbuttonup = 168
Global Const $wm_ncmbuttondblclk = 169
Global Const $wm_ncxbuttondown = 171
Global Const $wm_ncxbuttonup = 172
Global Const $wm_ncxbuttondblclk = 173
Global Const $wm_ncuahdrawcaption = 174
Global Const $wm_ncuahdrawframe = 175
Global Const $wm_input_device_change = 254
Global Const $wm_input = 255
Global Const $wm_keydown = 256
Global Const $wm_keyfirst = 256
Global Const $wm_keyup = 257
Global Const $wm_char = 258
Global Const $wm_deadchar = 259
Global Const $wm_syskeydown = 260
Global Const $wm_syskeyup = 261
Global Const $wm_syschar = 262
Global Const $wm_sysdeadchar = 263
Global Const $wm_yomichar = 264
Global Const $wm_keylast = 265
Global Const $wm_unichar = 265
Global Const $wm_convertrequest = 266
Global Const $wm_convertresult = 267
Global Const $wm_im_info = 268
Global Const $wm_ime_startcomposition = 269
Global Const $wm_ime_endcomposition = 270
Global Const $wm_ime_composition = 271
Global Const $wm_ime_keylast = 271
Global Const $wm_initdialog = 272
Global Const $wm_command = 273
Global Const $wm_syscommand = 274
Global Const $wm_timer = 275
Global Const $wm_hscroll = 276
Global Const $wm_vscroll = 277
Global Const $wm_initmenu = 278
Global Const $wm_initmenupopup = 279
Global Const $wm_systimer = 280
Global Const $wm_gesture = 281
Global Const $wm_gesturenotify = 282
Global Const $wm_gestureinput = 283
Global Const $wm_gesturenotified = 284
Global Const $wm_menuselect = 287
Global Const $wm_menuchar = 288
Global Const $wm_enteridle = 289
Global Const $wm_menurbuttonup = 290
Global Const $wm_menudrag = 291
Global Const $wm_menugetobject = 292
Global Const $wm_uninitmenupopup = 293
Global Const $wm_menucommand = 294
Global Const $wm_changeuistate = 295
Global Const $wm_updateuistate = 296
Global Const $wm_queryuistate = 297
Global Const $wm_lbtrackpoint = 305
Global Const $wm_ctlcolormsgbox = 306
Global Const $wm_ctlcoloredit = 307
Global Const $wm_ctlcolorlistbox = 308
Global Const $wm_ctlcolorbtn = 309
Global Const $wm_ctlcolordlg = 310
Global Const $wm_ctlcolorscrollbar = 311
Global Const $wm_ctlcolorstatic = 312
Global Const $mn_gethmenu = 481
Global Const $wm_parentnotify = 528
Global Const $wm_entermenuloop = 529
Global Const $wm_exitmenuloop = 530
Global Const $wm_nextmenu = 531
Global Const $wm_sizing = 532
Global Const $wm_capturechanged = 533
Global Const $wm_moving = 534
Global Const $wm_powerbroadcast = 536
Global Const $wm_devicechange = 537
Global Const $wm_mdicreate = 544
Global Const $wm_mdidestroy = 545
Global Const $wm_mdiactivate = 546
Global Const $wm_mdirestore = 547
Global Const $wm_mdinext = 548
Global Const $wm_mdimaximize = 549
Global Const $wm_mditile = 550
Global Const $wm_mdicascade = 551
Global Const $wm_mdiiconarrange = 552
Global Const $wm_mdigetactive = 553
Global Const $wm_dropobject = 554
Global Const $wm_querydropobject = 555
Global Const $wm_begindrag = 556
Global Const $wm_dragloop = 557
Global Const $wm_dragselect = 558
Global Const $wm_dragmove = 559
Global Const $wm_mdisetmenu = 560
Global Const $wm_entersizemove = 561
Global Const $wm_exitsizemove = 562
Global Const $wm_dropfiles = 563
Global Const $wm_mdirefreshmenu = 564
Global Const $wm_touch = 576
Global Const $wm_ime_setcontext = 641
Global Const $wm_ime_notify = 642
Global Const $wm_ime_control = 643
Global Const $wm_ime_compositionfull = 644
Global Const $wm_ime_select = 645
Global Const $wm_ime_char = 646
Global Const $wm_ime_system = 647
Global Const $wm_ime_request = 648
Global Const $wm_ime_keydown = 656
Global Const $wm_ime_keyup = 657
Global Const $wm_ncmousehover = 672
Global Const $wm_mousehover = 673
Global Const $wm_ncmouseleave = 674
Global Const $wm_mouseleave = 675
Global Const $wm_wtssession_change = 689
Global Const $wm_tablet_first = 704
Global Const $wm_tablet_last = 735
Global Const $wm_cut = 768
Global Const $wm_copy = 769
Global Const $wm_paste = 770
Global Const $wm_clear = 771
Global Const $wm_undo = 772
Global Const $wm_paletteischanging = 784
Global Const $wm_hotkey = 786
Global Const $wm_palettechanged = 785
Global Const $wm_sysmenu = 787
Global Const $wm_hookmsg = 788
Global Const $wm_exitprocess = 789
Global Const $wm_wakethread = 790
Global Const $wm_print = 791
Global Const $wm_printclient = 792
Global Const $wm_appcommand = 793
Global Const $wm_querynewpalette = 783
Global Const $wm_themechanged = 794
Global Const $wm_uahinit = 795
Global Const $wm_desktopnotify = 796
Global Const $wm_clipboardupdate = 797
Global Const $wm_dwmcompositionchanged = 798
Global Const $wm_dwmncrenderingchanged = 799
Global Const $wm_dwmcolorizationcolorchanged = 800
Global Const $wm_dwmwindowmaximizedchange = 801
Global Const $wm_dwmexileframe = 802
Global Const $wm_dwmsendiconicthumbnail = 803
Global Const $wm_magnification_started = 804
Global Const $wm_magnification_ended = 805
Global Const $wm_dwmsendiconiclivepreviewbitmap = 806
Global Const $wm_dwmthumbnailsizechanged = 807
Global Const $wm_magnification_output = 808
Global Const $wm_measurecontrol = 816
Global Const $wm_getactiontext = 817
Global Const $wm_forwardkeydown = 819
Global Const $wm_forwardkeyup = 820
Global Const $wm_gettitlebarinfoex = 831
Global Const $wm_notifywow = 832
Global Const $wm_handheldfirst = 856
Global Const $wm_handheldlast = 863
Global Const $wm_afxfirst = 864
Global Const $wm_afxlast = 895
Global Const $wm_penwinfirst = 896
Global Const $wm_penwinlast = 911
Global Const $wm_dde_initiate = 992
Global Const $wm_dde_terminate = 993
Global Const $wm_dde_advise = 994
Global Const $wm_dde_unadvise = 995
Global Const $wm_dde_ack = 996
Global Const $wm_dde_data = 997
Global Const $wm_dde_request = 998
Global Const $wm_dde_poke = 999
Global Const $wm_dde_execute = 1000
Global Const $wm_dbnotification = 1021
Global Const $wm_netconnect = 1022
Global Const $wm_hibernate = 1023
Global Const $wm_user = 1024
Global Const $wm_app = 32768
Global Const $nm_first = 0
Global Const $nm_outofmemory = $nm_first - 1
Global Const $nm_click = $nm_first - 2
Global Const $nm_dblclk = $nm_first - 3
Global Const $nm_return = $nm_first - 4
Global Const $nm_rclick = $nm_first - 5
Global Const $nm_rdblclk = $nm_first - 6
Global Const $nm_setfocus = $nm_first - 7
Global Const $nm_killfocus = $nm_first - 8
Global Const $nm_customdraw = $nm_first - 12
Global Const $nm_hover = $nm_first - 13
Global Const $nm_nchittest = $nm_first - 14
Global Const $nm_keydown = $nm_first - 15
Global Const $nm_releasedcapture = $nm_first - 16
Global Const $nm_setcursor = $nm_first - 17
Global Const $nm_char = $nm_first - 18
Global Const $nm_tooltipscreated = $nm_first - 19
Global Const $nm_ldown = $nm_first - 20
Global Const $nm_rdown = $nm_first - 21
Global Const $nm_themechanged = $nm_first - 22
Global Const $wm_mousefirst = 512
Global Const $wm_mousemove = 512
Global Const $wm_lbuttondown = 513
Global Const $wm_lbuttonup = 514
Global Const $wm_lbuttondblclk = 515
Global Const $wm_rbuttondown = 516
Global Const $wm_rbuttonup = 517
Global Const $wm_rbuttondblclk = 518
Global Const $wm_mbuttondown = 519
Global Const $wm_mbuttonup = 520
Global Const $wm_mbuttondblclk = 521
Global Const $wm_mousewheel = 522
Global Const $wm_xbuttondown = 523
Global Const $wm_xbuttonup = 524
Global Const $wm_xbuttondblclk = 525
Global Const $wm_mousehwheel = 526
Global Const $ps_solid = 0
Global Const $ps_dash = 1
Global Const $ps_dot = 2
Global Const $ps_dashdot = 3
Global Const $ps_dashdotdot = 4
Global Const $ps_null = 5
Global Const $ps_insideframe = 6
Global Const $ps_userstyle = 7
Global Const $ps_alternate = 8
Global Const $ps_endcap_round = 0
Global Const $ps_endcap_square = 256
Global Const $ps_endcap_flat = 512
Global Const $ps_join_bevel = 4096
Global Const $ps_join_miter = 8192
Global Const $ps_join_round = 0
Global Const $ps_geometric = 65536
Global Const $ps_cosmetic = 0
Global Const $lwa_alpha = 2
Global Const $lwa_colorkey = 1
Global Const $rgn_and = 1
Global Const $rgn_or = 2
Global Const $rgn_xor = 3
Global Const $rgn_diff = 4
Global Const $rgn_copy = 5
Global Const $errorregion = 0
Global Const $nullregion = 1
Global Const $simpleregion = 2
Global Const $complexregion = 3
Global Const $transparent = 1
Global Const $opaque = 2
Global Const $ccm_first = 8192
Global Const $ccm_getunicodeformat = ($ccm_first + 6)
Global Const $ccm_setunicodeformat = ($ccm_first + 5)
Global Const $ccm_setbkcolor = $ccm_first + 1
Global Const $ccm_setcolorscheme = $ccm_first + 2
Global Const $ccm_getcolorscheme = $ccm_first + 3
Global Const $ccm_getdroptarget = $ccm_first + 4
Global Const $ccm_setwindowtheme = $ccm_first + 11
Global Const $ga_parent = 1
Global Const $ga_root = 2
Global Const $ga_rootowner = 3
Global Const $sm_cxscreen = 0
Global Const $sm_cyscreen = 1
Global Const $sm_cxvscroll = 2
Global Const $sm_cyhscroll = 3
Global Const $sm_cycaption = 4
Global Const $sm_cxborder = 5
Global Const $sm_cyborder = 6
Global Const $sm_cxfixedframe = 7
Global Const $sm_cxdlgframe = $sm_cxfixedframe
Global Const $sm_cyfixedframe = 8
Global Const $sm_cydlgframe = $sm_cyfixedframe
Global Const $sm_cyvthumb = 9
Global Const $sm_cxhthumb = 10
Global Const $sm_cxicon = 11
Global Const $sm_cyicon = 12
Global Const $sm_cxcursor = 13
Global Const $sm_cycursor = 14
Global Const $sm_cymenu = 15
Global Const $sm_cxfullscreen = 16
Global Const $sm_cyfullscreen = 17
Global Const $sm_cykanjiwindow = 18
Global Const $sm_mousepresent = 19
Global Const $sm_cyvscroll = 20
Global Const $sm_cxhscroll = 21
Global Const $sm_debug = 22
Global Const $sm_swapbutton = 23
Global Const $sm_reserved1 = 24
Global Const $sm_reserved2 = 25
Global Const $sm_reserved3 = 26
Global Const $sm_reserved4 = 27
Global Const $sm_cxmin = 28
Global Const $sm_cymin = 29
Global Const $sm_cxsize = 30
Global Const $sm_cysize = 31
Global Const $sm_cxsizeframe = 32
Global Const $sm_cxframe = $sm_cxsizeframe
Global Const $sm_cysizeframe = 33
Global Const $sm_cyframe = $sm_cysizeframe
Global Const $sm_cxmintrack = 34
Global Const $sm_cymintrack = 35
Global Const $sm_cxdoubleclk = 36
Global Const $sm_cydoubleclk = 37
Global Const $sm_cxiconspacing = 38
Global Const $sm_cyiconspacing = 39
Global Const $sm_menudropalignment = 40
Global Const $sm_penwindows = 41
Global Const $sm_dbcsenabled = 42
Global Const $sm_cmousebuttons = 43
Global Const $sm_secure = 44
Global Const $sm_cxedge = 45
Global Const $sm_cyedge = 46
Global Const $sm_cxminspacing = 47
Global Const $sm_cyminspacing = 48
Global Const $sm_cxsmicon = 49
Global Const $sm_cysmicon = 50
Global Const $sm_cysmcaption = 51
Global Const $sm_cxsmsize = 52
Global Const $sm_cysmsize = 53
Global Const $sm_cxmenusize = 54
Global Const $sm_cymenusize = 55
Global Const $sm_arrange = 56
Global Const $sm_cxminimized = 57
Global Const $sm_cyminimized = 58
Global Const $sm_cxmaxtrack = 59
Global Const $sm_cymaxtrack = 60
Global Const $sm_cxmaximized = 61
Global Const $sm_cymaximized = 62
Global Const $sm_network = 63
Global Const $sm_cleanboot = 67
Global Const $sm_cxdrag = 68
Global Const $sm_cydrag = 69
Global Const $sm_showsounds = 70
Global Const $sm_cxmenucheck = 71
Global Const $sm_cymenucheck = 72
Global Const $sm_slowmachine = 73
Global Const $sm_mideastenabled = 74
Global Const $sm_mousewheelpresent = 75
Global Const $sm_xvirtualscreen = 76
Global Const $sm_yvirtualscreen = 77
Global Const $sm_cxvirtualscreen = 78
Global Const $sm_cyvirtualscreen = 79
Global Const $sm_cmonitors = 80
Global Const $sm_samedisplayformat = 81
Global Const $sm_immenabled = 82
Global Const $sm_cxfocusborder = 83
Global Const $sm_cyfocusborder = 84
Global Const $sm_tabletpc = 86
Global Const $sm_mediacenter = 87
Global Const $sm_starter = 88
Global Const $sm_serverr2 = 89
Global Const $sm_cmetrics = 90
Global Const $sm_remotesession = 4096
Global Const $sm_shuttingdown = 8192
Global Const $sm_remotecontrol = 8193
Global Const $sm_caretblinkingenabled = 8194
Global Const $blackness = 66
Global Const $captureblt = 1073741824
Global Const $dstinvert = 5570569
Global Const $mergecopy = 12583114
Global Const $mergepaint = 12255782
Global Const $nomirrorbitmap = -2147483648
Global Const $notsrccopy = 3342344
Global Const $notsrcerase = 1114278
Global Const $patcopy = 15728673
Global Const $patinvert = 5898313
Global Const $patpaint = 16452105
Global Const $srcand = 8913094
Global Const $srccopy = 13369376
Global Const $srcerase = 4457256
Global Const $srcinvert = 6684742
Global Const $srcpaint = 15597702
Global Const $whiteness = 16711778
Global Const $dt_bottom = 8
Global Const $dt_calcrect = 1024
Global Const $dt_center = 1
Global Const $dt_editcontrol = 8192
Global Const $dt_end_ellipsis = 32768
Global Const $dt_expandtabs = 64
Global Const $dt_externalleading = 512
Global Const $dt_hideprefix = 1048576
Global Const $dt_internal = 4096
Global Const $dt_left = 0
Global Const $dt_modifystring = 65536
Global Const $dt_noclip = 256
Global Const $dt_nofullwidthcharbreak = 524288
Global Const $dt_noprefix = 2048
Global Const $dt_path_ellipsis = 16384
Global Const $dt_prefixonly = 2097152
Global Const $dt_right = 2
Global Const $dt_rtlreading = 131072
Global Const $dt_singleline = 32
Global Const $dt_tabstop = 128
Global Const $dt_top = 0
Global Const $dt_vcenter = 4
Global Const $dt_wordbreak = 16
Global Const $dt_word_ellipsis = 262144
Global Const $rdw_erase = 4
Global Const $rdw_frame = 1024
Global Const $rdw_internalpaint = 2
Global Const $rdw_invalidate = 1
Global Const $rdw_noerase = 32
Global Const $rdw_noframe = 2048
Global Const $rdw_nointernalpaint = 16
Global Const $rdw_validate = 8
Global Const $rdw_erasenow = 512
Global Const $rdw_updatenow = 256
Global Const $rdw_allchildren = 128
Global Const $rdw_nochildren = 64
Global Const $wm_renderformat = 773
Global Const $wm_renderallformats = 774
Global Const $wm_destroyclipboard = 775
Global Const $wm_drawclipboard = 776
Global Const $wm_paintclipboard = 777
Global Const $wm_vscrollclipboard = 778
Global Const $wm_sizeclipboard = 779
Global Const $wm_askcbformatname = 780
Global Const $wm_changecbchain = 781
Global Const $wm_hscrollclipboard = 782
Global Const $hterror = -2
Global Const $httransparent = -1
Global Const $htnowhere = 0
Global Const $htclient = 1
Global Const $htcaption = 2
Global Const $htsysmenu = 3
Global Const $htgrowbox = 4
Global Const $htsize = $htgrowbox
Global Const $htmenu = 5
Global Const $hthscroll = 6
Global Const $htvscroll = 7
Global Const $htminbutton = 8
Global Const $htmaxbutton = 9
Global Const $htleft = 10
Global Const $htright = 11
Global Const $httop = 12
Global Const $httopleft = 13
Global Const $httopright = 14
Global Const $htbottom = 15
Global Const $htbottomleft = 16
Global Const $htbottomright = 17
Global Const $htborder = 18
Global Const $htreduce = $htminbutton
Global Const $htzoom = $htmaxbutton
Global Const $htsizefirst = $htleft
Global Const $htsizelast = $htbottomright
Global Const $htobject = 19
Global Const $htclose = 20
Global Const $hthelp = 21
Global Const $color_scrollbar = 0
Global Const $color_background = 1
Global Const $color_activecaption = 2
Global Const $color_inactivecaption = 3
Global Const $color_menu = 4
Global Const $color_window = 5
Global Const $color_windowframe = 6
Global Const $color_menutext = 7
Global Const $color_windowtext = 8
Global Const $color_captiontext = 9
Global Const $color_activeborder = 10
Global Const $color_inactiveborder = 11
Global Const $color_appworkspace = 12
Global Const $color_highlight = 13
Global Const $color_highlighttext = 14
Global Const $color_btnface = 15
Global Const $color_btnshadow = 16
Global Const $color_graytext = 17
Global Const $color_btntext = 18
Global Const $color_inactivecaptiontext = 19
Global Const $color_btnhighlight = 20
Global Const $color_3ddkshadow = 21
Global Const $color_3dlight = 22
Global Const $color_infotext = 23
Global Const $color_infobk = 24
Global Const $color_hotlight = 26
Global Const $color_gradientactivecaption = 27
Global Const $color_gradientinactivecaption = 28
Global Const $color_menuhilight = 29
Global Const $color_menubar = 30
Global Const $color_desktop = 1
Global Const $color_3dface = 15
Global Const $color_3dshadow = 16
Global Const $color_3dhighlight = 20
Global Const $color_3dhilight = 20
Global Const $color_btnhilight = 20
Global Const $hinst_commctrl = -1
Global Const $idb_std_small_color = 0
Global Const $idb_std_large_color = 1
Global Const $idb_view_small_color = 4
Global Const $idb_view_large_color = 5
Global Const $idb_hist_small_color = 8
Global Const $idb_hist_large_color = 9
Global Const $startf_forceofffeedback = 128
Global Const $startf_forceonfeedback = 64
Global Const $startf_preventpinning = 8192
Global Const $startf_runfullscreen = 32
Global Const $startf_titleisappid = 4096
Global Const $startf_titleislinkname = 2048
Global Const $startf_usecountchars = 8
Global Const $startf_usefillattribute = 16
Global Const $startf_usehotkey = 512
Global Const $startf_useposition = 4
Global Const $startf_useshowwindow = 1
Global Const $startf_usesize = 2
Global Const $startf_usestdhandles = 256
Global Const $cdds_prepaint = 1
Global Const $cdds_postpaint = 2
Global Const $cdds_preerase = 3
Global Const $cdds_posterase = 4
Global Const $cdds_item = 65536
Global Const $cdds_itemprepaint = 65537
Global Const $cdds_itempostpaint = 65538
Global Const $cdds_itempreerase = 65539
Global Const $cdds_itemposterase = 65540
Global Const $cdds_subitem = 131072
Global Const $cdis_selected = 1
Global Const $cdis_grayed = 2
Global Const $cdis_disabled = 4
Global Const $cdis_checked = 8
Global Const $cdis_focus = 16
Global Const $cdis_default = 32
Global Const $cdis_hot = 64
Global Const $cdis_marked = 128
Global Const $cdis_indeterminate = 256
Global Const $cdis_showkeyboardcues = 512
Global Const $cdis_nearhot = 1024
Global Const $cdis_othersidehot = 2048
Global Const $cdis_drophilited = 4096
Global Const $cdrf_dodefault = 0
Global Const $cdrf_newfont = 2
Global Const $cdrf_skipdefault = 4
Global Const $cdrf_notifypostpaint = 16
Global Const $cdrf_notifyitemdraw = 32
Global Const $cdrf_notifysubitemdraw = 32
Global Const $cdrf_notifyposterase = 64
Global Const $cdrf_doerase = 8
Global Const $cdrf_skippostpaint = 256
Global Const $gui_ss_default_gui = BitOR($ws_minimizebox, $ws_caption, $ws_popup, $ws_sysmenu)
Global Const $gdip_dashcapflat = 0
Global Const $gdip_dashcapround = 2
Global Const $gdip_dashcaptriangle = 3
Global Const $gdip_dashstylesolid = 0
Global Const $gdip_dashstyledash = 1
Global Const $gdip_dashstyledot = 2
Global Const $gdip_dashstyledashdot = 3
Global Const $gdip_dashstyledashdotdot = 4
Global Const $gdip_dashstylecustom = 5
Global Const $gdip_epgchrominancetable = "{F2E455DC-09B3-4316-8260-676ADA32481C}"
Global Const $gdip_epgcolordepth = "{66087055-AD66-4C7C-9A18-38A2310B8337}"
Global Const $gdip_epgcompression = "{E09D739D-CCD4-44EE-8EBA-3FBF8BE4FC58}"
Global Const $gdip_epgluminancetable = "{EDB33BCE-0266-4A77-B904-27216099E717}"
Global Const $gdip_epgquality = "{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}"
Global Const $gdip_epgrendermethod = "{6D42C53A-229A-4825-8BB7-5C99E2B9A8B8}"
Global Const $gdip_epgsaveflag = "{292266FC-AC40-47BF-8CFC-A85B89A655DE}"
Global Const $gdip_epgscanmethod = "{3A4E2661-3109-4E56-8536-42C156E7DCFA}"
Global Const $gdip_epgtransformation = "{8D0EB2D1-A58E-4EA8-AA14-108074B7B6F9}"
Global Const $gdip_epgversion = "{24D18C76-814A-41A4-BF53-1C219CCCF797}"
Global Const $gdip_eptbyte = 1
Global Const $gdip_eptascii = 2
Global Const $gdip_eptshort = 3
Global Const $gdip_eptlong = 4
Global Const $gdip_eptrational = 5
Global Const $gdip_eptlongrange = 6
Global Const $gdip_eptundefined = 7
Global Const $gdip_eptrationalrange = 8
Global Const $gdip_errok = 0
Global Const $gdip_errgenericerror = 1
Global Const $gdip_errinvalidparameter = 2
Global Const $gdip_erroutofmemory = 3
Global Const $gdip_errobjectbusy = 4
Global Const $gdip_errinsufficientbuffer = 5
Global Const $gdip_errnotimplemented = 6
Global Const $gdip_errwin32error = 7
Global Const $gdip_errwrongstate = 8
Global Const $gdip_erraborted = 9
Global Const $gdip_errfilenotfound = 10
Global Const $gdip_errvalueoverflow = 11
Global Const $gdip_erraccessdenied = 12
Global Const $gdip_errunknownimageformat = 13
Global Const $gdip_errfontfamilynotfound = 14
Global Const $gdip_errfontstylenotfound = 15
Global Const $gdip_errnottruetypefont = 16
Global Const $gdip_errunsupportedgdiversion = 17
Global Const $gdip_errgdiplusnotinitialized = 18
Global Const $gdip_errpropertynotfound = 19
Global Const $gdip_errpropertynotsupported = 20
Global Const $gdip_evtcompressionlzw = 2
Global Const $gdip_evtcompressionccitt3 = 3
Global Const $gdip_evtcompressionccitt4 = 4
Global Const $gdip_evtcompressionrle = 5
Global Const $gdip_evtcompressionnone = 6
Global Const $gdip_evttransformrotate90 = 13
Global Const $gdip_evttransformrotate180 = 14
Global Const $gdip_evttransformrotate270 = 15
Global Const $gdip_evttransformfliphorizontal = 16
Global Const $gdip_evttransformflipvertical = 17
Global Const $gdip_evtmultiframe = 18
Global Const $gdip_evtlastframe = 19
Global Const $gdip_evtflush = 20
Global Const $gdip_evtframedimensionpage = 23
Global Const $gdip_icfencoder = 1
Global Const $gdip_icfdecoder = 2
Global Const $gdip_icfsupportbitmap = 4
Global Const $gdip_icfsupportvector = 8
Global Const $gdip_icfseekableencode = 16
Global Const $gdip_icfblockingdecode = 32
Global Const $gdip_icfbuiltin = 65536
Global Const $gdip_icfsystem = 131072
Global Const $gdip_icfuser = 262144
Global Const $gdip_ilmread = 1
Global Const $gdip_ilmwrite = 2
Global Const $gdip_ilmuserinputbuf = 4
Global Const $gdip_linecapflat = 0
Global Const $gdip_linecapsquare = 1
Global Const $gdip_linecapround = 2
Global Const $gdip_linecaptriangle = 3
Global Const $gdip_linecapnoanchor = 16
Global Const $gdip_linecapsquareanchor = 17
Global Const $gdip_linecaproundanchor = 18
Global Const $gdip_linecapdiamondanchor = 19
Global Const $gdip_linecaparrowanchor = 20
Global Const $gdip_linecapcustom = 255
Global Const $gdip_pxf01indexed = 196865
Global Const $gdip_pxf04indexed = 197634
Global Const $gdip_pxf08indexed = 198659
Global Const $gdip_pxf16grayscale = 1052676
Global Const $gdip_pxf16rgb555 = 135173
Global Const $gdip_pxf16rgb565 = 135174
Global Const $gdip_pxf16argb1555 = 397319
Global Const $gdip_pxf24rgb = 137224
Global Const $gdip_pxf32rgb = 139273
Global Const $gdip_pxf32argb = 2498570
Global Const $gdip_pxf32pargb = 925707
Global Const $gdip_pxf48rgb = 1060876
Global Const $gdip_pxf64argb = 3424269
Global Const $gdip_pxf64pargb = 1720334
Global Const $gdip_imageformat_undefined = "{B96B3CA9-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_memorybmp = "{B96B3CAA-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_bmp = "{B96B3CAB-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_emf = "{B96B3CAC-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_wmf = "{B96B3CAD-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_jpeg = "{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_png = "{B96B3CAF-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_gif = "{B96B3CB0-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_tiff = "{B96B3CB1-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_exif = "{B96B3CB2-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imageformat_icon = "{B96B3CB5-0728-11D3-9D7B-0000F81EF32E}"
Global Const $gdip_imagetype_unknown = 0
Global Const $gdip_imagetype_bitmap = 1
Global Const $gdip_imagetype_metafile = 2
Global Const $gdip_imageflags_none = 0
Global Const $gdip_imageflags_scalable = 1
Global Const $gdip_imageflags_hasalpha = 2
Global Const $gdip_imageflags_hastranslucent = 4
Global Const $gdip_imageflags_partiallyscalable = 8
Global Const $gdip_imageflags_colorspace_rgb = 16
Global Const $gdip_imageflags_colorspace_cmyk = 32
Global Const $gdip_imageflags_colorspace_gray = 64
Global Const $gdip_imageflags_colorspace_ycbcr = 128
Global Const $gdip_imageflags_colorspace_ycck = 256
Global Const $gdip_imageflags_hasrealdpi = 4096
Global Const $gdip_imageflags_hasrealpixelsize = 8192
Global Const $gdip_imageflags_readonly = 65536
Global Const $gdip_imageflags_caching = 131072
Global Const $gdip_smoothingmode_invalid = -1
Global Const $gdip_smoothingmode_default = 0
Global Const $gdip_smoothingmode_highspeed = 1
Global Const $gdip_smoothingmode_highquality = 2
Global Const $gdip_smoothingmode_none = 3
Global Const $gdip_smoothingmode_antialias8x4 = 4
Global Const $gdip_smoothingmode_antialias = $gdip_smoothingmode_antialias8x4
Global Const $gdip_smoothingmode_antialias8x8 = 5
Global Const $gdip_rlum = 0.3086
Global Const $gdip_glum = 0.6094
Global Const $gdip_blum = 0.082
Global Const $gdip_interpolationmode_invalid = -1
Global Const $gdip_interpolationmode_default = 0
Global Const $gdip_interpolationmode_lowquality = 1
Global Const $gdip_interpolationmode_highquality = 2
Global Const $gdip_interpolationmode_bilinear = 3
Global Const $gdip_interpolationmode_bicubic = 4
Global Const $gdip_interpolationmode_nearestneighbor = 5
Global Const $gdip_interpolationmode_highqualitybilinear = 6
Global Const $gdip_interpolationmode_highqualitybicubic = 7
Global Const $gdip_textrenderinghint_systemdefault = 0
Global Const $gdip_textrenderinghint_singlebitperpixelgridfit = 1
Global Const $gdip_textrenderinghint_singlebitperpixel = 2
Global Const $gdip_textrenderinghint_antialiasgridfit = 3
Global Const $gdip_textrenderinghint_antialias = 4
Global Const $gdip_textrenderinghint_cleartypegridfit = 5
Global Const $gdip_pixeloffsetmode_invalid = -1
Global Const $gdip_pixeloffsetmode_default = 0
Global Const $gdip_pixeloffsetmode_highspeed = 1
Global Const $gdip_pixeloffsetmode_highquality = 2
Global Const $gdip_pixeloffsetmode_none = 3
Global Const $gdip_pixeloffsetmode_half = 4
Global Const $gdip_pensetlinejoin_miter = 0
Global Const $gdip_pensetlinejoin_bevel = 1
Global Const $gdip_pensetlinejoin_round = 2
Global Const $gdip_pensetlinejoin_miterclipped = 3
Global Const $gdip_fillmodealternate = 0
Global Const $gdip_fillmodewinding = 1
Global Const $gdip_qualitymodeinvalid = -1
Global Const $gdip_qualitymodedefault = 0
Global Const $gdip_qualitymodelow = 1
Global Const $gdip_qualitymodehigh = 2
Global Const $gdip_compositingmodesourceover = 0
Global Const $gdip_compositingmodesourcecopy = 1
Global Const $gdip_compositingqualityinvalid = $gdip_qualitymodeinvalid
Global Const $gdip_compositingqualitydefault = $gdip_qualitymodedefault
Global Const $gdip_compositingqualityhighspeed = $gdip_qualitymodelow
Global Const $gdip_compositingqualityhighquality = $gdip_qualitymodehigh
Global Const $gdip_compositingqualitygammacorrected = 3
Global Const $gdip_compositingqualityassumelinear = 4
Global Const $gdip_hatchstyle_horizontal = 0
Global Const $gdip_hatchstyle_vertical = 1
Global Const $gdip_hatchstyle_forwarddiagonal = 2
Global Const $gdip_hatchstyle_backwarddiagonal = 3
Global Const $gdip_hatchstyle_cross = 4
Global Const $gdip_hatchstyle_diagonalcross = 5
Global Const $gdip_hatchstyle_05percent = 6
Global Const $gdip_hatchstyle_10percent = 7
Global Const $gdip_hatchstyle_20percent = 8
Global Const $gdip_hatchstyle_25percent = 9
Global Const $gdip_hatchstyle_30percent = 10
Global Const $gdip_hatchstyle_40percent = 11
Global Const $gdip_hatchstyle_50percent = 12
Global Const $gdip_hatchstyle_60percent = 13
Global Const $gdip_hatchstyle_70percent = 14
Global Const $gdip_hatchstyle_75percent = 15
Global Const $gdip_hatchstyle_80percent = 16
Global Const $gdip_hatchstyle_90percent = 17
Global Const $gdip_hatchstyle_lightdownwarddiagonal = 18
Global Const $gdip_hatchstyle_lightupwarddiagonal = 19
Global Const $gdip_hatchstyle_darkdownwarddiagonal = 20
Global Const $gdip_hatchstyle_darkupwarddiagonal = 21
Global Const $gdip_hatchstyle_widedownwarddiagonal = 22
Global Const $gdip_hatchstyle_wideupwarddiagonal = 23
Global Const $gdip_hatchstyle_lightvertical = 24
Global Const $gdip_hatchstyle_lighthorizontal = 25
Global Const $gdip_hatchstyle_narrowvertical = 26
Global Const $gdip_hatchstyle_narrowhorizontal = 27
Global Const $gdip_hatchstyle_darkvertical = 28
Global Const $gdip_hatchstyle_darkhorizontal = 29
Global Const $gdip_hatchstyle_dasheddownwarddiagonal = 30
Global Const $gdip_hatchstyle_dashedupwarddiagonal = 31
Global Const $gdip_hatchstyle_dashedhorizontal = 32
Global Const $gdip_hatchstyle_dashedvertical = 33
Global Const $gdip_hatchstyle_smallconfetti = 34
Global Const $gdip_hatchstyle_largeconfetti = 35
Global Const $gdip_hatchstyle_zigzag = 36
Global Const $gdip_hatchstyle_wave = 37
Global Const $gdip_hatchstyle_diagonalbrick = 38
Global Const $gdip_hatchstyle_horizontalbrick = 39
Global Const $gdip_hatchstyle_weave = 40
Global Const $gdip_hatchstyle_plaid = 41
Global Const $gdip_hatchstyle_divot = 42
Global Const $gdip_hatchstyle_dottedgrid = 43
Global Const $gdip_hatchstyle_dotteddiamond = 44
Global Const $gdip_hatchstyle_shingle = 45
Global Const $gdip_hatchstyle_trellis = 46
Global Const $gdip_hatchstyle_sphere = 47
Global Const $gdip_hatchstyle_smallgrid = 48
Global Const $gdip_hatchstyle_smallcheckerboard = 49
Global Const $gdip_hatchstyle_largecheckerboard = 50
Global Const $gdip_hatchstyle_outlineddiamond = 51
Global Const $gdip_hatchstyle_soliddiamond = 52
Global Const $gdip_hatchstyle_total = 53
Global Const $gdip_hatchstyle_largegrid = $gdip_hatchstyle_cross
Global Const $gdip_hatchstyle_min = $gdip_hatchstyle_horizontal
Global Const $gdip_hatchstyle_max = $gdip_hatchstyle_total - 1
Global Const $gdip_blureffectguid = "{633C80A4-1843-482b-9EF2-BE2834C5FDD4}"
Global Const $gdip_sharpeneffectguid = "{63CBF3EE-C526-402c-8F71-62C540BF5142}"
Global Const $gdip_colormatrixeffectguid = "{718F2615-7933-40e3-A511-5F68FE14DD74}"
Global Const $gdip_colorluteffectguid = "{A7CE72A9-0F7F-40d7-B3CC-D0C02D5C3212}"
Global Const $gdip_brightnesscontrasteffectguid = "{D3A1DBE1-8EC4-4c17-9F4C-EA97AD1C343D}"
Global Const $gdip_huesaturationlightnesseffectguid = "{8B2DD6C3-EB07-4d87-A5F0-7108E26A9C5F}"
Global Const $gdip_levelseffectguid = "{99C354EC-2A31-4f3a-8C34-17A803B33A25}"
Global Const $gdip_tinteffectguid = "{1077AF00-2848-4441-9489-44AD4C2D7A2C}"
Global Const $gdip_colorbalanceeffectguid = "{537E597D-251E-48da-9664-29CA496B70F8}"
Global Const $gdip_redeyecorrectioneffectguid = "{74D29D05-69A4-4266-9549-3CC52836B632}"
Global Const $gdip_colorcurveeffectguid = "{DD6A0022-58E4-4a67-9D9B-D48EB881A53D}"
Global Const $gdip_adjustexposure = 0
Global Const $gdip_adjustdensity = 1
Global Const $gdip_adjustcontrast = 2
Global Const $gdip_adjusthighlight = 3
Global Const $gdip_adjustshadow = 4
Global Const $gdip_adjustmidtone = 5
Global Const $gdip_adjustwhitesaturation = 6
Global Const $gdip_adjustblacksaturation = 7
Global Const $gdip_curvechannelall = 0
Global Const $gdip_curvechannelred = 1
Global Const $gdip_curvechannelgreen = 2
Global Const $gdip_curvechannelblue = 3
Global Const $gdip_palettetypecustom = 0
Global Const $gdip_palettetypeoptimal = 1
Global Const $gdip_palettetypefixedbw = 2
Global Const $gdip_palettetypefixedhalftone8 = 3
Global Const $gdip_palettetypefixedhalftone27 = 4
Global Const $gdip_palettetypefixedhalftone64 = 5
Global Const $gdip_palettetypefixedhalftone125 = 6
Global Const $gdip_palettetypefixedhalftone216 = 7
Global Const $gdip_palettetypefixedhalftone252 = 8
Global Const $gdip_palettetypefixedhalftone256 = 9
Global Const $gdip_paletteflagshasalpha = 1
Global Const $gdip_paletteflagsgrayscale = 2
Global Const $gdip_paletteflagshalftone = 4
Global Const $gdip_dithertypenone = 0
Global Const $gdip_dithertypesolid = 1
Global Const $gdip_dithertypeordered4x4 = 2
Global Const $gdip_dithertypeordered8x8 = 3
Global Const $gdip_dithertypeordered16x16 = 4
Global Const $gdip_dithertypeordered91x91 = 5
Global Const $gdip_dithertypespiral4x4 = 6
Global Const $gdip_dithertypespiral8x8 = 7
Global Const $gdip_dithertypedualspiral4x4 = 8
Global Const $gdip_dithertypedualspiral8x8 = 9
Global Const $gdip_dithertypeerrordiffusion = 10
Global Const $gdip_dithertypemax = 10
Global Const $gdip_histogramformatargb = 0
Global Const $gdip_histogramformatpargb = 1
Global Const $gdip_histogramformatrgb = 2
Global Const $gdip_histogramformatgray = 3
Global Const $gdip_histogramformatb = 4
Global Const $gdip_histogramformatg = 5
Global Const $gdip_histogramformatr = 6
Global Const $gdip_histogramformata = 7
Global Const $gdip_textrenderinghintsystemdefault = 0
Global Const $gdip_textrenderinghintsinglebitperpixelgridfit = 1
Global Const $gdip_textrenderinghintsinglebitperpixel = 2
Global Const $gdip_textrenderinghintantialiasgridfit = 3
Global Const $gdip_textrenderinghintantialias = 4
Global Const $gdip_textrenderinghintcleartypegridfit = 5
Global Const $gdip_rotatenoneflipnone = 0
Global Const $gdip_rotate90flipnone = 1
Global Const $gdip_rotate180flipnone = 2
Global Const $gdip_rotate270flipnone = 3
Global Const $gdip_rotatenoneflipx = 4
Global Const $gdip_rotate90flipx = 5
Global Const $gdip_rotate180flipx = 6
Global Const $gdip_rotate270flipx = 7
Global Const $gdip_rotatenoneflipy = $gdip_rotate180flipx
Global Const $gdip_rotate90flipy = $gdip_rotate270flipx
Global Const $gdip_rotate180flipy = $gdip_rotatenoneflipx
Global Const $gdip_rotate270flipy = $gdip_rotate90flipx
Global Const $gdip_rotatenoneflipxy = $gdip_rotate180flipnone
Global Const $gdip_rotate90flipxy = $gdip_rotate270flipnone
Global Const $gdip_rotate270flipxy = $gdip_rotate90flipnone
Global Const $gdip_framedimension_time = "{6AEDBD6D-3FB5-418A-83A6-7F45229DC872}"
Global Const $gdip_framedimension_resolution = "{84236F7B-3BD3-428F-8DAB-4EA1439CA315}"
Global Const $gdip_framedimension_page = "{7462DC86-6180-4C7E-8E3F-EE7333A7A483}"
Global Const $gdip_coloradjusttype_default = 0
Global Const $gdip_coloradjusttype_bitmap = 1
Global Const $gdip_coloradjusttype_brush = 2
Global Const $gdip_coloradjusttype_pen = 3
Global Const $gdip_coloradjusttype_text = 4
Global Const $gdip_coloradjusttype_count = 5
Global Const $gdip_coloradjusttype_any = 6
Global Const $tagpoint = "struct;long X;long Y;endstruct"
Global Const $tagrect = "struct;long Left;long Top;long Right;long Bottom;endstruct"
Global Const $tagsize = "struct;long X;long Y;endstruct"
Global Const $tagmargins = "int cxLeftWidth;int cxRightWidth;int cyTopHeight;int cyBottomHeight"
Global Const $tagfiletime = "struct;dword Lo;dword Hi;endstruct"
Global Const $tagsystemtime = "struct;word Year;word Month;word Dow;word Day;word Hour;word Minute;word Second;word MSeconds;endstruct"
Global Const $tagtime_zone_information = "struct;long Bias;wchar StdName[32];word StdDate[8];long StdBias;wchar DayName[32];word DayDate[8];long DayBias;endstruct"
Global Const $tagnmhdr = "struct;hwnd hWndFrom;uint_ptr IDFrom;INT Code;endstruct"
Global Const $tagcomboboxexitem = "uint Mask;int_ptr Item;ptr Text;int TextMax;int Image;int SelectedImage;int OverlayImage;" & "int Indent;lparam Param"
Global Const $tagnmcbedragbegin = $tagnmhdr & ";int ItemID;wchar szText[260]"
Global Const $tagnmcbeendedit = $tagnmhdr & ";bool fChanged;int NewSelection;wchar szText[260];int Why"
Global Const $tagnmcomboboxex = $tagnmhdr & ";uint Mask;int_ptr Item;ptr Text;int TextMax;int Image;" & "int SelectedImage;int OverlayImage;int Indent;lparam Param"
Global Const $tagdtprange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;" & "word MinSecond;word MinMSecond;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;" & "word MaxMinute;word MaxSecond;word MaxMSecond;bool MinValid;bool MaxValid"
Global Const $tagnmdatetimechange = $tagnmhdr & ";dword Flag;" & $tagsystemtime
Global Const $tagnmdatetimeformat = $tagnmhdr & ";ptr Format;" & $tagsystemtime & ";ptr pDisplay;wchar Display[64]"
Global Const $tagnmdatetimeformatquery = $tagnmhdr & ";ptr Format;struct;long SizeX;long SizeY;endstruct"
Global Const $tagnmdatetimekeydown = $tagnmhdr & ";int VirtKey;ptr Format;" & $tagsystemtime
Global Const $tagnmdatetimestring = $tagnmhdr & ";ptr UserString;" & $tagsystemtime & ";dword Flags"
Global Const $tageventlogrecord = "dword Length;dword Reserved;dword RecordNumber;dword TimeGenerated;dword TimeWritten;dword EventID;" & "word EventType;word NumStrings;word EventCategory;word ReservedFlags;dword ClosingRecordNumber;dword StringOffset;" & "dword UserSidLength;dword UserSidOffset;dword DataLength;dword DataOffset"
Global Const $taggdip_effectparams_blur = "float Radius; bool ExpandEdge"
Global Const $taggdip_effectparams_brightnesscontrast = "int BrightnessLevel; int ContrastLevel"
Global Const $taggdip_effectparams_colorbalance = "int CyanRed; int MagentaGreen; int YellowBlue"
Global Const $taggdip_effectparams_colorcurve = "int Adjustment; int Channel; int AdjustValue"
Global Const $taggdip_effectparams_colorlut = "byte LutB[256]; byte LutG[256]; byte LutR[256]; byte LutA[256]"
Global Const $taggdip_effectparams_huesaturationlightness = "int HueLevel; int SaturationLevel; int LightnessLevel"
Global Const $taggdip_effectparams_levels = "int Highlight; int Midtone; int Shadow"
Global Const $taggdip_effectparams_redeyecorrection = "uint NumberOfAreas; ptr Areas"
Global Const $taggdip_effectparams_sharpen = "float Radius; float Amount"
Global Const $taggdip_effectparams_tint = "int Hue; int Amount"
Global Const $taggdipbitmapdata = "uint Width;uint Height;int Stride;int Format;ptr Scan0;uint_ptr Reserved"
Global Const $taggdipcolormatrix = "float m[25]"
Global Const $taggdipencoderparam = "struct;byte GUID[16];ulong NumberOfValues;ulong Type;ptr Values;endstruct"
Global Const $taggdipencoderparams = "uint Count;" & $taggdipencoderparam
Global Const $taggdiprectf = "struct;float X;float Y;float Width;float Height;endstruct"
Global Const $taggdipstartupinput = "uint Version;ptr Callback;bool NoThread;bool NoCodecs"
Global Const $taggdipstartupoutput = "ptr HookProc;ptr UnhookProc"
Global Const $taggdipimagecodecinfo = "byte CLSID[16];byte FormatID[16];ptr CodecName;ptr DllName;ptr FormatDesc;ptr FileExt;" & "ptr MimeType;dword Flags;dword Version;dword SigCount;dword SigSize;ptr SigPattern;ptr SigMask"
Global Const $taggdippencoderparams = "uint Count;byte Params[1]"
Global Const $taghditem = "uint Mask;int XY;ptr Text;handle hBMP;int TextMax;int Fmt;lparam Param;int Image;int Order;uint Type;ptr pFilter;uint State"
Global Const $tagnmhddispinfo = $tagnmhdr & ";int Item;uint Mask;ptr Text;int TextMax;int Image;lparam lParam"
Global Const $tagnmhdfilterbtnclick = $tagnmhdr & ";int Item;" & $tagrect
Global Const $tagnmheader = $tagnmhdr & ";int Item;int Button;ptr pItem"
Global Const $taggetipaddress = "byte Field4;byte Field3;byte Field2;byte Field1"
Global Const $tagnmipaddress = $tagnmhdr & ";int Field;int Value"
Global Const $taglvfindinfo = "struct;uint Flags;ptr Text;lparam Param;" & $tagpoint & ";uint Direction;endstruct"
Global Const $taglvhittestinfo = $tagpoint & ";uint Flags;int Item;int SubItem;int iGroup"
Global Const $taglvitem = "struct;uint Mask;int Item;int SubItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;lparam Param;" & "int Indent;int GroupID;uint Columns;ptr pColumns;ptr piColFmt;int iGroup;endstruct"
Global Const $tagnmlistview = $tagnmhdr & ";int Item;int SubItem;uint NewState;uint OldState;uint Changed;" & "struct;long ActionX;long ActionY;endstruct;lparam Param"
Global Const $tagnmlvcustomdraw = "struct;" & $tagnmhdr & ";dword dwDrawStage;handle hdc;" & $tagrect & ";dword_ptr dwItemSpec;uint uItemState;lparam lItemlParam;endstruct" & ";dword clrText;dword clrTextBk;int iSubItem;dword dwItemType;dword clrFace;int iIconEffect;" & "int iIconPhase;int iPartID;int iStateID;struct;long TextLeft;long TextTop;long TextRight;long TextBottom;endstruct;uint uAlign"
Global Const $tagnmlvdispinfo = $tagnmhdr & ";" & $taglvitem
Global Const $tagnmlvfinditem = $tagnmhdr & ";int Start;" & $taglvfindinfo
Global Const $tagnmlvgetinfotip = $tagnmhdr & ";dword Flags;ptr Text;int TextMax;int Item;int SubItem;lparam lParam"
Global Const $tagnmitemactivate = $tagnmhdr & ";int Index;int SubItem;uint NewState;uint OldState;uint Changed;" & $tagpoint & ";lparam lParam;uint KeyFlags"
Global Const $tagnmlvkeydown = "align 1;" & $tagnmhdr & ";word VKey;uint Flags"
Global Const $tagnmlvscroll = $tagnmhdr & ";int DX;int DY"
Global Const $tagmchittestinfo = "uint Size;" & $tagpoint & ";uint Hit;" & $tagsystemtime & ";" & $tagrect & ";int iOffset;int iRow;int iCol"
Global Const $tagmcmonthrange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;" & "word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;" & "word MaxMSeconds;short Span"
Global Const $tagmcrange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;" & "word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;" & "word MaxMSeconds;short MinSet;short MaxSet"
Global Const $tagmcselrange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;" & "word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;" & "word MaxMSeconds"
Global Const $tagnmdaystate = $tagnmhdr & ";" & $tagsystemtime & ";int DayState;ptr pDayState"
Global Const $tagnmselchange = $tagnmhdr & ";struct;word BegYear;word BegMonth;word BegDOW;word BegDay;word BegHour;word BegMinute;word BegSecond;word BegMSeconds;endstruct;" & "struct;word EndYear;word EndMonth;word EndDOW;word EndDay;word EndHour;word EndMinute;word EndSecond;word EndMSeconds;endstruct"
Global Const $tagnmobjectnotify = $tagnmhdr & ";int Item;ptr piid;ptr pObject;long Result;dword dwFlags"
Global Const $tagnmtckeydown = "align 1;" & $tagnmhdr & ";word VKey;uint Flags"
Global Const $tagtvitem = "struct;uint Mask;handle hItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;int SelectedImage;" & "int Children;lparam Param;endstruct"
Global Const $tagtvitemex = "struct;" & $tagtvitem & ";int Integral;uint uStateEx;hwnd hwnd;int iExpandedImage;int iReserved;endstruct"
Global Const $tagnmtreeview = $tagnmhdr & ";uint Action;" & "struct;uint OldMask;handle OldhItem;uint OldState;uint OldStateMask;" & "ptr OldText;int OldTextMax;int OldImage;int OldSelectedImage;int OldChildren;lparam OldParam;endstruct;" & "struct;uint NewMask;handle NewhItem;uint NewState;uint NewStateMask;" & "ptr NewText;int NewTextMax;int NewImage;int NewSelectedImage;int NewChildren;lparam NewParam;endstruct;" & "struct;long PointX;long PointY;endstruct"
Global Const $tagnmtvcustomdraw = "struct;" & $tagnmhdr & ";dword DrawStage;handle HDC;" & $tagrect & ";dword_ptr ItemSpec;uint ItemState;lparam ItemParam;endstruct" & ";dword ClrText;dword ClrTextBk;int Level"
Global Const $tagnmtvdispinfo = $tagnmhdr & ";" & $tagtvitem
Global Const $tagnmtvgetinfotip = $tagnmhdr & ";ptr Text;int TextMax;handle hItem;lparam lParam"
Global Const $tagnmtvitemchange = $tagnmhdr & ";uint Changed;handle hItem;uint StateNew;uint StateOld;lparam lParam;"
Global Const $tagtvhittestinfo = $tagpoint & ";uint Flags;handle Item"
Global Const $tagnmtvkeydown = "align 1;" & $tagnmhdr & ";word VKey;uint Flags"
Global Const $tagnmmouse = $tagnmhdr & ";dword_ptr ItemSpec;dword_ptr ItemData;" & $tagpoint & ";lparam HitInfo"
Global Const $tagtoken_privileges = "dword Count;align 4;int64 LUID;dword Attributes"
Global Const $tagimageinfo = "handle hBitmap;handle hMask;int Unused1;int Unused2;" & $tagrect
Global Const $tagmenuinfo = "dword Size;INT Mask;dword Style;uint YMax;handle hBack;dword ContextHelpID;ulong_ptr MenuData"
Global Const $tagmenuiteminfo = "uint Size;uint Mask;uint Type;uint State;uint ID;handle SubMenu;handle BmpChecked;handle BmpUnchecked;" & "ulong_ptr ItemData;ptr TypeData;uint CCH;handle BmpItem"
Global Const $tagrebarbandinfo = "uint cbSize;uint fMask;uint fStyle;dword clrFore;dword clrBack;ptr lpText;uint cch;" & "int iImage;hwnd hwndChild;uint cxMinChild;uint cyMinChild;uint cx;handle hbmBack;uint wID;uint cyChild;uint cyMaxChild;" & "uint cyIntegral;uint cxIdeal;lparam lParam;uint cxHeader" & ((@OSVersion = "WIN_XP") ? "" : ";" & $tagrect & ";uint uChevronState")
Global Const $tagnmrebarautobreak = $tagnmhdr & ";uint uBand;uint wID;lparam lParam;uint uMsg;uint fStyleCurrent;bool fAutoBreak"
Global Const $tagnmrbautosize = $tagnmhdr & ";bool fChanged;" & "struct;long TargetLeft;long TargetTop;long TargetRight;long TargetBottom;endstruct;" & "struct;long ActualLeft;long ActualTop;long ActualRight;long ActualBottom;endstruct"
Global Const $tagnmrebar = $tagnmhdr & ";dword dwMask;uint uBand;uint fStyle;uint wID;lparam lParam"
Global Const $tagnmrebarchevron = $tagnmhdr & ";uint uBand;uint wID;lparam lParam;" & $tagrect & ";lparam lParamNM"
Global Const $tagnmrebarchildsize = $tagnmhdr & ";uint uBand;uint wID;" & "struct;long CLeft;long CTop;long CRight;long CBottom;endstruct;" & "struct;long BLeft;long BTop;long BRight;long BBottom;endstruct"
Global Const $tagcolorscheme = "dword Size;dword BtnHighlight;dword BtnShadow"
Global Const $tagnmtoolbar = $tagnmhdr & ";int iItem;" & "struct;int iBitmap;int idCommand;byte fsState;byte fsStyle;dword_ptr dwData;int_ptr iString;endstruct" & ";int cchText;ptr pszText;" & $tagrect
Global Const $tagnmtbhotitem = $tagnmhdr & ";int idOld;int idNew;dword dwFlags"
Global Const $tagtbbutton = "int Bitmap;int Command;byte State;byte Style;dword_ptr Param;int_ptr String"
Global Const $tagtbbuttoninfo = "uint Size;dword Mask;int Command;int Image;byte State;byte Style;word CX;dword_ptr Param;ptr Text;int TextMax"
Global Const $tagnetresource = "dword Scope;dword Type;dword DisplayType;dword Usage;ptr LocalName;ptr RemoteName;ptr Comment;ptr Provider"
Global Const $tagoverlapped = "ulong_ptr Internal;ulong_ptr InternalHigh;struct;dword Offset;dword OffsetHigh;endstruct;handle hEvent"
Global Const $tagopenfilename = "dword StructSize;hwnd hwndOwner;handle hInstance;ptr lpstrFilter;ptr lpstrCustomFilter;" & "dword nMaxCustFilter;dword nFilterIndex;ptr lpstrFile;dword nMaxFile;ptr lpstrFileTitle;dword nMaxFileTitle;" & "ptr lpstrInitialDir;ptr lpstrTitle;dword Flags;word nFileOffset;word nFileExtension;ptr lpstrDefExt;lparam lCustData;" & "ptr lpfnHook;ptr lpTemplateName;ptr pvReserved;dword dwReserved;dword FlagsEx"
Global Const $tagbitmapinfoheader = "struct;dword biSize;long biWidth;long biHeight;word biPlanes;word biBitCount;" & "dword biCompression;dword biSizeImage;long biXPelsPerMeter;long biYPelsPerMeter;dword biClrUsed;dword biClrImportant;endstruct"
Global Const $tagbitmapinfo = $tagbitmapinfoheader & ";dword biRGBQuad[1]"
Global Const $tagblendfunction = "byte Op;byte Flags;byte Alpha;byte Format"
Global Const $tagguid = "struct;ulong Data1;ushort Data2;ushort Data3;byte Data4[8];endstruct"
Global Const $tagwindowplacement = "uint length;uint flags;uint showCmd;long ptMinPosition[2];long ptMaxPosition[2];long rcNormalPosition[4]"
Global Const $tagwindowpos = "hwnd hWnd;hwnd InsertAfter;int X;int Y;int CX;int CY;uint Flags"
Global Const $tagscrollinfo = "uint cbSize;uint fMask;int nMin;int nMax;uint nPage;int nPos;int nTrackPos"
Global Const $tagscrollbarinfo = "dword cbSize;" & $tagrect & ";int dxyLineButton;int xyThumbTop;" & "int xyThumbBottom;int reserved;dword rgstate[6]"
Global Const $taglogfont = "struct;long Height;long Width;long Escapement;long Orientation;long Weight;byte Italic;byte Underline;" & "byte Strikeout;byte CharSet;byte OutPrecision;byte ClipPrecision;byte Quality;byte PitchAndFamily;wchar FaceName[32];endstruct"
Global Const $tagkbdllhookstruct = "dword vkCode;dword scanCode;dword flags;dword time;ulong_ptr dwExtraInfo"
Global Const $tagprocess_information = "handle hProcess;handle hThread;dword ProcessID;dword ThreadID"
Global Const $tagstartupinfo = "dword Size;ptr Reserved1;ptr Desktop;ptr Title;dword X;dword Y;dword XSize;dword YSize;dword XCountChars;" & "dword YCountChars;dword FillAttribute;dword Flags;word ShowWindow;word Reserved2;ptr Reserved3;handle StdInput;" & "handle StdOutput;handle StdError"
Global Const $tagsecurity_attributes = "dword Length;ptr Descriptor;bool InheritHandle"
Global Const $tagwin32_find_data = "dword dwFileAttributes;dword ftCreationTime[2];dword ftLastAccessTime[2];dword ftLastWriteTime[2];dword nFileSizeHigh;dword nFileSizeLow;dword dwReserved0;dword dwReserved1;wchar cFileName[260];wchar cAlternateFileName[14]"
Global Const $tagtextmetric = "long tmHeight;long tmAscent;long tmDescent;long tmInternalLeading;long tmExternalLeading;" & "long tmAveCharWidth;long tmMaxCharWidth;long tmWeight;long tmOverhang;long tmDigitizedAspectX;long tmDigitizedAspectY;" & "wchar tmFirstChar;wchar tmLastChar;wchar tmDefaultChar;wchar tmBreakChar;byte tmItalic;byte tmUnderlined;byte tmStruckOut;" & "byte tmPitchAndFamily;byte tmCharSet"
Global Const $coinit_apartmentthreaded = 2
Global Const $coinit_disable_ole1dde = 4
Global Const $coinit_multithreaded = 0
Global Const $coinit_speed_over_memory = 8
Global Const $opt_coordsrelative = 0
Global Const $opt_coordsabsolute = 1
Global Const $opt_coordsclient = 2
Global Const $opt_errorsilent = 0
Global Const $opt_errorfatal = 1
Global Const $opt_capsnostore = 0
Global Const $opt_capsstore = 1
Global Const $opt_matchstart = 1
Global Const $opt_matchany = 2
Global Const $opt_matchexact = 3
Global Const $opt_matchadvanced = 4
Global Const $ccs_top = 1
Global Const $ccs_nomovey = 2
Global Const $ccs_bottom = 3
Global Const $ccs_noresize = 4
Global Const $ccs_noparentalign = 8
Global Const $ccs_nohilite = 16
Global Const $ccs_adjustable = 32
Global Const $ccs_nodivider = 64
Global Const $ccs_vert = 128
Global Const $ccs_left = 129
Global Const $ccs_nomovex = 130
Global Const $ccs_right = 131
Global Const $dt_drivetype = 1
Global Const $dt_ssdstatus = 2
Global Const $dt_bustype = 3
Global Const $proxy_ie = 0
Global Const $proxy_none = 1
Global Const $proxy_specified = 2
Global Const $objid_window = 0
Global Const $objid_titlebar = -2
Global Const $objid_sizegrip = -7
Global Const $objid_caret = -8
Global Const $objid_cursor = -9
Global Const $objid_alert = -10
Global Const $objid_sound = -11
Global Const $dlg_centerontop = 0
Global Const $dlg_notitle = 1
Global Const $dlg_notontop = 2
Global Const $dlg_textleft = 4
Global Const $dlg_textright = 8
Global Const $dlg_moveable = 16
Global Const $dlg_textvcenter = 32
Global Const $idc_unknown = 0
Global Const $idc_appstarting = 1
Global Const $idc_arrow = 2
Global Const $idc_cross = 3
Global Const $idc_hand = 32649
Global Const $idc_help = 4
Global Const $idc_ibeam = 5
Global Const $idc_icon = 6
Global Const $idc_no = 7
Global Const $idc_size = 8
Global Const $idc_sizeall = 9
Global Const $idc_sizenesw = 10
Global Const $idc_sizens = 11
Global Const $idc_sizenwse = 12
Global Const $idc_sizewe = 13
Global Const $idc_uparrow = 14
Global Const $idc_wait = 15
Global Const $idi_application = 32512
Global Const $idi_asterisk = 32516
Global Const $idi_exclamation = 32515
Global Const $idi_hand = 32513
Global Const $idi_question = 32514
Global Const $idi_winlogo = 32517
Global Const $idi_shield = 32518
Global Const $idi_error = $idi_hand
Global Const $idi_information = $idi_asterisk
Global Const $idi_warning = $idi_exclamation
Global Const $sd_logoff = 0
Global Const $sd_shutdown = 1
Global Const $sd_reboot = 2
Global Const $sd_force = 4
Global Const $sd_powerdown = 8
Global Const $sd_forcehung = 16
Global Const $sd_standby = 32
Global Const $sd_hibernate = 64
Global Const $stdin_child = 1
Global Const $stdout_child = 2
Global Const $stderr_child = 4
Global Const $stderr_merged = 8
Global Const $stdio_inherit_parent = 16
Global Const $run_create_new_console = 65536
Global Const $ubound_dimensions = 0
Global Const $ubound_rows = 1
Global Const $ubound_columns = 2
Global Const $mouseeventf_absolute = 32768
Global Const $mouseeventf_move = 1
Global Const $mouseeventf_leftdown = 2
Global Const $mouseeventf_leftup = 4
Global Const $mouseeventf_rightdown = 8
Global Const $mouseeventf_rightup = 16
Global Const $mouseeventf_middledown = 32
Global Const $mouseeventf_middleup = 64
Global Const $mouseeventf_wheel = 2048
Global Const $mouseeventf_xdown = 128
Global Const $mouseeventf_xup = 256
Global Const $reg_none = 0
Global Const $reg_sz = 1
Global Const $reg_expand_sz = 2
Global Const $reg_binary = 3
Global Const $reg_dword = 4
Global Const $reg_dword_little_endian = 4
Global Const $reg_dword_big_endian = 5
Global Const $reg_link = 6
Global Const $reg_multi_sz = 7
Global Const $reg_resource_list = 8
Global Const $reg_full_resource_descriptor = 9
Global Const $reg_resource_requirements_list = 10
Global Const $reg_qword = 11
Global Const $reg_qword_little_endian = 11
Global Const $hwnd_bottom = 1
Global Const $hwnd_notopmost = -2
Global Const $hwnd_top = 0
Global Const $hwnd_topmost = -1
Global Const $swp_nosize = 1
Global Const $swp_nomove = 2
Global Const $swp_nozorder = 4
Global Const $swp_noredraw = 8
Global Const $swp_noactivate = 16
Global Const $swp_framechanged = 32
Global Const $swp_drawframe = 32
Global Const $swp_showwindow = 64
Global Const $swp_hidewindow = 128
Global Const $swp_nocopybits = 256
Global Const $swp_noownerzorder = 512
Global Const $swp_noreposition = 512
Global Const $swp_nosendchanging = 1024
Global Const $swp_defererase = 8192
Global Const $swp_asyncwindowpos = 16384
Global Const $keyword_default = 1
Global Const $keyword_null = 2
Global Const $declared_local = -1
Global Const $declared_unknown = 0
Global Const $declared_global = 1
Global Const $assign_create = 0
Global Const $assign_forcelocal = 1
Global Const $assign_forceglobal = 2
Global Const $assign_existfail = 4
Global Const $bi_enable = 0
Global Const $bi_disable = 1
Global Const $break_enable = 1
Global Const $break_disable = 0
Global Const $cdtray_open = "open"
Global Const $cdtray_closed = "closed"
Global Const $send_default = 0
Global Const $send_raw = 1
Global Const $dir_default = 0
Global Const $dir_extended = 1
Global Const $dir_norecurse = 2
Global Const $dir_remove = 1
Global Const $dt_all = "ALL"
Global Const $dt_cdrom = "CDROM"
Global Const $dt_removable = "REMOVABLE"
Global Const $dt_fixed = "FIXED"
Global Const $dt_network = "NETWORK"
Global Const $dt_ramdisk = "RAMDISK"
Global Const $dt_unknown = "UNKNOWN"
Global Const $dt_undefined = 1
Global Const $dt_fat = "FAT"
Global Const $dt_fat32 = "FAT32"
Global Const $dt_exfat = "exFAT"
Global Const $dt_ntfs = "NTFS"
Global Const $dt_nwfs = "NWFS"
Global Const $dt_cdfs = "CDFS"
Global Const $dt_udf = "UDF"
Global Const $dma_default = 0
Global Const $dma_persistent = 1
Global Const $dma_authentication = 8
Global Const $ds_unknown = "UNKNOWN"
Global Const $ds_ready = "READY"
Global Const $ds_notready = "NOTREADY"
Global Const $ds_invalid = "INVALID"
Global Const $mouse_click_left = "left"
Global Const $mouse_click_right = "right"
Global Const $mouse_click_middle = "middle"
Global Const $mouse_click_main = "main"
Global Const $mouse_click_menu = "menu"
Global Const $mouse_click_primary = "primary"
Global Const $mouse_click_secondary = "secondary"
Global Const $mouse_wheel_up = "up"
Global Const $mouse_wheel_down = "down"
Global Const $number_auto = 0
Global Const $number_32bit = 1
Global Const $number_64bit = 2
Global Const $number_double = 3
Global Const $obj_name = 1
Global Const $obj_string = 2
Global Const $obj_progid = 3
Global Const $obj_file = 4
Global Const $obj_module = 5
Global Const $obj_clsid = 6
Global Const $obj_iid = 7
Global Const $exitclose_normal = 0
Global Const $exitclose_byexit = 1
Global Const $exitclose_byclick = 2
Global Const $exitclose_bylogoff = 3
Global Const $exitclose_byshutdown = 4
Global Const $process_stats_memory = 0
Global Const $process_stats_io = 1
Global Const $process_low = 0
Global Const $process_belownormal = 1
Global Const $process_normal = 2
Global Const $process_abovenormal = 3
Global Const $process_high = 4
Global Const $process_realtime = 5
Global Const $run_logon_noprofile = 0
Global Const $run_logon_profile = 1
Global Const $run_logon_network = 2
Global Const $run_logon_inherit = 4
Global Const $sound_nowait = 0
Global Const $sound_wait = 1
Global Const $shex_open = "open"
Global Const $shex_edit = "edit"
Global Const $shex_print = "print"
Global Const $shex_properties = "properties"
Global Const $tcp_data_default = 0
Global Const $tcp_data_binary = 1
Global Const $udp_open_default = 0
Global Const $udp_open_broadcast = 1
Global Const $udp_data_default = 0
Global Const $udp_data_binary = 1
Global Const $udp_data_array = 2
Global Const $tip_noicon = 0
Global Const $tip_infoicon = 1
Global Const $tip_warningicon = 2
Global Const $tip_erroricon = 3
Global Const $tip_balloon = 1
Global Const $tip_center = 2
Global Const $tip_forcevisible = 4
Global Const $windows_noontop = 0
Global Const $windows_ontop = 1
Global Const $win_state_exists = 1
Global Const $win_state_visible = 2
Global Const $win_state_enabled = 4
Global Const $win_state_active = 8
Global Const $win_state_minimized = 16
Global Const $win_state_maximized = 32
Global Const $fc_nooverwrite = 0
Global Const $fc_overwrite = 1
Global Const $fc_createpath = 8
Global Const $ft_modified = 0
Global Const $ft_created = 1
Global Const $ft_accessed = 2
Global Const $ft_array = 0
Global Const $ft_string = 1
Global Const $fsf_createbutton = 1
Global Const $fsf_newdialog = 2
Global Const $fsf_editcontrol = 4
Global Const $ft_nonrecursive = 0
Global Const $ft_recursive = 1
Global Const $fo_read = 0
Global Const $fo_append = 1
Global Const $fo_overwrite = 2
Global Const $fo_createpath = 8
Global Const $fo_binary = 16
Global Const $fo_unicode = 32
Global Const $fo_utf16_le = 32
Global Const $fo_utf16_be = 64
Global Const $fo_utf8 = 128
Global Const $fo_utf8_nobom = 256
Global Const $fo_ansi = 512
Global Const $fo_utf16_le_nobom = 1024
Global Const $fo_utf16_be_nobom = 2048
Global Const $fo_utf8_full = 16384
Global Const $fo_fullfile_detect = 16384
Global Const $eof = -1
Global Const $fd_filemustexist = 1
Global Const $fd_pathmustexist = 2
Global Const $fd_multiselect = 4
Global Const $fd_promptcreatenew = 8
Global Const $fd_promptoverwrite = 16
Global Const $create_new = 1
Global Const $create_always = 2
Global Const $open_existing = 3
Global Const $open_always = 4
Global Const $truncate_existing = 5
Global Const $invalid_set_file_pointer = -1
Global Const $file_begin = 0
Global Const $file_current = 1
Global Const $file_end = 2
Global Const $file_attribute_readonly = 1
Global Const $file_attribute_hidden = 2
Global Const $file_attribute_system = 4
Global Const $file_attribute_directory = 16
Global Const $file_attribute_archive = 32
Global Const $file_attribute_device = 64
Global Const $file_attribute_normal = 128
Global Const $file_attribute_temporary = 256
Global Const $file_attribute_sparse_file = 512
Global Const $file_attribute_reparse_point = 1024
Global Const $file_attribute_compressed = 2048
Global Const $file_attribute_offline = 4096
Global Const $file_attribute_not_content_indexed = 8192
Global Const $file_attribute_encrypted = 16384
Global Const $file_share_read = 1
Global Const $file_share_write = 2
Global Const $file_share_delete = 4
Global Const $file_share_readwrite = BitOR($file_share_read, $file_share_write)
Global Const $file_share_any = BitOR($file_share_read, $file_share_write, $file_share_delete)
Global Const $generic_all = 268435456
Global Const $generic_execute = 536870912
Global Const $generic_write = 1073741824
Global Const $generic_read = -2147483648
Global Const $generic_readwrite = BitOR($generic_read, $generic_write)
Global Const $file_encoding_utf16le = 32
Global Const $fe_entire_utf8 = 1
Global Const $fe_partialfirst_utf8 = 2
Global Const $fn_fullpath = 0
Global Const $fn_relativepath = 1
Global Const $fv_comments = "Comments"
Global Const $fv_companyname = "CompanyName"
Global Const $fv_filedescription = "FileDescription"
Global Const $fv_fileversion = "FileVersion"
Global Const $fv_internalname = "InternalName"
Global Const $fv_legalcopyright = "LegalCopyright"
Global Const $fv_legaltrademarks = "LegalTrademarks"
Global Const $fv_originalfilename = "OriginalFilename"
Global Const $fv_productname = "ProductName"
Global Const $fv_productversion = "ProductVersion"
Global Const $fv_privatebuild = "PrivateBuild"
Global Const $fv_specialbuild = "SpecialBuild"
Global Const $frta_nocount = 0
Global Const $frta_count = 1
Global Const $frta_intarrays = 2
Global Const $frta_entiresplit = 4
Global Const $flta_filesfolders = 0
Global Const $flta_files = 1
Global Const $flta_folders = 2
Global Const $fltar_filesfolders = 0
Global Const $fltar_files = 1
Global Const $fltar_folders = 2
Global Const $fltar_nohidden = 4
Global Const $fltar_nosystem = 8
Global Const $fltar_nolink = 16
Global Const $fltar_norecur = 0
Global Const $fltar_recur = 1
Global Const $fltar_nosort = 0
Global Const $fltar_sort = 1
Global Const $fltar_fastsort = 2
Global Const $fltar_nopath = 0
Global Const $fltar_relpath = 1
Global Const $fltar_fullpath = 2
Global Const $path_original = 0
Global Const $path_drive = 1
Global Const $path_directory = 2
Global Const $path_filename = 3
Global Const $path_extension = 4
Global Const $mb_ok = 0
Global Const $mb_okcancel = 1
Global Const $mb_abortretryignore = 2
Global Const $mb_yesnocancel = 3
Global Const $mb_yesno = 4
Global Const $mb_retrycancel = 5
Global Const $mb_canceltrycontinue = 6
Global Const $mb_help = 16384
Global Const $mb_iconstop = 16
Global Const $mb_iconerror = 16
Global Const $mb_iconhand = 16
Global Const $mb_iconquestion = 32
Global Const $mb_iconexclamation = 48
Global Const $mb_iconwarning = 48
Global Const $mb_iconinformation = 64
Global Const $mb_iconasterisk = 64
Global Const $mb_usericon = 128
Global Const $mb_defbutton1 = 0
Global Const $mb_defbutton2 = 256
Global Const $mb_defbutton3 = 512
Global Const $mb_defbutton4 = 768
Global Const $mb_applmodal = 0
Global Const $mb_systemmodal = 4096
Global Const $mb_taskmodal = 8192
Global Const $mb_default_desktop_only = 131072
Global Const $mb_right = 524288
Global Const $mb_rtlreading = 1048576
Global Const $mb_setforeground = 65536
Global Const $mb_topmost = 262144
Global Const $mb_service_notification = 2097152
Global Const $mb_rightjustified = $mb_right
Global Const $idtimeout = -1
Global Const $idok = 1
Global Const $idcancel = 2
Global Const $idabort = 3
Global Const $idretry = 4
Global Const $idignore = 5
Global Const $idyes = 6
Global Const $idno = 7
Global Const $idclose = 8
Global Const $idhelp = 9
Global Const $idtryagain = 10
Global Const $idcontinue = 11
#Region Global Variables and Constants
	Global $__g_venum, $__g_vext = 0
	Global $__g_irgbmode = 1
	Global Const $tagosversioninfo = "struct;dword OSVersionInfoSize;dword MajorVersion;dword MinorVersion;dword BuildNumber;dword PlatformId;wchar CSDVersion[128];endstruct"
	Global Const $image_bitmap = 0
	Global Const $image_icon = 1
	Global Const $image_cursor = 2
	Global Const $image_enhmetafile = 3
	Global Const $lr_defaultcolor = 0
	Global Const $lr_monochrome = 1
	Global Const $lr_color = 2
	Global Const $lr_copyreturnorg = 4
	Global Const $lr_copydeleteorg = 8
	Global Const $lr_loadfromfile = 16
	Global Const $lr_loadtransparent = 32
	Global Const $lr_defaultsize = 64
	Global Const $lr_vgacolor = 128
	Global Const $lr_loadmap3dcolors = 4096
	Global Const $lr_createdibsection = 8192
	Global Const $lr_copyfromresource = 16384
	Global Const $lr_shared = 32768
	Global Const $__tagcursorinfo = "dword Size;dword Flags;handle hCursor;" & "struct;long X;long Y;endstruct"
	Global Const $__winver = __winver()
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_createfile($sfilename, $icreation, $iaccess = 4, $ishare = 0, $iattributes = 0, $tsecurity = 0)
		Local $ida = 0, $ism = 0, $icd = 0, $ifa = 0
		If BitAND($iaccess, 1) <> 0 Then $ida = BitOR($ida, $generic_execute)
		If BitAND($iaccess, 2) <> 0 Then $ida = BitOR($ida, $generic_read)
		If BitAND($iaccess, 4) <> 0 Then $ida = BitOR($ida, $generic_write)
		If BitAND($ishare, 1) <> 0 Then $ism = BitOR($ism, $file_share_delete)
		If BitAND($ishare, 2) <> 0 Then $ism = BitOR($ism, $file_share_read)
		If BitAND($ishare, 4) <> 0 Then $ism = BitOR($ism, $file_share_write)
		Switch $icreation
			Case 0
				$icd = $create_new
			Case 1
				$icd = $create_always
			Case 2
				$icd = $open_existing
			Case 3
				$icd = $open_always
			Case 4
				$icd = $truncate_existing
		EndSwitch
		If BitAND($iattributes, 1) <> 0 Then $ifa = BitOR($ifa, $file_attribute_archive)
		If BitAND($iattributes, 2) <> 0 Then $ifa = BitOR($ifa, $file_attribute_hidden)
		If BitAND($iattributes, 4) <> 0 Then $ifa = BitOR($ifa, $file_attribute_readonly)
		If BitAND($iattributes, 8) <> 0 Then $ifa = BitOR($ifa, $file_attribute_system)
		Local $aresult = DllCall("kernel32.dll", "handle", "CreateFileW", "wstr", $sfilename, "dword", $ida, "dword", $ism, "struct*", $tsecurity, "dword", $icd, "dword", $ifa, "ptr", 0)
		If @error OR ($aresult[0] = Ptr(-1)) Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_freelibrary($hmodule)
		Local $aresult = DllCall("kernel32.dll", "bool", "FreeLibrary", "handle", $hmodule)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_getcursorinfo()
		Local $tcursor = DllStructCreate($__tagcursorinfo)
		Local $icursor = DllStructGetSize($tcursor)
		DllStructSetData($tcursor, "Size", $icursor)
		Local $aret = DllCall("user32.dll", "bool", "GetCursorInfo", "struct*", $tcursor)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $acursor[5]
		$acursor[0] = True
		$acursor[1] = DllStructGetData($tcursor, "Flags") <> 0
		$acursor[2] = DllStructGetData($tcursor, "hCursor")
		$acursor[3] = DllStructGetData($tcursor, "X")
		$acursor[4] = DllStructGetData($tcursor, "Y")
		Return $acursor
	EndFunc

	Func _winapi_getdlgctrlid($hwnd)
		Local $aresult = DllCall("user32.dll", "int", "GetDlgCtrlID", "hwnd", $hwnd)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getmodulehandle($smodulename)
		Local $smodulenametype = "wstr"
		If $smodulename = "" Then
			$smodulename = 0
			$smodulenametype = "ptr"
		EndIf
		Local $aresult = DllCall("kernel32.dll", "handle", "GetModuleHandleW", $smodulenametype, $smodulename)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getstring($pstring, $bunicode = True)
		Local $ilength = _winapi_strlen($pstring, $bunicode)
		If @error OR NOT $ilength Then Return SetError(@error + 10, @extended, "")
		Local $tstring = DllStructCreate(($bunicode ? "wchar" : "char") & "[" & ($ilength + 1) & "]", $pstring)
		If @error Then Return SetError(@error, @extended, "")
		Return SetExtended($ilength, DllStructGetData($tstring, 1))
	EndFunc

	Func _winapi_iswow64process($ipid = 0)
		If NOT $ipid Then $ipid = @AutoItPID
		Local $hprocess = DllCall("kernel32.dll", "handle", "OpenProcess", "dword", ($__winver < 1536 ? 1024 : 4096), "bool", 0, "dword", $ipid)
		If @error OR NOT $hprocess[0] Then Return SetError(@error + 20, @extended, False)
		Local $aret = DllCall("kernel32.dll", "bool", "IsWow64Process", "handle", $hprocess[0], "bool*", 0)
		If __checkerrorclosehandle($aret, $hprocess[0]) Then Return SetError(@error, @extended, False)
		Return $aret[2]
	EndFunc

	Func _winapi_loadimage($hinstance, $simage, $itype, $ixdesired, $iydesired, $iload)
		Local $aresult, $simagetype = "int"
		If IsString($simage) Then $simagetype = "wstr"
		$aresult = DllCall("user32.dll", "handle", "LoadImageW", "handle", $hinstance, $simagetype, $simage, "uint", $itype, "int", $ixdesired, "int", $iydesired, "uint", $iload)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_loadlibrary($sfilename)
		Local $aresult = DllCall("kernel32.dll", "handle", "LoadLibraryW", "wstr", $sfilename)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_pathisdirectory($sfilepath)
		Local $aret = DllCall("shlwapi.dll", "bool", "PathIsDirectoryW", "wstr", $sfilepath)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_readfile($hfile, $pbuffer, $itoread, ByRef $iread, $toverlapped = 0)
		Local $aresult = DllCall("kernel32.dll", "bool", "ReadFile", "handle", $hfile, "struct*", $pbuffer, "dword", $itoread, "dword*", 0, "struct*", $toverlapped)
		If @error Then Return SetError(@error, @extended, False)
		$iread = $aresult[4]
		Return $aresult[0]
	EndFunc

	Func _winapi_strlen($pstring, $bunicode = True)
		Local $w = ""
		If $bunicode Then $w = "W"
		Local $aret = DllCall("kernel32.dll", "int", "lstrlen" & $w, "struct*", $pstring)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_switchcolor($icolor)
		If $icolor = -1 Then Return $icolor
		Return BitOR(BitAND($icolor, 65280), BitShift(BitAND($icolor, 255), -16), BitShift(BitAND($icolor, 16711680), 16))
	EndFunc

	Func _winapi_writefile($hfile, $pbuffer, $itowrite, ByRef $iwritten, $toverlapped = 0)
		Local $aresult = DllCall("kernel32.dll", "bool", "WriteFile", "handle", $hfile, "struct*", $pbuffer, "dword", $itowrite, "dword*", 0, "struct*", $toverlapped)
		If @error Then Return SetError(@error, @extended, False)
		$iwritten = $aresult[4]
		Return $aresult[0]
	EndFunc

#EndRegion Public Functions
#Region Internal Functions

	Func __checkerrorarraybounds(Const ByRef $adata, ByRef $istart, ByRef $iend, $ndim = 1, $idim = $ubound_dimensions)
		If NOT IsArray($adata) Then Return SetError(1, 0, 1)
		If UBound($adata, $idim) <> $ndim Then Return SetError(2, 0, 1)
		If $istart < 0 Then $istart = 0
		Local $iubound = UBound($adata) - 1
		If $iend < 1 OR $iend > $iubound Then $iend = $iubound
		If $istart > $iend Then Return SetError(4, 0, 1)
		Return 0
	EndFunc

	Func __checkerrorclosehandle($aret, $hfile, $blasterror = False, $icurerr = @error, $icurext = @extended)
		If NOT $icurerr AND NOT $aret[0] Then $icurerr = 10
		Local $alasterror = DllCall("kernel32.dll", "dword", "GetLastError")
		DllCall("kernel32.dll", "bool", "CloseHandle", "handle", $hfile)
		If $icurerr Then DllCall("kernel32.dll", "none", "SetLastError", "dword", $alasterror[0])
		If $blasterror Then $icurext = $alasterror[0]
		Return SetError($icurerr, $icurext, $icurerr)
	EndFunc

	Func __dll($spath, $bpin = False)
		Local $aret = DllCall("kernel32.dll", "bool", "GetModuleHandleExW", "dword", ($bpin ? 1 : 2), "wstr", $spath, "ptr*", 0)
		If NOT $aret[3] Then
			Local $aresult = DllCall("kernel32.dll", "handle", "LoadLibraryW", "wstr", $spath)
			If NOT $aresult[0] Then Return 0
		EndIf
		Return 1
	EndFunc

	Func __enumwindowsproc($hwnd, $bvisible)
		Local $aresult
		If $bvisible Then
			$aresult = DllCall("user32.dll", "bool", "IsWindowVisible", "hwnd", $hwnd)
			If NOT $aresult[0] Then
				Return 1
			EndIf
		EndIf
		__inc($__g_venum)
		$__g_venum[$__g_venum[0][0]][0] = $hwnd
		$aresult = DllCall("user32.dll", "int", "GetClassNameW", "hwnd", $hwnd, "wstr", "", "int", 4096)
		$__g_venum[$__g_venum[0][0]][1] = $aresult[2]
		Return 1
	EndFunc

	Func __fatalexit($icode, $stext = "")
		If $stext Then MsgBox($mb_systemmodal, "AutoIt", $stext)
		DllCall("kernel32.dll", "none", "FatalExit", "int", $icode)
	EndFunc

	Func __inc(ByRef $adata, $iincrement = 100)
		Select 
			Case UBound($adata, $ubound_columns)
				If $iincrement < 0 Then
					ReDim $adata[$adata[0][0] + 1][UBound($adata, $ubound_columns)]
				Else
					$adata[0][0] += 1
					If $adata[0][0] > UBound($adata) - 1 Then
						ReDim $adata[$adata[0][0] + $iincrement][UBound($adata, $ubound_columns)]
					EndIf
				EndIf
			Case UBound($adata, $ubound_rows)
				If $iincrement < 0 Then
					ReDim $adata[$adata[0] + 1]
				Else
					$adata[0] += 1
					If $adata[0] > UBound($adata) - 1 Then
						ReDim $adata[$adata[0] + $iincrement]
					EndIf
				EndIf
			Case Else
				Return 0
		EndSelect
		Return 1
	EndFunc

	Func __rgb($icolor)
		If $__g_irgbmode Then
			$icolor = _winapi_switchcolor($icolor)
		EndIf
		Return $icolor
	EndFunc

	Func __winver()
		Local $tosvi = DllStructCreate($tagosversioninfo)
		DllStructSetData($tosvi, 1, DllStructGetSize($tosvi))
		Local $aret = DllCall("kernel32.dll", "bool", "GetVersionExW", "struct*", $tosvi)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		Return BitOR(BitShift(DllStructGetData($tosvi, 2), -8), DllStructGetData($tosvi, 3))
	EndFunc

#EndRegion Internal Functions
#Region Global Variables and Constants
	Global Const $__tagwinapicom_guid = "struct;ulong Data1;ushort Data2;ushort Data3;byte Data4[8];endstruct"
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_clsidfromprogid($sprogid)
		Local $tguid = DllStructCreate($__tagwinapicom_guid)
		Local $areturn = DllCall("ole32.dll", "long", "CLSIDFromProgID", "wstr", $sprogid, "struct*", $tguid)
		If @error Then Return SetError(@error, @extended, "")
		If $areturn[0] Then Return SetError(10, $areturn[0], "")
		$areturn = DllCall("ole32.dll", "int", "StringFromGUID2", "struct*", $tguid, "wstr", "", "int", 39)
		If @error OR NOT $areturn[0] Then Return SetError(@error + 20, @extended, "")
		Return $areturn[2]
	EndFunc

	Func _winapi_coinitialize($iflags = 0)
		Local $areturn = DllCall("ole32.dll", "long", "CoInitializeEx", "ptr", 0, "dword", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		If $areturn[0] Then Return SetError(10, $areturn[0], 0)
		Return 1
	EndFunc

	Func _winapi_cotaskmemalloc($isize)
		Local $areturn = DllCall("ole32.dll", "ptr", "CoTaskMemAlloc", "uint_ptr", $isize)
		If @error Then Return SetError(@error, @extended, 0)
		Return $areturn[0]
	EndFunc

	Func _winapi_cotaskmemfree($pmemory)
		DllCall("ole32.dll", "none", "CoTaskMemFree", "ptr", $pmemory)
		If @error Then Return SetError(@error, @extended, 0)
		Return 1
	EndFunc

	Func _winapi_cotaskmemrealloc($pmemory, $isize)
		Local $areturn = DllCall("ole32.dll", "ptr", "CoTaskMemRealloc", "ptr", $pmemory, "ulong_ptr", $isize)
		If @error Then Return SetError(@error, @extended, 0)
		Return $areturn[0]
	EndFunc

	Func _winapi_couninitialize()
		DllCall("ole32.dll", "none", "CoUninitialize")
		If @error Then Return SetError(@error, @extended, 0)
		Return 1
	EndFunc

	Func _winapi_createguid()
		Local $tguid = DllStructCreate($__tagwinapicom_guid)
		Local $areturn = DllCall("ole32.dll", "long", "CoCreateGuid", "struct*", $tguid)
		If @error Then Return SetError(@error, @extended, "")
		If $areturn[0] Then Return SetError(10, $areturn[0], "")
		$areturn = DllCall("ole32.dll", "int", "StringFromGUID2", "struct*", $tguid, "wstr", "", "int", 65536)
		If @error OR NOT $areturn[0] Then Return SetError(@error + 20, @extended, "")
		Return $areturn[2]
	EndFunc

	Func _winapi_createstreamonhglobal($hglobal = 0, $bdeleteonrelease = True)
		Local $areturn = DllCall("ole32.dll", "long", "CreateStreamOnHGlobal", "handle", $hglobal, "bool", $bdeleteonrelease, "ptr*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $areturn[0] Then Return SetError(10, $areturn[0], 0)
		Return $areturn[3]
	EndFunc

	Func _winapi_gethglobalfromstream($pstream)
		Local $areturn = DllCall("ole32.dll", "uint", "GetHGlobalFromStream", "ptr", $pstream, "ptr*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $areturn[0] Then Return SetError(10, $areturn[0], 0)
		Return $areturn[2]
	EndFunc

	Func _winapi_progidfromclsid($sclsid)
		Local $tguid = DllStructCreate($__tagwinapicom_guid)
		Local $areturn = DllCall("ole32.dll", "uint", "CLSIDFromString", "wstr", $sclsid, "struct*", $tguid)
		If @error OR $areturn[0] Then Return SetError(@error + 20, @extended, "")
		$areturn = DllCall("ole32.dll", "uint", "ProgIDFromCLSID", "struct*", $tguid, "ptr*", 0)
		If @error Then Return SetError(@error, @extended, "")
		If $areturn[0] Then Return SetError(10, $areturn[0], "")
		Local $sid = _winapi_getstring($areturn[2])
		_winapi_cotaskmemfree($areturn[2])
		Return $sid
	EndFunc

	Func _winapi_releasestream($pstream)
		Local $areturn = DllCall("oleaut32.dll", "long", "DispCallFunc", "ptr", $pstream, "ulong_ptr", 8 * (1 + @AutoItX64), "uint", 4, "ushort", 23, "uint", 0, "ptr", 0, "ptr", 0, "str", "")
		If @error Then Return SetError(@error, @extended, 0)
		If $areturn[0] Then Return SetError(10, $areturn[0], 0)
		Return 1
	EndFunc

#EndRegion Public Functions
Global Const $str_nocasesense = 0
Global Const $str_casesense = 1
Global Const $str_nocasesensebasic = 2
Global Const $str_stripleading = 1
Global Const $str_striptrailing = 2
Global Const $str_stripspaces = 4
Global Const $str_stripall = 8
Global Const $str_chrsplit = 0
Global Const $str_entiresplit = 1
Global Const $str_nocount = 2
Global Const $str_regexpmatch = 0
Global Const $str_regexparraymatch = 1
Global Const $str_regexparrayfullmatch = 2
Global Const $str_regexparrayglobalmatch = 3
Global Const $str_regexparrayglobalfullmatch = 4
Global Const $str_endisstart = 0
Global Const $str_endnotstart = 1
Global Const $sb_ansi = 1
Global Const $sb_utf16le = 2
Global Const $sb_utf16be = 3
Global Const $sb_utf8 = 4
Global Const $se_utf16 = 0
Global Const $se_ansi = 1
Global Const $se_utf8 = 2
Global Const $str_utf16 = 0
Global Const $str_ucs2 = 1
#Region Global Variables and Constants
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_chartooem($sstr)
		Local $aret = DllCall("user32.dll", "bool", "CharToOemW", "wstr", $sstr, "wstr", "")
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
		Return $aret[2]
	EndFunc

	Func _winapi_clienttoscreen($hwnd, ByRef $tpoint)
		Local $aret = DllCall("user32.dll", "bool", "ClientToScreen", "hwnd", $hwnd, "struct*", $tpoint)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tpoint
	EndFunc

	Func _winapi_dwordtofloat($ivalue)
		Local $tdword = DllStructCreate("dword")
		Local $tfloat = DllStructCreate("float", DllStructGetPtr($tdword))
		DllStructSetData($tdword, 1, $ivalue)
		Return DllStructGetData($tfloat, 1)
	EndFunc

	Func _winapi_dwordtoint($ivalue)
		Local $tdata = DllStructCreate("int")
		DllStructSetData($tdata, 1, $ivalue)
		Return DllStructGetData($tdata, 1)
	EndFunc

	Func _winapi_floattodword($ivalue)
		Local $tfloat = DllStructCreate("float")
		Local $tdword = DllStructCreate("dword", DllStructGetPtr($tfloat))
		DllStructSetData($tfloat, 1, $ivalue)
		Return DllStructGetData($tdword, 1)
	EndFunc

	Func _winapi_floattoint($nfloat)
		Local $tfloat = DllStructCreate("float")
		Local $tint = DllStructCreate("int", DllStructGetPtr($tfloat))
		DllStructSetData($tfloat, 1, $nfloat)
		Return DllStructGetData($tint, 1)
	EndFunc

	Func _winapi_getxyfrompoint(ByRef $tpoint, ByRef $ix, ByRef $iy)
		$ix = DllStructGetData($tpoint, "X")
		$iy = DllStructGetData($tpoint, "Y")
	EndFunc

	Func _winapi_guidfromstring($sguid)
		Local $tguid = DllStructCreate($tagguid)
		_winapi_guidfromstringex($sguid, $tguid)
		If @error Then Return SetError(@error + 10, @extended, 0)
		Return $tguid
	EndFunc

	Func _winapi_guidfromstringex($sguid, $tguid)
		Local $aresult = DllCall("ole32.dll", "long", "CLSIDFromString", "wstr", $sguid, "struct*", $tguid)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_hashdata($pmemory, $isize, $ilength = 32)
		If ($ilength <= 0) OR ($ilength > 256) Then Return SetError(11, 0, 0)
		Local $tdata = DllStructCreate("byte[" & $ilength & "]")
		Local $aret = DllCall("shlwapi.dll", "uint", "HashData", "struct*", $pmemory, "dword", $isize, "struct*", $tdata, "dword", $ilength)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return DllStructGetData($tdata, 1)
	EndFunc

	Func _winapi_hashstring($sstring, $bcasesensitive = True, $ilength = 32)
		Local $ilengths = StringLen($sstring)
		If NOT $ilengths OR ($ilength > 256) Then Return SetError(12, 0, 0)
		Local $tstring = DllStructCreate("wchar[" & ($ilengths + 1) & "]")
		If NOT $bcasesensitive Then
			$sstring = StringLower($sstring)
		EndIf
		DllStructSetData($tstring, 1, $sstring)
		Local $shash = _winapi_hashdata($tstring, 2 * $ilengths, $ilength)
		If @error Then Return SetError(@error, @extended, 0)
		Return $shash
	EndFunc

	Func _winapi_hibyte($ivalue)
		Return BitAND(BitShift($ivalue, 8), 255)
	EndFunc

	Func _winapi_hidword($ivalue)
		Local $tint64 = DllStructCreate("int64")
		Local $tqword = DllStructCreate("dword;dword", DllStructGetPtr($tint64))
		DllStructSetData($tint64, 1, $ivalue)
		Return DllStructGetData($tqword, 2)
	EndFunc

	Func _winapi_hiword($ilong)
		Return BitShift($ilong, 16)
	EndFunc

	Func _winapi_inttodword($ivalue)
		Local $tdata = DllStructCreate("dword")
		DllStructSetData($tdata, 1, $ivalue)
		Return DllStructGetData($tdata, 1)
	EndFunc

	Func _winapi_inttofloat($iint)
		Local $tint = DllStructCreate("int")
		Local $tfloat = DllStructCreate("float", DllStructGetPtr($tint))
		DllStructSetData($tint, 1, $iint)
		Return DllStructGetData($tfloat, 1)
	EndFunc

	Func _winapi_lobyte($ivalue)
		Return BitAND($ivalue, 255)
	EndFunc

	Func _winapi_lodword($ivalue)
		Local $tint64 = DllStructCreate("int64")
		Local $tqword = DllStructCreate("dword;dword", DllStructGetPtr($tint64))
		DllStructSetData($tint64, 1, $ivalue)
		Return DllStructGetData($tqword, 1)
	EndFunc

	Func _winapi_loword($ilong)
		Return BitAND($ilong, 65535)
	EndFunc

	Func _winapi_longmid($ivalue, $istart, $icount)
		Return BitAND(BitShift($ivalue, $istart), BitOR(BitShift(BitShift(2147483647, 32 - ($icount + 1)), 1), BitShift(1, -($icount - 1))))
	EndFunc

	Func _winapi_makelangid($ilngidprimary, $ilngidsub)
		Return BitOR(BitShift($ilngidsub, -10), $ilngidprimary)
	EndFunc

	Func _winapi_makelcid($ilngid, $isortid)
		Return BitOR(BitShift($isortid, -16), $ilngid)
	EndFunc

	Func _winapi_makelong($ilo, $ihi)
		Return BitOR(BitShift($ihi, -16), BitAND($ilo, 65535))
	EndFunc

	Func _winapi_makeqword($ilodword, $ihidword)
		Local $tint64 = DllStructCreate("uint64")
		Local $tdwords = DllStructCreate("dword;dword", DllStructGetPtr($tint64))
		DllStructSetData($tdwords, 1, $ilodword)
		DllStructSetData($tdwords, 2, $ihidword)
		Return DllStructGetData($tint64, 1)
	EndFunc

	Func _winapi_makeword($ilo, $ihi)
		Local $tword = DllStructCreate("ushort")
		Local $tbyte = DllStructCreate("byte;byte", DllStructGetPtr($tword))
		DllStructSetData($tbyte, 1, $ihi)
		DllStructSetData($tbyte, 2, $ilo)
		Return DllStructGetData($tword, 1)
	EndFunc

	Func _winapi_multibytetowidechar($vtext, $icodepage = 0, $iflags = 0, $bretstring = False)
		Local $stexttype = "str"
		If NOT IsString($vtext) Then $stexttype = "struct*"
		Local $aresult = DllCall("kernel32.dll", "int", "MultiByteToWideChar", "uint", $icodepage, "dword", $iflags, $stexttype, $vtext, "int", -1, "ptr", 0, "int", 0)
		If @error OR NOT $aresult[0] Then Return SetError(@error + 10, @extended, 0)
		Local $iout = $aresult[0]
		Local $tout = DllStructCreate("wchar[" & $iout & "]")
		$aresult = DllCall("kernel32.dll", "int", "MultiByteToWideChar", "uint", $icodepage, "dword", $iflags, $stexttype, $vtext, "int", -1, "struct*", $tout, "int", $iout)
		If @error OR NOT $aresult[0] Then Return SetError(@error + 20, @extended, 0)
		If $bretstring Then Return DllStructGetData($tout, 1)
		Return $tout
	EndFunc

	Func _winapi_multibytetowidecharex($stext, $ptext, $icodepage = 0, $iflags = 0)
		Local $aresult = DllCall("kernel32.dll", "int", "MultiByteToWideChar", "uint", $icodepage, "dword", $iflags, "STR", $stext, "int", -1, "struct*", $ptext, "int", (StringLen($stext) + 1) * 2)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_oemtochar($sstr)
		Local $aret = DllCall("user32.dll", "bool", "OemToChar", "str", $sstr, "str", "")
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
		Return $aret[2]
	EndFunc

	Func _winapi_pointfromrect(ByRef $trect, $bcenter = True)
		Local $ix1 = DllStructGetData($trect, "Left")
		Local $iy1 = DllStructGetData($trect, "Top")
		Local $ix2 = DllStructGetData($trect, "Right")
		Local $iy2 = DllStructGetData($trect, "Bottom")
		If $bcenter Then
			$ix1 = $ix1 + (($ix2 - $ix1) / 2)
			$iy1 = $iy1 + (($iy2 - $iy1) / 2)
		EndIf
		Local $tpoint = DllStructCreate($tagpoint)
		DllStructSetData($tpoint, "X", $ix1)
		DllStructSetData($tpoint, "Y", $iy1)
		Return $tpoint
	EndFunc

	Func _winapi_primarylangid($ilngid)
		Return BitAND($ilngid, 1023)
	EndFunc

	Func _winapi_screentoclient($hwnd, ByRef $tpoint)
		Local $aresult = DllCall("user32.dll", "bool", "ScreenToClient", "hwnd", $hwnd, "struct*", $tpoint)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_shorttoword($ivalue)
		Return BitAND($ivalue, 65535)
	EndFunc

	Func _winapi_strformatbytesize($isize)
		Local $aret = DllCall("shlwapi.dll", "ptr", "StrFormatByteSizeW", "int64", $isize, "wstr", "", "uint", 1024)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
		Return $aret[2]
	EndFunc

	Func _winapi_strformatbytesizeex($isize)
		Local $asymbol = DllCall("kernel32.dll", "int", "GetLocaleInfoW", "dword", 1024, "dword", 15, "wstr", "", "int", 2048)
		If @error Then Return SetError(@error + 10, @extended, "")
		Local $ssize = _winapi_strformatbytesize(0)
		If @error Then Return SetError(@error, @extended, "")
		Return StringReplace($ssize, "0", StringRegExpReplace(Number($isize), "(?<=\d)(?=(\d{3})+\z)", $asymbol[3]))
	EndFunc

	Func _winapi_strformatkbsize($isize)
		Local $aret = DllCall("shlwapi.dll", "ptr", "StrFormatKBSizeW", "int64", $isize, "wstr", "", "uint", 1024)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
		Return $aret[2]
	EndFunc

	Func _winapi_strfromtimeinterval($itime, $idigits = 7)
		Local $aret = DllCall("shlwapi.dll", "int", "StrFromTimeIntervalW", "wstr", "", "uint", 1024, "dword", $itime, "int", $idigits)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
		Return StringStripWS($aret[1], $str_stripleading + $str_striptrailing)
	EndFunc

	Func _winapi_stringfromguid($tguid)
		Local $aresult = DllCall("ole32.dll", "int", "StringFromGUID2", "struct*", $tguid, "wstr", "", "int", 40)
		If @error OR NOT $aresult[0] Then Return SetError(@error, @extended, "")
		Return SetExtended($aresult[0], $aresult[2])
	EndFunc

	Func _winapi_sublangid($ilngid)
		Return BitShift($ilngid, 10)
	EndFunc

	Func _winapi_swapdword($ivalue)
		Local $tstruct1 = DllStructCreate("dword;dword")
		Local $tstruct2 = DllStructCreate("byte[4];byte[4]", DllStructGetPtr($tstruct1))
		DllStructSetData($tstruct1, 1, $ivalue)
		For $i = 1 To 4
			DllStructSetData($tstruct2, 2, DllStructGetData($tstruct2, 1, 5 - $i), $i)
		Next
		Return DllStructGetData($tstruct1, 2)
	EndFunc

	Func _winapi_swapqword($ivalue)
		Local $tstruct1 = DllStructCreate("int64;int64")
		Local $tstruct2 = DllStructCreate("byte[8];byte[8]", DllStructGetPtr($tstruct1))
		DllStructSetData($tstruct1, 1, $ivalue)
		For $i = 1 To 8
			DllStructSetData($tstruct2, 2, DllStructGetData($tstruct2, 1, 9 - $i), $i)
		Next
		Return DllStructGetData($tstruct1, 2)
	EndFunc

	Func _winapi_swapword($ivalue)
		Local $tstruct1 = DllStructCreate("word;word")
		Local $tstruct2 = DllStructCreate("byte[2];byte[2]", DllStructGetPtr($tstruct1))
		DllStructSetData($tstruct1, 1, $ivalue)
		For $i = 1 To 2
			DllStructSetData($tstruct2, 2, DllStructGetData($tstruct2, 1, 3 - $i), $i)
		Next
		Return DllStructGetData($tstruct1, 2)
	EndFunc

	Func _winapi_widechartomultibyte($vunicode, $icodepage = 0, $bretnostruct = True, $bretbinary = False)
		Local $sunicodetype = "wstr"
		If NOT IsString($vunicode) Then $sunicodetype = "struct*"
		Local $aresult = DllCall("kernel32.dll", "int", "WideCharToMultiByte", "uint", $icodepage, "dword", 0, $sunicodetype, $vunicode, "int", -1, "ptr", 0, "int", 0, "ptr", 0, "ptr", 0)
		If @error OR NOT $aresult[0] Then Return SetError(@error + 20, @extended, "")
		Local $tmultibyte = DllStructCreate((($bretbinary) ? ("byte") : ("char")) & "[" & $aresult[0] & "]")
		$aresult = DllCall("kernel32.dll", "int", "WideCharToMultiByte", "uint", $icodepage, "dword", 0, $sunicodetype, $vunicode, "int", -1, "struct*", $tmultibyte, "int", $aresult[0], "ptr", 0, "ptr", 0)
		If @error OR NOT $aresult[0] Then Return SetError(@error + 10, @extended, "")
		If $bretnostruct Then Return DllStructGetData($tmultibyte, 1)
		Return $tmultibyte
	EndFunc

	Func _winapi_wordtoshort($ivalue)
		If BitAND($ivalue, 32768) Then
			Return BitOR($ivalue, -32768)
		EndIf
		Return BitAND($ivalue, 32767)
	EndFunc

#EndRegion Public Functions
Global Const $fr_private = 16
Global Const $fr_not_enum = 32
Global Const $compression_bitmap_png = 0
Global Const $compression_bitmap_jpeg = 1
Global Const $bs_dibpattern = 5
Global Const $bs_dibpattern8x8 = 8
Global Const $bs_dibpatternpt = 6
Global Const $bs_hatched = 2
Global Const $bs_hollow = 1
Global Const $bs_null = 1
Global Const $bs_pattern = 3
Global Const $bs_pattern8x8 = 7
Global Const $bs_solid = 0
Global Const $hs_bdiagonal = 3
Global Const $hs_cross = 4
Global Const $hs_diagcross = 5
Global Const $hs_fdiagonal = 2
Global Const $hs_horizontal = 0
Global Const $hs_vertical = 1
Global Const $dib_pal_colors = 1
Global Const $dib_rgb_colors = 0
Global Const $ca_negative = 1
Global Const $ca_log_filter = 2
Global Const $illuminant_device_default = 0
Global Const $illuminant_a = 1
Global Const $illuminant_b = 2
Global Const $illuminant_c = 3
Global Const $illuminant_d50 = 4
Global Const $illuminant_d55 = 5
Global Const $illuminant_d65 = 6
Global Const $illuminant_d75 = 7
Global Const $illuminant_f2 = 8
Global Const $illuminant_tungsten = $illuminant_a
Global Const $illuminant_daylight = $illuminant_c
Global Const $illuminant_fluorescent = $illuminant_f2
Global Const $illuminant_ntsc = $illuminant_c
Global Const $bi_rgb = 0
Global Const $bi_rle8 = 1
Global Const $bi_rle4 = 2
Global Const $bi_bitfields = 3
Global Const $bi_jpeg = 4
Global Const $bi_png = 5
Global Const $alternate = 1
Global Const $winding = 2
Global Const $dwmwa_ncrendering_enabled = 1
Global Const $dwmwa_ncrendering_policy = 2
Global Const $dwmwa_transitions_forcedisabled = 3
Global Const $dwmwa_allow_ncpaint = 4
Global Const $dwmwa_caption_button_bounds = 5
Global Const $dwmwa_nonclient_rtl_layout = 6
Global Const $dwmwa_force_iconic_representation = 7
Global Const $dwmwa_flip3d_policy = 8
Global Const $dwmwa_extended_frame_bounds = 9
Global Const $dwmwa_has_iconic_bitmap = 10
Global Const $dwmwa_disallow_peek = 11
Global Const $dwmwa_excluded_from_peek = 12
Global Const $dwmncrp_usewindowstyle = 0
Global Const $dwmncrp_disabled = 1
Global Const $dwmncrp_enabled = 2
Global Const $dwmflip3d_default = 0
Global Const $dwmflip3d_excludebelow = 1
Global Const $dwmflip3d_excludeabove = 2
Global Const $dm_bitsperpel = 262144
Global Const $dm_collate = 32768
Global Const $dm_color = 2048
Global Const $dm_copies = 256
Global Const $dm_defaultsource = 512
Global Const $dm_displayfixedoutput = 536870912
Global Const $dm_displayflags = 2097152
Global Const $dm_displayfrequency = 4194304
Global Const $dm_displayorientation = 128
Global Const $dm_dithertype = 67108864
Global Const $dm_duplex = 4096
Global Const $dm_formname = 65536
Global Const $dm_icmintent = 16777216
Global Const $dm_icmmethod = 8388608
Global Const $dm_logpixels = 131072
Global Const $dm_mediatype = 33554432
Global Const $dm_nup = 64
Global Const $dm_orientation = 1
Global Const $dm_panningheight = 268435456
Global Const $dm_panningwidth = 134217728
Global Const $dm_paperlength = 4
Global Const $dm_papersize = 2
Global Const $dm_paperwidth = 8
Global Const $dm_pelsheight = 1048576
Global Const $dm_pelswidth = 524288
Global Const $dm_position = 32
Global Const $dm_printquality = 1024
Global Const $dm_scale = 16
Global Const $dm_ttoption = 16384
Global Const $dm_yresolution = 8192
Global Const $dmpaper_letter = 1
Global Const $dmpaper_lettersmall = 2
Global Const $dmpaper_tabloid = 3
Global Const $dmpaper_ledger = 4
Global Const $dmpaper_legal = 5
Global Const $dmpaper_statement = 6
Global Const $dmpaper_executive = 7
Global Const $dmpaper_a3 = 8
Global Const $dmpaper_a4 = 9
Global Const $dmpaper_a4small = 10
Global Const $dmpaper_a5 = 11
Global Const $dmpaper_b4 = 12
Global Const $dmpaper_b5 = 13
Global Const $dmpaper_folio = 14
Global Const $dmpaper_quarto = 15
Global Const $dmpaper_10x14 = 16
Global Const $dmpaper_11x17 = 17
Global Const $dmpaper_note = 18
Global Const $dmpaper_env_9 = 19
Global Const $dmpaper_env_10 = 20
Global Const $dmpaper_env_11 = 21
Global Const $dmpaper_env_12 = 22
Global Const $dmpaper_env_14 = 23
Global Const $dmpaper_csheet = 24
Global Const $dmpaper_dsheet = 25
Global Const $dmpaper_esheet = 26
Global Const $dmpaper_env_dl = 27
Global Const $dmpaper_env_c5 = 28
Global Const $dmpaper_env_c3 = 29
Global Const $dmpaper_env_c4 = 30
Global Const $dmpaper_env_c6 = 31
Global Const $dmpaper_env_c65 = 32
Global Const $dmpaper_env_b4 = 33
Global Const $dmpaper_env_b5 = 34
Global Const $dmpaper_env_b6 = 35
Global Const $dmpaper_env_italy = 36
Global Const $dmpaper_env_monarch = 37
Global Const $dmpaper_env_personal = 38
Global Const $dmpaper_fanfold_us = 39
Global Const $dmpaper_fanfold_std_german = 40
Global Const $dmpaper_fanfold_lgl_german = 41
Global Const $dmpaper_iso_b4 = 42
Global Const $dmpaper_japanese_postcard = 43
Global Const $dmpaper_9x11 = 44
Global Const $dmpaper_10x11 = 45
Global Const $dmpaper_15x11 = 46
Global Const $dmpaper_env_invite = 47
Global Const $dmpaper_reserved_48 = 48
Global Const $dmpaper_reserved_49 = 49
Global Const $dmpaper_letter_extra = 50
Global Const $dmpaper_legal_extra = 51
Global Const $dmpaper_tabloid_extra = 52
Global Const $dmpaper_a4_extra = 53
Global Const $dmpaper_letter_transverse = 54
Global Const $dmpaper_a4_transverse = 55
Global Const $dmpaper_letter_extra_transverse = 56
Global Const $dmpaper_a_plus = 57
Global Const $dmpaper_b_plus = 58
Global Const $dmpaper_letter_plus = 59
Global Const $dmpaper_a4_plus = 60
Global Const $dmpaper_a5_transverse = 61
Global Const $dmpaper_b5_transverse = 62
Global Const $dmpaper_a3_extra = 63
Global Const $dmpaper_a5_extra = 64
Global Const $dmpaper_b5_extra = 65
Global Const $dmpaper_a2 = 66
Global Const $dmpaper_a3_transverse = 67
Global Const $dmpaper_a3_extra_transverse = 68
Global Const $dmpaper_dbl_japanese_postcard = 69
Global Const $dmpaper_a6 = 70
Global Const $dmpaper_jenv_kaku2 = 71
Global Const $dmpaper_jenv_kaku3 = 72
Global Const $dmpaper_jenv_chou3 = 73
Global Const $dmpaper_jenv_chou4 = 74
Global Const $dmpaper_letter_rotated = 75
Global Const $dmpaper_a3_rotated = 76
Global Const $dmpaper_a4_rotated = 77
Global Const $dmpaper_a5_rotated = 78
Global Const $dmpaper_b4_jis_rotated = 79
Global Const $dmpaper_b5_jis_rotated = 80
Global Const $dmpaper_japanese_postcard_rotated = 81
Global Const $dmpaper_dbl_japanese_postcard_rotated = 82
Global Const $dmpaper_a6_rotated = 83
Global Const $dmpaper_jenv_kaku2_rotated = 84
Global Const $dmpaper_jenv_kaku3_rotated = 85
Global Const $dmpaper_jenv_chou3_rotated = 86
Global Const $dmpaper_jenv_chou4_rotated = 87
Global Const $dmpaper_b6_jis = 88
Global Const $dmpaper_b6_jis_rotated = 89
Global Const $dmpaper_12x11 = 90
Global Const $dmpaper_jenv_you4 = 91
Global Const $dmpaper_jenv_you4_rotated = 92
Global Const $dmpaper_p16k = 93
Global Const $dmpaper_p32k = 94
Global Const $dmpaper_p32kbig = 95
Global Const $dmpaper_penv_1 = 96
Global Const $dmpaper_penv_2 = 97
Global Const $dmpaper_penv_3 = 98
Global Const $dmpaper_penv_4 = 99
Global Const $dmpaper_penv_5 = 100
Global Const $dmpaper_penv_6 = 101
Global Const $dmpaper_penv_7 = 102
Global Const $dmpaper_penv_8 = 103
Global Const $dmpaper_penv_9 = 104
Global Const $dmpaper_penv_10 = 105
Global Const $dmpaper_p16k_rotated = 106
Global Const $dmpaper_p32k_rotated = 107
Global Const $dmpaper_p32kbig_rotated = 108
Global Const $dmpaper_penv_1_rotated = 109
Global Const $dmpaper_penv_2_rotated = 110
Global Const $dmpaper_penv_3_rotated = 111
Global Const $dmpaper_penv_4_rotated = 112
Global Const $dmpaper_penv_5_rotated = 113
Global Const $dmpaper_penv_6_rotated = 114
Global Const $dmpaper_penv_7_rotated = 115
Global Const $dmpaper_penv_8_rotated = 116
Global Const $dmpaper_penv_9_rotated = 117
Global Const $dmpaper_penv_10_rotated = 118
Global Const $dmpaper_user = 256
Global Const $dmbin_upper = 1
Global Const $dmbin_lower = 2
Global Const $dmbin_middle = 3
Global Const $dmbin_manual = 4
Global Const $dmbin_envelope = 5
Global Const $dmbin_envmanual = 6
Global Const $dmbin_auto = 7
Global Const $dmbin_tractor = 8
Global Const $dmbin_smallfmt = 9
Global Const $dmbin_largefmt = 10
Global Const $dmbin_largecapacity = 11
Global Const $dmbin_cassette = 14
Global Const $dmbin_formsource = 15
Global Const $dmbin_user = 256
Global Const $dmres_draft = -1
Global Const $dmres_low = -2
Global Const $dmres_medium = -3
Global Const $dmres_high = -4
Global Const $dmdo_default = 0
Global Const $dmdo_90 = 1
Global Const $dmdo_180 = 2
Global Const $dmdo_270 = 3
Global Const $dmdfo_default = 0
Global Const $dmdfo_stretch = 1
Global Const $dmdfo_center = 2
Global Const $dmcolor_monochrome = 1
Global Const $dmcolor_color = 2
Global Const $dmdup_simplex = 1
Global Const $dmdup_vertical = 2
Global Const $dmdup_horizontal = 3
Global Const $dmtt_bitmap = 1
Global Const $dmtt_download = 2
Global Const $dmtt_subdev = 3
Global Const $dmtt_download_outline = 4
Global Const $dmcollate_false = 0
Global Const $dmcollate_true = 1
Global Const $dm_grayscale = 1
Global Const $dm_interlaced = 2
Global Const $dmnup_system = 1
Global Const $dmnup_oneup = 2
Global Const $dmicmmethod_none = 1
Global Const $dmicmmethod_system = 2
Global Const $dmicmmethod_driver = 3
Global Const $dmicmmethod_device = 4
Global Const $dmicmmethod_user = 256
Global Const $dmicm_saturate = 1
Global Const $dmicm_contrast = 2
Global Const $dmicm_colorimetric = 3
Global Const $dmicm_abs_colorimetric = 4
Global Const $dmicm_user = 256
Global Const $dmmedia_standard = 1
Global Const $dmmedia_transparency = 2
Global Const $dmmedia_glossy = 3
Global Const $dmmedia_user = 256
Global Const $dmdither_none = 1
Global Const $dmdither_coarse = 2
Global Const $dmdither_fine = 3
Global Const $dmdither_lineart = 4
Global Const $dmdither_errordiffusion = 5
Global Const $dmdither_reserved6 = 6
Global Const $dmdither_reserved7 = 7
Global Const $dmdither_reserved8 = 8
Global Const $dmdither_reserved9 = 9
Global Const $dmdither_grayscale = 10
Global Const $dmdither_user = 256
Global Const $enum_current_settings = -1
Global Const $enum_registry_settings = -2
Global Const $device_fonttype = 2
Global Const $raster_fonttype = 1
Global Const $truetype_fonttype = 4
Global Const $ntm_bold = 32
Global Const $ntm_dsig = 2097152
Global Const $ntm_italic = 1
Global Const $ntm_multiplemaster = 524288
Global Const $ntm_nonnegative_ac = 65536
Global Const $ntm_ps_opentype = 131072
Global Const $ntm_regular = 64
Global Const $ntm_tt_opentype = 262144
Global Const $ntm_type1 = 1048576
Global Const $floodfillborder = 0
Global Const $floodfillsurface = 1
Global Const $ad_counterclockwise = 1
Global Const $ad_clockwise = 2
Global Const $dcb_accumulate = 2
Global Const $dcb_disable = 8
Global Const $dcb_enable = 4
Global Const $dcb_reset = 1
Global Const $dcb_set = BitOR($dcb_reset, $dcb_accumulate)
Global Const $dcx_window = 1
Global Const $dcx_cache = 2
Global Const $dcx_parentclip = 32
Global Const $dcx_clipsiblings = 16
Global Const $dcx_clipchildren = 8
Global Const $dcx_noresetattrs = 4
Global Const $dcx_lockwindowupdate = 1024
Global Const $dcx_excludergn = 64
Global Const $dcx_intersectrgn = 128
Global Const $dcx_intersectupdate = 512
Global Const $dcx_validate = 2097152
Global Const $ggo_bezier = 3
Global Const $ggo_bitmap = 1
Global Const $ggo_glyph_index = 128
Global Const $ggo_gray2_bitmap = 4
Global Const $ggo_gray4_bitmap = 5
Global Const $ggo_gray8_bitmap = 6
Global Const $ggo_metrics = 0
Global Const $ggo_native = 2
Global Const $ggo_unhinted = 256
Global Const $gm_compatible = 1
Global Const $gm_advanced = 2
Global Const $mm_anisotropic = 8
Global Const $mm_hienglish = 5
Global Const $mm_himetric = 3
Global Const $mm_isotropic = 7
Global Const $mm_loenglish = 4
Global Const $mm_lometric = 2
Global Const $mm_text = 1
Global Const $mm_twips = 6
Global Const $r2_black = 1
Global Const $r2_copypen = 13
Global Const $r2_last = 16
Global Const $r2_masknotpen = 3
Global Const $r2_maskpen = 9
Global Const $r2_maskpennot = 5
Global Const $r2_mergenotpen = 12
Global Const $r2_mergepen = 15
Global Const $r2_mergepennot = 14
Global Const $r2_nop = 11
Global Const $r2_not = 6
Global Const $r2_notcopypen = 4
Global Const $r2_notmaskpen = 8
Global Const $r2_notmergepen = 2
Global Const $r2_notxorpen = 10
Global Const $r2_white = 16
Global Const $r2_xorpen = 7
Global Const $blackonwhite = 1
Global Const $coloroncolor = 3
Global Const $halftone = 4
Global Const $whiteonblack = 2
Global Const $stretch_andscans = $blackonwhite
Global Const $stretch_deletescans = $coloroncolor
Global Const $stretch_halftone = $halftone
Global Const $stretch_orscans = $whiteonblack
Global Const $ta_baseline = 24
Global Const $ta_bottom = 8
Global Const $ta_top = 0
Global Const $ta_center = 6
Global Const $ta_left = 0
Global Const $ta_right = 2
Global Const $ta_noupdatecp = 0
Global Const $ta_rtlreading = 256
Global Const $ta_updatecp = 1
Global Const $vta_baseline = $ta_baseline
Global Const $vta_bottom = $ta_right
Global Const $vta_top = $ta_left
Global Const $vta_center = $ta_center
Global Const $vta_left = $ta_bottom
Global Const $vta_right = $ta_top
Global Const $udf_bgr = 1
Global Const $udf_rgb = 0
Global Const $mwt_identity = 1
Global Const $mwt_leftmultiply = 2
Global Const $mwt_rightmultiply = 3
Global Const $mwt_set = 4
Global Const $monitor_defaulttonearest = 2
Global Const $monitor_defaulttonull = 0
Global Const $monitor_defaulttoprimary = 1
Global Const $pt_bezierto = 4
Global Const $pt_lineto = 2
Global Const $pt_moveto = 6
Global Const $pt_closefigure = 1
#Region Global Variables and Constants
	Global Const $format_message_allocate_buffer = 256
	Global Const $format_message_ignore_inserts = 512
	Global Const $format_message_from_string = 1024
	Global Const $format_message_from_hmodule = 2048
	Global Const $format_message_from_system = 4096
	Global Const $format_message_argument_array = 8192
#EndRegion Global Variables and Constants

Func _winapi_beep($ifreq = 500, $iduration = 1000)
	Local $aresult = DllCall("kernel32.dll", "bool", "Beep", "dword", $ifreq, "dword", $iduration)
	If @error Then Return SetError(@error, @extended, False)
	Return $aresult[0]
EndFunc

Func _winapi_formatmessage($iflags, $psource, $imessageid, $ilanguageid, ByRef $pbuffer, $isize, $varguments)
	Local $sbuffertype = "struct*"
	If IsString($pbuffer) Then $sbuffertype = "wstr"
	Local $aresult = DllCall("kernel32.dll", "dword", "FormatMessageW", "dword", $iflags, "struct*", $psource, "dword", $imessageid, "dword", $ilanguageid, $sbuffertype, $pbuffer, "dword", $isize, "ptr", $varguments)
	If @error OR NOT $aresult[0] Then Return SetError(@error + 10, @extended, 0)
	If $sbuffertype = "wstr" Then $pbuffer = $aresult[5]
	Return $aresult[0]
EndFunc

Func _winapi_geterrormessage($icode, $ilanguage = 0, Const $_icurrenterror = @error, Const $_icurrentextended = @extended)
	Local $aret = DllCall("kernel32.dll", "dword", "FormatMessageW", "dword", 4096, "ptr", 0, "dword", $icode, "dword", $ilanguage, "wstr", "", "dword", 4096, "ptr", 0)
	If @error OR NOT $aret[0] Then Return SetError(@error, @extended, "")
	Return SetError($_icurrenterror, $_icurrentextended, StringRegExpReplace($aret[5], "[" & @LF & "," & @CR & "]*\Z", ""))
EndFunc

Func _winapi_getlasterror(Const $_icurrenterror = @error, Const $_icurrentextended = @extended)
	Local $aresult = DllCall("kernel32.dll", "dword", "GetLastError")
	Return SetError($_icurrenterror, $_icurrentextended, $aresult[0])
EndFunc

Func _winapi_getlasterrormessage(Const $_icurrenterror = @error, Const $_icurrentextended = @extended)
	Local $ilasterror = _winapi_getlasterror()
	Local $tbufferptr = DllStructCreate("ptr")
	Local $ncount = _winapi_formatmessage(BitOR($format_message_allocate_buffer, $format_message_from_system), 0, $ilasterror, 0, $tbufferptr, 0, 0)
	If @error Then Return SetError(-@error, @extended, "")
	Local $stext = ""
	Local $pbuffer = DllStructGetData($tbufferptr, 1)
	If $pbuffer Then
		If $ncount > 0 Then
			Local $tbuffer = DllStructCreate("wchar[" & ($ncount + 1) & "]", $pbuffer)
			$stext = DllStructGetData($tbuffer, 1)
			If StringRight($stext, 2) = @CRLF Then $stext = StringTrimRight($stext, 2)
		EndIf
		DllCall("kernel32.dll", "handle", "LocalFree", "handle", $pbuffer)
	EndIf
	Return SetError($_icurrenterror, $_icurrentextended, $stext)
EndFunc

Func _winapi_messagebeep($itype = 1)
	Local $isound
	Switch $itype
		Case 1
			$isound = 0
		Case 2
			$isound = 16
		Case 3
			$isound = 32
		Case 4
			$isound = 48
		Case 5
			$isound = 64
		Case Else
			$isound = -1
	EndSwitch
	Local $aresult = DllCall("user32.dll", "bool", "MessageBeep", "uint", $isound)
	If @error Then Return SetError(@error, @extended, False)
	Return $aresult[0]
EndFunc

Func _winapi_msgbox($iflags, $stitle, $stext)
	BlockInput(0)
	MsgBox($iflags, $stitle, $stext & "      ")
EndFunc

Func _winapi_setlasterror($ierrorcode, Const $_icurrenterror = @error, Const $_icurrentextended = @extended)
	DllCall("kernel32.dll", "none", "SetLastError", "dword", $ierrorcode)
	Return SetError($_icurrenterror, $_icurrentextended, NULL )
EndFunc

Func _winapi_showerror($stext, $bexit = True)
	BlockInput(0)
	MsgBox($mb_systemmodal, "Error", $stext & "      ")
	If $bexit Then Exit
EndFunc

Func _winapi_showlasterror($stext = "", $babort = False, $ilanguage = 0, Const $_icurrenterror = @error, Const $_icurrentextended = @extended)
	Local $serror
	Local $ilasterror = _winapi_getlasterror()
	While 1
		$serror = _winapi_geterrormessage($ilasterror, $ilanguage)
		If @error AND $ilanguage Then
			$ilanguage = 0
		Else
			ExitLoop
		EndIf
	WEnd
	If StringStripWS($stext, $str_stripleading + $str_striptrailing) Then
		$stext &= @CRLF & @CRLF
	Else
		$stext = ""
	EndIf
	_winapi_msgbox(BitOR(262144, BitShift(16, -2 * (NOT $ilasterror))), $ilasterror, $stext & $serror)
	If $ilasterror Then
		_winapi_setlasterror($ilasterror)
		If $babort Then
			Exit $ilasterror
		EndIf
	EndIf
	Return SetError($_icurrenterror, $_icurrentextended, 1)
EndFunc

Func _winapi_showmsg($stext)
	_winapi_msgbox($mb_systemmodal, "Information", $stext)
EndFunc

Func __comerrorformating(ByRef $ocomerror, $sprefix = @TAB)
	Local Const $str_striptrailing = 2
	Local $serror = "COM Error encountered in " & @ScriptName & " (" & $ocomerror.scriptline & ") :" & @CRLF & $sprefix & "Number        " & @TAB & "= 0x" & Hex($ocomerror.number, 8) & " (" & $ocomerror.number & ")" & @CRLF & $sprefix & "WinDescription" & @TAB & "= " & StringStripWS($ocomerror.windescription, $str_striptrailing) & @CRLF & $sprefix & "Description   " & @TAB & "= " & StringStripWS($ocomerror.description, $str_striptrailing) & @CRLF & $sprefix & "Source        " & @TAB & "= " & $ocomerror.source & @CRLF & $sprefix & "HelpFile      " & @TAB & "= " & $ocomerror.helpfile & @CRLF & $sprefix & "HelpContext   " & @TAB & "= " & $ocomerror.helpcontext & @CRLF & $sprefix & "LastDllError  " & @TAB & "= " & $ocomerror.lastdllerror & @CRLF & $sprefix & "Retcode       " & @TAB & "= 0x" & Hex($ocomerror.retcode)
	Return $serror
EndFunc

#Region Global Variables and Constants
	Global Const $duplicate_close_source = 1
	Global Const $duplicate_same_access = 2
	Global Const $obj_bitmap = 7
	Global Const $obj_brush = 2
	Global Const $obj_colorspace = 14
	Global Const $obj_dc = 3
	Global Const $obj_enhmetadc = 12
	Global Const $obj_enhmetafile = 13
	Global Const $obj_extpen = 11
	Global Const $obj_font = 6
	Global Const $obj_memdc = 10
	Global Const $obj_metadc = 4
	Global Const $obj_metafile = 9
	Global Const $obj_pal = 5
	Global Const $obj_pen = 1
	Global Const $obj_region = 8
	Global Const $null_brush = 5
	Global Const $null_pen = 8
	Global Const $black_brush = 4
	Global Const $dkgray_brush = 3
	Global Const $dc_brush = 18
	Global Const $gray_brush = 2
	Global Const $hollow_brush = $null_brush
	Global Const $ltgray_brush = 1
	Global Const $white_brush = 0
	Global Const $black_pen = 7
	Global Const $dc_pen = 19
	Global Const $white_pen = 6
	Global Const $ansi_fixed_font = 11
	Global Const $ansi_var_font = 12
	Global Const $device_default_font = 14
	Global Const $default_gui_font = 17
	Global Const $oem_fixed_font = 10
	Global Const $system_font = 13
	Global Const $system_fixed_font = 16
	Global Const $default_palette = 15
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_closehandle($hobject)
		Local $aresult = DllCall("kernel32.dll", "bool", "CloseHandle", "handle", $hobject)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_deleteobject($hobject)
		Local $aresult = DllCall("gdi32.dll", "bool", "DeleteObject", "handle", $hobject)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_duplicatehandle($hsourceprocesshandle, $hsourcehandle, $htargetprocesshandle, $idesiredaccess, $iinherithandle, $ioptions)
		Local $aresult = DllCall("kernel32.dll", "bool", "DuplicateHandle", "handle", $hsourceprocesshandle, "handle", $hsourcehandle, "handle", $htargetprocesshandle, "handle*", 0, "dword", $idesiredaccess, "bool", $iinherithandle, "dword", $ioptions)
		If @error OR NOT $aresult[0] Then Return SetError(@error, @extended, 0)
		Return $aresult[4]
	EndFunc

	Func _winapi_getcurrentobject($hdc, $itype)
		Local $aret = DllCall("gdi32.dll", "handle", "GetCurrentObject", "handle", $hdc, "uint", $itype)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getcurrentprocess()
		Local $aresult = DllCall("kernel32.dll", "handle", "GetCurrentProcess")
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getobject($hobject, $isize, $pobject)
		Local $aresult = DllCall("gdi32.dll", "int", "GetObjectW", "handle", $hobject, "int", $isize, "struct*", $pobject)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getobjectinfobyhandle($hobject)
		Local $tagpublic_object_basic_information = "ulong Attributes;ulong GrantedAcess;ulong HandleCount;ulong PointerCount;ulong Reserved[10]"
		Local $tpobi = DllStructCreate($tagpublic_object_basic_information)
		Local $aret = DllCall("ntdll.dll", "long", "ZwQueryObject", "handle", $hobject, "uint", 0, "struct*", $tpobi, "ulong", DllStructGetSize($tpobi), "ptr", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Local $aresult[4]
		For $i = 0 To 3
			$aresult[$i] = DllStructGetData($tpobi, $i + 1)
		Next
		Return $aresult
	EndFunc

	Func _winapi_getobjectnamebyhandle($hobject)
		Local $tagunicode_string = "struct;ushort Length;ushort MaximumLength;ptr Buffer;endstruct"
		Local $tagpublic_object_type_information = "struct;" & $tagunicode_string & ";ulong Reserved[22];endstruct"
		Local $tpoti = DllStructCreate($tagpublic_object_type_information & ";byte[32]")
		Local $aret = DllCall("ntdll.dll", "long", "ZwQueryObject", "handle", $hobject, "uint", 2, "struct*", $tpoti, "ulong", DllStructGetSize($tpoti), "ulong*", 0)
		If @error Then Return SetError(@error, @extended, "")
		If $aret[0] Then Return SetError(10, $aret[0], "")
		Local $pdata = DllStructGetData($tpoti, 3)
		If NOT $pdata Then Return SetError(11, 0, "")
		Return _winapi_getstring($pdata)
	EndFunc

	Func _winapi_getobjecttype($hobject)
		Local $aret = DllCall("gdi32.dll", "dword", "GetObjectType", "handle", $hobject)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getstdhandle($istdhandle)
		If $istdhandle < 0 OR $istdhandle > 2 Then Return SetError(2, 0, -1)
		Local Const $ahandle[3] = [-10, -11, -12]
		Local $aresult = DllCall("kernel32.dll", "handle", "GetStdHandle", "dword", $ahandle[$istdhandle])
		If @error Then Return SetError(@error, @extended, -1)
		Return $aresult[0]
	EndFunc

	Func _winapi_getstockobject($iobject)
		Local $aresult = DllCall("gdi32.dll", "handle", "GetStockObject", "int", $iobject)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_selectobject($hdc, $hgdiobj)
		Local $aresult = DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hdc, "handle", $hgdiobj)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_sethandleinformation($hobject, $imask, $iflags)
		Local $aresult = DllCall("kernel32.dll", "bool", "SetHandleInformation", "handle", $hobject, "dword", $imask, "dword", $iflags)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

#EndRegion Public Functions
#Region Global Variables and Constants
	Global $__g_hheap = 0
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_createbuffer($ilength, $pbuffer = 0, $babort = True)
		$pbuffer = __heaprealloc($pbuffer, $ilength, 0, $babort)
		If @error Then Return SetError(@error, @extended, 0)
		Return $pbuffer
	EndFunc

	Func _winapi_createbufferfromstruct($tstruct, $pbuffer = 0, $babort = True)
		If NOT IsDllStruct($tstruct) Then Return SetError(1, 0, 0)
		$pbuffer = __heaprealloc($pbuffer, DllStructGetSize($tstruct), 0, $babort)
		If @error Then Return SetError(@error + 100, @extended, 0)
		_winapi_movememory($pbuffer, $tstruct, DllStructGetSize($tstruct))
		Return $pbuffer
	EndFunc

	Func _winapi_createstring($sstring, $pstring = 0, $ilength = -1, $bunicode = True, $babort = True)
		$ilength = Number($ilength)
		If $ilength >= 0 Then
			$sstring = StringLeft($sstring, $ilength)
		Else
			$ilength = StringLen($sstring)
		EndIf
		Local $isize = $ilength + 1
		If $bunicode Then
			$isize *= 2
		EndIf
		$pstring = __heaprealloc($pstring, $isize, 0, $babort)
		If @error Then Return SetError(@error, @extended, 0)
		DllStructSetData(DllStructCreate(($bunicode ? "wchar" : "char") & "[" & ($ilength + 1) & "]", $pstring), 1, $sstring)
		Return SetExtended($ilength, $pstring)
	EndFunc

	Func _winapi_equalmemory($psource1, $psource2, $ilength)
		If _winapi_isbadreadptr($psource1, $ilength) Then Return SetError(11, @extended, 0)
		If _winapi_isbadreadptr($psource2, $ilength) Then Return SetError(12, @extended, 0)
		Local $aret = DllCall("ntdll.dll", "ulong_ptr", "RtlCompareMemory", "struct*", $psource1, "struct*", $psource2, "ulong_ptr", $ilength)
		If @error Then Return SetError(@error, @extended, 0)
		Return Number($aret[0] = $ilength)
	EndFunc

	Func _winapi_fillmemory($pmemory, $ilength, $ivalue = 0)
		If _winapi_isbadwriteptr($pmemory, $ilength) Then Return SetError(11, @extended, 0)
		DllCall("ntdll.dll", "none", "RtlFillMemory", "struct*", $pmemory, "ulong_ptr", $ilength, "byte", $ivalue)
		If @error Then Return SetError(@error, @extended, 0)
		Return 1
	EndFunc

	Func _winapi_freememory($pmemory)
		If NOT __heapfree($pmemory, 1) Then Return SetError(@error, @extended, 0)
		Return 1
	EndFunc

	Func _winapi_getmemorysize($pmemory)
		Local $iresult = __heapsize($pmemory, 1)
		If @error Then Return SetError(@error, @extended, 0)
		Return $iresult
	EndFunc

	Func _winapi_globalmemorystatus()
		Local Const $tagmemorystatusex = "dword Length;dword MemoryLoad;" & "uint64 TotalPhys;uint64 AvailPhys;uint64 TotalPageFile;uint64 AvailPageFile;" & "uint64 TotalVirtual;uint64 AvailVirtual;uint64 AvailExtendedVirtual"
		Local $tmem = DllStructCreate($tagmemorystatusex)
		DllStructSetData($tmem, 1, DllStructGetSize($tmem))
		Local $aret = DllCall("kernel32.dll", "bool", "GlobalMemoryStatusEx", "struct*", $tmem)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $amem[7]
		$amem[0] = DllStructGetData($tmem, 2)
		$amem[1] = DllStructGetData($tmem, 3)
		$amem[2] = DllStructGetData($tmem, 4)
		$amem[3] = DllStructGetData($tmem, 5)
		$amem[4] = DllStructGetData($tmem, 6)
		$amem[5] = DllStructGetData($tmem, 7)
		$amem[6] = DllStructGetData($tmem, 8)
		Return $amem
	EndFunc

	Func _winapi_isbadcodeptr($paddress)
		Local $aret = DllCall("kernel32.dll", "bool", "IsBadCodePtr", "struct*", $paddress)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_isbadreadptr($paddress, $ilength)
		Local $aret = DllCall("kernel32.dll", "bool", "IsBadReadPtr", "struct*", $paddress, "uint_ptr", $ilength)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_isbadstringptr($paddress, $ilength)
		Local $aret = DllCall("kernel32.dll", "bool", "IsBadStringPtr", "struct*", $paddress, "uint_ptr", $ilength)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_isbadwriteptr($paddress, $ilength)
		Local $aret = DllCall("kernel32.dll", "bool", "IsBadWritePtr", "struct*", $paddress, "uint_ptr", $ilength)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_ismemory($pmemory)
		Local $bresult = __heapvalidate($pmemory)
		Return SetError(@error, @extended, $bresult)
	EndFunc

	Func _winapi_localfree($hmemory)
		Local $aresult = DllCall("kernel32.dll", "handle", "LocalFree", "handle", $hmemory)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_movememory($pdestination, $psource, $ilength)
		If _winapi_isbadreadptr($psource, $ilength) Then Return SetError(10, @extended, 0)
		If _winapi_isbadwriteptr($pdestination, $ilength) Then Return SetError(11, @extended, 0)
		DllCall("ntdll.dll", "none", "RtlMoveMemory", "struct*", $pdestination, "struct*", $psource, "ulong_ptr", $ilength)
		If @error Then Return SetError(@error, @extended, 0)
		Return 1
	EndFunc

	Func _winapi_readprocessmemory($hprocess, $pbaseaddress, $pbuffer, $isize, ByRef $iread)
		Local $aresult = DllCall("kernel32.dll", "bool", "ReadProcessMemory", "handle", $hprocess, "ptr", $pbaseaddress, "struct*", $pbuffer, "ulong_ptr", $isize, "ulong_ptr*", 0)
		If @error Then Return SetError(@error, @extended, False)
		$iread = $aresult[5]
		Return $aresult[0]
	EndFunc

	Func _winapi_writeprocessmemory($hprocess, $pbaseaddress, $pbuffer, $isize, ByRef $iwritten, $sbuffer = "ptr")
		Local $aresult = DllCall("kernel32.dll", "bool", "WriteProcessMemory", "handle", $hprocess, "ptr", $pbaseaddress, $sbuffer, $pbuffer, "ulong_ptr", $isize, "ulong_ptr*", 0)
		If @error Then Return SetError(@error, @extended, False)
		$iwritten = $aresult[5]
		Return $aresult[0]
	EndFunc

	Func _winapi_zeromemory($pmemory, $ilength)
		If _winapi_isbadwriteptr($pmemory, $ilength) Then Return SetError(11, @extended, 0)
		DllCall("ntdll.dll", "none", "RtlZeroMemory", "struct*", $pmemory, "ulong_ptr", $ilength)
		If @error Then Return SetError(@error, @extended, 0)
		Return 1
	EndFunc

#EndRegion Public Functions
#Region Internal Functions

	Func __heapalloc($isize, $babort = False)
		Local $aret
		If NOT $__g_hheap Then
			$aret = DllCall("kernel32.dll", "handle", "HeapCreate", "dword", 0, "ulong_ptr", 0, "ulong_ptr", 0)
			If @error OR NOT $aret[0] Then __fatalexit(1, "Error allocating memory.")
			$__g_hheap = $aret[0]
		EndIf
		$aret = DllCall("kernel32.dll", "ptr", "HeapAlloc", "handle", $__g_hheap, "dword", 8, "ulong_ptr", $isize)
		If @error OR NOT $aret[0] Then
			If $babort Then __fatalexit(1, "Error allocating memory.")
			Return SetError(@error + 30, @extended, 0)
		EndIf
		Return $aret[0]
	EndFunc

	Func __heapfree(ByRef $pmemory, $bcheck = False, $icurerr = @error, $icurext = @extended)
		If $bcheck AND (NOT __heapvalidate($pmemory)) Then Return SetError(@error, @extended, 0)
		Local $aret = DllCall("kernel32.dll", "int", "HeapFree", "handle", $__g_hheap, "dword", 0, "ptr", $pmemory)
		If @error OR NOT $aret[0] Then Return SetError(@error + 40, @extended, 0)
		$pmemory = 0
		Return SetError($icurerr, $icurext, 1)
	EndFunc

	Func __heaprealloc($pmemory, $isize, $bamount = False, $babort = False)
		Local $aret, $pret
		If __heapvalidate($pmemory) Then
			If $bamount AND (__heapsize($pmemory) >= $isize) Then Return SetExtended(1, Ptr($pmemory))
			$aret = DllCall("kernel32.dll", "ptr", "HeapReAlloc", "handle", $__g_hheap, "dword", 8, "ptr", $pmemory, "ulong_ptr", $isize)
			If @error OR NOT $aret[0] Then
				If $babort Then __fatalexit(1, "Error allocating memory.")
				Return SetError(@error + 20, @extended, Ptr($pmemory))
			EndIf
			$pret = $aret[0]
		Else
			$pret = __heapalloc($isize, $babort)
			If @error Then Return SetError(@error, @extended, 0)
		EndIf
		Return $pret
	EndFunc

	Func __heapsize($pmemory, $bcheck = False)
		If $bcheck AND (NOT __heapvalidate($pmemory)) Then Return SetError(@error, @extended, 0)
		Local $aret = DllCall("kernel32.dll", "ulong_ptr", "HeapSize", "handle", $__g_hheap, "dword", 0, "ptr", $pmemory)
		If @error OR ($aret[0] = Ptr(-1)) Then Return SetError(@error + 50, @extended, 0)
		Return $aret[0]
	EndFunc

	Func __heapvalidate($pmemory)
		If (NOT $__g_hheap) OR (NOT Ptr($pmemory)) Then Return SetError(9, 0, False)
		Local $aret = DllCall("kernel32.dll", "int", "HeapValidate", "handle", $__g_hheap, "dword", 0, "ptr", $pmemory)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

#EndRegion Internal Functions
Global Const $snd_application = 128
Global Const $snd_alias = 65536
Global Const $snd_alias_id = 1114112
Global Const $snd_async = 1
Global Const $snd_filename = 131072
Global Const $snd_loop = 8
Global Const $snd_memory = 4
Global Const $snd_nodefault = 2
Global Const $snd_nostop = 16
Global Const $snd_nowait = 8192
Global Const $snd_purge = 64
Global Const $snd_resource = 262148
Global Const $snd_sentry = 524288
Global Const $snd_sync = 0
Global Const $snd_system = 2097152
Global Const $snd_system_nostop = 2097168
Global Const $snd_alias_systemasterisk = "SystemAsterisk"
Global Const $snd_alias_systemdefault = "SystemDefault"
Global Const $snd_alias_systemexclamation = "SystemExclamation"
Global Const $snd_alias_systemexit = "SystemExit"
Global Const $snd_alias_systemhand = "SystemHand"
Global Const $snd_alias_systemquestion = "SystemQuestion"
Global Const $snd_alias_systemstart = "SystemStart"
Global Const $snd_alias_systemwelcome = "SystemWelcome"
#Region Global Variables and Constants
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_arraytostruct(Const ByRef $adata, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($adata, $istart, $iend) Then Return SetError(@error + 10, @extended, 0)
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "wchar[" & (StringLen($adata[$i]) + 1) & "];"
		Next
		Local $tdata = DllStructCreate($tagstruct & "wchar[1]")
		Local $icount = 1
		For $i = $istart To $iend
			DllStructSetData($tdata, $icount, $adata[$i])
			$icount += 1
		Next
		DllStructSetData($tdata, $icount, ChrW(0))
		Return $tdata
	EndFunc

	Func _winapi_createmargins($ileftwidth, $irightwidth, $itopheight, $ibottomheight)
		Local $tmargins = DllStructCreate($tagmargins)
		DllStructSetData($tmargins, 1, $ileftwidth)
		DllStructSetData($tmargins, 2, $irightwidth)
		DllStructSetData($tmargins, 3, $itopheight)
		DllStructSetData($tmargins, 4, $ibottomheight)
		Return $tmargins
	EndFunc

	Func _winapi_createpoint($ix, $iy)
		Local $tpoint = DllStructCreate($tagpoint)
		DllStructSetData($tpoint, 1, $ix)
		DllStructSetData($tpoint, 2, $iy)
		Return $tpoint
	EndFunc

	Func _winapi_createrect($ileft, $itop, $iright, $ibottom)
		Local $trect = DllStructCreate($tagrect)
		DllStructSetData($trect, 1, $ileft)
		DllStructSetData($trect, 2, $itop)
		DllStructSetData($trect, 3, $iright)
		DllStructSetData($trect, 4, $ibottom)
		Return $trect
	EndFunc

	Func _winapi_createrectex($ix, $iy, $iwidth, $iheight)
		Local $trect = DllStructCreate($tagrect)
		DllStructSetData($trect, 1, $ix)
		DllStructSetData($trect, 2, $iy)
		DllStructSetData($trect, 3, $ix + $iwidth)
		DllStructSetData($trect, 4, $iy + $iheight)
		Return $trect
	EndFunc

	Func _winapi_createsize($iwidth, $iheight)
		Local $tsize = DllStructCreate($tagsize)
		DllStructSetData($tsize, 1, $iwidth)
		DllStructSetData($tsize, 2, $iheight)
		Return $tsize
	EndFunc

	Func _winapi_copystruct($tstruct, $sstruct = "")
		Local $isize = DllStructGetSize($tstruct)
		If NOT $isize Then Return SetError(1, 0, 0)
		Local $tresult
		If NOT StringStripWS($sstruct, $str_stripleading + $str_striptrailing + $str_stripspaces) Then
			$tresult = DllStructCreate("byte[" & $isize & "]")
		Else
			$tresult = DllStructCreate($sstruct)
		EndIf
		If DllStructGetSize($tresult) < $isize Then Return SetError(2, 0, 0)
		_winapi_movememory($tresult, $tstruct, $isize)
		Return $tresult
	EndFunc

	Func _winapi_getextended()
		Return $__g_vext
	EndFunc

	Func _winapi_getmousepos($btoclient = False, $hwnd = 0)
		Local $imode = Opt("MouseCoordMode", 1)
		Local $apos = MouseGetPos()
		Opt("MouseCoordMode", $imode)
		Local $tpoint = DllStructCreate($tagpoint)
		DllStructSetData($tpoint, "X", $apos[0])
		DllStructSetData($tpoint, "Y", $apos[1])
		If $btoclient AND NOT _winapi_screentoclient($hwnd, $tpoint) Then Return SetError(@error + 20, @extended, 0)
		Return $tpoint
	EndFunc

	Func _winapi_getmouseposx($btoclient = False, $hwnd = 0)
		Local $tpoint = _winapi_getmousepos($btoclient, $hwnd)
		If @error Then Return SetError(@error, @extended, 0)
		Return DllStructGetData($tpoint, "X")
	EndFunc

	Func _winapi_getmouseposy($btoclient = False, $hwnd = 0)
		Local $tpoint = _winapi_getmousepos($btoclient, $hwnd)
		If @error Then Return SetError(@error, @extended, 0)
		Return DllStructGetData($tpoint, "Y")
	EndFunc

	Func _winapi_muldiv($inumber, $inumerator, $idenominator)
		Local $aresult = DllCall("kernel32.dll", "int", "MulDiv", "int", $inumber, "int", $inumerator, "int", $idenominator)
		If @error Then Return SetError(@error, @extended, -1)
		Return $aresult[0]
	EndFunc

	Func _winapi_playsound($ssound, $iflags = $snd_system_nostop, $hinstance = 0)
		Local $stypeofsound = "ptr"
		If $ssound Then
			If IsString($ssound) Then
				$stypeofsound = "wstr"
			EndIf
		Else
			$ssound = 0
			$iflags = 0
		EndIf
		Local $aret = DllCall("winmm.dll", "bool", "PlaySoundW", $stypeofsound, $ssound, "handle", $hinstance, "dword", $iflags)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_stringlena(Const ByRef $tstring)
		Local $aresult = DllCall("kernel32.dll", "int", "lstrlenA", "struct*", $tstring)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_stringlenw(Const ByRef $tstring)
		Local $aresult = DllCall("kernel32.dll", "int", "lstrlenW", "struct*", $tstring)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_structtoarray(ByRef $tstruct, $iitems = 0)
		Local $isize = 2 * Floor(DllStructGetSize($tstruct) / 2)
		Local $pstruct = DllStructGetPtr($tstruct)
		If NOT $isize OR NOT $pstruct Then Return SetError(1, 0, 0)
		Local $tdata, $ilength, $ioffset = 0
		Local $aresult[101] = [0]
		While 1
			$ilength = _winapi_strlen($pstruct + $ioffset)
			If NOT $ilength Then
				ExitLoop
			EndIf
			If 2 * (1 + $ilength) + $ioffset > $isize Then Return SetError(3, 0, 0)
			$tdata = DllStructCreate("wchar[" & (1 + $ilength) & "]", $pstruct + $ioffset)
			If @error Then Return SetError(@error + 10, 0, 0)
			__inc($aresult)
			$aresult[$aresult[0]] = DllStructGetData($tdata, 1)
			If $aresult[0] = $iitems Then
				ExitLoop
			EndIf
			$ioffset += 2 * (1 + $ilength)
			If $ioffset >= $isize Then Return SetError(3, 0, 0)
		WEnd
		If NOT $aresult[0] Then Return SetError(2, 0, 0)
		__inc($aresult, -1)
		Return $aresult
	EndFunc

	Func _winapi_unionstruct($tstruct1, $tstruct2, $sstruct = "")
		Local $asize[2] = [DllStructGetSize($tstruct1), DllStructGetSize($tstruct2)]
		If NOT $asize[0] OR NOT $asize[1] Then Return SetError(1, 0, 0)
		Local $tresult
		If NOT StringStripWS($sstruct, $str_stripleading + $str_striptrailing + $str_stripspaces) Then
			$tresult = DllStructCreate("byte[" & ($asize[0] + $asize[1]) & "]")
		Else
			$tresult = DllStructCreate($sstruct)
		EndIf
		If DllStructGetSize($tresult) < ($asize[0] + $asize[1]) Then Return SetError(2, 0, 0)
		_winapi_movememory($tresult, $tstruct1, $asize[0])
		_winapi_movememory(DllStructGetPtr($tresult) + $asize[0], $tstruct2, $asize[1])
		Return $tresult
	EndFunc

#EndRegion Public Functions
#Region Global Variables and Constants
	Global Const $tagbitmap = "struct;long bmType;long bmWidth;long bmHeight;long bmWidthBytes;ushort bmPlanes;ushort bmBitsPixel;ptr bmBits;endstruct"
	Global Const $tagbitmapv5header = "struct;dword bV5Size;long bV5Width;long bV5Height;ushort bV5Planes;ushort bV5BitCount;dword bV5Compression;dword bV5SizeImage;long bV5XPelsPerMeter;long bV5YPelsPerMeter;dword bV5ClrUsed;dword bV5ClrImportant;dword bV5RedMask;dword bV5GreenMask;dword bV5BlueMask;dword bV5AlphaMask;dword bV5CSType;int bV5Endpoints[9];dword bV5GammaRed;dword bV5GammaGreen;dword bV5GammaBlue;dword bV5Intent;dword bV5ProfileData;dword bV5ProfileSize;dword bV5Reserved;endstruct"
	Global Const $tagdibsection = $tagbitmap & ";" & $tagbitmapinfoheader & ";dword dsBitfields[3];ptr dshSection;dword dsOffset"
	Global Const $tmpf_fixed_pitch = 1
	Global Const $tmpf_vector = 2
	Global Const $tmpf_truetype = 4
	Global Const $tmpf_device = 8
	Global Const $__winapiconstant_fw_normal = 400
	Global Const $__winapiconstant_default_charset = 1
	Global Const $__winapiconstant_out_default_precis = 0
	Global Const $__winapiconstant_clip_default_precis = 0
	Global Const $__winapiconstant_default_quality = 0
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_bitblt($hdestdc, $ixdest, $iydest, $iwidth, $iheight, $hsrcdc, $ixsrc, $iysrc, $irop)
		Local $aresult = DllCall("gdi32.dll", "bool", "BitBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidth, "int", $iheight, "handle", $hsrcdc, "int", $ixsrc, "int", $iysrc, "dword", $irop)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_combinergn($hrgndest, $hrgnsrc1, $hrgnsrc2, $icombinemode)
		Local $aresult = DllCall("gdi32.dll", "int", "CombineRgn", "handle", $hrgndest, "handle", $hrgnsrc1, "handle", $hrgnsrc2, "int", $icombinemode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_copybitmap($hbitmap)
		$hbitmap = _winapi_copyimage($hbitmap, 0, 0, 0, 8192)
		Return SetError(@error, @extended, $hbitmap)
	EndFunc

	Func _winapi_copyimage($himage, $itype = 0, $ixdesiredpixels = 0, $iydesiredpixels = 0, $iflags = 0)
		Local $aret = DllCall("user32.dll", "handle", "CopyImage", "handle", $himage, "uint", $itype, "int", $ixdesiredpixels, "int", $iydesiredpixels, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createandbitmap($hbitmap)
		Local $ierror = 0, $hdib = 0
		$hbitmap = _winapi_copybitmap($hbitmap)
		If NOT $hbitmap Then Return SetError(@error + 20, @extended, 0)
		Do
			Local $atdib[2]
			$atdib[0] = DllStructCreate($tagdibsection)
			If (NOT _winapi_getobject($hbitmap, DllStructGetSize($atdib[0]), $atdib[0])) OR (DllStructGetData($atdib[0], "bmBitsPixel") <> 32) OR (DllStructGetData($atdib[0], "biCompression")) Then
				$ierror = 10
				ExitLoop
			EndIf
			$atdib[1] = DllStructCreate($tagbitmap)
			$hdib = _winapi_createdib(DllStructGetData($atdib[0], "bmWidth"), DllStructGetData($atdib[0], "bmHeight"), 1)
			If NOT _winapi_getobject($hdib, DllStructGetSize($atdib[1]), $atdib[1]) Then
				$ierror = 11
				ExitLoop
			EndIf
			Local $aret = DllCall("user32.dll", "lresult", "CallWindowProc", "ptr", __andproc(), "ptr", 0, "uint", 0, "wparam", DllStructGetPtr($atdib[0]), "lparam", DllStructGetPtr($atdib[1]))
			If @error Then
				$ierror = @error
				ExitLoop
			EndIf
			If NOT $aret[0] Then
				$ierror = 12
				ExitLoop
			EndIf
			$ierror = 0
		Until 1
		_winapi_deleteobject($hbitmap)
		If $ierror Then
			If $hdib Then
				_winapi_deleteobject($hdib)
			EndIf
			$hdib = 0
		EndIf
		Return SetError($ierror, 0, $hdib)
	EndFunc

	Func _winapi_createbitmap($iwidth, $iheight, $iplanes = 1, $ibitsperpel = 1, $pbits = 0)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateBitmap", "int", $iwidth, "int", $iheight, "uint", $iplanes, "uint", $ibitsperpel, "struct*", $pbits)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createcompatiblebitmap($hdc, $iwidth, $iheight)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateCompatibleBitmap", "handle", $hdc, "int", $iwidth, "int", $iheight)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createdib($iwidth, $iheight, $ibitsperpel = 32, $tcolortable = 0, $icolorcount = 0)
		Local $argbq[2], $icolors, $tagrgbq
		Switch $ibitsperpel
			Case 1
				$icolors = 2
			Case 4
				$icolors = 16
			Case 8
				$icolors = 256
			Case Else
				$icolors = 0
		EndSwitch
		If $icolors Then
			If NOT IsDllStruct($tcolortable) Then
				Switch $ibitsperpel
					Case 1
						$argbq[0] = 0
						$argbq[1] = 16777215
						$tcolortable = _winapi_createdibcolortable($argbq)
					Case Else
				EndSwitch
			Else
				If $icolors > $icolorcount Then
					$icolors = $icolorcount
				EndIf
				If (NOT $icolors) OR ((4 * $icolors) > DllStructGetSize($tcolortable)) Then
					Return SetError(20, 0, 0)
				EndIf
			EndIf
			$tagrgbq = ";dword aRGBQuad[" & $icolors & "]"
		Else
			$tagrgbq = ""
		EndIf
		Local $tbitmapinfo = DllStructCreate($tagbitmapinfoheader & $tagrgbq)
		DllStructSetData($tbitmapinfo, "biSize", 40)
		DllStructSetData($tbitmapinfo, "biWidth", $iwidth)
		DllStructSetData($tbitmapinfo, "biHeight", $iheight)
		DllStructSetData($tbitmapinfo, "biPlanes", 1)
		DllStructSetData($tbitmapinfo, "biBitCount", $ibitsperpel)
		DllStructSetData($tbitmapinfo, "biCompression", 0)
		DllStructSetData($tbitmapinfo, "biSizeImage", 0)
		DllStructSetData($tbitmapinfo, "biXPelsPerMeter", 0)
		DllStructSetData($tbitmapinfo, "biYPelsPerMeter", 0)
		DllStructSetData($tbitmapinfo, "biClrUsed", $icolors)
		DllStructSetData($tbitmapinfo, "biClrImportant", 0)
		If $icolors Then
			If IsDllStruct($tcolortable) Then
				_winapi_movememory(DllStructGetPtr($tbitmapinfo, "aRGBQuad"), $tcolortable, 4 * $icolors)
			Else
				_winapi_zeromemory(DllStructGetPtr($tbitmapinfo, "aRGBQuad"), 4 * $icolors)
			EndIf
		EndIf
		Local $hbitmap = _winapi_createdibsection(0, $tbitmapinfo, 0, $__g_vext)
		If NOT $hbitmap Then Return SetError(@error, @extended, 0)
		Return $hbitmap
	EndFunc

	Func _winapi_createdibsection($hdc, $tbitmapinfo, $iusage, ByRef $pbits, $hsection = 0, $ioffset = 0)
		$pbits = 0
		Local $aret = DllCall("gdi32.dll", "handle", "CreateDIBSection", "handle", $hdc, "struct*", $tbitmapinfo, "uint", $iusage, "ptr*", 0, "handle", $hsection, "dword", $ioffset)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		$pbits = $aret[4]
		Return $aret[0]
	EndFunc

	Func _winapi_createdibcolortable(Const ByRef $acolortable, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($acolortable, $istart, $iend) Then Return SetError(@error + 10, @extended, 0)
		Local $tcolortable = DllStructCreate("dword[" & ($iend - $istart + 1) & "]")
		Local $icount = 1
		For $i = $istart To $iend
			DllStructSetData($tcolortable, 1, _winapi_switchcolor(__rgb($acolortable[$i])), $icount)
			$icount += 1
		Next
		Return $tcolortable
	EndFunc

	Func _winapi_createfont($iheight, $iwidth, $iescape = 0, $iorientn = 0, $iweight = $__winapiconstant_fw_normal, $bitalic = False, $bunderline = False, $bstrikeout = False, $icharset = $__winapiconstant_default_charset, $ioutputprec = $__winapiconstant_out_default_precis, $iclipprec = $__winapiconstant_clip_default_precis, $iquality = $__winapiconstant_default_quality, $ipitch = 0, $sface = "Arial")
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateFontW", "int", $iheight, "int", $iwidth, "int", $iescape, "int", $iorientn, "int", $iweight, "dword", $bitalic, "dword", $bunderline, "dword", $bstrikeout, "dword", $icharset, "dword", $ioutputprec, "dword", $iclipprec, "dword", $iquality, "dword", $ipitch, "wstr", $sface)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createfontindirect($tlogfont)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateFontIndirectW", "struct*", $tlogfont)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createrectrgn($ileftrect, $itoprect, $irightrect, $ibottomrect)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateRectRgn", "int", $ileftrect, "int", $itoprect, "int", $irightrect, "int", $ibottomrect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createroundrectrgn($ileftrect, $itoprect, $irightrect, $ibottomrect, $iwidthellipse, $iheightellipse)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateRoundRectRgn", "int", $ileftrect, "int", $itoprect, "int", $irightrect, "int", $ibottomrect, "int", $iwidthellipse, "int", $iheightellipse)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createsolidbrush($icolor)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateSolidBrush", "INT", $icolor)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getbitmapdimension($hbitmap)
		Local $tobj = DllStructCreate($tagbitmap)
		Local $aret = DllCall("gdi32.dll", "int", "GetObject", "handle", $hbitmap, "int", DllStructGetSize($tobj), "struct*", $tobj)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return _winapi_createsize(DllStructGetData($tobj, "bmWidth"), DllStructGetData($tobj, "bmHeight"))
	EndFunc

	Func _winapi_getsyscolorbrush($iindex)
		Local $aresult = DllCall("user32.dll", "handle", "GetSysColorBrush", "int", $iindex)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_gettextextentpoint32($hdc, $stext)
		Local $tsize = DllStructCreate($tagsize)
		Local $isize = StringLen($stext)
		Local $aret = DllCall("gdi32.dll", "bool", "GetTextExtentPoint32W", "handle", $hdc, "wstr", $stext, "int", $isize, "struct*", $tsize)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tsize
	EndFunc

	Func _winapi_gettextmetrics($hdc)
		Local $ttextmetric = DllStructCreate($tagtextmetric)
		Local $aret = DllCall("gdi32.dll", "bool", "GetTextMetricsW", "handle", $hdc, "struct*", $ttextmetric)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $ttextmetric
	EndFunc

	Func _winapi_getwindowrgn($hwnd, $hrgn)
		Local $aresult = DllCall("user32.dll", "int", "GetWindowRgn", "hwnd", $hwnd, "handle", $hrgn)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_isalphabitmap($hbitmap)
		$hbitmap = _winapi_copybitmap($hbitmap)
		If NOT $hbitmap Then Return SetError(@error + 20, @extended, 0)
		Local $aret, $ierror = 0
		Do
			Local $tdib = DllStructCreate($tagdibsection)
			If (NOT _winapi_getobject($hbitmap, DllStructGetSize($tdib), $tdib)) OR (DllStructGetData($tdib, "bmBitsPixel") <> 32) OR (DllStructGetData($tdib, "biCompression")) Then
				$ierror = 1
				ExitLoop
			EndIf
			$aret = DllCall("user32.dll", "int", "CallWindowProc", "ptr", __alphaproc(), "ptr", 0, "uint", 0, "struct*", $tdib, "ptr", 0)
			If @error OR ($aret[0] = -1) Then
				$ierror = @error + 10
				ExitLoop
			EndIf
		Until 1
		_winapi_deleteobject($hbitmap)
		If $ierror Then Return SetError($ierror, 0, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_ptinrect(ByRef $trect, ByRef $tpoint)
		Local $aresult = DllCall("user32.dll", "bool", "PtInRect", "struct*", $trect, "struct", $tpoint)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_redrawwindow($hwnd, $trect = 0, $hregion = 0, $iflags = 5)
		Local $aresult = DllCall("user32.dll", "bool", "RedrawWindow", "hwnd", $hwnd, "struct*", $trect, "handle", $hregion, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_setwindowrgn($hwnd, $hrgn, $bredraw = True)
		Local $aresult = DllCall("user32.dll", "int", "SetWindowRgn", "hwnd", $hwnd, "handle", $hrgn, "bool", $bredraw)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

#EndRegion Public Functions
#Region Embedded DLL Functions

	Func __alphaproc()
		Static $pproc = 0
		If NOT $pproc Then
			If @AutoItX64 Then
				$pproc = __init(Binary("0x48894C240848895424104C894424184C894C24205541574831C050504883EC28" & "48837C24600074054831C0EB0748C7C0010000004821C0751F488B6C24604883" & "7D180074054831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB" & "034831C04821C0740C48C7C0FFFFFFFF4863C0EB6F48C744242800000000488B" & "6C24604C637D04488B6C2460486345084C0FAFF849C1E7024983C7FC4C3B7C24" & "287C36488B6C24604C8B7D184C037C24284983C7034C897C2430488B6C243080" & "7D0000740C48C7C0010000004863C0EB1348834424280471A54831C04863C0EB" & "034831C04883C438415F5DC3"))
			Else
				$pproc = __init(Binary("0x555331C05050837C241C00740431C0EB05B80100000021C075198B6C241C837D" & "1400740431C0EB05B80100000021C07502EB07B801000000EB0231C021C07407" & "B8FFFFFFFFEB4FC70424000000008B6C241C8B5D048B6C241C0FAF5D08C1E302" & "83C3FC3B1C247C288B6C241C8B5D14031C2483C303895C24048B6C2404807D00" & "007407B801000000EB0C8304240471BE31C0EB0231C083C4085B5DC21000"))
			EndIf
		EndIf
		Return $pproc
	EndFunc

	Func __andproc()
		Static $pproc = 0
		If NOT $pproc Then
			If @AutoItX64 Then
				$pproc = __init(Binary("0x48894C240848895424104C894424184C894C2420554157415648C7C009000000" & "4883EC0848C704240000000048FFC875EF4883EC284883BC24A0000000007405" & "4831C0EB0748C7C0010000004821C00F85840000004883BC24A8000000007405" & "4831C0EB0748C7C0010000004821C07555488BAC24A000000048837D18007405" & "4831C0EB0748C7C0010000004821C07522488BAC24A800000048837D18007405" & "4831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB034831C048" & "21C07502EB0948C7C001000000EB034831C04821C07502EB0948C7C001000000" & "EB034831C04821C0740B4831C04863C0E9D701000048C74424280000000048C7" & "44243000000000488BAC24A00000004C637D0849FFCF4C3B7C24300F8C9C0100" & "0048C74424380000000048C74424400000000048C744244800000000488BAC24" & "A00000004C637D0449FFCF4C3B7C24480F8CDB000000488BAC24A00000004C8B" & "7D184C037C24284983C7034C897C2450488B6C2450807D000074264C8B7C2440" & "4C8B74243849F7DE4983C61F4C89F148C7C00100000048D3E04909C74C897C24" & "4048FF4424384C8B7C24384983FF1F7E6F4C8B7C244049F7D74C897C244048C7" & "442458180000004831C0483B4424587F3D488BAC24A80000004C8B7D184C037C" & "24604C897C24504C8B7C2440488B4C245849D3FF4C89F850488B6C2458588845" & "0048FF4424604883442458F871B948C74424380000000048C744244000000000" & "48834424280448FF4424480F810BFFFFFF48837C24380074794C8B7C244049F7" & "D74C8B74243849F7DE4983C6204C89F148C7C0FFFFFFFF48D3E04921C74C897C" & "244048C7442458180000004831C0483B4424587F3D488BAC24A80000004C8B7D" & "184C037C24604C897C24504C8B7C2440488B4C245849D3FF4C89F850488B6C24" & "585888450048FF4424604883442458F871B948FF4424300F814AFEFFFF48C7C0" & "010000004863C0EB034831C04883C470415E415F5DC3"))
			Else
				$pproc = __init(Binary("0x555357BA0800000083EC04C70424000000004A75F3837C243800740431C0EB05" & "B80100000021C07562837C243C00740431C0EB05B80100000021C0753F8B6C24" & "38837D1400740431C0EB05B80100000021C075198B6C243C837D1400740431C0" & "EB05B80100000021C07502EB07B801000000EB0231C021C07502EB07B8010000" & "00EB0231C021C07502EB07B801000000EB0231C021C0740731C0E969010000C7" & "042400000000C7442404000000008B6C24388B5D084B3B5C24040F8C3F010000" & "C744240800000000C744240C00000000C7442410000000008B6C24388B5D044B" & "3B5C24100F8CA90000008B6C24388B5D14031C2483C303895C24148B6C241480" & "7D0000741C8B5C240C8B7C2408F7DF83C71F89F9B801000000D3E009C3895C24" & "0CFF4424088B5C240883FB1F7E578B5C240CF7D3895C240CC744241818000000" & "31C03B4424187F2D8B6C243C8B5D14035C241C895C24148B5C240C8B4C2418D3" & "FB538B6C241858884500FF44241C83442418F871CBC744240800000000C74424" & "0C0000000083042404FF4424100F8145FFFFFF837C240800745B8B5C240CF7D3" & "8B7C2408F7DF83C72089F9B8FFFFFFFFD3E021C3895C240CC744241818000000" & "31C03B4424187F2D8B6C243C8B5D14035C241C895C24148B5C240C8B4C2418D3" & "FB538B6C241858884500FF44241C83442418F871CBFF4424040F81AFFEFFFFB8" & "01000000EB0231C083C4205F5B5DC21000"))
			EndIf
		EndIf
		Return $pproc
	EndFunc

	Func __xorproc()
		Static $pproc = 0
		If NOT $pproc Then
			If @AutoItX64 Then
				$pproc = __init(Binary("0x48894C240848895424104C894424184C894C24205541574831C050504883EC28" & "48837C24600074054831C0EB0748C7C0010000004821C0751B48837C24680074" & "054831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB034831C0" & "4821C074084831C04863C0EB7748C7442428000000004C637C24584983C7FC4C" & "3B7C24287C4F4C8B7C24604C037C24284C897C2430488B6C2430807D00007405" & "4831C0EB0748C7C0010000004821C0741C4C8B7C24684C037C24284983C7034C" & "897C2430488B6C2430C64500FF48834424280471A148C7C0010000004863C0EB" & "034831C04883C438415F5DC3"))
			Else
				$pproc = __init(Binary("0x555331C05050837C241C00740431C0EB05B80100000021C07516837C24200074" & "0431C0EB05B80100000021C07502EB07B801000000EB0231C021C0740431C0EB" & "5AC70424000000008B5C241883C3FC3B1C247C3E8B5C241C031C24895C24048B" & "6C2404807D0000740431C0EB05B80100000021C074168B5C2420031C2483C303" & "895C24048B6C2404C64500FF8304240471B6B801000000EB0231C083C4085B5D" & "C21000"))
			EndIf
		EndIf
		Return $pproc
	EndFunc

#EndRegion Embedded DLL Functions
#Region Internal Functions

	Func __init($ddata)
		Local $ilength = BinaryLen($ddata)
		Local $aret = DllCall("kernel32.dll", "ptr", "VirtualAlloc", "ptr", 0, "ulong_ptr", $ilength, "dword", 4096, "dword", 64)
		If @error OR NOT $aret[0] Then __fatalexit(1, "Error allocating memory.")
		Local $tdata = DllStructCreate("byte[" & $ilength & "]", $aret[0])
		DllStructSetData($tdata, 1, $ddata)
		Return $aret[0]
	EndFunc

#EndRegion Internal Functions
#Region Global Variables and Constants
	Global Const $di_mask = 1
	Global Const $di_image = 2
	Global Const $di_normal = 3
	Global Const $di_compat = 4
	Global Const $di_defaultsize = 8
	Global Const $di_nomirror = 16
	Global Const $display_device_attached_to_desktop = 1
	Global Const $display_device_multi_driver = 2
	Global Const $display_device_primary_device = 4
	Global Const $display_device_mirroring_driver = 8
	Global Const $display_device_vga_compatible = 16
	Global Const $display_device_removable = 32
	Global Const $display_device_disconnect = 33554432
	Global Const $display_device_remote = 67108864
	Global Const $display_device_modespruned = 134217728
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_createcompatibledc($hdc)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_deletedc($hdc)
		Local $aresult = DllCall("gdi32.dll", "bool", "DeleteDC", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_drawedge($hdc, $trect, $iedgetype, $iflags)
		Local $aresult = DllCall("user32.dll", "bool", "DrawEdge", "handle", $hdc, "struct*", $trect, "uint", $iedgetype, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_drawframecontrol($hdc, $trect, $itype, $istate)
		Local $aresult = DllCall("user32.dll", "bool", "DrawFrameControl", "handle", $hdc, "struct*", $trect, "uint", $itype, "uint", $istate)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_drawicon($hdc, $ix, $iy, $hicon)
		Local $aresult = DllCall("user32.dll", "bool", "DrawIcon", "handle", $hdc, "int", $ix, "int", $iy, "handle", $hicon)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_drawiconex($hdc, $ix, $iy, $hicon, $iwidth = 0, $iheight = 0, $istep = 0, $hbrush = 0, $iflags = 3)
		Local $ioptions
		Switch $iflags
			Case 1
				$ioptions = $di_mask
			Case 2
				$ioptions = $di_image
			Case 3
				$ioptions = $di_normal
			Case 4
				$ioptions = $di_compat
			Case 5
				$ioptions = $di_defaultsize
			Case Else
				$ioptions = $di_nomirror
		EndSwitch
		Local $aresult = DllCall("user32.dll", "bool", "DrawIconEx", "handle", $hdc, "int", $ix, "int", $iy, "handle", $hicon, "int", $iwidth, "int", $iheight, "uint", $istep, "handle", $hbrush, "uint", $ioptions)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_drawtext($hdc, $stext, ByRef $trect, $iflags)
		Local $aresult = DllCall("user32.dll", "int", "DrawTextW", "handle", $hdc, "wstr", $stext, "int", -1, "struct*", $trect, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_enumdisplaydevices($sdevice, $idevnum)
		Local $tname = 0, $iflags = 0, $adevice[5]
		If $sdevice <> "" Then
			$tname = DllStructCreate("wchar Text[" & StringLen($sdevice) + 1 & "]")
			DllStructSetData($tname, "Text", $sdevice)
		EndIf
		Local Const $tagdisplay_device = "dword Size;wchar Name[32];wchar String[128];dword Flags;wchar ID[128];wchar Key[128]"
		Local $tdevice = DllStructCreate($tagdisplay_device)
		Local $idevice = DllStructGetSize($tdevice)
		DllStructSetData($tdevice, "Size", $idevice)
		Local $aret = DllCall("user32.dll", "bool", "EnumDisplayDevicesW", "struct*", $tname, "dword", $idevnum, "struct*", $tdevice, "dword", 1)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $in = DllStructGetData($tdevice, "Flags")
		If BitAND($in, $display_device_attached_to_desktop) <> 0 Then $iflags = BitOR($iflags, 1)
		If BitAND($in, $display_device_primary_device) <> 0 Then $iflags = BitOR($iflags, 2)
		If BitAND($in, $display_device_mirroring_driver) <> 0 Then $iflags = BitOR($iflags, 4)
		If BitAND($in, $display_device_vga_compatible) <> 0 Then $iflags = BitOR($iflags, 8)
		If BitAND($in, $display_device_removable) <> 0 Then $iflags = BitOR($iflags, 16)
		If BitAND($in, $display_device_modespruned) <> 0 Then $iflags = BitOR($iflags, 32)
		$adevice[0] = True
		$adevice[1] = DllStructGetData($tdevice, "Name")
		$adevice[2] = DllStructGetData($tdevice, "String")
		$adevice[3] = $iflags
		$adevice[4] = DllStructGetData($tdevice, "ID")
		Return $adevice
	EndFunc

	Func _winapi_fillrect($hdc, $trect, $hbrush)
		Local $aresult
		If IsPtr($hbrush) Then
			$aresult = DllCall("user32.dll", "int", "FillRect", "handle", $hdc, "struct*", $trect, "handle", $hbrush)
		Else
			$aresult = DllCall("user32.dll", "int", "FillRect", "handle", $hdc, "struct*", $trect, "dword_ptr", $hbrush)
		EndIf
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_framerect($hdc, $trect, $hbrush)
		Local $aresult = DllCall("user32.dll", "int", "FrameRect", "handle", $hdc, "struct*", $trect, "handle", $hbrush)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_getbkmode($hdc)
		Local $aresult = DllCall("gdi32.dll", "int", "GetBkMode", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getdc($hwnd)
		Local $aresult = DllCall("user32.dll", "handle", "GetDC", "hwnd", $hwnd)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_getdcex($hwnd, $hrgn, $iflags)
		Local $aret = DllCall("user32.dll", "handle", "GetDCEx", "hwnd", $hwnd, "handle", $hrgn, "dword", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getdevicecaps($hdc, $iindex)
		Local $aresult = DllCall("gdi32.dll", "int", "GetDeviceCaps", "handle", $hdc, "int", $iindex)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_gettextcolor($hdc)
		Local $aret = DllCall("gdi32.dll", "dword", "GetTextColor", "handle", $hdc)
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_getwindowdc($hwnd)
		Local $aresult = DllCall("user32.dll", "handle", "GetWindowDC", "hwnd", $hwnd)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_printwindow($hwnd, $hdc, $bclient = False)
		Local $aret = DllCall("user32.dll", "bool", "PrintWindow", "hwnd", $hwnd, "handle", $hdc, "uint", $bclient)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_releasedc($hwnd, $hdc)
		Local $aresult = DllCall("user32.dll", "int", "ReleaseDC", "hwnd", $hwnd, "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_restoredc($hdc, $iid)
		Local $aret = DllCall("gdi32.dll", "bool", "RestoreDC", "handle", $hdc, "int", $iid)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_savedc($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "SaveDC", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setbkcolor($hdc, $icolor)
		Local $aresult = DllCall("gdi32.dll", "INT", "SetBkColor", "handle", $hdc, "INT", $icolor)
		If @error Then Return SetError(@error, @extended, -1)
		Return $aresult[0]
	EndFunc

	Func _winapi_setbkmode($hdc, $ibkmode)
		Local $aresult = DllCall("gdi32.dll", "int", "SetBkMode", "handle", $hdc, "int", $ibkmode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_settextcolor($hdc, $icolor)
		Local $aresult = DllCall("gdi32.dll", "INT", "SetTextColor", "handle", $hdc, "INT", $icolor)
		If @error Then Return SetError(@error, @extended, -1)
		Return $aresult[0]
	EndFunc

	Func _winapi_twipsperpixelx()
		Local $hdc, $itwipsperpixelx
		$hdc = _winapi_getdc(0)
		Local Const $__winapiconstant_logpixelsx = 88
		$itwipsperpixelx = 1440 / _winapi_getdevicecaps($hdc, $__winapiconstant_logpixelsx)
		_winapi_releasedc(0, $hdc)
		Return $itwipsperpixelx
	EndFunc

	Func _winapi_twipsperpixely()
		Local $hdc, $itwipsperpixely
		$hdc = _winapi_getdc(0)
		Local Const $__winapiconstant_logpixelsy = 90
		$itwipsperpixely = 1440 / _winapi_getdevicecaps($hdc, $__winapiconstant_logpixelsy)
		_winapi_releasedc(0, $hdc)
		Return $itwipsperpixely
	EndFunc

#EndRegion Public Functions
#Region Internal Functions
#EndRegion Internal Functions
#Region Global Variables and Constants
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions
	Global Const $tagiconinfo = "bool Icon;dword XHotSpot;dword YHotSpot;handle hMask;handle hColor"

	Func _winapi_addicontransparency($hicon, $ipercent = 50, $bdelete = False)
		Local $tbitmap, $hdib = 0, $hresult = 0
		Local $ahbitmap[2]
		Local $ticoninfo = DllStructCreate($tagiconinfo)
		Local $aret = DllCall("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $ticoninfo)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		For $i = 0 To 1
			$ahbitmap[$i] = DllStructGetData($ticoninfo, $i + 4)
		Next
		Local $ierror = 0
		Do
			$hdib = _winapi_copybitmap($ahbitmap[1])
			If NOT $hdib Then
				$ierror = 20
				ExitLoop
			EndIf
			$tbitmap = DllStructCreate($tagbitmap)
			If (NOT _winapi_getobject($hdib, DllStructGetSize($tbitmap), $tbitmap)) OR (DllStructGetData($tbitmap, "bmBitsPixel") <> 32) Then
				$ierror = 21
				ExitLoop
			EndIf
			$aret = DllCall("user32.dll", "lresult", "CallWindowProc", "PTR", __transparencyproc(), "hwnd", 0, "uint", $ipercent, "wparam", DllStructGetPtr($tbitmap), "lparam", 0)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 30
				ExitLoop
			EndIf
			If $aret[0] = -1 Then
				$hresult = _winapi_createemptyicon(DllStructGetData($tbitmap, "bmWidth"), DllStructGetData($tbitmap, "bmHeight"))
			Else
				$hresult = _winapi_createiconindirect($hdib, $ahbitmap[0])
			EndIf
			If NOT $hresult Then $ierror = 22
		Until 1
		If $hdib Then
			_winapi_deleteobject($hdib)
		EndIf
		For $i = 0 To 1
			If $ahbitmap[$i] Then
				_winapi_deleteobject($ahbitmap[$i])
			EndIf
		Next
		If $ierror Then Return SetError($ierror, 0, 0)
		If $bdelete Then
			_winapi_destroyicon($hicon)
		EndIf
		Return $hresult
	EndFunc

	Func _winapi_copyicon($hicon)
		Local $aresult = DllCall("user32.dll", "handle", "CopyIcon", "handle", $hicon)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_create32bithicon($hicon, $bdelete = False)
		Local $ahbitmap[2], $hresult = 0
		Local $adib[2][2] = [[0, 0], [0, 0]]
		Local $ticoninfo = DllStructCreate($tagiconinfo)
		Local $aret = DllCall("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $ticoninfo)
		If @error Then Return SetError(@error, @extended, 0)
		If NOT $aret[0] Then Return SetError(10, 0, 0)
		For $i = 0 To 1
			$ahbitmap[$i] = DllStructGetData($ticoninfo, $i + 4)
		Next
		If _winapi_isalphabitmap($ahbitmap[1]) Then
			$adib[0][0] = _winapi_createandbitmap($ahbitmap[1])
			If NOT @error Then
				$hresult = _winapi_createiconindirect($ahbitmap[1], $adib[0][0])
			EndIf
		Else
			Local $tsize = _winapi_getbitmapdimension($ahbitmap[1])
			Local $asize[2]
			For $i = 0 To 1
				$asize[$i] = DllStructGetData($tsize, $i + 1)
			Next
			Local $hsrcdc = _winapi_createcompatibledc(0)
			Local $hdstdc = _winapi_createcompatibledc(0)
			Local $hsrcsv, $hdstsv
			For $i = 0 To 1
				$adib[$i][0] = _winapi_createdib($asize[0], $asize[1])
				$adib[$i][1] = $__g_vext
				$hsrcsv = _winapi_selectobject($hsrcdc, $ahbitmap[$i])
				$hdstsv = _winapi_selectobject($hdstdc, $adib[$i][0])
				_winapi_bitblt($hdstdc, 0, 0, $asize[0], $asize[1], $hsrcdc, 0, 0, 12583114)
				_winapi_selectobject($hsrcdc, $hsrcsv)
				_winapi_selectobject($hdstdc, $hdstsv)
			Next
			_winapi_deletedc($hsrcdc)
			_winapi_deletedc($hdstdc)
			$aret = DllCall("user32.dll", "lresult", "CallWindowProc", "ptr", __xorproc(), "ptr", 0, "uint", $asize[0] * $asize[1] * 4, "wparam", $adib[0][1], "lparam", $adib[1][1])
			If NOT @error AND $aret[0] Then
				$hresult = _winapi_createiconindirect($adib[1][0], $ahbitmap[0])
			EndIf
		EndIf
		For $i = 0 To 1
			_winapi_deleteobject($ahbitmap[$i])
			If $adib[$i][0] Then
				_winapi_deleteobject($adib[$i][0])
			EndIf
		Next
		If NOT $hresult Then Return SetError(11, 0, 0)
		If $bdelete Then
			_winapi_destroyicon($hicon)
		EndIf
		Return $hresult
	EndFunc

	Func _winapi_createemptyicon($iwidth, $iheight, $ibitsperpel = 32)
		Local $hxor = _winapi_createdib($iwidth, $iheight, $ibitsperpel)
		Local $hand = _winapi_createdib($iwidth, $iheight, 1)
		Local $hdc = _winapi_createcompatibledc(0)
		Local $hsv = _winapi_selectobject($hdc, $hand)
		Local $hbrush = _winapi_createsolidbrush(16777215)
		Local $trect = _winapi_createrect(0, 0, $iwidth, $iheight)
		_winapi_fillrect($hdc, $trect, $hbrush)
		_winapi_deleteobject($hbrush)
		_winapi_selectobject($hdc, $hsv)
		_winapi_deletedc($hdc)
		Local $hicon = _winapi_createiconindirect($hxor, $hand)
		Local $ierror = @error
		If $hxor Then
			_winapi_deleteobject($hxor)
		EndIf
		If $hand Then
			_winapi_deleteobject($hand)
		EndIf
		If NOT $hicon Then Return SetError($ierror + 10, 0, 0)
		Return $hicon
	EndFunc

	Func _winapi_createicon($hinstance, $iwidth, $iheight, $iplanes, $ibitspixel, $pandbits, $pxorbits)
		Local $aret = DllCall("user32.dll", "handle", "CreateIcon", "handle", $hinstance, "int", $iwidth, "int", $iheight, "byte", $iplanes, "byte", $ibitspixel, "struct*", $pandbits, "struct*", $pxorbits)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createiconfromresourceex($pdata, $isize, $bicon = True, $ixdesiredpixels = 0, $iydesiredpixels = 0, $iflags = 0)
		Local $aret = DllCall("user32.dll", "handle", "CreateIconFromResourceEx", "ptr", $pdata, "dword", $isize, "bool", $bicon, "dword", 196608, "int", $ixdesiredpixels, "int", $iydesiredpixels, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createiconindirect($hbitmap, $hmask, $ixhotspot = 0, $iyhotspot = 0, $bicon = True)
		Local $ticoninfo = DllStructCreate($tagiconinfo)
		DllStructSetData($ticoninfo, 1, $bicon)
		DllStructSetData($ticoninfo, 2, $ixhotspot)
		DllStructSetData($ticoninfo, 3, $iyhotspot)
		DllStructSetData($ticoninfo, 4, $hmask)
		DllStructSetData($ticoninfo, 5, $hbitmap)
		Local $aret = DllCall("user32.dll", "handle", "CreateIconIndirect", "struct*", $ticoninfo)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_destroyicon($hicon)
		Local $aresult = DllCall("user32.dll", "bool", "DestroyIcon", "handle", $hicon)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_extracticon($sicon, $iindex, $bsmall = False)
		Local $plarge, $psmall, $tptr = DllStructCreate("ptr")
		If $bsmall Then
			$plarge = 0
			$psmall = DllStructGetPtr($tptr)
		Else
			$plarge = DllStructGetPtr($tptr)
			$psmall = 0
		EndIf
		DllCall("shell32.dll", "uint", "ExtractIconExW", "wstr", $sicon, "int", $iindex, "ptr", $plarge, "ptr", $psmall, "uint", 1)
		If @error Then Return SetError(@error, @extended, 0)
		Return DllStructGetData($tptr, 1)
	EndFunc

	Func _winapi_extracticonex($sfilepath, $iindex, $palarge, $pasmall, $iicons)
		Local $aresult = DllCall("shell32.dll", "uint", "ExtractIconExW", "wstr", $sfilepath, "int", $iindex, "struct*", $palarge, "struct*", $pasmall, "uint", $iicons)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_fileiconinit($brestore = True)
		Local $aret = DllCall("shell32.dll", "int", 660, "int", $brestore)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return 1
	EndFunc

	Func _winapi_geticondimension($hicon)
		Local $ticoninfo = DllStructCreate($tagiconinfo)
		Local $aret = DllCall("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $ticoninfo)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $tsize = _winapi_getbitmapdimension(DllStructGetData($ticoninfo, 5))
		For $i = 4 To 5
			_winapi_deleteobject(DllStructGetData($ticoninfo, $i))
		Next
		If NOT IsDllStruct($tsize) Then Return SetError(20, 0, 0)
		Return $tsize
	EndFunc

	Func _winapi_geticoninfo($hicon)
		Local $tinfo = DllStructCreate($tagiconinfo)
		Local $aret = DllCall("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $tinfo)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $aicon[6]
		$aicon[0] = True
		$aicon[1] = DllStructGetData($tinfo, "Icon") <> 0
		$aicon[2] = DllStructGetData($tinfo, "XHotSpot")
		$aicon[3] = DllStructGetData($tinfo, "YHotSpot")
		$aicon[4] = DllStructGetData($tinfo, "hMask")
		$aicon[5] = DllStructGetData($tinfo, "hColor")
		Return $aicon
	EndFunc

	Func _winapi_geticoninfoex($hicon)
		Local $tiiex = DllStructCreate("dword;int;dword;dword;ptr;ptr;ushort;wchar[260];wchar[260]")
		DllStructSetData($tiiex, 1, DllStructGetSize($tiiex))
		Local $aret = DllCall("user32.dll", "bool", "GetIconInfoExW", "handle", $hicon, "struct*", $tiiex)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $aresult[8]
		For $i = 0 To 7
			$aresult[$i] = DllStructGetData($tiiex, $i + 2)
		Next
		Return $aresult
	EndFunc

	Func _winapi_loadicon($hinstance, $sname)
		Local $stypeofname = "int"
		If IsString($sname) Then
			$stypeofname = "wstr"
		EndIf
		Local $aret = DllCall("user32.dll", "handle", "LoadIconW", "handle", $hinstance, $stypeofname, $sname)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_loadiconmetric($hinstance, $sname, $imetric)
		Local $stypeofname = "int"
		If IsString($sname) Then
			$stypeofname = "wstr"
		EndIf
		Local $aret = DllCall("comctl32.dll", "long", "LoadIconMetric", "handle", $hinstance, $stypeofname, $sname, "int", $imetric, "handle*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return $aret[4]
	EndFunc

	Func _winapi_loadiconwithscaledown($hinstance, $sname, $iwidth, $iheight)
		Local $stypeofname = "int"
		If IsString($sname) Then
			$stypeofname = "wstr"
		EndIf
		Local $aret = DllCall("comctl32.dll", "long", "LoadIconWithScaleDown", "handle", $hinstance, $stypeofname, $sname, "int", $iwidth, "int", $iheight, "handle*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return $aret[5]
	EndFunc

	Func _winapi_loadshell32icon($iiconid)
		Local $ticons = DllStructCreate("ptr Data")
		Local $iicons = _winapi_extracticonex("shell32.dll", $iiconid, 0, $ticons, 1)
		If @error Then Return SetError(@error, @extended, 0)
		If $iicons <= 0 Then Return SetError(10, 0, 0)
		Return DllStructGetData($ticons, "Data")
	EndFunc

	Func _winapi_lookupiconidfromdirectoryex($pdata, $bicon = True, $ixdesiredpixels = 0, $iydesiredpixels = 0, $iflags = 0)
		Local $aret = DllCall("user32.dll", "int", "LookupIconIdFromDirectoryEx", "ptr", $pdata, "bool", $bicon, "int", $ixdesiredpixels, "int", $iydesiredpixels, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_mirroricon($hicon, $bdelete = False)
		If NOT $bdelete Then
			$hicon = _winapi_copyicon($hicon)
		EndIf
		Local $aret = DllCall("comctl32.dll", "int", 414, "ptr", 0, "ptr*", $hicon)
		If @error OR NOT $aret[0] Then
			Local $ierror = @error + 10
			If $hicon AND NOT $bdelete Then
				_winapi_destroyicon($hicon)
			EndIf
			Return SetError($ierror, 0, 0)
		EndIf
		Return $aret[2]
	EndFunc

#EndRegion Public Functions
#Region Embedded DLL Functions

	Func __transparencyproc()
		Static $pproc = 0
		If NOT $pproc Then
			If @AutoItX64 Then
				$pproc = __init(Binary("0x48894C240848895424104C894424184C894C24205541574831C0505050505050" & "4883EC284883BC24800000000074054831C0EB0748C7C0010000004821C07522" & "488BAC248000000048837D180074054831C0EB0748C7C0010000004821C07502" & "EB0948C7C001000000EB034831C04821C0740B4831C04863C0E93C0100004C63" & "7C24784983FF647E0F48C7C0010000004863C0E9220100004C637C24784D21FF" & "7D08C74424780000000048C74424280100000048C74424300000000048C74424" & "3800000000488BAC24800000004C637D04488BAC2480000000486345084C0FAF" & "F849C1E7024983C7FC4C3B7C24380F8C88000000488BAC24800000004C8B7D18" & "4C037C24384983C7034C897C2440488B6C2440480FB64500505888442448807C" & "244800744B4C0FB67C244848634424784C0FAFF84C89F848C7C1640000004899" & "48F7F94989C74C89F850488B6C244858884500488B6C2440807D0000740948C7" & "4424280000000048C7442430010000004883442438040F8149FFFFFF48837C24" & "3000741148837C242800740948C7C001000000EB034831C04821C0740E48C7C0" & "FFFFFFFF4863C0EB11EB0C48C7C0010000004863C0EB034831C04883C458415F" & "5DC3"))
			Else
				$pproc = __init(Binary("0x555331C05050505050837C242800740431C0EB05B80100000021C075198B6C24" & "28837D1400740431C0EB05B80100000021C07502EB07B801000000EB0231C021" & "C0740731C0E9E50000008B5C242483FB647E0AB801000000E9D20000008B5C24" & "2421DB7D08C744242400000000C7042401000000C744240400000000C7442408" & "000000008B6C24288B5D048B6C24280FAF5D08C1E30283C3FC3B5C24087C648B" & "6C24288B5D14035C240883C303895C240C8B6C240C0FB6450088442410807C24" & "100074380FB65C24100FAF5C242489D8B96400000099F7F989C3538B6C241058" & "8845008B6C240C807D00007407C7042400000000C74424040100000083442408" & "047181837C240400740D833C24007407B801000000EB0231C021C07409B8FFFF" & "FFFFEB0BEB07B801000000EB0231C083C4145B5DC21000"))
			EndIf
		EndIf
		Return $pproc
	EndFunc

#EndRegion Embedded DLL Functions
#Region Global Variables and Constants
	Global Const $tagbitmapv4header = "struct;dword bV4Size;long bV4Width;long bV4Height;ushort bV4Planes;ushort bV4BitCount;dword bV4Compression;dword bV4SizeImage;long bV4XPelsPerMeter;long bV4YPelsPerMeter;dword bV4ClrUsed;dword bV4ClrImportant;dword bV4RedMask;dword bV4GreenMask;dword bV4BlueMask;dword bV4AlphaMask;dword bV4CSType;int bV4Endpoints[9];dword bV4GammaRed;dword bV4GammaGreen;dword bV4GammaBlue;endstruct"
	Global Const $tagcoloradjustment = "ushort Size;ushort Flags;ushort IlluminantIndex;ushort RedGamma;ushort GreenGamma;ushort BlueGamma;ushort ReferenceBlack;ushort ReferenceWhite;short Contrast;short Brightness;short Colorfulness;short RedGreenTint"
	Global Const $tagdevmode = "wchar DeviceName[32];ushort SpecVersion;ushort DriverVersion;ushort Size;ushort DriverExtra;dword Fields;short Orientation;short PaperSize;short PaperLength;short PaperWidth;short Scale;short Copies;short DefaultSource;short PrintQuality;short Color;short Duplex;short YResolution;short TTOption;short Collate;wchar FormName[32];ushort Unused1;dword Unused2[3];dword Nup;dword Unused3;dword ICMMethod;dword ICMIntent;dword MediaType;dword DitherType;dword Reserved1;dword Reserved2;dword PanningWidth;dword PanningHeight"
	Global Const $tagdevmode_display = "wchar DeviceName[32];ushort SpecVersion;ushort DriverVersion;ushort Size;ushort DriverExtra;dword Fields;" & $tagpoint & ";dword DisplayOrientation;dword DisplayFixedOutput;short Unused1[5];wchar Unused2[32];ushort LogPixels;dword BitsPerPel;dword PelsWidth;dword PelsHeight;dword DisplayFlags;dword DisplayFrequency"
	Global Const $tagdwm_colorization_parameters = "dword Color;dword AfterGlow;uint ColorBalance;uint AfterGlowBalance;uint BlurBalance;uint GlassReflectionIntensity; uint OpaqueBlend"
	Global Const $tagenhmetaheader = "struct;dword Type;dword Size;long rcBounds[4];long rcFrame[4];dword Signature;dword Version;dword Bytes;dword Records;ushort Handles;ushort Reserved;dword Description;dword OffDescription;dword PalEntries;long Device[2];long Millimeters[2];dword PixelFormat;dword OffPixelFormat;dword OpenGL;long Micrometers[2];endstruct"
	Global Const $tagextlogpen = "dword PenStyle;dword Width;uint BrushStyle;dword Color;ulong_ptr Hatch;dword NumEntries"
	Global Const $tagfontsignature = "dword fsUsb[4];dword fsCsb[2]"
	Global Const $tagglyphmetrics = "uint BlackBoxX;uint BlackBoxY;" & $tagpoint & ";short CellIncX;short CellIncY"
	Global Const $taglogbrush = "uint Style;dword Color;ulong_ptr Hatch"
	Global Const $taglogpen = "uint Style;dword Width;dword Color"
	Global Const $tagmat2 = "short eM11[2];short eM12[2];short eM21[2];short eM22[2]"
	Global Const $tagnewtextmetric = $tagtextmetric & ";dword ntmFlags;uint ntmSizeEM;uint ntmCellHeight;uint ntmAvgWidth"
	Global Const $tagnewtextmetricex = $tagnewtextmetric & ";" & $tagfontsignature
	Global Const $tagpanose = "struct;byte bFamilyType;byte bSerifStyle;byte bWeight;byte bProportion;byte bContrast;byte bStrokeVariation;byte bArmStyle;byte bLetterform;byte bMidline;byte bXHeight;endstruct"
	Global Const $tagoutlinetextmetric = "struct;uint otmSize;" & $tagtextmetric & ";byte otmFiller;" & $tagpanose & ";byte bugFiller[3];uint otmSelection;uint otmType;int otmCharSlopeRise;int otmCharSlopeRun;int otmItalicAngle;uint otmEMSquare;int otmAscent;int otmDescent;uint otmLineGap;uint otmCapEmHeight;uint otmXHeight;long otmFontBox[4];int otmMacAscent;int otmMacDescent;uint otmMacLineGap;uint otmMinimumPPEM;long otmSubscriptSize[2];long otmSubscriptOffset[2];long otmSuperscriptSize[2];long otmSuperscriptOffse[2];uint otmStrikeoutSize;int otmStrikeoutPosition;int otmUnderscoreSize;int otmUnderscorePosition;uint_ptr otmFamilyName;uint_ptr otmFaceName;uint_ptr otmStyleName;uint_ptr otmFullName;endstruct"
	Global Const $tagpaintstruct = "hwnd hDC;int fErase;dword rPaint[4];int fRestore;int fIncUpdate;byte rgbReserved[32]"
	Global Const $tagrgndataheader = "struct;dword Size;dword Type;dword Count;dword RgnSize;" & $tagrect & ";endstruct"
	Global Const $tagxform = "float eM11;float eM12;float eM21;float eM22;float eDx;float eDy"
#EndRegion Global Variables and Constants
#Region Functions list
#EndRegion Functions list
#Region Public Functions

	Func _winapi_abortpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "AbortPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_addfontmemresourceex($pdata, $isize)
		Local $aret = DllCall("gdi32.dll", "handle", "AddFontMemResourceEx", "ptr", $pdata, "dword", $isize, "ptr", 0, "dword*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aret[4], $aret[0])
	EndFunc

	Func _winapi_addfontresourceex($sfont, $iflag = 0, $bnotify = False)
		Local $aret = DllCall("gdi32.dll", "int", "AddFontResourceExW", "wstr", $sfont, "dword", $iflag, "ptr", 0)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		If $bnotify Then
			Local Const $wm_fontchange = 29
			Local Const $hwnd_broadcast = 65535
			DllCall("user32.dll", "lresult", "SendMessage", "hwnd", $hwnd_broadcast, "uint", $wm_fontchange, "wparam", 0, "lparam", 0)
		EndIf
		Return $aret[0]
	EndFunc

	Func _winapi_addiconoverlay($hicon, $hoverlay)
		Local $aret, $hresult = 0, $ierror = 0
		Local $ahdev[2] = [0, 0]
		Local $tsize = _winapi_geticondimension($hicon)
		Local $hil = DllCall("comctl32.dll", "handle", "ImageList_Create", "int", DllStructGetData($tsize, 1), "int", DllStructGetData($tsize, 2), "uint", 33, "int", 2, "int", 2)
		If @error OR NOT $hil[0] Then Return SetError(@error + 10, @extended, 0)
		Do
			$ahdev[0] = _winapi_create32bithicon($hicon)
			If @error Then
				$ierror = @error + 100
				ExitLoop
			EndIf
			$aret = DllCall("comctl32.dll", "int", "ImageList_ReplaceIcon", "handle", $hil[0], "int", -1, "handle", $ahdev[0])
			If @error OR ($aret[0] = -1) Then
				$ierror = @error + 200
				ExitLoop
			EndIf
			$ahdev[1] = _winapi_create32bithicon($hoverlay)
			If @error Then
				$ierror = @error + 300
				ExitLoop
			EndIf
			$aret = DllCall("comctl32.dll", "int", "ImageList_ReplaceIcon", "handle", $hil[0], "int", -1, "handle", $ahdev[1])
			If @error OR ($aret[0] = -1) Then
				$ierror = @error + 400
				ExitLoop
			EndIf
			$aret = DllCall("comctl32.dll", "bool", "ImageList_SetOverlayImage", "handle", $hil[0], "int", 1, "int", 1)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 500
				ExitLoop
			EndIf
			$aret = DllCall("comctl32.dll", "handle", "ImageList_GetIcon", "handle", $hil[0], "int", 0, "uint", 256)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 600
				ExitLoop
			EndIf
			$hresult = $aret[0]
		Until 1
		DllCall("comctl32.dll", "bool", "ImageList_Destroy", "handle", $hil[0])
		For $i = 0 To 1
			If $ahdev[$i] Then
				_winapi_destroyicon($ahdev[$i])
			EndIf
		Next
		If NOT $hresult Then Return SetError($ierror, 0, 0)
		Return $hresult
	EndFunc

	Func _winapi_adjustbitmap($hbitmap, $iwidth, $iheight, $imode = 3, $tadjustment = 0)
		Local $tobj = DllStructCreate($tagbitmap)
		Local $aret = DllCall("gdi32.dll", "int", "GetObject", "handle", $hbitmap, "int", DllStructGetSize($tobj), "struct*", $tobj)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		If $iwidth = -1 Then
			$iwidth = DllStructGetData($tobj, "bmWidth")
		EndIf
		If $iheight = -1 Then
			$iheight = DllStructGetData($tobj, "bmHeight")
		EndIf
		$aret = DllCall("user32.dll", "handle", "GetDC", "hwnd", 0)
		Local $hdc = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
		Local $hdestdc = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "CreateCompatibleBitmap", "handle", $hdc, "int", $iwidth, "int", $iheight)
		Local $hbmp = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hbmp)
		Local $hdestsv = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
		Local $hsrcdc = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hbitmap)
		Local $hsrcsv = $aret[0]
		If _winapi_setstretchbltmode($hdestdc, $imode) Then
			Switch $imode
				Case 4
					If IsDllStruct($tadjustment) Then
						If NOT _winapi_setcoloradjustment($hdestdc, $tadjustment) Then
						EndIf
					EndIf
				Case Else
			EndSwitch
		EndIf
		$aret = _winapi_stretchblt($hdestdc, 0, 0, $iwidth, $iheight, $hsrcdc, 0, 0, DllStructGetData($tobj, "bmWidth"), DllStructGetData($tobj, "bmHeight"), 13369376)
		DllCall("user32.dll", "int", "ReleaseDC", "hwnd", 0, "handle", $hdc)
		DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hdestsv)
		DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hsrcsv)
		DllCall("gdi32.dll", "bool", "DeleteDC", "handle", $hdestdc)
		DllCall("gdi32.dll", "bool", "DeleteDC", "handle", $hsrcdc)
		If NOT $aret Then Return SetError(10, 0, 0)
		Return $hbmp
	EndFunc

	Func _winapi_alphablend($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $hsrcdc, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $ialpha, $balpha = False)
		Local $iblend = BitOR(BitShift(NOT ($balpha = False), -24), BitShift(BitAND($ialpha, 255), -16))
		Local $aret = DllCall("gdi32.dll", "bool", "GdiAlphaBlend", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "handle", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "dword", $iblend)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_anglearc($hdc, $ix, $iy, $iradius, $nstartangle, $nsweepangle)
		Local $aret = DllCall("gdi32.dll", "bool", "AngleArc", "handle", $hdc, "int", $ix, "int", $iy, "dword", $iradius, "float", $nstartangle, "float", $nsweepangle)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_arc($hdc, $trect, $ixstartarc, $iystartarc, $ixendarc, $iyendarc)
		Local $aret = DllCall("gdi32.dll", "bool", "Arc", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4), "int", $ixstartarc, "int", $iystartarc, "int", $ixendarc, "int", $iyendarc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_arcto($hdc, $trect, $ixradial1, $iyradial1, $ixradial2, $iyradial2)
		Local $aret = DllCall("gdi32.dll", "bool", "ArcTo", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4), "int", $ixradial1, "int", $iyradial1, "int", $ixradial2, "int", $iyradial2)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_beginpaint($hwnd, ByRef $tpaintstruct)
		$tpaintstruct = DllStructCreate($tagpaintstruct)
		Local $aret = DllCall("user32.dll", "handle", "BeginPaint", "hwnd", $hwnd, "struct*", $tpaintstruct)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_beginpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "BeginPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_closeenhmetafile($hdc)
		Local $aret = DllCall("gdi32.dll", "handle", "CloseEnhMetaFile", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_closefigure($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "CloseFigure", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_coloradjustluma($irgb, $ipercent, $bscale = True)
		If $irgb = -1 Then Return SetError(10, 0, -1)
		If $bscale Then
			$ipercent = Floor($ipercent * 10)
		EndIf
		Local $aret = DllCall("shlwapi.dll", "dword", "ColorAdjustLuma", "dword", __rgb($irgb), "int", $ipercent, "bool", $bscale)
		If @error Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_colorhlstorgb($ihue, $iluminance, $isaturation)
		If NOT $isaturation Then $ihue = 160
		Local $aret = DllCall("shlwapi.dll", "dword", "ColorHLSToRGB", "word", $ihue, "word", $iluminance, "word", $isaturation)
		If @error Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_colorrgbtohls($irgb, ByRef $ihue, ByRef $iluminance, ByRef $isaturation)
		Local $aret = DllCall("shlwapi.dll", "none", "ColorRGBToHLS", "dword", __rgb($irgb), "word*", 0, "word*", 0, "word*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		$ihue = $aret[2]
		$iluminance = $aret[3]
		$isaturation = $aret[4]
		Return 1
	EndFunc

	Func _winapi_combinetransform($txform1, $txform2)
		Local $txform = DllStructCreate($tagxform)
		Local $aret = DllCall("gdi32.dll", "bool", "CombineTransform", "struct*", $txform, "struct*", $txform1, "struct*", $txform2)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $txform
	EndFunc

	Func _winapi_compressbitmapbits($hbitmap, ByRef $pbuffer, $icompression = 0, $iquality = 100)
		If NOT __dll("gdiplus.dll") Then Return SetError(103, 0, 0)
		Local $asize[2], $icount, $iformat, $ilength, $smime, $aret, $hdc, $hsv, $hmem, $tbits, $tdata, $pdata, $ierror = 1
		Local $hsource = 0, $himage = 0, $htoken = 0, $pstream = 0, $tparam = 0
		Local $tdib = DllStructCreate($tagdibsection)
		Do
			Switch $icompression
				Case 0
					$smime = "image/png"
				Case 1
					$smime = "image/jpeg"
				Case Else
					$ierror = 10
					ExitLoop
			EndSwitch
			While $hbitmap
				If NOT _winapi_getobject($hbitmap, DllStructGetSize($tdib), $tdib) Then
					$ierror = 11
					ExitLoop 2
				EndIf
				If (DllStructGetData($tdib, "bmBitsPixel") = 32) AND (NOT DllStructGetData($tdib, "biCompression")) Then
					$ierror = 12
					ExitLoop
				EndIf
				If $hsource Then
					$ierror = 13
					ExitLoop 2
				EndIf
				$hsource = _winapi_createdib(DllStructGetData($tdib, "bmWidth"), DllStructGetData($tdib, "bmHeight"))
				If NOT $hsource Then
					$ierror = @error + 100
					ExitLoop 2
				EndIf
				$hdc = _winapi_createcompatibledc(0)
				$hsv = _winapi_selectobject($hdc, $hsource)
				If _winapi_drawbitmap($hdc, 0, 0, $hbitmap) Then
					$hbitmap = $hsource
				Else
					$ierror = @error + 200
					$hbitmap = 0
				EndIf
				_winapi_selectobject($hdc, $hsv)
				_winapi_deletedc($hdc)
			WEnd
			If NOT $hbitmap Then
				ExitLoop
			EndIf
			For $i = 0 To 1
				$asize[$i] = DllStructGetData($tdib, $i + 2)
			Next
			$tbits = DllStructCreate("byte[" & ($asize[0] * $asize[1] * 4) & "]")
			If NOT _winapi_getbitmapbits($hbitmap, DllStructGetSize($tbits), $tbits) Then
				$ierror = @error + 300
				ExitLoop
			EndIf
			$tdata = DllStructCreate($taggdipstartupinput)
			DllStructSetData($tdata, "Version", 1)
			$aret = DllCall("gdiplus.dll", "int", "GdiplusStartup", "ulong_ptr*", 0, "struct*", $tdata, "ptr", 0)
			If @error OR $aret[0] Then
				$ierror = @error + 400
				ExitLoop
			EndIf
			If _winapi_isalphabitmap($hbitmap) Then
				$iformat = 2498570
			Else
				$iformat = 139273
			EndIf
			$htoken = $aret[1]
			$aret = DllCall("gdiplus.dll", "int", "GdipCreateBitmapFromScan0", "int", $asize[0], "int", $asize[1], "uint", $asize[0] * 4, "int", $iformat, "struct*", $tbits, "ptr*", 0)
			If @error OR $aret[0] Then
				$ierror = @error + 500
				ExitLoop
			EndIf
			$himage = $aret[6]
			$aret = DllCall("gdiplus.dll", "int", "GdipGetImageEncodersSize", "uint*", 0, "uint*", 0)
			If @error OR $aret[0] Then
				$ierror = @error + 600
				ExitLoop
			EndIf
			$icount = $aret[1]
			$tdata = DllStructCreate("byte[" & $aret[2] & "]")
			If @error Then
				$ierror = @error + 700
				ExitLoop
			EndIf
			$pdata = DllStructGetPtr($tdata)
			$aret = DllCall("gdiplus.dll", "int", "GdipGetImageEncoders", "uint", $icount, "uint", $aret[2], "struct*", $tdata)
			If @error OR $aret[0] Then
				$ierror = @error + 800
				ExitLoop
			EndIf
			Local $tcodec, $pencoder = 0
			For $i = 1 To $icount
				$tcodec = DllStructCreate($taggdipimagecodecinfo, $pdata)
				If NOT StringInStr(_winapi_widechartomultibyte(DllStructGetData($tcodec, "MimeType")), $smime) Then
					$pdata += DllStructGetSize($taggdipimagecodecinfo)
				Else
					$pencoder = $pdata
					$ierror = 0
					ExitLoop
				EndIf
			Next
			If NOT $pencoder Then
				$ierror = 15
				ExitLoop
			EndIf
			Switch $icompression
				Case 0
				Case 1
					Local Const $tagencoderparameter = "byte[16] GUID;ulong NumberOfValues;dword Type;ptr pValue"
					$tparam = DllStructCreate("dword Count;" & $tagencoderparameter & ";ulong Quality")
					DllStructSetData($tparam, "Count", 1)
					DllStructSetData($tparam, "NumberOfValues", 1)
					DllStructSetData($tparam, "Type", 4)
					DllStructSetData($tparam, "pValue", DllStructGetPtr($tparam, "Quality"))
					DllStructSetData($tparam, "Quality", $iquality)
					$aret = DllCall("ole32.dll", "long", "CLSIDFromString", "wstr", "{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}", "ptr", DllStructGetPtr($tparam, 2))
					If @error OR $aret[0] Then
						$tparam = 0
					EndIf
			EndSwitch
			$pstream = _winapi_createstreamonhglobal()
			$aret = DllCall("gdiplus.dll", "int", "GdipSaveImageToStream", "handle", $himage, "ptr", $pstream, "ptr", $pencoder, "struct*", $tparam)
			If @error OR $aret[0] Then
				$ierror = @error + 900
				ExitLoop
			EndIf
			$hmem = _winapi_gethglobalfromstream($pstream)
			$aret = DllCall("kernel32.dll", "ulong_ptr", "GlobalSize", "handle", $hmem)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 1000
				ExitLoop
			EndIf
			$ilength = $aret[0]
			$aret = DllCall("kernel32.dll", "ptr", "GlobalLock", "handle", $hmem)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 1100
				ExitLoop
			EndIf
			$pbuffer = __heaprealloc($pbuffer, $ilength, 1)
			If NOT @error Then
				_winapi_movememory($pbuffer, $aret[0], $ilength)
			Else
				$ierror = @error + 1300
			EndIf
		Until 1
		If $pstream Then
			_winapi_releasestream($pstream)
		EndIf
		If $himage Then
			DllCall("gdiplus.dll", "int", "GdipDisposeImage", "handle", $himage)
		EndIf
		If $htoken Then
			DllCall("gdiplus.dll", "none", "GdiplusShutdown", "ulong_ptr", $htoken)
		EndIf
		If $hsource Then
			_winapi_deleteobject($hsource)
		EndIf
		If $ierror Then Return SetError($ierror, 0, 0)
		Return $ilength
	EndFunc

	Func _winapi_copyenhmetafile($hemf, $sfilepath = "")
		Local $stypeoffile = "wstr"
		If NOT StringStripWS($sfilepath, $str_stripleading + $str_striptrailing) Then
			$stypeoffile = "ptr"
			$sfilepath = 0
		EndIf
		Local $aret = DllCall("gdi32.dll", "handle", "CopyEnhMetaFileW", "handle", $hemf, $stypeoffile, $sfilepath)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_copyrect($trect)
		Local $tdata = DllStructCreate($tagrect)
		Local $aret = DllCall("user32.dll", "bool", "CopyRect", "struct*", $tdata, "struct*", $trect)
		If @error OR NOT $aret[0] Then SetError(@error + 10, @extended, 0)
		Return $tdata
	EndFunc

	Func _winapi_create32bithbitmap($hicon, $bdib = False, $bdelete = False)
		Local $hbitmap = 0
		Local $adib[2] = [0, 0]
		Local $htemp = _winapi_create32bithicon($hicon)
		If @error Then Return SetError(@error, @extended, 0)
		Local $ierror = 0
		Do
			Local $ticoninfo = DllStructCreate($tagiconinfo)
			Local $aret = DllCall("user32.dll", "bool", "GetIconInfo", "handle", $htemp, "struct*", $ticoninfo)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 10
				ExitLoop
			EndIf
			For $i = 0 To 1
				$adib[$i] = DllStructGetData($ticoninfo, $i + 4)
			Next
			Local $tbitmap = DllStructCreate($tagbitmap)
			If NOT _winapi_getobject($adib[0], DllStructGetSize($tbitmap), $tbitmap) Then
				$ierror = @error + 20
				ExitLoop
			EndIf
			If $bdib Then
				$hbitmap = _winapi_createdib(DllStructGetData($tbitmap, "bmWidth"), DllStructGetData($tbitmap, "bmHeight"))
				Local $hdc = _winapi_createcompatibledc(0)
				Local $hsv = _winapi_selectobject($hdc, $hbitmap)
				_winapi_drawiconex($hdc, 0, 0, $htemp)
				_winapi_selectobject($hdc, $hsv)
				_winapi_deletedc($hdc)
			Else
				$hbitmap = $adib[1]
				$adib[1] = 0
			EndIf
		Until 1
		For $i = 0 To 1
			If $adib[$i] Then
				_winapi_deleteobject($adib[$i])
			EndIf
		Next
		_winapi_destroyicon($htemp)
		If $ierror Then Return SetError($ierror, 0, 0)
		If NOT $hbitmap Then Return SetError(12, 0, 0)
		If $bdelete Then
			_winapi_destroyicon($hicon)
		EndIf
		Return $hbitmap
	EndFunc

	Func _winapi_createbitmapindirect(ByRef $tbitmap)
		Local $aret = DllCall("gdi32.dll", "handle", "CreateBitmapIndirect", "struct*", $tbitmap)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createbrushindirect($istyle, $irgb, $ihatch = 0)
		Local $tlogbrush = DllStructCreate($taglogbrush)
		DllStructSetData($tlogbrush, 1, $istyle)
		DllStructSetData($tlogbrush, 2, __rgb($irgb))
		DllStructSetData($tlogbrush, 3, $ihatch)
		Local $aret = DllCall("gdi32.dll", "handle", "CreateBrushIndirect", "struct*", $tlogbrush)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createcoloradjustment($iflags = 0, $iilluminant = 0, $igammar = 10000, $igammag = 10000, $igammab = 10000, $iblack = 0, $iwhite = 10000, $icontrast = 0, $ibrightness = 0, $icolorfulness = 0, $itint = 0)
		Local $tca = DllStructCreate($tagcoloradjustment)
		DllStructSetData($tca, 1, DllStructGetSize($tca))
		DllStructSetData($tca, 2, $iflags)
		DllStructSetData($tca, 3, $iilluminant)
		DllStructSetData($tca, 4, $igammar)
		DllStructSetData($tca, 5, $igammag)
		DllStructSetData($tca, 6, $igammab)
		DllStructSetData($tca, 7, $iblack)
		DllStructSetData($tca, 8, $iwhite)
		DllStructSetData($tca, 9, $icontrast)
		DllStructSetData($tca, 10, $ibrightness)
		DllStructSetData($tca, 11, $icolorfulness)
		DllStructSetData($tca, 12, $itint)
		Return $tca
	EndFunc

	Func _winapi_createcompatiblebitmapex($hdc, $iwidth, $iheight, $irgb)
		Local $hbrush = _winapi_createbrushindirect(0, $irgb)
		Local $aret = DllCall("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
		Local $hdestdc = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "CreateCompatibleBitmap", "handle", $hdc, "int", $iwidth, "int", $iheight)
		Local $hbmp = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hbmp)
		Local $hdestsv = $aret[0]
		Local $trect = _winapi_createrectex(0, 0, $iwidth, $iheight)
		Local $ierror = 0
		$aret = DllCall("user32.dll", "int", "FillRect", "handle", $hdestdc, "struct*", $trect, "handle", $hbrush)
		If @error OR NOT $aret[0] Then
			$ierror = @error + 10
			_winapi_deleteobject($hbmp)
		EndIf
		_winapi_deleteobject($hbrush)
		DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hdestsv)
		DllCall("gdi32.dll", "bool", "DeleteDC", "handle", $hdestdc)
		If $ierror Then Return SetError($ierror, 0, 0)
		Return $hbmp
	EndFunc

	Func _winapi_createdibitmap($hdc, ByRef $tbitmapinfo, $iusage, $pbits = 0)
		Local $iinit = 0
		If $pbits Then
			$iinit = 4
		EndIf
		Local $aret = DllCall("gdi32.dll", "handle", "CreateDIBitmap", "handle", $hdc, "struct*", $tbitmapinfo, "dword", $iinit, "struct*", $pbits, "struct*", $tbitmapinfo, "uint", $iusage)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createellipticrgn($trect)
		Local $aret = DllCall("gdi32.dll", "handle", "CreateEllipticRgnIndirect", "struct*", $trect)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_createenhmetafile($hdc = 0, $trect = 0, $bpixels = False, $sfilepath = "", $sdescription = "")
		Local $stypeoffile = "wstr"
		If NOT StringStripWS($sfilepath, $str_stripleading + $str_striptrailing) Then
			$stypeoffile = "ptr"
			$sfilepath = 0
		EndIf
		Local $tdata = 0, $adata = StringSplit($sdescription, "|", $str_nocount)
		If UBound($adata) < 2 Then
			ReDim $adata[2]
			$adata[1] = ""
		EndIf
		For $i = 0 To 1
			$adata[$i] = StringStripWS($adata[$i], $str_stripleading + $str_striptrailing)
		Next
		If ($adata[0]) OR ($adata[1]) Then
			$tdata = _winapi_arraytostruct($adata)
		EndIf
		Local $ixp, $iyp, $ixm, $iym, $href = 0
		If $bpixels AND (IsDllStruct($trect)) Then
			If NOT $hdc Then
				$href = _winapi_getdc(0)
			EndIf
			$ixp = _winapi_getdevicecaps($href, 8)
			$iyp = _winapi_getdevicecaps($href, 10)
			$ixm = _winapi_getdevicecaps($href, 4)
			$iym = _winapi_getdevicecaps($href, 6)
			If $href Then
				_winapi_releasedc(0, $href)
			EndIf
			For $i = 1 To 3 Step 2
				DllStructSetData($trect, $i, Round(DllStructGetData($trect, $i) * $ixm / $ixp * 100))
			Next
			For $i = 2 To 4 Step 2
				DllStructSetData($trect, $i, Round(DllStructGetData($trect, $i) * $iym / $iyp * 100))
			Next
		EndIf
		Local $aret = DllCall("gdi32.dll", "handle", "CreateEnhMetaFileW", "handle", $hdc, $stypeoffile, $sfilepath, "struct*", $trect, "struct*", $tdata)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createfontex($iheight, $iwidth = 0, $iescapement = 0, $iorientation = 0, $iweight = 400, $bitalic = False, $bunderline = False, $bstrikeout = False, $icharset = 1, $ioutprecision = 0, $iclipprecision = 0, $iquality = 0, $ipitchandfamily = 0, $sfacename = "", $istyle = 0)
		Local $aret = DllCall("gdi32.dll", "handle", "CreateFontW", "int", $iheight, "int", $iwidth, "int", $iescapement, "int", $iorientation, "int", $iweight, "dword", $bitalic, "dword", $bunderline, "dword", $bstrikeout, "dword", $icharset, "dword", $ioutprecision, "dword", $iclipprecision, "dword", $iquality, "dword", $ipitchandfamily, "wstr", _winapi_getfontname($sfacename, $istyle, $icharset))
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createnullrgn()
		Local $aret = DllCall("gdi32.dll", "handle", "CreateRectRgn", "int", 0, "int", 0, "int", 0, "int", 0)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createpen($ipenstyle, $iwidth, $icolor)
		Local $aresult = DllCall("gdi32.dll", "handle", "CreatePen", "int", $ipenstyle, "int", $iwidth, "INT", $icolor)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _winapi_createpolygonrgn(Const ByRef $apoint, $istart = 0, $iend = -1, $imode = 1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2, 2) Then Return SetError(@error + 10, @extended, 0)
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "int[2];"
		Next
		Local $tdata = DllStructCreate($tagstruct)
		Local $icount = 1
		For $i = $istart To $iend
			For $j = 0 To 1
				DllStructSetData($tdata, $icount, $apoint[$i][$j], $j + 1)
			Next
			$icount += 1
		Next
		Local $aret = DllCall("gdi32.dll", "handle", "CreatePolygonRgn", "struct*", $tdata, "int", $icount - 1, "int", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createrectrgnindirect($trect)
		Local $aret = DllCall("gdi32.dll", "handle", "CreateRectRgnIndirect", "struct*", $trect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_createsolidbitmap($hwnd, $icolor, $iwidth, $iheight, $brgb = 1)
		Local $hdc = _winapi_getdc($hwnd)
		Local $hdestdc = _winapi_createcompatibledc($hdc)
		Local $hbitmap = _winapi_createcompatiblebitmap($hdc, $iwidth, $iheight)
		Local $hold = _winapi_selectobject($hdestdc, $hbitmap)
		Local $trect = DllStructCreate($tagrect)
		DllStructSetData($trect, 1, 0)
		DllStructSetData($trect, 2, 0)
		DllStructSetData($trect, 3, $iwidth)
		DllStructSetData($trect, 4, $iheight)
		If $brgb Then
			$icolor = BitOR(BitAND($icolor, 65280), BitShift(BitAND($icolor, 255), -16), BitShift(BitAND($icolor, 16711680), 16))
		EndIf
		Local $hbrush = _winapi_createsolidbrush($icolor)
		If NOT _winapi_fillrect($hdestdc, $trect, $hbrush) Then
			_winapi_deleteobject($hbitmap)
			$hbitmap = 0
		EndIf
		_winapi_deleteobject($hbrush)
		_winapi_releasedc($hwnd, $hdc)
		_winapi_selectobject($hdestdc, $hold)
		_winapi_deletedc($hdestdc)
		If NOT $hbitmap Then Return SetError(1, 0, 0)
		Return $hbitmap
	EndFunc

	Func _winapi_createtransform($nm11 = 1, $nm12 = 0, $nm21 = 0, $nm22 = 1, $ndx = 0, $ndy = 0)
		Local $txform = DllStructCreate($tagxform)
		DllStructSetData($txform, 1, $nm11)
		DllStructSetData($txform, 2, $nm12)
		DllStructSetData($txform, 3, $nm21)
		DllStructSetData($txform, 4, $nm22)
		DllStructSetData($txform, 5, $ndx)
		DllStructSetData($txform, 6, $ndy)
		Return $txform
	EndFunc

	Func _winapi_deleteenhmetafile($hemf)
		Local $aret = DllCall("gdi32.dll", "bool", "DeleteEnhMetaFile", "handle", $hemf)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_dptolp($hdc, ByRef $tpoint, $icount = 1)
		Local $aret = DllCall("gdi32.dll", "bool", "DPtoLP", "handle", $hdc, "struct*", $tpoint, "int", $icount)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_drawanimatedrects($hwnd, $trectfrom, $trectto)
		Local $aret = DllCall("user32.dll", "bool", "DrawAnimatedRects", "hwnd", $hwnd, "int", 3, "struct*", $trectfrom, "struct*", $trectto)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_drawbitmap($hdc, $ix, $iy, $hbitmap, $irop = 13369376)
		Local $tobj = DllStructCreate($tagbitmap)
		Local $aret = DllCall("gdi32.dll", "int", "GetObject", "handle", $hbitmap, "int", DllStructGetSize($tobj), "struct*", $tobj)
		If @error OR NOT $aret[0] Then Return SetError(@error + 20, @extended, 0)
		$aret = DllCall("user32.dll", "handle", "GetDC", "hwnd", 0)
		Local $_hdc = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $_hdc)
		Local $hsrcdc = $aret[0]
		$aret = DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hbitmap)
		Local $hsrcsv = $aret[0]
		Local $ierror = 0
		$aret = DllCall("gdi32.dll", "int", "BitBlt", "hwnd", $hdc, "int", $ix, "int", $iy, "int", DllStructGetData($tobj, "bmWidth"), "int", DllStructGetData($tobj, "bmHeight"), "hwnd", $hsrcdc, "int", 0, "int", 0, "int", $irop)
		If @error OR NOT $aret[0] Then
			$ierror = @error + 1
		EndIf
		DllCall("user32.dll", "int", "ReleaseDC", "hwnd", 0, "handle", $_hdc)
		DllCall("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hsrcsv)
		DllCall("gdi32.dll", "bool", "DeleteDC", "handle", $hsrcdc)
		If $ierror Then Return SetError(10, 0, 0)
		Return 1
	EndFunc

	Func _winapi_drawfocusrect($hdc, $trect)
		Local $aret = DllCall("user32.dll", "bool", "DrawFocusRect", "handle", $hdc, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_drawline($hdc, $ix1, $iy1, $ix2, $iy2)
		_winapi_moveto($hdc, $ix1, $iy1)
		If @error Then Return SetError(@error, @extended, False)
		_winapi_lineto($hdc, $ix2, $iy2)
		If @error Then Return SetError(@error + 10, @extended, False)
		Return True
	EndFunc

	Func _winapi_drawshadowtext($hdc, $stext, $irgbtext, $irgbshadow, $ixoffset = 0, $iyoffset = 0, $trect = 0, $iflags = 0)
		Local $aret
		If NOT IsDllStruct($trect) Then
			$trect = DllStructCreate($tagrect)
			$aret = DllCall("user32.dll", "bool", "GetClientRect", "hwnd", _winapi_windowfromdc($hdc), "struct*", $trect)
			If @error Then Return SetError(@error + 10, @extended, 0)
			If NOT $aret[0] Then Return SetError(10, 0, 0)
		EndIf
		$aret = DllCall("comctl32.dll", "int", "DrawShadowText", "handle", $hdc, "wstr", $stext, "uint", -1, "struct*", $trect, "dword", $iflags, "int", __rgb($irgbtext), "int", __rgb($irgbshadow), "int", $ixoffset, "int", $iyoffset)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_dwmdefwindowproc($hwnd, $imsg, $wparam, $lparam)
		Local $aret = DllCall("dwmapi.dll", "bool", "DwmDefWindowProc", "hwnd", $hwnd, "uint", $imsg, "wparam", $wparam, "lparam", $lparam, "lresult*", 0)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $aret[5]
	EndFunc

	Func _winapi_dwmenableblurbehindwindow($hwnd, $benable = True, $btransition = False, $hrgn = 0)
		Local $tblurbehind = DllStructCreate("dword;bool;handle;bool")
		Local $iflags = 0
		If $hrgn Then
			$iflags += 2
			DllStructSetData($tblurbehind, 3, $hrgn)
		EndIf
		DllStructSetData($tblurbehind, 1, BitOR($iflags, 5))
		DllStructSetData($tblurbehind, 2, $benable)
		DllStructSetData($tblurbehind, 4, $btransition)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmEnableBlurBehindWindow", "hwnd", $hwnd, "struct*", $tblurbehind)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmenablecomposition($benable)
		If $benable Then $benable = 1
		Local $aret = DllCall("dwmapi.dll", "long", "DwmEnableComposition", "uint", $benable)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmextendframeintoclientarea($hwnd, $tmargins = 0)
		If NOT IsDllStruct($tmargins) Then
			$tmargins = _winapi_createmargins(-1, -1, -1, -1)
		EndIf
		Local $aret = DllCall("dwmapi.dll", "long", "DwmExtendFrameIntoClientArea", "hwnd", $hwnd, "struct*", $tmargins)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmgetcolorizationcolor()
		Local $aret = DllCall("dwmapi.dll", "long", "DwmGetColorizationColor", "dword*", 0, "bool*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return SetExtended($aret[2], $aret[1])
	EndFunc

	Func _winapi_dwmgetcolorizationparameters()
		Local $tdwmcp = DllStructCreate($tagdwm_colorization_parameters)
		Local $aret = DllCall("dwmapi.dll", "uint", 127, "struct*", $tdwmcp)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return $tdwmcp
	EndFunc

	Func _winapi_dwmgetwindowattribute($hwnd, $iattribute)
		Local $tagstruct
		Switch $iattribute
			Case 5, 9
				$tagstruct = $tagrect
			Case 1
				$tagstruct = "uint"
			Case Else
				Return SetError(11, 0, 0)
		EndSwitch
		Local $tdata = DllStructCreate($tagstruct)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmGetWindowAttribute", "hwnd", $hwnd, "dword", $iattribute, "struct*", $tdata, "dword", DllStructGetSize($tdata))
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Switch $iattribute
			Case 1
				Return DllStructGetData($tdata, 1)
			Case Else
				Return $tdata
		EndSwitch
	EndFunc

	Func _winapi_dwminvalidateiconicbitmaps($hwnd)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmInvalidateIconicBitmaps", "hwnd", $hwnd)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmiscompositionenabled()
		Local $aret = DllCall("dwmapi.dll", "long", "DwmIsCompositionEnabled", "bool*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return $aret[1]
	EndFunc

	Func _winapi_dwmquerythumbnailsourcesize($hthumbnail)
		Local $tsize = DllStructCreate($tagsize)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmQueryThumbnailSourceSize", "handle", $hthumbnail, "struct*", $tsize)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return $tsize
	EndFunc

	Func _winapi_dwmregisterthumbnail($hdestination, $hsource)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmRegisterThumbnail", "hwnd", $hdestination, "hwnd", $hsource, "handle*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return $aret[3]
	EndFunc

	Func _winapi_dwmsetcolorizationparameters($tdwmcp)
		Local $aret = DllCall("dwmapi.dll", "uint", 131, "struct*", $tdwmcp, "uint", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmseticoniclivepreviewbitmap($hwnd, $hbitmap, $bframe = False, $tclient = 0)
		Local $iflags
		If $bframe Then
			$iflags = 1
		Else
			$iflags = 0
		EndIf
		Local $aret = DllCall("dwmapi.dll", "uint", "DwmSetIconicLivePreviewBitmap", "hwnd", $hwnd, "handle", $hbitmap, "struct*", $tclient, "dword", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmseticonicthumbnail($hwnd, $hbitmap, $bframe = False)
		Local $iflags
		If $bframe Then
			$iflags = 1
		Else
			$iflags = 0
		EndIf
		Local $aret = DllCall("dwmapi.dll", "long", "DwmSetIconicThumbnail", "hwnd", $hwnd, "handle", $hbitmap, "dword", $iflags)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmsetwindowattribute($hwnd, $iattribute, $idata)
		Switch $iattribute
			Case 2, 3, 4, 6, 7, 8, 10, 11, 12
			Case Else
				Return SetError(1, 0, 0)
		EndSwitch
		Local $aret = DllCall("dwmapi.dll", "long", "DwmSetWindowAttribute", "hwnd", $hwnd, "dword", $iattribute, "dword*", $idata, "dword", 4)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmunregisterthumbnail($hthumbnail)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmUnregisterThumbnail", "handle", $hthumbnail)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_dwmupdatethumbnailproperties($hthumbnail, $bvisible = True, $bclientareaonly = False, $iopacity = 255, $trectdest = 0, $trectsrc = 0)
		Local Const $tagdwm_thumbnail_properties = "struct;dword dwFlags;int rcDestination[4];int rcSource[4];byte opacity;bool opacity;bool fSourceClientAreaOnly;endstruct"
		Local $tthumbnailproperties = DllStructCreate($tagdwm_thumbnail_properties)
		Local $tsize, $iflags = 0
		If NOT IsDllStruct($trectdest) Then
			$tsize = _winapi_dwmquerythumbnailsourcesize($hthumbnail)
			If @error Then
				Return SetError(@error + 10, @extended, 0)
			EndIf
			$trectdest = _winapi_createrectex(0, 0, DllStructGetData($tsize, 1), DllStructGetData($tsize, 2))
		EndIf
		For $i = 1 To 4
			DllStructSetData($tthumbnailproperties, 2, DllStructGetData($trectdest, $i), $i)
		Next
		If IsDllStruct($trectsrc) Then
			$iflags += 2
			For $i = 1 To 4
				DllStructSetData($tthumbnailproperties, 3, DllStructGetData($trectsrc, $i), $i)
			Next
		EndIf
		DllStructSetData($tthumbnailproperties, 1, BitOR($iflags, 29))
		DllStructSetData($tthumbnailproperties, 4, $iopacity)
		DllStructSetData($tthumbnailproperties, 5, $bvisible)
		DllStructSetData($tthumbnailproperties, 6, $bclientareaonly)
		Local $aret = DllCall("dwmapi.dll", "long", "DwmUpdateThumbnailProperties", "handle", $hthumbnail, "struct*", $tthumbnailproperties)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] Then Return SetError(10, $aret[0], 0)
		Return 1
	EndFunc

	Func _winapi_ellipse($hdc, $trect)
		Local $aret = DllCall("gdi32.dll", "bool", "Ellipse", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4))
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_endpaint($hwnd, ByRef $tpaintstruct)
		Local $aret = DllCall("user32.dll", "bool", "EndPaint", "hwnd", $hwnd, "struct*", $tpaintstruct)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_endpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "EndPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_enumdisplaymonitors($hdc = 0, $trect = 0)
		Local $henumproc = DllCallbackRegister("__EnumDisplayMonitorsProc", "bool", "handle;handle;ptr;lparam")
		Dim $__g_venum[101][2] = [[0]]
		Local $aret = DllCall("user32.dll", "bool", "EnumDisplayMonitors", "handle", $hdc, "struct*", $trect, "ptr", DllCallbackGetPtr($henumproc), "lparam", 0)
		If @error OR NOT $aret[0] OR NOT $__g_venum[0][0] Then
			$__g_venum = @error + 10
		EndIf
		DllCallbackFree($henumproc)
		If $__g_venum Then Return SetError($__g_venum, 0, 0)
		__inc($__g_venum, -1)
		Return $__g_venum
	EndFunc

	Func _winapi_enumdisplaysettings($sdevice, $imode)
		Local $stypeofdevice = "wstr"
		If NOT StringStripWS($sdevice, $str_stripleading + $str_striptrailing) Then
			$stypeofdevice = "ptr"
			$sdevice = 0
		EndIf
		Local $tdevmode = DllStructCreate($tagdevmode_display)
		DllStructSetData($tdevmode, "Size", DllStructGetSize($tdevmode))
		DllStructSetData($tdevmode, "DriverExtra", 0)
		Local $aret = DllCall("user32.dll", "bool", "EnumDisplaySettingsW", $stypeofdevice, $sdevice, "dword", $imode, "struct*", $tdevmode)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $aresult[5]
		$aresult[0] = DllStructGetData($tdevmode, "PelsWidth")
		$aresult[1] = DllStructGetData($tdevmode, "PelsHeight")
		$aresult[2] = DllStructGetData($tdevmode, "BitsPerPel")
		$aresult[3] = DllStructGetData($tdevmode, "DisplayFrequency")
		$aresult[4] = DllStructGetData($tdevmode, "DisplayFlags")
		Return $aresult
	EndFunc

	Func _winapi_enumfontfamilies($hdc = 0, $sfacename = "", $icharset = 1, $ifonttype = 7, $spattern = "", $bexclude = False)
		Local $tlogfont = DllStructCreate($taglogfont)
		Local $tpattern = DllStructCreate("uint;uint;ptr;wchar[" & (StringLen($spattern) + 1) & "]")
		DllStructSetData($tpattern, 1, $ifonttype)
		If NOT $spattern Then
			DllStructSetData($tpattern, 2, 0)
			DllStructSetData($tpattern, 3, 0)
		Else
			DllStructSetData($tpattern, 2, $bexclude)
			DllStructSetData($tpattern, 3, DllStructGetPtr($tpattern, 4))
			DllStructSetData($tpattern, 4, $spattern)
		EndIf
		DllStructSetData($tlogfont, 9, $icharset)
		DllStructSetData($tlogfont, 13, 0)
		DllStructSetData($tlogfont, 14, StringLeft($sfacename, 31))
		Local $hcdc
		If NOT $hdc Then
			$hcdc = _winapi_createcompatibledc(0)
		Else
			$hcdc = $hdc
		EndIf
		Dim $__g_venum[101][8] = [[0]]
		Local $henumproc = DllCallbackRegister("__EnumFontFamiliesProc", "int", "ptr;ptr;dword;PTR")
		Local $aret = DllCall("gdi32.dll", "int", "EnumFontFamiliesExW", "handle", $hcdc, "struct*", $tlogfont, "ptr", DllCallbackGetPtr($henumproc), "struct*", $tpattern, "dword", 0)
		If @error OR NOT $aret[0] OR NOT $__g_venum[0][0] Then
			$__g_venum = @error + 10
		EndIf
		DllCallbackFree($henumproc)
		If NOT $hdc Then
			_winapi_deletedc($hcdc)
		EndIf
		If $__g_venum Then Return SetError($__g_venum, 0, 0)
		__inc($__g_venum, -1)
		Return $__g_venum
	EndFunc

	Func _winapi_equalrect($trect1, $trect2)
		Local $aret = DllCall("user32.dll", "bool", "EqualRect", "struct*", $trect1, "struct*", $trect2)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_equalrgn($hrgn1, $hrgn2)
		Local $aret = DllCall("gdi32.dll", "bool", "EqualRgn", "handle", $hrgn1, "handle", $hrgn2)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_excludecliprect($hdc, $trect)
		Local $aret = DllCall("gdi32.dll", "int", "ExcludeClipRect", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4))
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_extcreatepen($ipenstyle, $iwidth, $ibrushstyle, $irgb, $ihatch = 0, $auserstyle = 0, $istart = 0, $iend = -1)
		Local $icount = 0, $tstyle = 0
		If BitAND($ipenstyle, 255) = 7 Then
			If __checkerrorarraybounds($auserstyle, $istart, $iend) Then Return SetError(@error + 10, @extended, 0)
			$tstyle = DllStructCreate("dword[" & ($iend - $istart + 1) & "]")
			For $i = $istart To $iend
				DllStructSetData($tstyle, 1, $auserstyle[$i], $icount + 1)
				$icount += 1
			Next
		EndIf
		Local $tlogbrush = DllStructCreate($taglogbrush)
		DllStructSetData($tlogbrush, 1, $ibrushstyle)
		DllStructSetData($tlogbrush, 2, __rgb($irgb))
		DllStructSetData($tlogbrush, 3, $ihatch)
		Local $aret = DllCall("gdi32.dll", "handle", "ExtCreatePen", "dword", $ipenstyle, "dword", $iwidth, "struct*", $tlogbrush, "dword", $icount, "struct*", $tstyle)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_extcreateregion($trgndata, $txform = 0)
		Local $aret = DllCall("gdi32.dll", "handle", "ExtCreateRegion", "struct*", $txform, "dword", DllStructGetSize($trgndata), "struct*", $trgndata)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_extfloodfill($hdc, $ix, $iy, $irgb, $itype = 0)
		Local $aret = DllCall("gdi32.dll", "bool", "ExtFloodFill", "handle", $hdc, "int", $ix, "int", $iy, "dword", __rgb($irgb), "uint", $itype)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_extselectcliprgn($hdc, $hrgn, $imode = 5)
		Local $aret = DllCall("gdi32.dll", "int", "ExtSelectClipRgn", "handle", $hdc, "handle", $hrgn, "int", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_fillpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "FillPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_fillrgn($hdc, $hrgn, $hbrush)
		Local $aret = DllCall("gdi32.dll", "bool", "FillRgn", "handle", $hdc, "handle", $hrgn, "handle", $hbrush)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_flattenpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "FlattenPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_framergn($hdc, $hrgn, $hbrush, $iwidth, $iheight)
		Local $aret = DllCall("gdi32.dll", "bool", "FrameRgn", "handle", $hdc, "handle", $hrgn, "handle", $hbrush, "int", $iwidth, "int", $iheight)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_gdicomment($hdc, $pbuffer, $isize)
		Local $aret = DllCall("gdi32.dll", "bool", "GdiComment", "handle", $hdc, "uint", $isize, "struct*", $pbuffer)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_getarcdirection($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetArcDirection", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		If ($aret[0] < 1) OR ($aret[0] > 2) Then Return SetError(10, $aret[0], 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getbitmapbits($hbitmap, $isize, $pbits)
		Local $aret = DllCall("gdi32.dll", "long", "GetBitmapBits", "handle", $hbitmap, "long", $isize, "struct*", $pbits)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getbitmapdimensionex($hbitmap)
		Local $tsize = DllStructCreate($tagsize)
		Local $aret = DllCall("gdi32.dll", "bool", "GetBitmapDimensionEx", "handle", $hbitmap, "struct*", $tsize)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tsize
	EndFunc

	Func _winapi_getbkcolor($hdc)
		Local $aret = DllCall("gdi32.dll", "dword", "GetBkColor", "handle", $hdc)
		If @error OR ($aret[0] = -1) Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_getboundsrect($hdc, $iflags = 0)
		Local $trect = DllStructCreate($tagrect)
		Local $aret = DllCall("gdi32.dll", "uint", "GetBoundsRect", "handle", $hdc, "struct*", $trect, "uint", $iflags)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return SetExtended($aret[0], $trect)
	EndFunc

	Func _winapi_getbrushorg($hdc)
		Local $tpoint = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "bool", "GetBrushOrgEx", "handle", $hdc, "struct*", $tpoint)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tpoint
	EndFunc

	Func _winapi_getbvalue($irgb)
		Return BitShift(BitAND(__rgb($irgb), 16711680), 16)
	EndFunc

	Func _winapi_getclipbox($hdc, ByRef $trect)
		$trect = DllStructCreate($tagrect)
		Local $aret = DllCall("gdi32.dll", "int", "GetClipBox", "handle", $hdc, "struct*", $trect)
		If @error OR NOT $aret[0] Then
			$trect = 0
			Return SetError(@error, @extended, 0)
		EndIf
		Return $aret[0]
	EndFunc

	Func _winapi_getcliprgn($hdc)
		Local $hrgn = _winapi_createrectrgn(0, 0, 0, 0)
		Local $ierror = 0
		Local $aret = DllCall("gdi32.dll", "int", "GetClipRgn", "handle", $hdc, "handle", $hrgn)
		If @error OR ($aret[0] = -1) Then $ierror = @error + 10
		If $ierror OR NOT $aret[0] Then
			_winapi_deleteobject($hrgn)
			$hrgn = 0
		EndIf
		Return SetError($ierror, 0, $hrgn)
	EndFunc

	Func _winapi_getcoloradjustment($hdc)
		Local $tadjustment = DllStructCreate($tagcoloradjustment)
		Local $aret = DllCall("gdi32.dll", "bool", "GetColorAdjustment", "handle", $hdc, "struct*", $tadjustment)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tadjustment
	EndFunc

	Func _winapi_getcurrentposition($hdc)
		Local $tpoint = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "int", "GetCurrentPositionEx", "handle", $hdc, "struct*", $tpoint)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tpoint
	EndFunc

	Func _winapi_getdevicegammaramp($hdc, ByRef $aramp)
		$aramp = 0
		Local $tdata = DllStructCreate("word[256];word[256];word[256]")
		Local $aret = DllCall("gdi32.dll", "bool", "GetDeviceGammaRamp", "handle", $hdc, "struct*", $tdata)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		Dim $aramp[256][3]
		For $i = 0 To 2
			For $j = 0 To 255
				$aramp[$j][$i] = DllStructGetData($tdata, $i + 1, $j + 1)
			Next
		Next
		Return 1
	EndFunc

	Func _winapi_getdibcolortable($hbitmap)
		Local $hdc = _winapi_createcompatibledc(0)
		Local $hsv = _winapi_selectobject($hdc, $hbitmap)
		Local $tpeak = DllStructCreate("dword[256]")
		Local $ierror = 0
		Local $aret = DllCall("gdi32.dll", "uint", "GetDIBColorTable", "handle", $hdc, "uint", 0, "uint", 256, "struct*", $tpeak)
		If @error OR NOT $aret[0] Then $ierror = @error + 10
		_winapi_selectobject($hdc, $hsv)
		_winapi_deletedc($hdc)
		If $ierror Then Return SetError($ierror, 0, 0)
		Local $tdata = DllStructCreate("dword[" & $aret[0] & "]")
		If @error Then Return SetError(@error + 20, @extended, 0)
		_winapi_movememory($tdata, $aret[4], 4 * $aret[0])
		Return SetExtended($aret[0], $tdata)
	EndFunc

	Func _winapi_getdibits($hdc, $hbitmap, $istartscan, $iscanlines, $pbits, $tbi, $iusage)
		Local $aresult = DllCall("gdi32.dll", "int", "GetDIBits", "handle", $hdc, "handle", $hbitmap, "uint", $istartscan, "uint", $iscanlines, "struct*", $pbits, "struct*", $tbi, "uint", $iusage)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_getenhmetafile($sfilepath)
		Local $aret = DllCall("gdi32.dll", "handle", "GetEnhMetaFileW", "wstr", $sfilepath)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getenhmetafilebits($hemf, ByRef $pbuffer)
		Local $aret = DllCall("gdi32.dll", "uint", "GetEnhMetaFileBits", "handle", $hemf, "uint", 0, "ptr", 0)
		If @error OR NOT $aret[0] Then Return SetError(@error + 50, @extended, 0)
		$pbuffer = __heaprealloc($pbuffer, $aret[0], 1)
		If @error Then Return SetError(@error, @extended, 0)
		$aret = DllCall("gdi32.dll", "uint", "GetEnhMetaFileBits", "handle", $hemf, "uint", $aret[0], "ptr", $pbuffer)
		If NOT $aret[0] Then Return SetError(60, 0, 0)
		Return $aret[2]
	EndFunc

	Func _winapi_getenhmetafiledescription($hemf)
		Local $tdata = DllStructCreate("wchar[4096]")
		Local $aret = DllCall("gdi32.dll", "uint", "GetEnhMetaFileDescriptionW", "handle", $hemf, "uint", 4096, "struct*", $tdata)
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error + 20, $aret[0], 0)
		If NOT $aret[0] Then Return 0
		Local $adata = _winapi_structtoarray($tdata)
		If @error Then Return SetError(@error, @extended, 0)
		Local $aresult[2]
		For $i = 0 To 1
			If $adata[0] > $i Then
				$aresult[$i] = $adata[$i + 1]
			Else
				$aresult[$i] = ""
			EndIf
		Next
		Return $aresult
	EndFunc

	Func _winapi_getenhmetafiledimension($hemf)
		Local $tenhmetaheader = _winapi_getenhmetafileheader($hemf)
		If @error Then Return SetError(@error, @extended, 0)
		Local $tsize = DllStructCreate($tagsize)
		DllStructSetData($tsize, 1, Round((DllStructGetData($tenhmetaheader, "rcFrame", 3) - DllStructGetData($tenhmetaheader, "rcFrame", 1)) * DllStructGetData($tenhmetaheader, "Device", 1) / DllStructGetData($tenhmetaheader, "Millimeters", 1) / 100))
		DllStructSetData($tsize, 2, Round((DllStructGetData($tenhmetaheader, "rcFrame", 4) - DllStructGetData($tenhmetaheader, "rcFrame", 2)) * DllStructGetData($tenhmetaheader, "Device", 2) / DllStructGetData($tenhmetaheader, "Millimeters", 2) / 100))
		Return $tsize
	EndFunc

	Func _winapi_getenhmetafileheader($hemf)
		Local $tenhmetaheader = DllStructCreate($tagenhmetaheader)
		Local $aret = DllCall("gdi32.dll", "uint", "GetEnhMetaFileHeader", "handle", $hemf, "uint", DllStructGetSize($tenhmetaheader), "struct*", $tenhmetaheader)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return SetExtended($aret[0], $tenhmetaheader)
	EndFunc

	Func _winapi_getfontname($sfacename, $istyle = 0, $icharset = 1)
		If NOT $sfacename Then Return SetError(1, 0, "")
		Local $iflags = 0
		If BitAND($istyle, 1) Then
			$iflags += 32
		EndIf
		If BitAND($istyle, 2) Then
			$iflags += 1
		EndIf
		If NOT $iflags Then
			$iflags = 64
		EndIf
		Local $tlogfont = DllStructCreate($taglogfont)
		DllStructSetData($tlogfont, 9, $icharset)
		DllStructSetData($tlogfont, 13, 0)
		DllStructSetData($tlogfont, 14, StringLeft($sfacename, 31))
		Local $tfn = DllStructCreate("dword;wchar[64]")
		DllStructSetData($tfn, 1, $iflags)
		DllStructSetData($tfn, 2, "")
		Local $hdc = _winapi_createcompatibledc(0)
		Local $henumproc = DllCallbackRegister("__EnumFontStylesProc", "int", "ptr;ptr;dword;lparam")
		Local $sret = ""
		Local $aret = DllCall("gdi32.dll", "int", "EnumFontFamiliesExW", "handle", $hdc, "struct*", $tlogfont, "ptr", DllCallbackGetPtr($henumproc), "struct*", $tfn, "dword", 0)
		If NOT @error AND NOT $aret[0] Then $sret = DllStructGetData($tfn, 2)
		DllCallbackFree($henumproc)
		_winapi_deletedc($hdc)
		If NOT $sret Then Return SetError(2, 0, "")
		Return $sret
	EndFunc

	Func _winapi_getfontresourceinfo($sfont, $bforce = False, $iflag = Default)
		If $iflag = Default Then
			If $bforce Then
				If NOT _winapi_addfontresourceex($sfont, $fr_not_enum) Then Return SetError(@error + 20, @extended, "")
			EndIf
			Local $ierror = 0
			Local $aret = DllCall("gdi32.dll", "bool", "GetFontResourceInfoW", "wstr", $sfont, "dword*", 4096, "wstr", "", "dword", 1)
			If @error OR NOT $aret[0] Then $ierror = @error + 10
			If $bforce Then
				_winapi_removefontresourceex($sfont, $fr_not_enum)
			EndIf
			If $ierror Then Return SetError($ierror, 0, "")
			Return $aret[3]
		Else
			If NOT FileExists($sfont) Then
				$sfont = RegRead("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders", "Fonts") & "\" & $sfont
				If NOT FileExists($sfont) Then Return SetError(31, 0, "")
			EndIf
			Local Const $hfile = _winapi_createfile($sfont, 2, 2, 2)
			If NOT $hfile Then Return SetError(32, _winapi_getlasterror(), "")
			Local Const $ifile = FileGetSize($sfont)
			Local Const $tbuffer = DllStructCreate("byte[" & $ifile + 1 & "]")
			Local Const $pfile = DllStructGetPtr($tbuffer)
			Local $iread
			_winapi_readfile($hfile, $pfile, $ifile, $iread)
			_winapi_closehandle($hfile)
			Local $sttfname = _winapi_getfontmemoryresourceinfo($pfile, $iflag)
			If @error Then
				If @error = 1 AND $iflag = 4 Then
					$sttfname = _winapi_getfontresourceinfo($sfont, True)
					Return SetError(@error, @extended, $sttfname)
				EndIf
				Return SetError(33, @error, "")
			EndIf
			Return $sttfname
		EndIf
	EndFunc

	Func _winapi_getfontmemoryresourceinfo($pmemory, $iflag = 1)
		Local Const $tagtt_offset_table = "USHORT uMajorVersion;USHORT uMinorVersion;USHORT uNumOfTables;USHORT uSearchRange;USHORT uEntrySelector;USHORT uRangeShift"
		Local Const $tagtt_table_directory = "char szTag[4];ULONG uCheckSum;ULONG uOffset;ULONG uLength"
		Local Const $tagtt_name_table_header = "USHORT uFSelector;USHORT uNRCount;USHORT uStorageOffset"
		Local Const $tagtt_name_record = "USHORT uPlatformID;USHORT uEncodingID;USHORT uLanguageID;USHORT uNameID;USHORT uStringLength;USHORT uStringOffset"
		Local $tttoffsettable = DllStructCreate($tagtt_offset_table, $pmemory)
		Local $inumoftables = _winapi_swapword(DllStructGetData($tttoffsettable, "uNumOfTables"))
		If NOT (_winapi_swapword(DllStructGetData($tttoffsettable, "uMajorVersion")) = 1 AND _winapi_swapword(DllStructGetData($tttoffsettable, "uMinorVersion")) = 0) Then Return SetError(1, 0, "")
		Local $itbldirsize = DllStructGetSize(DllStructCreate($tagtt_table_directory))
		Local $bfound = False, $ioffset, $ttbldir
		For $i = 0 To $inumoftables - 1
			$ttbldir = DllStructCreate($tagtt_table_directory, $pmemory + DllStructGetSize($tttoffsettable) + $i * $itbldirsize)
			If StringLeft(DllStructGetData($ttbldir, "szTag"), 4) = "name" Then
				$bfound = True
				$ioffset = _winapi_swapdword(DllStructGetData($ttbldir, "uOffset"))
				ExitLoop
			EndIf
		Next
		If NOT $bfound Then Return SetError(2, 0, "")
		Local $tntheader = DllStructCreate($tagtt_name_table_header, $pmemory + $ioffset)
		Local $intheadersize = DllStructGetSize($tntheader)
		Local $inrcount = _winapi_swapword(DllStructGetData($tntheader, "uNRCount"))
		Local $istorageoffset = _winapi_swapword(DllStructGetData($tntheader, "uStorageOffset"))
		Local $ittrecordsize = DllStructGetSize(DllStructCreate($tagtt_name_record))
		Local $tresult, $sresult, $istringlength, $istringoffset, $iencodingid, $tttrecord
		For $i = 0 To $inrcount - 1
			$tttrecord = DllStructCreate($tagtt_name_record, $pmemory + $ioffset + $intheadersize + $i * $ittrecordsize)
			If _winapi_swapword($tttrecord.unameid) = $iflag Then
				$istringlength = _winapi_swapword(DllStructGetData($tttrecord, "uStringLength"))
				$istringoffset = _winapi_swapword(DllStructGetData($tttrecord, "uStringOffset"))
				$iencodingid = _winapi_swapword(DllStructGetData($tttrecord, "uEncodingID"))
				Local $swchar = "char"
				If $iencodingid = 1 Then
					$swchar = "word"
					$istringlength = $istringlength / 2
				EndIf
				$tresult = DllStructCreate($swchar & " szTTFName[" & $istringlength & "]", $pmemory + $ioffset + $istringoffset + $istorageoffset)
				If $iencodingid = 1 Then
					$sresult = ""
					For $j = 1 To $istringlength
						$sresult &= ChrW(_winapi_swapword(DllStructGetData($tresult, 1, $j)))
					Next
				Else
					$sresult = $tresult.szttfname
				EndIf
				If StringLen($sresult) > 0 Then ExitLoop
			EndIf
		Next
		Return $sresult
	EndFunc

	Func _winapi_getglyphoutline($hdc, $schar, $iformat, ByRef $pbuffer, $tmat2 = 0)
		Local $tgm = DllStructCreate($tagglyphmetrics)
		Local $aret, $ilength = 0
		If NOT IsDllStruct($tmat2) Then
			$tmat2 = DllStructCreate("short[8]")
			DllStructSetData($tmat2, 1, 1, 2)
			DllStructSetData($tmat2, 1, 1, 8)
		EndIf
		If $iformat Then
			$aret = DllCall("gdi32.dll", "dword", "GetGlyphOutlineW", "handle", $hdc, "uint", AscW($schar), "uint", $iformat, "struct*", $tgm, "dword", 0, "ptr", 0, "struct*", $tmat2)
			If @error OR ($aret[0] = 4294967295) Then Return SetError(@error + 10, @extended, 0)
			$ilength = $aret[0]
			$pbuffer = __heaprealloc($pbuffer, $ilength, 1)
			If @error Then Return SetError(@error + 20, @extended, 0)
		EndIf
		$aret = DllCall("gdi32.dll", "dword", "GetGlyphOutlineW", "handle", $hdc, "uint", AscW($schar), "uint", $iformat, "struct*", $tgm, "dword", $ilength, "ptr", $pbuffer, "struct*", $tmat2)
		If @error Then Return SetError(@error, @extended, 0)
		If $aret[0] = 4294967295 Then Return SetError(10, -1, 0)
		Return SetExtended($ilength, $tgm)
	EndFunc

	Func _winapi_getgraphicsmode($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetGraphicsMode", "handle", $hdc)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getgvalue($irgb)
		Return BitShift(BitAND(__rgb($irgb), 65280), 8)
	EndFunc

	Func _winapi_getmapmode($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetMapMode", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getmonitorinfo($hmonitor)
		Local $tmiex = DllStructCreate("dword;long[4];long[4];dword;wchar[32]")
		DllStructSetData($tmiex, 1, DllStructGetSize($tmiex))
		Local $aret = DllCall("user32.dll", "bool", "GetMonitorInfoW", "handle", $hmonitor, "struct*", $tmiex)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $aresult[4]
		For $i = 0 To 1
			$aresult[$i] = DllStructCreate($tagrect)
			_winapi_movememory($aresult[$i], DllStructGetPtr($tmiex, $i + 2), 16)
		Next
		$aresult[3] = DllStructGetData($tmiex, 5)
		Switch DllStructGetData($tmiex, 4)
			Case 1
				$aresult[2] = 1
			Case Else
				$aresult[2] = 0
		EndSwitch
		Return $aresult
	EndFunc

	Func _winapi_getoutlinetextmetrics($hdc)
		Local $aret = DllCall("gdi32.dll", "uint", "GetOutlineTextMetricsW", "handle", $hdc, "uint", 0, "ptr", 0)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Local $tdata = DllStructCreate("byte[" & $aret[0] & "]")
		Local $toltm = DllStructCreate($tagoutlinetextmetric, DllStructGetPtr($tdata))
		$aret = DllCall("gdi32.dll", "uint", "GetOutlineTextMetricsW", "handle", $hdc, "uint", $aret[0], "struct*", $tdata)
		If NOT $aret[0] Then Return SetError(20, 0, 0)
		Return $toltm
	EndFunc

	Func _winapi_getpixel($hdc, $ix, $iy)
		Local $aret = DllCall("gdi32.dll", "dword", "GetPixel", "handle", $hdc, "int", $ix, "int", $iy)
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_getpolyfillmode($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetPolyFillMode", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getposfromrect($trect)
		Local $aresult[4]
		For $i = 0 To 3
			$aresult[$i] = DllStructGetData($trect, $i + 1)
			If @error Then Return SetError(@error, @extended, 0)
		Next
		For $i = 2 To 3
			$aresult[$i] -= $aresult[$i - 2]
		Next
		Return $aresult
	EndFunc

	Func _winapi_getregiondata($hrgn, ByRef $trgndata)
		Local $aret = DllCall("gdi32.dll", "dword", "GetRegionData", "handle", $hrgn, "dword", 0, "ptr", 0)
		If @error OR NOT $aret[0] Then
			$trgndata = 0
			Return SetError(@error, @extended, False)
		EndIf
		$trgndata = DllStructCreate($tagrgndataheader)
		Local $irectsize = $aret[0] - DllStructGetSize($trgndata)
		If $irectsize > 0 Then $trgndata = DllStructCreate($tagrgndataheader & ";byte[" & $irectsize & "]")
		$aret = DllCall("gdi32.dll", "dword", "GetRegionData", "handle", $hrgn, "dword", $aret[0], "struct*", $trgndata)
		If NOT $aret[0] Then $trgndata = 0
		Return $aret[0]
	EndFunc

	Func _winapi_getrgnbox($hrgn, ByRef $trect)
		$trect = DllStructCreate($tagrect)
		Local $aret = DllCall("gdi32.dll", "int", "GetRgnBox", "handle", $hrgn, "struct*", $trect)
		If @error OR NOT $aret[0] Then
			$trect = 0
			Return SetError(@error, @extended, 0)
		EndIf
		Return $aret[0]
	EndFunc

	Func _winapi_getrop2($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetROP2", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getrvalue($irgb)
		Return BitAND(__rgb($irgb), 255)
	EndFunc

	Func _winapi_getstretchbltmode($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetStretchBltMode", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_gettabbedtextextent($hdc, $stext, $atab = 0, $istart = 0, $iend = -1)
		Local $itab, $icount
		If NOT IsArray($atab) Then
			If $atab Then
				$itab = $atab
				Dim $atab[1] = [$itab]
				$istart = 0
				$iend = 0
				$icount = 1
			Else
				$icount = 0
			EndIf
		Else
			$icount = 1
		EndIf
		Local $ttab = 0
		If $icount Then
			If __checkerrorarraybounds($atab, $istart, $iend) Then Return SetError(@error + 10, @extended, 0)
			$icount = $iend - $istart + 1
			$ttab = DllStructCreate("uint[" & $icount & "]")
			$itab = 1
			For $i = $istart To $iend
				DllStructSetData($ttab, 1, $atab[$i], $itab)
				$itab += 1
			Next
		EndIf
		Local $aret = DllCall("user32.dll", "dword", "GetTabbedTextExtentW", "handle", $hdc, "wstr", $stext, "int", StringLen($stext), "int", $icount, "struct*", $ttab)
		If @error OR NOT $aret[0] Then Return SetError(@error + 20, @extended, 0)
		Return _winapi_createsize(_winapi_loword($aret[0]), _winapi_hiword($aret[0]))
	EndFunc

	Func _winapi_gettextalign($hdc)
		Local $aret = DllCall("gdi32.dll", "uint", "GetTextAlign", "handle", $hdc)
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error, @extended, -1)
		Return $aret[0]
	EndFunc

	Func _winapi_gettextcharacterextra($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetTextCharacterExtra", "handle", $hdc)
		If @error OR ($aret[0] = 134217728) Then Return SetError(@error, @extended, -1)
		Return $aret[0]
	EndFunc

	Func _winapi_gettextface($hdc)
		Local $aret = DllCall("gdi32.dll", "int", "GetTextFaceW", "handle", $hdc, "int", 2048, "wstr", "")
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
		Return $aret[3]
	EndFunc

	Func _winapi_getudfcolormode()
		Return Number($__g_irgbmode)
	EndFunc

	Func _winapi_getupdaterect($hwnd, $berase = True)
		Local $trect = DllStructCreate($tagrect)
		Local $aret = DllCall("user32.dll", "bool", "GetUpdateRect", "hwnd", $hwnd, "struct*", $trect, "bool", $berase)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $trect
	EndFunc

	Func _winapi_getupdatergn($hwnd, $hrgn, $berase = True)
		Local $aret = DllCall("user32.dll", "int", "GetUpdateRgn", "hwnd", $hwnd, "handle", $hrgn, "bool", $berase)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getwindowext($hdc)
		Local $tsize = DllStructCreate($tagsize)
		Local $aret = DllCall("gdi32.dll", "bool", "GetWindowExtEx", "handle", $hdc, "struct*", $tsize)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tsize
	EndFunc

	Func _winapi_getwindoworg($hdc)
		Local $tpoint = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "bool", "GetWindowOrgEx", "handle", $hdc, "struct*", $tpoint)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tpoint
	EndFunc

	Func _winapi_getwindowrgnbox($hwnd, ByRef $trect)
		$trect = DllStructCreate($tagrect)
		Local $aret = DllCall("gdi32.dll", "int", "GetWindowRgnBox", "hwnd", $hwnd, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_getworldtransform($hdc)
		Local $txform = DllStructCreate($tagxform)
		Local $aret = DllCall("gdi32.dll", "bool", "GetWorldTransform", "handle", $hdc, "struct*", $txform)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $txform
	EndFunc

	Func _winapi_gradientfill($hdc, Const ByRef $avertex, $istart = 0, $iend = -1, $brotate = False)
		If __checkerrorarraybounds($avertex, $istart, $iend, 2) Then Return SetError(@error + 10, @extended, 0)
		If UBound($avertex, $ubound_columns) < 3 Then Return SetError(13, 0, 0)
		Local $ipoint = $iend - $istart + 1
		If $ipoint > 3 Then
			$iend = $istart + 2
			$ipoint = 3
		EndIf
		Local $imode
		Switch $ipoint
			Case 2
				$imode = Number(NOT $brotate)
			Case 3
				$imode = 2
			Case Else
				Return SetError(15, 0, 0)
		EndSwitch
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "ushort[8];"
		Next
		Local $tvertex = DllStructCreate($tagstruct)
		Local $icount = 1
		Local $tgradient = DllStructCreate("ulong[" & $ipoint & "]")
		For $i = $istart To $iend
			DllStructSetData($tgradient, 1, $icount - 1, $icount)
			DllStructSetData($tvertex, $icount, _winapi_loword($avertex[$i][0]), 1)
			DllStructSetData($tvertex, $icount, _winapi_hiword($avertex[$i][0]), 2)
			DllStructSetData($tvertex, $icount, _winapi_loword($avertex[$i][1]), 3)
			DllStructSetData($tvertex, $icount, _winapi_hiword($avertex[$i][1]), 4)
			DllStructSetData($tvertex, $icount, BitShift(_winapi_getrvalue($avertex[$i][2]), -8), 5)
			DllStructSetData($tvertex, $icount, BitShift(_winapi_getgvalue($avertex[$i][2]), -8), 6)
			DllStructSetData($tvertex, $icount, BitShift(_winapi_getbvalue($avertex[$i][2]), -8), 7)
			DllStructSetData($tvertex, $icount, 0, 8)
			$icount += 1
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "GdiGradientFill", "handle", $hdc, "struct*", $tvertex, "ulong", $ipoint, "struct*", $tgradient, "ulong", 1, "ulong", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_inflaterect(ByRef $trect, $idx, $idy)
		Local $aret = DllCall("user32.dll", "bool", "InflateRect", "struct*", $trect, "int", $idx, "int", $idy)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_intersectcliprect($hdc, $trect)
		Local $aret = DllCall("gdi32.dll", "int", "IntersectClipRect", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4))
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_intersectrect($trect1, $trect2)
		Local $trect = DllStructCreate($tagrect)
		Local $aret = DllCall("user32.dll", "bool", "IntersectRect", "struct*", $trect, "struct*", $trect1, "struct*", $trect2)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $trect
	EndFunc

	Func _winapi_invalidatergn($hwnd, $hrgn = 0, $berase = True)
		Local $aret = DllCall("user32.dll", "bool", "InvalidateRgn", "hwnd", $hwnd, "handle", $hrgn, "bool", $berase)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_invertandbitmap($hbitmap, $bdelete = False)
		Local $tbitmap = DllStructCreate($tagbitmap)
		If NOT _winapi_getobject($hbitmap, DllStructGetSize($tbitmap), $tbitmap) OR (DllStructGetData($tbitmap, "bmBitsPixel") <> 1) Then
			Return SetError(@error + 10, @extended, 0)
		EndIf
		Local $hresult = _winapi_createdib(DllStructGetData($tbitmap, "bmWidth"), DllStructGetData($tbitmap, "bmHeight"), 1)
		If NOT $hresult Then Return SetError(@error, @extended, 0)
		Local $hsrcdc = _winapi_createcompatibledc(0)
		Local $hsrcsv = _winapi_selectobject($hsrcdc, $hbitmap)
		Local $hdstdc = _winapi_createcompatibledc(0)
		Local $hdstsv = _winapi_selectobject($hdstdc, $hresult)
		_winapi_bitblt($hdstdc, 0, 0, DllStructGetData($tbitmap, "bmWidth"), DllStructGetData($tbitmap, "bmHeight"), $hsrcdc, 0, 0, 3342344)
		_winapi_selectobject($hsrcdc, $hsrcsv)
		_winapi_deletedc($hsrcdc)
		_winapi_selectobject($hdstdc, $hdstsv)
		_winapi_deletedc($hdstdc)
		If $bdelete Then
			_winapi_deleteobject($hbitmap)
		EndIf
		Return $hresult
	EndFunc

	Func _winapi_invertcolor($icolor)
		If $icolor = -1 Then Return 0
		Return 16777215 - BitAND($icolor, 16777215)
	EndFunc

	Func _winapi_invertrect($hdc, ByRef $trect)
		Local $aret = DllCall("user32.dll", "bool", "InvertRect", "handle", $hdc, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_invertrgn($hdc, $hrgn)
		Local $aret = DllCall("gdi32.dll", "bool", "InvertRgn", "handle", $hdc, "handle", $hrgn)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_isrectempty(ByRef $trect)
		Local $aret = DllCall("user32.dll", "bool", "IsRectEmpty", "struct*", $trect)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_linedda($ix1, $iy1, $ix2, $iy2, $plineproc, $pdata = 0)
		Local $aret = DllCall("gdi32.dll", "bool", "LineDDA", "int", $ix1, "int", $iy1, "int", $ix2, "int", $iy2, "ptr", $plineproc, "lparam", $pdata)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_lineto($hdc, $ix, $iy)
		Local $aresult = DllCall("gdi32.dll", "bool", "LineTo", "handle", $hdc, "int", $ix, "int", $iy)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_lockwindowupdate($hwnd)
		Local $aret = DllCall("user32.dll", "bool", "LockWindowUpdate", "hwnd", $hwnd)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_lptodp($hdc, ByRef $tpoint, $icount = 1)
		Local $aret = DllCall("gdi32.dll", "bool", "LPtoDP", "handle", $hdc, "struct*", $tpoint, "int", $icount)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_maskblt($hdestdc, $ixdest, $iydest, $iwidth, $iheight, $hsrcdc, $ixsrc, $iysrc, $hmask, $ixmask, $iymask, $irop)
		Local $aret = DllCall("gdi32.dll", "bool", "MaskBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidth, "int", $iheight, "hwnd", $hsrcdc, "int", $ixsrc, "int", $iysrc, "handle", $hmask, "int", $ixmask, "int", $iymask, "dword", $irop)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_modifyworldtransform($hdc, ByRef $txform, $imode)
		Local $aret = DllCall("gdi32.dll", "bool", "ModifyWorldTransform", "handle", $hdc, "struct*", $txform, "dword", $imode)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_monitorfrompoint(ByRef $tpoint, $iflag = 1)
		If DllStructGetSize($tpoint) <> 8 Then Return SetError(@error + 10, @extended, 0)
		Local $aret = DllCall("user32.dll", "handle", "MonitorFromPoint", "struct", $tpoint, "dword", $iflag)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_monitorfromrect(ByRef $trect, $iflag = 1)
		Local $aret = DllCall("user32.dll", "ptr", "MonitorFromRect", "struct*", $trect, "dword", $iflag)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_monitorfromwindow($hwnd, $iflag = 1)
		Local $aret = DllCall("user32.dll", "handle", "MonitorFromWindow", "hwnd", $hwnd, "dword", $iflag)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_moveto($hdc, $ix, $iy)
		Local $aresult = DllCall("gdi32.dll", "bool", "MoveToEx", "handle", $hdc, "int", $ix, "int", $iy, "ptr", 0)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_movetoex($hdc, $ix, $iy)
		Local $tpoint = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "bool", "MoveToEx", "handle", $hdc, "int", $ix, "int", $iy, "struct*", $tpoint)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $tpoint
	EndFunc

	Func _winapi_offsetcliprgn($hdc, $ixoffset, $iyoffset)
		Local $aret = DllCall("gdi32.dll", "int", "OffsetClipRgn", "handle", $hdc, "int", $ixoffset, "int", $iyoffset)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_offsetpoints(ByRef $apoint, $ixoffset, $iyoffset, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2) Then Return SetError(@error + 10, @extended, 0)
		If UBound($apoint, $ubound_columns) < 2 Then Return SetError(13, 0, 0)
		For $i = $istart To $iend
			$apoint[$i][0] += $ixoffset
			$apoint[$i][1] += $iyoffset
		Next
		Return 1
	EndFunc

	Func _winapi_offsetrect(ByRef $trect, $idx, $idy)
		Local $aret = DllCall("user32.dll", "bool", "OffsetRect", "struct*", $trect, "int", $idx, "int", $idy)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_offsetrgn($hrgn, $ixoffset, $iyoffset)
		Local $aret = DllCall("gdi32.dll", "int", "OffsetRgn", "handle", $hrgn, "int", $ixoffset, "int", $iyoffset)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_offsetwindoworg($hdc, $ixoffset, $iyoffset)
		$__g_vext = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "bool", "OffsetWindowOrgEx", "handle", $hdc, "int", $ixoffset, "int", $iyoffset, "struct*", $__g_vext)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_paintdesktop($hdc)
		Local $aret = DllCall("user32.dll", "bool", "PaintDesktop", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_paintrgn($hdc, $hrgn)
		Local $aret = DllCall("gdi32.dll", "bool", "PaintRgn", "handle", $hdc, "handle", $hrgn)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_patblt($hdc, $ix, $iy, $iwidth, $iheight, $irop)
		Local $aret = DllCall("gdi32.dll", "bool", "PatBlt", "handle", $hdc, "int", $ix, "int", $iy, "int", $iwidth, "int", $iheight, "dword", $irop)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_pathtoregion($hdc)
		Local $aret = DllCall("gdi32.dll", "handle", "PathToRegion", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_playenhmetafile($hdc, $hemf, ByRef $trect)
		Local $aret = DllCall("gdi32.dll", "bool", "PlayEnhMetaFile", "handle", $hdc, "handle", $hemf, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_plgblt($hdestdc, Const ByRef $apoint, $hsrcdc, $ixsrc, $iysrc, $iwidth, $iheight, $hmask = 0, $ixmask = 0, $iymask = 0)
		If (UBound($apoint) < 3) OR (UBound($apoint, $ubound_columns) < 2) Then Return SetError(12, 0, False)
		Local $tpoints = DllStructCreate("long[2];long[2];long[2]")
		For $i = 0 To 2
			For $j = 0 To 1
				DllStructSetData($tpoints, $i + 1, $apoint[$i][$j], $j + 1)
			Next
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "PlgBlt", "handle", $hdestdc, "struct*", $tpoints, "handle", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidth, "int", $iheight, "handle", $hmask, "int", $ixmask, "int", $iymask)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_polybezier($hdc, Const ByRef $apoint, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2, 2) Then Return SetError(@error + 10, @extended, False)
		Local $ipoint = 1 + 3 * Floor(($iend - $istart) / 3)
		If $ipoint < 1 Then Return SetError(15, 0, False)
		$iend = $istart + $ipoint - 1
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "long[2];"
		Next
		Local $tpoint = DllStructCreate($tagstruct)
		Local $icount = 0
		For $i = $istart To $iend
			$icount += 1
			For $j = 0 To 1
				DllStructSetData($tpoint, $icount, $apoint[$i][$j], $j + 1)
			Next
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "PolyBezier", "handle", $hdc, "struct*", $tpoint, "dword", $ipoint)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_polybezierto($hdc, Const ByRef $apoint, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2, 2) Then Return SetError(@error + 10, @extended, False)
		Local $ipoint = 3 * Floor(($iend - $istart + 1) / 3)
		If $ipoint < 3 Then Return SetError(15, 0, False)
		$iend = $istart + $ipoint - 1
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "long[2];"
		Next
		Local $tpoint = DllStructCreate($tagstruct)
		Local $icount = 0
		For $i = $istart To $iend
			$icount += 1
			For $j = 0 To 1
				DllStructSetData($tpoint, $icount, $apoint[$i][$j], $j + 1)
			Next
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "PolyBezierTo", "handle", $hdc, "struct*", $tpoint, "dword", $ipoint)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_polydraw($hdc, Const ByRef $apoint, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2) Then Return SetError(@error + 10, @extended, 0)
		If UBound($apoint, $ubound_columns) < 3 Then Return SetError(13, 0, False)
		Local $ipoint = $iend - $istart + 1
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "long[2];"
		Next
		Local $tpoint = DllStructCreate($tagstruct)
		Local $ttypes = DllStructCreate("byte[" & $ipoint & "]")
		Local $icount = 0
		For $i = $istart To $iend
			$icount += 1
			For $j = 0 To 1
				DllStructSetData($tpoint, $icount, $apoint[$i][$j], $j + 1)
			Next
			DllStructSetData($ttypes, 1, $apoint[$i][2], $icount)
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "PolyDraw", "handle", $hdc, "struct*", $tpoint, "struct*", $ttypes, "dword", $ipoint)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_polygon($hdc, Const ByRef $apoint, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2, 2) Then Return SetError(@error + 10, @extended, False)
		Local $tagstruct = ""
		For $i = $istart To $iend
			$tagstruct &= "int[2];"
		Next
		Local $tdata = DllStructCreate($tagstruct)
		Local $icount = 1
		For $i = $istart To $iend
			For $j = 0 To 1
				DllStructSetData($tdata, $icount, $apoint[$i][$j], $j + 1)
			Next
			$icount += 1
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "Polygon", "handle", $hdc, "struct*", $tdata, "int", $icount - 1)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_ptinrectex($ix, $iy, $ileft, $itop, $iright, $ibottom)
		Local $trect = _winapi_createrect($ileft, $itop, $iright, $ibottom)
		Local $tpoint = _winapi_createpoint($ix, $iy)
		Local $aret = DllCall("user32.dll", "bool", "PtInRect", "struct*", $trect, "struct", $tpoint)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_ptinregion($hrgn, $ix, $iy)
		Local $aret = DllCall("gdi32.dll", "bool", "PtInRegion", "handle", $hrgn, "int", $ix, "int", $iy)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_ptvisible($hdc, $ix, $iy)
		Local $aret = DllCall("gdi32.dll", "bool", "PtVisible", "handle", $hdc, "int", $ix, "int", $iy)
		If @error Then Return SetError(@error + 10, @extended, 0)
		If $aret[0] = -1 Then Return SetError(10, $aret[0], 0)
		Return $aret[0]
	EndFunc

	Func _winapi_radialgradientfill($hdc, $ix, $iy, $iradius, $irgb1, $irgb2, $fanglestart = 0, $fangleend = 360, $fstep = 5)
		If Abs($fanglestart) > 360 Then
			$fanglestart = Mod($fanglestart, 360)
		EndIf
		If Abs($fangleend) > 360 Then
			$fangleend = Mod($fangleend, 360)
		EndIf
		If ($fanglestart < 0) OR ($fangleend < 0) Then
			$fanglestart += 360
			$fangleend += 360
		EndIf
		If $fanglestart > $fangleend Then
			Local $fval = $fanglestart
			$fanglestart = $fangleend
			$fangleend = $fval
		EndIf
		If $fstep < 1 Then
			$fstep = 1
		EndIf
		Local $fki = ATan(1) / 45
		Local $ixp = Round($ix + $iradius * Cos($fki * $fanglestart))
		Local $iyp = Round($iy + $iradius * Sin($fki * $fanglestart))
		Local $ixn, $iyn, $fan = $fanglestart
		Local $avertex[3][3]
		While $fan < $fangleend
			$fan += $fstep
			If $fan > $fangleend Then
				$fan = $fangleend
			EndIf
			$ixn = Round($ix + $iradius * Cos($fki * $fan))
			$iyn = Round($iy + $iradius * Sin($fki * $fan))
			$avertex[0][0] = $ix
			$avertex[0][1] = $iy
			$avertex[0][2] = $irgb1
			$avertex[1][0] = $ixp
			$avertex[1][1] = $iyp
			$avertex[1][2] = $irgb2
			$avertex[2][0] = $ixn
			$avertex[2][1] = $iyn
			$avertex[2][2] = $irgb2
			If NOT _winapi_gradientfill($hdc, $avertex, 0, 2) Then
				Return SetError(@error, @extended, 0)
			EndIf
			$ixp = $ixn
			$iyp = $iyn
		WEnd
		Return 1
	EndFunc

	Func _winapi_rectangle($hdc, $trect)
		Local $aret = DllCall("gdi32.dll", "bool", "Rectangle", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4))
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_rectinregion($hrgn, $trect)
		Local $aret = DllCall("gdi32.dll", "bool", "RectInRegion", "handle", $hrgn, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_rectisempty(ByRef $trect)
		Return (DllStructGetData($trect, "Left") = 0) AND (DllStructGetData($trect, "Top") = 0) AND (DllStructGetData($trect, "Right") = 0) AND (DllStructGetData($trect, "Bottom") = 0)
	EndFunc

	Func _winapi_rectvisible($hdc, $trect)
		Local $aret = DllCall("gdi32.dll", "bool", "RectVisible", "handle", $hdc, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, 0)
		Switch $aret[0]
			Case 0, 1, 2
			Case Else
				Return SetError(10, $aret[0], 0)
		EndSwitch
		Return $aret[0]
	EndFunc

	Func _winapi_removefontmemresourceex($hfont)
		Local $aret = DllCall("gdi32.dll", "bool", "RemoveFontMemResourceEx", "handle", $hfont)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_removefontresourceex($sfont, $iflag = 0, $bnotify = False)
		Local $aret = DllCall("gdi32.dll", "bool", "RemoveFontResourceExW", "wstr", $sfont, "dword", $iflag, "ptr", 0)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, False)
		If $bnotify Then
			Local Const $wm_fontchange = 29
			Local Const $hwnd_broadcast = 65535
			DllCall("user32.dll", "none", "SendMessage", "hwnd", $hwnd_broadcast, "uint", $wm_fontchange, "wparam", 0, "lparam", 0)
		EndIf
		Return $aret[0]
	EndFunc

	Func _winapi_rgb($ired, $igreen, $iblue)
		Return __rgb(BitOR(BitShift($iblue, -16), BitShift($igreen, -8), $ired))
	EndFunc

	Func _winapi_rotatepoints(ByRef $apoint, $ixc, $iyc, $fangle, $istart = 0, $iend = -1)
		If __checkerrorarraybounds($apoint, $istart, $iend, 2) Then Return SetError(@error + 10, @extended, 0)
		If UBound($apoint, $ubound_columns) < 2 Then Return SetError(13, 0, 0)
		Local $fcos = Cos(ATan(1) / 45 * $fangle)
		Local $fsin = Sin(ATan(1) / 45 * $fangle)
		Local $ixn, $iyn
		For $i = $istart To $iend
			$ixn = $apoint[$i][0] - $ixc
			$iyn = $apoint[$i][1] - $iyc
			$apoint[$i][0] = $ixc + Round($ixn * $fcos - $iyn * $fsin)
			$apoint[$i][1] = $iyc + Round($ixn * $fsin + $iyn * $fcos)
		Next
		Return 1
	EndFunc

	Func _winapi_roundrect($hdc, $trect, $iwidth, $iheight)
		Local $aret = DllCall("gdi32.dll", "bool", "RoundRect", "handle", $hdc, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4), "int", $iwidth, "int", $iheight)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_savehbitmaptofile($sfilepath, $hbitmap, $ixpelspermeter = Default, $iypelspermeter = Default)
		Local $tbmp = DllStructCreate("align 1;ushort bfType;dword bfSize;ushort bfReserved1;ushort bfReserved2;dword bfOffset")
		Local $tdib = DllStructCreate($tagdibsection)
		Local $hdc, $hsv, $hsource = 0
		While $hbitmap
			If (NOT _winapi_getobject($hbitmap, DllStructGetSize($tdib), $tdib)) OR (DllStructGetData($tdib, "biCompression")) Then
				$hbitmap = 0
			Else
				Switch DllStructGetData($tdib, "bmBitsPixel")
					Case 32
						If NOT _winapi_isalphabitmap($hbitmap) Then
							If NOT $hsource Then
								$hsource = _winapi_createdib(DllStructGetData($tdib, "bmWidth"), DllStructGetData($tdib, "bmHeight"), 24)
								If NOT $hsource Then
									$hbitmap = 0
								EndIf
								$hdc = _winapi_createcompatibledc(0)
								$hsv = _winapi_selectobject($hdc, $hsource)
								If _winapi_drawbitmap($hdc, 0, 0, $hbitmap) Then
									$hbitmap = $hsource
								Else
									$hbitmap = 0
								EndIf
								_winapi_selectobject($hdc, $hsv)
								_winapi_deletedc($hdc)
							Else
								$hbitmap = 0
							EndIf
							ContinueLoop
						EndIf
					Case Else
				EndSwitch
				If (NOT DllStructGetData($tdib, "bmBits")) OR (NOT DllStructGetData($tdib, "biSizeImage")) Then
					If NOT $hsource Then
						$hbitmap = _winapi_copybitmap($hbitmap)
						$hsource = $hbitmap
					Else
						$hbitmap = 0
					EndIf
				Else
					ExitLoop
				EndIf
			EndIf
		WEnd
		Local $hfile = 0, $ierror = 0, $iresult = 0
		Do
			If NOT $hbitmap Then
				$ierror = 1
				ExitLoop
			EndIf
			Local $adata[4][2]
			$adata[0][0] = DllStructGetPtr($tbmp)
			$adata[0][1] = DllStructGetSize($tbmp)
			$adata[1][0] = DllStructGetPtr($tdib, "biSize")
			$adata[1][1] = 40
			$adata[2][1] = DllStructGetData($tdib, "biClrUsed") * 4
			Local $ttable = 0
			If $adata[2][1] Then
				$ttable = _winapi_getdibcolortable($hbitmap)
				If @error OR (@extended <> $adata[2][1] / 4) Then
					$ierror = @error + 10
					ExitLoop
				EndIf
			EndIf
			$adata[2][0] = DllStructGetPtr($ttable)
			$adata[3][0] = DllStructGetData($tdib, "bmBits")
			$adata[3][1] = DllStructGetData($tdib, "biSizeImage")
			DllStructSetData($tbmp, "bfType", 19778)
			DllStructSetData($tbmp, "bfSize", $adata[0][1] + $adata[1][1] + $adata[2][1] + $adata[3][1])
			DllStructSetData($tbmp, "bfReserved1", 0)
			DllStructSetData($tbmp, "bfReserved2", 0)
			DllStructSetData($tbmp, "bfOffset", $adata[0][1] + $adata[1][1] + $adata[2][1])
			$hdc = _winapi_getdc(0)
			If $ixpelspermeter = Default Then
				If NOT DllStructGetData($tdib, "biXPelsPerMeter") Then
					DllStructSetData($tdib, "biXPelsPerMeter", _winapi_getdevicecaps($hdc, 8) / _winapi_getdevicecaps($hdc, 4) * 1000)
				EndIf
			Else
				DllStructSetData($tdib, "biXPelsPerMeter", $ixpelspermeter)
			EndIf
			If $iypelspermeter = Default Then
				If NOT DllStructGetData($tdib, "biYPelsPerMeter") Then
					DllStructSetData($tdib, "biYPelsPerMeter", _winapi_getdevicecaps($hdc, 10) / _winapi_getdevicecaps($hdc, 6) * 1000)
				EndIf
			Else
				DllStructSetData($tdib, "biYPelsPerMeter", $iypelspermeter)
			EndIf
			_winapi_releasedc(0, $hdc)
			$hfile = _winapi_createfile($sfilepath, 1, 4)
			If @error Then
				$ierror = @error + 20
				ExitLoop
			EndIf
			Local $ibytes
			For $i = 0 To 3
				If $adata[$i][1] Then
					If NOT _winapi_writefile($hfile, $adata[$i][0], $adata[$i][1], $ibytes) Then
						$ierror = @error + 30
						ExitLoop 2
					EndIf
				EndIf
			Next
			$iresult = 1
		Until 1
		If $hsource Then
			_winapi_deleteobject($hsource)
		EndIf
		_winapi_closehandle($hfile)
		If NOT $iresult Then
			FileDelete($sfilepath)
		EndIf
		Return SetError($ierror, 0, $iresult)
	EndFunc

	Func _winapi_savehicontofile($sfilepath, Const ByRef $vicon, $bcompress = 0, $istart = 0, $iend = -1)
		Local $aicon, $atemp, $icount = 1
		If NOT IsArray($vicon) Then
			Dim $aicon[1] = [$vicon]
			Dim $atemp[1] = [0]
		Else
			If __checkerrorarraybounds($vicon, $istart, $iend) Then Return SetError(@error + 10, @extended, 0)
			$icount = $iend - $istart + 1
			If $icount Then
				Dim $aicon[$icount]
				Dim $atemp[$icount]
				For $i = 0 To $icount - 1
					$aicon[$i] = $vicon[$istart + $i]
					$atemp[$i] = 0
				Next
			EndIf
		EndIf
		Local $hfile = _winapi_createfile($sfilepath, 1, 4)
		If @error Then Return SetError(@error + 20, @extended, 0)
		Local $tico = DllStructCreate("align 1;ushort Reserved;ushort Type;ushort Count;byte Data[" & (16 * $icount) & "]")
		Local $ilength = DllStructGetSize($tico)
		Local $tbi = DllStructCreate($tagbitmapinfoheader)
		Local $tii = DllStructCreate($tagiconinfo)
		Local $tdib = DllStructCreate($tagdibsection)
		Local $idib = DllStructGetSize($tdib)
		Local $pdib = DllStructGetPtr($tdib)
		Local $ioffset = $ilength
		DllStructSetData($tbi, "biSize", 40)
		DllStructSetData($tbi, "biPlanes", 1)
		DllStructSetData($tbi, "biXPelsPerMeter", 0)
		DllStructSetData($tbi, "biYPelsPerMeter", 0)
		DllStructSetData($tbi, "biClrUsed", 0)
		DllStructSetData($tbi, "biClrImportant", 0)
		DllStructSetData($tico, "Reserved", 0)
		DllStructSetData($tico, "Type", 1)
		DllStructSetData($tico, "Count", $icount)
		Local $iresult = 0, $ierror = 0, $ibytes
		Local $ainfo[8], $aret, $pdata = 0, $iindex = 0
		Local $asize[2], $tdata = 0
		Do
			If NOT _winapi_writefile($hfile, $tico, $ilength, $ibytes) Then
				$ierror = @error + 30
				ExitLoop
			EndIf
			While $icount > $iindex
				$aret = DllCall("user32.dll", "bool", "GetIconInfo", "handle", $aicon[$iindex], "struct*", $tii)
				If @error OR NOT $aret[0] Then
					$ierror = @error + 40
					ExitLoop 2
				EndIf
				For $i = 4 To 5
					$ainfo[$i] = _winapi_copyimage(DllStructGetData($tii, $i), 0, 0, 0, 8200)
					If _winapi_getobject($ainfo[$i], $idib, $pdib) Then
						$ainfo[$i - 4] = DllStructGetData($tdib, "biSizeImage")
						$ainfo[$i - 2] = DllStructGetData($tdib, "bmBits")
					Else
						$ierror = @error + 50
					EndIf
				Next
				$ainfo[6] = 40
				$ainfo[7] = DllStructGetData($tdib, "bmBitsPixel")
				Switch $ainfo[7]
					Case 16, 24
					Case 32
						If NOT _winapi_isalphabitmap($ainfo[5]) Then
							If NOT $atemp[$iindex] Then
								$aicon[$iindex] = _winapi_create32bithicon($aicon[$iindex])
								$atemp[$iindex] = $aicon[$iindex]
								If NOT @error Then
									ContinueLoop
								Else
									ContinueCase
								EndIf
							EndIf
						Else
							If ($ainfo[1] >= 256 * 256 * 4) AND ($bcompress) Then
								$ibytes = _winapi_compressbitmapbits($ainfo[5], $pdata)
								If NOT @error Then
									$ainfo[0] = 0
									$ainfo[1] = $ibytes
									$ainfo[2] = 0
									$ainfo[3] = $pdata
									$ainfo[6] = 0
								EndIf
							EndIf
						EndIf
					Case Else
						$ierror = 60
				EndSwitch
				If NOT $ierror Then
					$tdata = DllStructCreate("byte Width;byte Height;byte ColorCount;byte Reserved;ushort Planes;ushort BitCount;long Size;long Offset", DllStructGetPtr($tico) + 6 + 16 * $iindex)
					DllStructSetData($tdata, "ColorCount", 0)
					DllStructSetData($tdata, "Reserved", 0)
					DllStructSetData($tdata, "Planes", 1)
					DllStructSetData($tdata, "BitCount", $ainfo[7])
					DllStructSetData($tdata, "Size", $ainfo[0] + $ainfo[1] + $ainfo[6])
					DllStructSetData($tdata, "Offset", $ioffset)
					For $i = 0 To 1
						$asize[$i] = DllStructGetData($tdib, $i + 2)
						If $asize[$i] < 256 Then
							DllStructSetData($tdata, $i + 1, $asize[$i])
						Else
							DllStructSetData($tdata, $i + 1, 0)
						EndIf
					Next
					DllStructSetData($tbi, "biWidth", $asize[0])
					DllStructSetData($tbi, "biHeight", 2 * $asize[1])
					DllStructSetData($tbi, "biBitCount", $ainfo[7])
					DllStructSetData($tbi, "biCompression", 0)
					DllStructSetData($tbi, "biSizeImage", $ainfo[0] + $ainfo[1])
					$ioffset += $ainfo[0] + $ainfo[1] + $ainfo[6]
					Do
						If $ainfo[6] Then
							If NOT _winapi_writefile($hfile, $tbi, $ainfo[6], $ibytes) Then
								$ierror = @error + 70
								ExitLoop
							EndIf
							For $i = 1 To 0 Step -1
								If NOT _winapi_writefile($hfile, $ainfo[$i + 2], $ainfo[$i], $ibytes) Then
									$ierror = @error + 80
									ExitLoop 2
								EndIf
							Next
						Else
							If NOT _winapi_writefile($hfile, $ainfo[3], $ainfo[1], $ibytes) Then
								$ierror = @error + 90
								ExitLoop
							EndIf
						EndIf
					Until 1
				EndIf
				For $i = 4 To 5
					_winapi_deleteobject($ainfo[$i])
				Next
				If $ierror Then
					ExitLoop 2
				EndIf
				$iindex += 1
			WEnd
			$aret = DllCall("kernel32.dll", "bool", "SetFilePointerEx", "handle", $hfile, "int64", 0, "int64*", 0, "dword", 0)
			If @error OR NOT $aret[0] Then
				$ierror = @error + 100
				ExitLoop
			EndIf
			If NOT _winapi_writefile($hfile, $tico, $ilength, $ibytes) Then
				$ierror = @error + 110
				ExitLoop
			EndIf
			$iresult = 1
		Until 1
		For $i = 0 To $icount - 1
			If $atemp[$i] Then
				_winapi_destroyicon($atemp[$i])
			EndIf
		Next
		If $pdata Then
			__heapfree($pdata)
		EndIf
		_winapi_closehandle($hfile)
		If NOT $iresult Then
			FileDelete($sfilepath)
		EndIf
		Return SetError($ierror, 0, $iresult)
	EndFunc

	Func _winapi_scalewindowext($hdc, $ixnum, $ixdenom, $iynum, $iydenom)
		$__g_vext = DllStructCreate($tagsize)
		Local $aret = DllCall("gdi32.dll", "bool", "ScaleWindowExtEx", "handle", $hdc, "int", $ixnum, "int", $ixdenom, "int", $iynum, "int", $iydenom, "struct*", $__g_vext)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_selectclippath($hdc, $imode = 5)
		Local $aret = DllCall("gdi32.dll", "bool", "SelectClipPath", "handle", $hdc, "int", $imode)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_selectcliprgn($hdc, $hrgn)
		Local $aret = DllCall("gdi32.dll", "int", "SelectClipRgn", "handle", $hdc, "handle", $hrgn)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setarcdirection($hdc, $idirection)
		Local $aret = DllCall("gdi32.dll", "int", "SetArcDirection", "handle", $hdc, "int", $idirection)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setbitmapbits($hbitmap, $isize, $pbits)
		Local $aret = DllCall("gdi32.dll", "long", "SetBitmapBits", "handle", $hbitmap, "dword", $isize, "struct*", $pbits)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setbitmapdimensionex($hbitmap, $iwidth, $iheight)
		$__g_vext = DllStructCreate($tagsize)
		Local $aret = DllCall("gdi32.dll", "bool", "SetBitmapDimensionEx", "handle", $hbitmap, "int", $iwidth, "int", $iheight, "struct*", $__g_vext)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setboundsrect($hdc, $iflags, $trect = 0)
		Local $aret = DllCall("gdi32.dll", "uint", "SetBoundsRect", "handle", $hdc, "struct*", $trect, "uint", $iflags)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setbrushorg($hdc, $ix, $iy)
		$__g_vext = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "bool", "SetBrushOrgEx", "handle", $hdc, "int", $ix, "int", $iy, "struct*", $__g_vext)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setcoloradjustment($hdc, $tadjustment)
		Local $aret = DllCall("gdi32.dll", "bool", "SetColorAdjustment", "handle", $hdc, "struct*", $tadjustment)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setdcbrushcolor($hdc, $irgb)
		Local $aret = DllCall("gdi32.dll", "dword", "SetDCBrushColor", "handle", $hdc, "dword", __rgb($irgb))
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_setdcpencolor($hdc, $irgb)
		Local $aret = DllCall("gdi32.dll", "dword", "SetDCPenColor", "handle", $hdc, "dword", __rgb($irgb))
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error, @extended, -1)
		Return __rgb($aret[0])
	EndFunc

	Func _winapi_setdevicegammaramp($hdc, Const ByRef $aramp)
		If (UBound($aramp, $ubound_dimensions) <> 2) OR (UBound($aramp, $ubound_rows) <> 256) OR (UBound($aramp, $ubound_columns) <> 3) Then
			Return SetError(12, 0, 0)
		EndIf
		Local $tdata = DllStructCreate("ushort[256];ushort[256];ushort[256]")
		For $i = 0 To 2
			For $j = 0 To 255
				DllStructSetData($tdata, $i + 1, $aramp[$j][$i], $j + 1)
			Next
		Next
		Local $aret = DllCall("gdi32.dll", "bool", "SetDeviceGammaRamp", "handle", $hdc, "struct*", $tdata)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setdibcolortable($hbitmap, $tcolortable, $icolorcount)
		If $icolorcount > DllStructGetSize($tcolortable) / 4 Then Return SetError(1, 0, 0)
		Local $hdc = _winapi_createcompatibledc(0)
		Local $hsv = _winapi_selectobject($hdc, $hbitmap)
		Local $ierror = 0
		Local $aret = DllCall("gdi32.dll", "uint", "SetDIBColorTable", "handle", $hdc, "uint", 0, "uint", $icolorcount, "struct*", $tcolortable)
		If @error Then $ierror = @error
		_winapi_selectobject($hdc, $hsv)
		_winapi_deletedc($hdc)
		If $ierror Then Return SetError($ierror, 0, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setdibits($hdc, $hbitmap, $istartscan, $iscanlines, $pbits, $tbmi, $icoloruse = 0)
		Local $aresult = DllCall("gdi32.dll", "int", "SetDIBits", "handle", $hdc, "handle", $hbitmap, "uint", $istartscan, "uint", $iscanlines, "struct*", $pbits, "struct*", $tbmi, "INT", $icoloruse)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _winapi_setdibitstodevice($hdc, $ixdest, $iydest, $iwidth, $iheight, $ixsrc, $iysrc, $istartscan, $iscanlines, $tbitmapinfo, $iusage, $pbits)
		Local $aret = DllCall("gdi32.dll", "int", "SetDIBitsToDevice", "handle", $hdc, "int", $ixdest, "int", $iydest, "dword", $iwidth, "dword", $iheight, "int", $ixsrc, "int", $iysrc, "uint", $istartscan, "uint", $iscanlines, "struct*", $pbits, "struct*", $tbitmapinfo, "uint", $iusage)
		If @error OR ($aret[0] = -1) Then Return SetError(@error + 10, $aret[0], 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setenhmetafilebits($pdata, $ilength)
		Local $aret = DllCall("gdi32.dll", "handle", "SetEnhMetaFileBits", "uint", $ilength, "struct*", $pdata)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setgraphicsmode($hdc, $imode)
		Local $aret = DllCall("gdi32.dll", "int", "SetGraphicsMode", "handle", $hdc, "int", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setmapmode($hdc, $imode)
		Local $aret = DllCall("gdi32.dll", "int", "SetMapMode", "handle", $hdc, "int", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setpixel($hdc, $ix, $iy, $irgb)
		Local $aret = DllCall("gdi32.dll", "bool", "SetPixelV", "handle", $hdc, "int", $ix, "int", $iy, "dword", __rgb($irgb))
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setpolyfillmode($hdc, $imode = 1)
		Local $aret = DllCall("gdi32.dll", "int", "SetPolyFillMode", "handle", $hdc, "int", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setrectrgn($hrgn, $trect)
		Local $aret = DllCall("gdi32.dll", "bool", "SetRectRgn", "handle", $hrgn, "int", DllStructGetData($trect, 1), "int", DllStructGetData($trect, 2), "int", DllStructGetData($trect, 3), "int", DllStructGetData($trect, 4))
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setrop2($hdc, $imode)
		Local $aret = DllCall("gdi32.dll", "int", "SetROP2", "handle", $hdc, "int", $imode)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_setstretchbltmode($hdc, $imode)
		Local $aret = DllCall("gdi32.dll", "int", "SetStretchBltMode", "handle", $hdc, "int", $imode)
		If @error OR NOT $aret[0] OR ($aret[0] = 87) Then Return SetError(@error + 10, $aret[0], 0)
		Return $aret[0]
	EndFunc

	Func _winapi_settextalign($hdc, $imode = 0)
		Local $aret = DllCall("gdi32.dll", "uint", "SetTextAlign", "handle", $hdc, "uint", $imode)
		If @error OR ($aret[0] = 4294967295) Then Return SetError(@error, @extended, -1)
		Return $aret[0]
	EndFunc

	Func _winapi_settextcharacterextra($hdc, $icharextra)
		Local $aret = DllCall("gdi32.dll", "int", "SetTextCharacterExtra", "handle", $hdc, "int", $icharextra)
		If @error OR ($aret[0] = -2147483648) Then Return SetError(@error, @extended, -1)
		Return $aret[0]
	EndFunc

	Func _winapi_settextjustification($hdc, $ibreakextra, $ibreakcount)
		Local $aret = DllCall("gdi32.dll", "bool", "SetTextJustification", "handle", $hdc, "int", $ibreakextra, "int", $ibreakcount)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setudfcolormode($imode)
		$__g_irgbmode = NOT ($imode = 0)
	EndFunc

	Func _winapi_setwindowext($hdc, $ixextent, $iyextent)
		$__g_vext = DllStructCreate($tagsize)
		Local $aret = DllCall("gdi32.dll", "bool", "SetWindowExtEx", "handle", $hdc, "int", $ixextent, "int", $iyextent, "struct*", $__g_vext)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setwindoworg($hdc, $ix, $iy)
		$__g_vext = DllStructCreate($tagpoint)
		Local $aret = DllCall("gdi32.dll", "bool", "SetWindowOrgEx", "handle", $hdc, "int", $ix, "int", $iy, "struct*", $__g_vext)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_setworldtransform($hdc, ByRef $txform)
		Local $aret = DllCall("gdi32.dll", "bool", "SetWorldTransform", "handle", $hdc, "struct*", $txform)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_stretchblt($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $hsrcdc, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $irop)
		Local $aret = DllCall("gdi32.dll", "bool", "StretchBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "hwnd", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "dword", $irop)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_stretchdibits($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $tbitmapinfo, $iusage, $pbits, $irop)
		Local $aret = DllCall("gdi32.dll", "int", "StretchDIBits", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "struct*", $pbits, "struct*", $tbitmapinfo, "uint", $iusage, "dword", $irop)
		If @error OR ($aret[0] = -1) Then Return SetError(@error + 10, $aret[0], 0)
		Return $aret[0]
	EndFunc

	Func _winapi_strokeandfillpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "StrokeAndFillPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_strokepath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "StrokePath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_subtractrect(ByRef $trect1, ByRef $trect2)
		Local $trect = DllStructCreate($tagrect)
		Local $aret = DllCall("user32.dll", "bool", "SubtractRect", "struct*", $trect, "struct*", $trect1, "struct*", $trect2)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, 0)
		Return $trect
	EndFunc

	Func _winapi_tabbedtextout($hdc, $ix, $iy, $stext, $atab = 0, $istart = 0, $iend = -1, $iorigin = 0)
		Local $itab, $icount
		If NOT IsArray($atab) Then
			If $atab Then
				$itab = $atab
				Dim $atab[1] = [$itab]
				$istart = 0
				$iend = 0
				$icount = 1
			Else
				$icount = 0
			EndIf
		Else
			$icount = 1
		EndIf
		Local $ttab = 0
		If $icount Then
			If __checkerrorarraybounds($atab, $istart, $iend) Then Return SetError(@error + 10, @extended, 0)
			$icount = $iend - $istart + 1
			$ttab = DllStructCreate("uint[" & $icount & "]")
			$itab = 1
			For $i = $istart To $iend
				DllStructSetData($ttab, 1, $atab[$i], $itab)
				$itab += 1
			Next
		EndIf
		Local $aret = DllCall("user32.dll", "long", "TabbedTextOutW", "handle", $hdc, "int", $ix, "int", $iy, "wstr", $stext, "int", StringLen($stext), "int", $icount, "struct*", $ttab, "int", $iorigin)
		If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
		$__g_vext = _winapi_createsize(_winapi_loword($aret[0]), _winapi_hiword($aret[0]))
		Return 1
	EndFunc

	Func _winapi_textout($hdc, $ix, $iy, $stext)
		Local $aret = DllCall("gdi32.dll", "bool", "TextOutW", "handle", $hdc, "int", $ix, "int", $iy, "wstr", $stext, "int", StringLen($stext))
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_transparentblt($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $hsrcdc, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $irgb)
		Local $aret = DllCall("gdi32.dll", "bool", "GdiTransparentBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "hwnd", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "dword", __rgb($irgb))
		If @error Then Return SetError(@error, @extended, False)
		Return $aret[0]
	EndFunc

	Func _winapi_unionrect(ByRef $trect1, ByRef $trect2)
		Local $trect = DllStructCreate($tagrect)
		Local $aret = DllCall("user32.dll", "bool", "UnionRect", "struct*", $trect, "struct*", $trect1, "struct*", $trect2)
		If @error OR NOT $aret[0] Then Return SetError(@error + 10, 0, 0)
		Return $trect
	EndFunc

	Func _winapi_validaterect($hwnd, $trect = 0)
		Local $aret = DllCall("user32.dll", "bool", "ValidateRect", "hwnd", $hwnd, "struct*", $trect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_validatergn($hwnd, $hrgn = 0)
		Local $aret = DllCall("user32.dll", "bool", "ValidateRgn", "hwnd", $hwnd, "handle", $hrgn)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_widenpath($hdc)
		Local $aret = DllCall("gdi32.dll", "bool", "WidenPath", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

	Func _winapi_windowfromdc($hdc)
		Local $aret = DllCall("user32.dll", "hwnd", "WindowFromDC", "handle", $hdc)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aret[0]
	EndFunc

#EndRegion Public Functions
#Region Internal Functions

	Func __enumdisplaymonitorsproc($hmonitor, $hdc, $prect, $lparam)
		#forceref $hDC, $lParam
		__inc($__g_venum)
		$__g_venum[$__g_venum[0][0]][0] = $hmonitor
		If NOT $prect Then
			$__g_venum[$__g_venum[0][0]][1] = 0
		Else
			$__g_venum[$__g_venum[0][0]][1] = DllStructCreate($tagrect)
			If NOT _winapi_movememory(DllStructGetPtr($__g_venum[$__g_venum[0][0]][1]), $prect, 16) Then Return 0
		EndIf
		Return 1
	EndFunc

	Func __enumfontfamiliesproc($pelfex, $pntmex, $ifonttype, $ppattern)
		Local $telfex = DllStructCreate($taglogfont & ";wchar FullName[64];wchar Style[32];wchar Script[32]", $pelfex)
		Local $tntmex = DllStructCreate($tagnewtextmetricex, $pntmex)
		Local $tpattern = DllStructCreate("uint;uint;ptr", $ppattern)
		If $ifonttype AND NOT BitAND($ifonttype, DllStructGetData($tpattern, 1)) Then
			Return 1
		EndIf
		If DllStructGetData($tpattern, 3) Then
			Local $aret = DllCall("shlwapi.dll", "bool", "PathMatchSpecW", "ptr", DllStructGetPtr($telfex, 14), "ptr", DllStructGetData($tpattern, 3))
			If NOT @error Then
				If DllStructGetData($tpattern, 2) Then
					If $aret[0] Then
						Return 1
					Else
					EndIf
				Else
					If $aret[0] Then
					Else
						Return 1
					EndIf
				EndIf
			EndIf
		EndIf
		__inc($__g_venum)
		$__g_venum[$__g_venum[0][0]][0] = DllStructGetData($telfex, 14)
		$__g_venum[$__g_venum[0][0]][1] = DllStructGetData($telfex, 16)
		$__g_venum[$__g_venum[0][0]][2] = DllStructGetData($telfex, 15)
		$__g_venum[$__g_venum[0][0]][3] = DllStructGetData($telfex, 17)
		$__g_venum[$__g_venum[0][0]][4] = $ifonttype
		$__g_venum[$__g_venum[0][0]][5] = DllStructGetData($tntmex, 19)
		$__g_venum[$__g_venum[0][0]][6] = DllStructGetData($tntmex, 20)
		$__g_venum[$__g_venum[0][0]][7] = DllStructGetData($tntmex, 21)
		Return 1
	EndFunc

	Func __enumfontstylesproc($pelfex, $pntmex, $ifonttype, $pfn)
		#forceref $iFontType
		Local $telfex = DllStructCreate($taglogfont & ";wchar FullName[64];wchar Style[32];wchar Script[32]", $pelfex)
		Local $tntmex = DllStructCreate($tagnewtextmetricex, $pntmex)
		Local $tfn = DllStructCreate("dword;wchar[64]", $pfn)
		If BitAND(DllStructGetData($tntmex, "ntmFlags"), 97) = DllStructGetData($tfn, 1) Then
			DllStructSetData($tfn, 2, DllStructGetData($telfex, "FullName"))
			Return 0
		Else
			Return 1
		EndIf
	EndFunc

#EndRegion Internal Functions
Global $__g_hgdipbrush = 0
Global $__g_hgdipdll = 0
Global $__g_hgdippen = 0
Global $__g_igdipref = 0
Global $__g_igdiptoken = 0
Global $__g_bgdip_v1_0 = True

Func _gdiplus_arrowcapcreate($fheight, $fwidth, $bfilled = True)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateAdjustableArrowCap", "float", $fheight, "float", $fwidth, "bool", $bfilled, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_arrowcapdispose($hcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteCustomLineCap", "handle", $hcap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_arrowcapgetfillstate($harrowcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapFillState", "handle", $harrowcap, "bool*", 0)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_arrowcapgetheight($harrowcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapHeight", "handle", $harrowcap, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_arrowcapgetmiddleinset($harrowcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapMiddleInset", "handle", $harrowcap, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_arrowcapgetwidth($harrowcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapWidth", "handle", $harrowcap, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_arrowcapsetfillstate($harrowcap, $bfilled = True)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapFillState", "handle", $harrowcap, "bool", $bfilled)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_arrowcapsetheight($harrowcap, $fheight)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapHeight", "handle", $harrowcap, "float", $fheight)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_arrowcapsetmiddleinset($harrowcap, $finset)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapMiddleInset", "handle", $harrowcap, "float", $finset)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_arrowcapsetwidth($harrowcap, $fwidth)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapWidth", "handle", $harrowcap, "float", $fwidth)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapclonearea($hbitmap, $nleft, $ntop, $nwidth, $nheight, $iformat = 137224)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCloneBitmapArea", "float", $nleft, "float", $ntop, "float", $nwidth, "float", $nheight, "int", $iformat, "handle", $hbitmap, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[7]
EndFunc

Func _gdiplus_bitmapcreatedibfrombitmap($hbitmap)
	Local $aret = DllCall($__g_hgdipdll, "uint", "GdipGetImageDimension", "handle", $hbitmap, "float*", 0, "float*", 0)
	If @error OR $aret[0] Then Return SetError(@error + 10, $aret[0], 0)
	Local $tdata = _gdiplus_bitmaplockbits($hbitmap, 0, 0, $aret[2], $aret[3], $gdip_ilmread, $gdip_pxf32argb)
	Local $pbits = DllStructGetData($tdata, "Scan0")
	If NOT $pbits Then Return 0
	Local $tbihdr = DllStructCreate($tagbitmapv5header)
	DllStructSetData($tbihdr, "bV5Size", DllStructGetSize($tbihdr))
	DllStructSetData($tbihdr, "bV5Width", $aret[2])
	DllStructSetData($tbihdr, "bV5Height", $aret[3])
	DllStructSetData($tbihdr, "bV5Planes", 1)
	DllStructSetData($tbihdr, "bV5BitCount", 32)
	DllStructSetData($tbihdr, "bV5Compression", 0)
	DllStructSetData($tbihdr, "bV5SizeImage", $aret[3] * DllStructGetData($tdata, "Stride"))
	DllStructSetData($tbihdr, "bV5AlphaMask", -16777216)
	DllStructSetData($tbihdr, "bV5RedMask", 16711680)
	DllStructSetData($tbihdr, "bV5GreenMask", 65280)
	DllStructSetData($tbihdr, "bV5BlueMask", 255)
	DllStructSetData($tbihdr, "bV5CSType", 2)
	DllStructSetData($tbihdr, "bV5Intent", 4)
	Local $hhbitmapv5 = DllCall("gdi32.dll", "ptr", "CreateDIBSection", "hwnd", 0, "struct*", $tbihdr, "uint", 0, "ptr*", 0, "ptr", 0, "dword", 0)
	If NOT @error AND $hhbitmapv5[0] Then
		DllCall("gdi32.dll", "dword", "SetBitmapBits", "ptr", $hhbitmapv5[0], "dword", $aret[2] * $aret[3] * 4, "ptr", DllStructGetData($tdata, "Scan0"))
		$hhbitmapv5 = $hhbitmapv5[0]
	Else
		$hhbitmapv5 = 0
	EndIf
	_gdiplus_bitmapunlockbits($hbitmap, $tdata)
	$tdata = 0
	$tbihdr = 0
	Return $hhbitmapv5
EndFunc

Func _gdiplus_bitmapcreatefromfile($sfilename)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateBitmapFromFile", "wstr", $sfilename, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_bitmapcreatefromgraphics($iwidth, $iheight, $hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateBitmapFromGraphics", "int", $iwidth, "int", $iheight, "handle", $hgraphics, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_bitmapcreatefromhbitmap($hbitmap, $hpal = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateBitmapFromHBITMAP", "handle", $hbitmap, "handle", $hpal, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_bitmapcreatefrommemory($dimage, $bhbitmap = False)
	If NOT IsBinary($dimage) Then Return SetError(1, 0, 0)
	Local $aresult = 0
	Local Const $dmembitmap = Binary($dimage)
	Local Const $ilen = BinaryLen($dmembitmap)
	Local Const $gmem_moveable = 2
	$aresult = DllCall("kernel32.dll", "handle", "GlobalAlloc", "uint", $gmem_moveable, "ulong_ptr", $ilen)
	If @error Then Return SetError(4, 0, 0)
	Local Const $hdata = $aresult[0]
	$aresult = DllCall("kernel32.dll", "ptr", "GlobalLock", "handle", $hdata)
	If @error Then Return SetError(5, 0, 0)
	Local $tmem = DllStructCreate("byte[" & $ilen & "]", $aresult[0])
	DllStructSetData($tmem, 1, $dmembitmap)
	DllCall("kernel32.dll", "bool", "GlobalUnlock", "handle", $hdata)
	If @error Then Return SetError(6, 0, 0)
	Local Const $hstream = _winapi_createstreamonhglobal($hdata)
	If @error Then Return SetError(2, 0, 0)
	Local Const $hbitmap = _gdiplus_bitmapcreatefromstream($hstream)
	If @error Then Return SetError(3, 0, 0)
	DllCall("oleaut32.dll", "long", "DispCallFunc", "ptr", $hstream, "ulong_ptr", 8 * (1 + @AutoItX64), "uint", 4, "ushort", 23, "uint", 0, "ptr", 0, "ptr", 0, "str", "")
	If $bhbitmap Then
		Local Const $hhbmp = _gdiplus_bitmapcreatedibfrombitmap($hbitmap)
		_gdiplus_bitmapdispose($hbitmap)
		Return $hhbmp
	EndIf
	Return $hbitmap
EndFunc

Func _gdiplus_bitmapcreatefromresource($hinst, $vresourcename)
	Local $stype = "int"
	If IsString($vresourcename) Then $stype = "wstr"
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateBitmapFromResource", "handle", $hinst, $stype, $vresourcename, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_bitmapcreatefromscan0($iwidth, $iheight, $ipixelformat = $gdip_pxf32argb, $istride = 0, $pscan0 = 0)
	Local $aresult = DllCall($__g_hgdipdll, "uint", "GdipCreateBitmapFromScan0", "int", $iwidth, "int", $iheight, "int", $istride, "int", $ipixelformat, "struct*", $pscan0, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[6]
EndFunc

Func _gdiplus_bitmapcreatefromstream($pstream)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateBitmapFromStream", "ptr", $pstream, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_bitmapcreatehbitmapfrombitmap($hbitmap, $iargb = -16777216)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateHBITMAPFromBitmap", "handle", $hbitmap, "handle*", 0, "dword", $iargb)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_bitmapdispose($hbitmap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDisposeImage", "handle", $hbitmap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapcreatefromhicon($hicon)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateBitmapFromHICON", "handle", $hicon, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_bitmapcreatefromhicon32($hicon)
	Local $tsize = _winapi_geticondimension($hicon)
	Local $iwidth = DllStructGetData($tsize, "X")
	Local $iheight = DllStructGetData($tsize, "Y")
	If $iwidth <= 0 OR $iheight <= 0 Then Return SetError(10, -1, 0)
	Local $tbitmapinfo = DllStructCreate("dword Size;long Width;long Height;word Planes;word BitCount;dword Compression;dword SizeImage;long XPelsPerMeter;long YPelsPerMeter;dword ClrUsed;dword ClrImportant;dword RGBQuad")
	DllStructSetData($tbitmapinfo, "Size", DllStructGetSize($tbitmapinfo) - 4)
	DllStructSetData($tbitmapinfo, "Width", $iwidth)
	DllStructSetData($tbitmapinfo, "Height", -$iheight)
	DllStructSetData($tbitmapinfo, "Planes", 1)
	DllStructSetData($tbitmapinfo, "BitCount", 32)
	DllStructSetData($tbitmapinfo, "Compression", 0)
	DllStructSetData($tbitmapinfo, "SizeImage", 0)
	Local $hdc = _winapi_createcompatibledc(0)
	Local $pbits
	Local $hbmp = _winapi_createdibsection(0, $tbitmapinfo, 0, $pbits)
	Local $horig = _winapi_selectobject($hdc, $hbmp)
	_winapi_drawiconex($hdc, 0, 0, $hicon, $iwidth, $iheight)
	Local $hbitmapicon = _gdiplus_bitmapcreatefromscan0($iwidth, $iheight, $gdip_pxf32argb, $iwidth * 4, $pbits)
	Local $hbitmap = _gdiplus_bitmapcreatefromscan0($iwidth, $iheight)
	Local $hcontext = _gdiplus_imagegetgraphicscontext($hbitmap)
	_gdiplus_graphicsdrawimage($hcontext, $hbitmapicon, 0, 0)
	_gdiplus_graphicsdispose($hcontext)
	_gdiplus_bitmapdispose($hbitmapicon)
	_winapi_selectobject($hdc, $horig)
	_winapi_deletedc($hdc)
	_winapi_deleteobject($hbmp)
	Return $hbitmap
EndFunc

Func _gdiplus_bitmapgetpixel($hbitmap, $ix, $iy)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapGetPixel", "handle", $hbitmap, "int", $ix, "int", $iy, "uint*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_bitmaplockbits($hbitmap, $ileft, $itop, $iwidth, $iheight, $iflags = $gdip_ilmread, $iformat = $gdip_pxf32rgb)
	Local $tdata = DllStructCreate($taggdipbitmapdata)
	Local $trect = DllStructCreate($tagrect)
	DllStructSetData($trect, "Left", $ileft)
	DllStructSetData($trect, "Top", $itop)
	DllStructSetData($trect, "Right", $iwidth)
	DllStructSetData($trect, "Bottom", $iheight)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapLockBits", "handle", $hbitmap, "struct*", $trect, "uint", $iflags, "int", $iformat, "struct*", $tdata)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $tdata
EndFunc

Func _gdiplus_bitmapsetpixel($hbitmap, $ix, $iy, $iargb)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapSetPixel", "handle", $hbitmap, "int", $ix, "int", $iy, "uint", $iargb)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapsetresolution($hbitmap, $fdpix, $fdpiy)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapSetResolution", "handle", $hbitmap, "float", $fdpix, "float", $fdpiy)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapunlockbits($hbitmap, $tbitmapdata)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapUnlockBits", "handle", $hbitmap, "struct*", $tbitmapdata)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_brushclone($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCloneBrush", "handle", $hbrush, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_brushcreatesolid($iargb = -16777216)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateSolidFill", "int", $iargb, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_brushdispose($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteBrush", "handle", $hbrush)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_brushgetsolidcolor($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetSolidFillColor", "handle", $hbrush, "dword*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_brushgettype($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetBrushType", "handle", $hbrush, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_brushsetsolidcolor($hbrush, $iargb = -16777216)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetSolidFillColor", "handle", $hbrush, "dword", $iargb)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_colormatrixcreate()
	Return _gdiplus_colormatrixcreatescale(1, 1, 1, 1)
EndFunc

Func _gdiplus_colormatrixcreategrayscale()
	Local $ii, $ij, $tcm, $alums[4] = [$gdip_rlum, $gdip_glum, $gdip_blum, 0]
	$tcm = DllStructCreate($taggdipcolormatrix)
	For $ii = 0 To 3
		For $ij = 1 To 3
			DllStructSetData($tcm, "m", $alums[$ii], $ii * 5 + $ij)
		Next
	Next
	DllStructSetData($tcm, "m", 1, 19)
	DllStructSetData($tcm, "m", 1, 25)
	Return $tcm
EndFunc

Func _gdiplus_colormatrixcreatenegative()
	Local $ii, $tcm
	$tcm = _gdiplus_colormatrixcreatescale(-1, -1, -1, 1)
	For $ii = 1 To 4
		DllStructSetData($tcm, "m", 1, 20 + $ii)
	Next
	Return $tcm
EndFunc

Func _gdiplus_colormatrixcreatesaturation($fsat)
	Local $fsatcomp, $tcm
	$tcm = DllStructCreate($taggdipcolormatrix)
	$fsatcomp = (1 - $fsat)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_rlum + $fsat, 1)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_rlum, 2)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_rlum, 3)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_glum, 6)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_glum + $fsat, 7)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_glum, 8)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_blum, 11)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_blum, 12)
	DllStructSetData($tcm, "m", $fsatcomp * $gdip_blum + $fsat, 13)
	DllStructSetData($tcm, "m", 1, 19)
	DllStructSetData($tcm, "m", 1, 25)
	Return $tcm
EndFunc

Func _gdiplus_colormatrixcreatescale($fred, $fgreen, $fblue, $falpha = 1)
	Local $tcm
	$tcm = DllStructCreate($taggdipcolormatrix)
	DllStructSetData($tcm, "m", $fred, 1)
	DllStructSetData($tcm, "m", $fgreen, 7)
	DllStructSetData($tcm, "m", $fblue, 13)
	DllStructSetData($tcm, "m", $falpha, 19)
	DllStructSetData($tcm, "m", 1, 25)
	Return $tcm
EndFunc

Func _gdiplus_colormatrixcreatetranslate($fred, $fgreen, $fblue, $falpha = 0)
	Local $ii, $tcm, $afactors[4] = [$fred, $fgreen, $fblue, $falpha]
	$tcm = _gdiplus_colormatrixcreate()
	For $ii = 0 To 3
		DllStructSetData($tcm, "m", $afactors[$ii], 21 + $ii)
	Next
	Return $tcm
EndFunc

Func _gdiplus_customlinecapclone($hcustomlinecap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCloneCustomLineCap", "handle", $hcustomlinecap, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_customlinecapcreate($hpathfill, $hpathstroke, $ilinecap = 0, $nbaseinset = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateCustomLineCap", "handle", $hpathfill, "handle", $hpathstroke, "int", $ilinecap, "float", $nbaseinset, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[5]
EndFunc

Func _gdiplus_customlinecapdispose($hcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteCustomLineCap", "handle", $hcap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_customlinecapgetstrokecaps($hcustomlinecap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetCustomLineCapStrokeCaps", "hwnd", $hcustomlinecap, "ptr*", 0, "ptr*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then SetError(10, $aresult[0], 0)
	Local $acaps[2]
	$acaps[0] = $aresult[2]
	$acaps[1] = $aresult[3]
	Return $acaps
EndFunc

Func _gdiplus_customlinecapsetstrokecaps($hcustomlinecap, $istartcap, $iendcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetCustomLineCapStrokeCaps", "handle", $hcustomlinecap, "int", $istartcap, "int", $iendcap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_decoders()
	Local $icount = _gdiplus_decodersgetcount()
	Local $isize = _gdiplus_decodersgetsize()
	Local $tbuffer = DllStructCreate("byte[" & $isize & "]")
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageDecoders", "uint", $icount, "uint", $isize, "struct*", $tbuffer)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Local $pbuffer = DllStructGetPtr($tbuffer)
	Local $tcodec, $ainfo[$icount + 1][14]
	$ainfo[0][0] = $icount
	For $ii = 1 To $icount
		$tcodec = DllStructCreate($taggdipimagecodecinfo, $pbuffer)
		$ainfo[$ii][1] = _winapi_stringfromguid(DllStructGetPtr($tcodec, "CLSID"))
		$ainfo[$ii][2] = _winapi_stringfromguid(DllStructGetPtr($tcodec, "FormatID"))
		$ainfo[$ii][3] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "CodecName"))
		$ainfo[$ii][4] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "DllName"))
		$ainfo[$ii][5] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "FormatDesc"))
		$ainfo[$ii][6] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "FileExt"))
		$ainfo[$ii][7] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "MimeType"))
		$ainfo[$ii][8] = DllStructGetData($tcodec, "Flags")
		$ainfo[$ii][9] = DllStructGetData($tcodec, "Version")
		$ainfo[$ii][10] = DllStructGetData($tcodec, "SigCount")
		$ainfo[$ii][11] = DllStructGetData($tcodec, "SigSize")
		$ainfo[$ii][12] = DllStructGetData($tcodec, "SigPattern")
		$ainfo[$ii][13] = DllStructGetData($tcodec, "SigMask")
		$pbuffer += DllStructGetSize($tcodec)
	Next
	Return $ainfo
EndFunc

Func _gdiplus_decodersgetcount()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageDecodersSize", "uint*", 0, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[1]
EndFunc

Func _gdiplus_decodersgetsize()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageDecodersSize", "uint*", 0, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_drawimagepoints($hgraphic, $himage, $nulx, $nuly, $nurx, $nury, $nllx, $nlly, $icount = 3)
	Local $tpoint = DllStructCreate("float X;float Y;float X2;float Y2;float X3;float Y3")
	DllStructSetData($tpoint, "X", $nulx)
	DllStructSetData($tpoint, "Y", $nuly)
	DllStructSetData($tpoint, "X2", $nurx)
	DllStructSetData($tpoint, "Y2", $nury)
	DllStructSetData($tpoint, "X3", $nllx)
	DllStructSetData($tpoint, "Y3", $nlly)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawImagePoints", "handle", $hgraphic, "handle", $himage, "struct*", $tpoint, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_encoders()
	Local $icount = _gdiplus_encodersgetcount()
	Local $isize = _gdiplus_encodersgetsize()
	Local $tbuffer = DllStructCreate("byte[" & $isize & "]")
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageEncoders", "uint", $icount, "uint", $isize, "struct*", $tbuffer)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Local $pbuffer = DllStructGetPtr($tbuffer)
	Local $tcodec, $ainfo[$icount + 1][14]
	$ainfo[0][0] = $icount
	For $ii = 1 To $icount
		$tcodec = DllStructCreate($taggdipimagecodecinfo, $pbuffer)
		$ainfo[$ii][1] = _winapi_stringfromguid(DllStructGetPtr($tcodec, "CLSID"))
		$ainfo[$ii][2] = _winapi_stringfromguid(DllStructGetPtr($tcodec, "FormatID"))
		$ainfo[$ii][3] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "CodecName"))
		$ainfo[$ii][4] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "DllName"))
		$ainfo[$ii][5] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "FormatDesc"))
		$ainfo[$ii][6] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "FileExt"))
		$ainfo[$ii][7] = _winapi_widechartomultibyte(DllStructGetData($tcodec, "MimeType"))
		$ainfo[$ii][8] = DllStructGetData($tcodec, "Flags")
		$ainfo[$ii][9] = DllStructGetData($tcodec, "Version")
		$ainfo[$ii][10] = DllStructGetData($tcodec, "SigCount")
		$ainfo[$ii][11] = DllStructGetData($tcodec, "SigSize")
		$ainfo[$ii][12] = DllStructGetData($tcodec, "SigPattern")
		$ainfo[$ii][13] = DllStructGetData($tcodec, "SigMask")
		$pbuffer += DllStructGetSize($tcodec)
	Next
	Return $ainfo
EndFunc

Func _gdiplus_encodersgetclsid($sfileextension)
	Local $aencoders = _gdiplus_encoders()
	If @error Then Return SetError(@error, 0, "")
	For $ii = 1 To $aencoders[0][0]
		If StringInStr($aencoders[$ii][6], "*." & $sfileextension) > 0 Then Return $aencoders[$ii][1]
	Next
	Return SetError(-1, -1, "")
EndFunc

Func _gdiplus_encodersgetcount()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageEncodersSize", "uint*", 0, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[1]
EndFunc

Func _gdiplus_encodersgetparamlist($himage, $sencoder)
	Local $isize = _gdiplus_encodersgetparamlistsize($himage, $sencoder)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Local $tguid = _winapi_guidfromstring($sencoder)
	Local $iremainingsize = $isize - 4 - _gdiplus_paramsize()
	Local $tbuffer
	If $iremainingsize Then
		$tbuffer = DllStructCreate("dword Count;" & $taggdipencoderparam & ";byte [" & $iremainingsize & "]")
	Else
		$tbuffer = DllStructCreate("dword Count;" & $taggdipencoderparam)
	EndIf
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetEncoderParameterList", "handle", $himage, "struct*", $tguid, "uint", $isize, "struct*", $tbuffer)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $tbuffer
EndFunc

Func _gdiplus_encodersgetparamlistsize($himage, $sencoder)
	Local $tguid = _winapi_guidfromstring($sencoder)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetEncoderParameterListSize", "handle", $himage, "struct*", $tguid, "uint*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_encodersgetsize()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageEncodersSize", "uint*", 0, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_fontcreate($hfamily, $fsize, $istyle = 0, $iunit = 3)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateFont", "handle", $hfamily, "float", $fsize, "int", $istyle, "int", $iunit, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[5]
EndFunc

Func _gdiplus_fontdispose($hfont)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteFont", "handle", $hfont)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_fontfamilycreate($sfamily, $pcollection = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateFontFamilyFromName", "wstr", $sfamily, "ptr", $pcollection, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_fontfamilycreatefromcollection($sfontname, $hfontcollection)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateFontFamilyFromName", "wstr", $sfontname, "ptr", $hfontcollection, "ptr*", 0)
	If @error Then Return SetError(@error, @extended, "")
	If $aresult[0] Then Return SetError(10, $aresult[0], "")
	Return $aresult[3]
EndFunc

Func _gdiplus_fontfamilydispose($hfamily)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteFontFamily", "handle", $hfamily)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_fontfamilygetcellascent($hfontfamily, $istyle = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetCellAscent", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_fontfamilygetcelldescent($hfontfamily, $istyle = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetCellDescent", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_fontfamilygetemheight($hfontfamily, $istyle = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetEmHeight", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_fontfamilygetlinespacing($hfontfamily, $istyle = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetLineSpacing", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_fontgetheight($hfont, $hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetFontHeight", "handle", $hfont, "handle", $hgraphics, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_fontprivateaddfont($hfontcollection, $sfontfile)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipPrivateAddFontFile", "ptr", $hfontcollection, "wstr", $sfontfile)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_fontprivateaddmemoryfont($hfontcollection, $tfont)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipPrivateAddMemoryFont", "handle", $hfontcollection, "struct*", $tfont, "int", DllStructGetSize($tfont))
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_fontprivatecollectiondispose($hfontcollection)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeletePrivateFontCollection", "handle*", $hfontcollection)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_fontprivatecreatecollection()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipNewPrivateFontCollection", "ptr*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[1]
EndFunc

Func _gdiplus_graphicsclear($hgraphics, $iargb = -16777216)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGraphicsClear", "handle", $hgraphics, "dword", $iargb)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicscreatefromhdc($hdc)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateFromHDC", "handle", $hdc, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicscreatefromhwnd($hwnd)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateFromHWND", "hwnd", $hwnd, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsdispose($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteGraphics", "handle", $hgraphics)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawarc($hgraphics, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawArc", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawbezier($hgraphics, $nx1, $ny1, $nx2, $ny2, $nx3, $ny3, $nx4, $ny4, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawBezier", "handle", $hgraphics, "handle", $hpen, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2, "float", $nx3, "float", $ny3, "float", $nx4, "float", $ny4)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawclosedcurve($hgraphics, $apoints, $hpen = 0)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawClosedCurve", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawclosedcurve2($hgraphics, $apoints, $ntension, $hpen = 0)
	Local $ii, $icount, $tpoints, $aresult
	__gdiplus_pendefcreate($hpen)
	$icount = $apoints[0][0]
	$tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	$aresult = DllCall($__g_hgdipdll, "int", "GdipDrawClosedCurve2", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount, "float", $ntension)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawcurve($hgraphics, $apoints, $hpen = 0)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawCurve", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawcurve2($hgraphics, $apoints, $ntension, $hpen = 0)
	Local $ii, $icount, $tpoints, $aresult
	__gdiplus_pendefcreate($hpen)
	$icount = $apoints[0][0]
	$tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	$aresult = DllCall($__g_hgdipdll, "int", "GdipDrawCurve2", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount, "float", $ntension)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawellipse($hgraphics, $nx, $ny, $nwidth, $nheight, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawEllipse", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawimage($hgraphics, $himage, $nx, $ny)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawImage", "handle", $hgraphics, "handle", $himage, "float", $nx, "float", $ny)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawimagepointsrect($hgraphics, $himage, $nulx, $nuly, $nurx, $nury, $nllx, $nlly, $nsrcx, $nsrcy, $nsrcwidth, $nsrcheight, $himageattributes = 0, $iunit = 2)
	Local $tpoints = DllStructCreate("float X; float Y; float X2; float Y2; float X3; float Y3;")
	DllStructSetData($tpoints, "X", $nulx)
	DllStructSetData($tpoints, "Y", $nuly)
	DllStructSetData($tpoints, "X2", $nurx)
	DllStructSetData($tpoints, "Y2", $nury)
	DllStructSetData($tpoints, "X3", $nllx)
	DllStructSetData($tpoints, "Y3", $nlly)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawImagePointsRect", "handle", $hgraphics, "handle", $himage, "struct*", $tpoints, "int", 3, "float", $nsrcx, "float", $nsrcy, "float", $nsrcwidth, "float", $nsrcheight, "int", $iunit, "handle", $himageattributes, "ptr", 0, "ptr", 0)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawimagerect($hgraphics, $himage, $nx, $ny, $nw, $nh)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawImageRect", "handle", $hgraphics, "handle", $himage, "float", $nx, "float", $ny, "float", $nw, "float", $nh)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawimagerectrect($hgraphics, $himage, $nsrcx, $nsrcy, $nsrcwidth, $nsrcheight, $ndstx, $ndsty, $ndstwidth, $ndstheight, $pattributes = 0, $iunit = 2)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawImageRectRect", "handle", $hgraphics, "handle", $himage, "float", $ndstx, "float", $ndsty, "float", $ndstwidth, "float", $ndstheight, "float", $nsrcx, "float", $nsrcy, "float", $nsrcwidth, "float", $nsrcheight, "int", $iunit, "handle", $pattributes, "ptr", 0, "ptr", 0)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawline($hgraphics, $nx1, $ny1, $nx2, $ny2, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawLine", "handle", $hgraphics, "handle", $hpen, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawpath($hgraphics, $hpath, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawPath", "handle", $hgraphics, "handle", $hpen, "handle", $hpath)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawpie($hgraphics, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawPie", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawpolygon($hgraphics, $apoints, $hpen = 0)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawPolygon", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawrect($hgraphics, $nx, $ny, $nwidth, $nheight, $hpen = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawRectangle", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsdrawstring($hgraphics, $sstring, $nx, $ny, $sfont = "Arial", $fsize = 10, $iformat = 0)
	Local $hbrush = _gdiplus_brushcreatesolid()
	Local $hformat = _gdiplus_stringformatcreate($iformat)
	Local $hfamily = _gdiplus_fontfamilycreate($sfont)
	Local $hfont = _gdiplus_fontcreate($hfamily, $fsize)
	Local $tlayout = _gdiplus_rectfcreate($nx, $ny, 0, 0)
	Local $ainfo = _gdiplus_graphicsmeasurestring($hgraphics, $sstring, $hfont, $tlayout, $hformat)
	If @error Then Return SetError(@error, @extended, 0)
	Local $aresult = _gdiplus_graphicsdrawstringex($hgraphics, $sstring, $hfont, $ainfo[0], $hformat, $hbrush)
	Local $ierror = @error, $iextended = @extended
	_gdiplus_fontdispose($hfont)
	_gdiplus_fontfamilydispose($hfamily)
	_gdiplus_stringformatdispose($hformat)
	_gdiplus_brushdispose($hbrush)
	Return SetError($ierror, $iextended, $aresult)
EndFunc

Func _gdiplus_graphicsdrawstringex($hgraphics, $sstring, $hfont, $tlayout, $hformat, $hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawString", "handle", $hgraphics, "wstr", $sstring, "int", -1, "handle", $hfont, "struct*", $tlayout, "handle", $hformat, "handle", $hbrush)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillclosedcurve($hgraphics, $apoints, $hbrush = 0)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillClosedCurve", "handle", $hgraphics, "handle", $hbrush, "struct*", $tpoints, "int", $icount)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillclosedcurve2($hgraphics, $apoints, $ntension, $hbrush = 0, $ifillmode = 0)
	Local $ii, $icount, $tpoints, $aresult
	__gdiplus_brushdefcreate($hbrush)
	$icount = $apoints[0][0]
	$tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	$aresult = DllCall($__g_hgdipdll, "int", "GdipFillClosedCurve2", "handle", $hgraphics, "handle", $hbrush, "struct*", $tpoints, "int", $icount, "float", $ntension, "int", $ifillmode)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillellipse($hgraphics, $nx, $ny, $nwidth, $nheight, $hbrush = 0)
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillEllipse", "handle", $hgraphics, "handle", $hbrush, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillpath($hgraphics, $hpath, $hbrush = 0)
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillPath", "handle", $hgraphics, "handle", $hbrush, "handle", $hpath)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillpie($hgraphics, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle, $hbrush = 0)
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillPie", "handle", $hgraphics, "handle", $hbrush, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillpolygon($hgraphics, $apoints, $hbrush = 0)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillPolygon", "handle", $hgraphics, "handle", $hbrush, "struct*", $tpoints, "int", $icount, "int", "FillModeAlternate")
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillrect($hgraphics, $nx, $ny, $nwidth, $nheight, $hbrush = 0)
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillRectangle", "handle", $hgraphics, "handle", $hbrush, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsfillregion($hgraphics, $hregion, $hbrush = 0)
	__gdiplus_brushdefcreate($hbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFillRegion", "handle", $hgraphics, "handle", $hbrush, "handle", $hregion)
	__gdiplus_brushdefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsgetcompositingmode($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetCompositingMode", "handle", $hgraphics, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsgetcompositingquality($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetCompositingQuality", "handle", $hgraphics, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsgetdc($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetDC", "handle", $hgraphics, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsgetinterpolationmode($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetInterpolationMode", "handle", $hgraphics, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsgetsmoothingmode($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetSmoothingMode", "handle", $hgraphics, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Switch $aresult[2]
		Case $gdip_smoothingmode_none
			Return 0
		Case $gdip_smoothingmode_highquality, $gdip_smoothingmode_antialias8x4
			Return 1
		Case $gdip_smoothingmode_antialias8x8
			Return 2
		Case Else
			Return 0
	EndSwitch
EndFunc

Func _gdiplus_graphicsgettransform($hgraphics, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetWorldTransform", "handle", $hgraphics, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsmeasurecharacterranges($hgraphics, $sstring, $hfont, $tlayout, $hstringformat)
	Local $icount = _gdiplus_stringformatgetmeasurablecharacterrangecount($hstringformat)
	If @error Then Return SetError(@error, @extended, 0)
	Local $tregions = DllStructCreate("handle[" & $icount & "]")
	Local $aregions[$icount + 1] = [$icount]
	For $ii = 1 To $icount
		$aregions[$ii] = _gdiplus_regioncreate()
		DllStructSetData($tregions, 1, $aregions[$ii], $ii)
	Next
	DllCall($__g_hgdipdll, "int", "GdipMeasureCharacterRanges", "handle", $hgraphics, "wstr", $sstring, "int", -1, "hwnd", $hfont, "struct*", $tlayout, "handle", $hstringformat, "int", $icount, "struct*", $tregions)
	Local $ierror = @error, $iextended = @extended
	If $ierror Then
		For $ii = 1 To $icount
			_gdiplus_regiondispose($aregions[$ii])
		Next
		Return SetError($ierror + 10, $iextended, 0)
	EndIf
	Return $aregions
EndFunc

Func _gdiplus_graphicsmeasurestring($hgraphics, $sstring, $hfont, $tlayout, $hformat)
	Local $trectf = DllStructCreate($taggdiprectf)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipMeasureString", "handle", $hgraphics, "wstr", $sstring, "int", -1, "handle", $hfont, "struct*", $tlayout, "handle", $hformat, "struct*", $trectf, "int*", 0, "int*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Local $ainfo[3]
	$ainfo[0] = $trectf
	$ainfo[1] = $aresult[8]
	$ainfo[2] = $aresult[9]
	Return $ainfo
EndFunc

Func _gdiplus_graphicsreleasedc($hgraphics, $hdc)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipReleaseDC", "handle", $hgraphics, "handle", $hdc)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsresetclip($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipResetClip", "handle", $hgraphics)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsresettransform($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipResetWorldTransform", "handle", $hgraphics)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsrestore($hgraphics, $istate)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipRestoreGraphics", "handle", $hgraphics, "uint", $istate)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicsrotatetransform($hgraphics, $fangle, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipRotateWorldTransform", "handle", $hgraphics, "float", $fangle, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssave($hgraphics)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSaveGraphics", "handle", $hgraphics, "uint*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_graphicsscaletransform($hgraphics, $fscalex, $fscaley, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipScaleWorldTransform", "handle", $hgraphics, "float", $fscalex, "float", $fscaley, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetclippath($hgraphics, $hpath, $icombinemode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetClipPath", "handle", $hgraphics, "handle", $hpath, "int", $icombinemode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetcliprect($hgraphics, $nx, $ny, $nwidth, $nheight, $icombinemode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetClipRect", "handle", $hgraphics, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "int", $icombinemode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetclipregion($hgraphics, $hregion, $icombinemode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetClipRegion", "handle", $hgraphics, "handle", $hregion, "int", $icombinemode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetcompositingmode($hgraphics, $icompositionmode)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetCompositingMode", "handle", $hgraphics, "int", $icompositionmode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetcompositingquality($hgraphics, $icompositionquality)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetCompositingQuality", "handle", $hgraphics, "int", $icompositionquality)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetinterpolationmode($hgraphics, $iinterpolationmode)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetInterpolationMode", "handle", $hgraphics, "int", $iinterpolationmode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetpixeloffsetmode($hgraphics, $ipixeloffsetmode)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPixelOffsetMode", "handle", $hgraphics, "int", $ipixeloffsetmode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssetsmoothingmode($hgraphics, $ismooth)
	If $ismooth < $gdip_smoothingmode_default OR $ismooth > $gdip_smoothingmode_antialias8x8 Then $ismooth = $gdip_smoothingmode_default
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetSmoothingMode", "handle", $hgraphics, "int", $ismooth)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssettextrenderinghint($hgraphics, $itextrenderinghint)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetTextRenderingHint", "handle", $hgraphics, "int", $itextrenderinghint)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicssettransform($hgraphics, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetWorldTransform", "handle", $hgraphics, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_graphicstransformpoints($hgraphics, ByRef $apoints, $icoordspaceto = 0, $icoordspacefrom = 1)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], ($ii - 1) * 2 + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], ($ii - 1) * 2 + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTransformPoints", "handle", $hgraphics, "int", $icoordspaceto, "int", $icoordspacefrom, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	For $ii = 1 To $icount
		$apoints[$ii][0] = DllStructGetData($tpoints, 1, ($ii - 1) * 2 + 1)
		$apoints[$ii][1] = DllStructGetData($tpoints, 1, ($ii - 1) * 2 + 2)
	Next
	Return True
EndFunc

Func _gdiplus_graphicstranslatetransform($hgraphics, $ndx, $ndy, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTranslateWorldTransform", "handle", $hgraphics, "float", $ndx, "float", $ndy, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_hatchbrushcreate($ihatchstyle = 0, $iargbforeground = -1, $iargbbackground = -1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateHatchBrush", "int", $ihatchstyle, "uint", $iargbforeground, "uint", $iargbbackground, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_hiconcreatefrombitmap($hbitmap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateHICONFromBitmap", "handle", $hbitmap, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_imageattributescreate()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateImageAttributes", "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[1]
EndFunc

Func _gdiplus_imageattributesdispose($himageattributes)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDisposeImageAttributes", "handle", $himageattributes)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imageattributessetcolorkeys($himageattributes, $icoloradjusttype = 0, $benable = False, $iargblow = 0, $iargbhigh = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetImageAttributesColorKeys", "handle", $himageattributes, "int", $icoloradjusttype, "int", $benable, "uint", $iargblow, "uint", $iargbhigh)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imageattributessetcolormatrix($himageattributes, $icoloradjusttype = 0, $benable = False, $tclrmatrix = 0, $tgraymatrix = 0, $icolormatrixflags = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetImageAttributesColorMatrix", "handle", $himageattributes, "int", $icoloradjusttype, "int", $benable, "struct*", $tclrmatrix, "struct*", $tgraymatrix, "int", $icolormatrixflags)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imageattributessetremaptable($himageattributes, $acolormap = 0, $icoloradjusttype = 0, $benable = True)
	Local $aresult
	If IsArray($acolormap) Then
		Local $icount = $acolormap[0][0]
		Local $tcolormap = DllStructCreate("uint[" & $icount * 2 & "]")
		For $i = 1 To $icount
			DllStructSetData($tcolormap, 1, $acolormap[$i][0], ($i - 1) * 2 + 1)
			DllStructSetData($tcolormap, 1, $acolormap[$i][1], ($i - 1) * 2 + 2)
		Next
		$aresult = DllCall($__g_hgdipdll, "int", "GdipSetImageAttributesRemapTable", "handle", $himageattributes, "int", $icoloradjusttype, "int", $benable, "int", $icount, "struct*", $tcolormap)
	Else
		$aresult = DllCall($__g_hgdipdll, "int", "GdipSetImageAttributesRemapTable", "handle", $himageattributes, "int", $icoloradjusttype, "int", $benable, "int", 0, "struct*", 0)
	EndIf
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imageattributessetthreshold($himageattributes, $fthreshold, $icoloradjusttype = $gdip_coloradjusttype_default, $benable = True)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetImageAttributesThreshold", "handle", $himageattributes, "int", $icoloradjusttype, "bool", $benable, "float", $fthreshold)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imageclone($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCloneImage", "handle", $himage, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_imagedispose($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDisposeImage", "handle", $himage)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imagegetdimension($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageDimension", "handle", $himage, "float*", 0, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Local $aimgdim[2] = [$aresult[2], $aresult[3]]
	Return $aimgdim
EndFunc

Func _gdiplus_imagegetflags($himage)
	Local $aflag[2] = [0, ""]
	If ($himage = -1) OR (NOT $himage) Then Return SetError(11, 0, $aflag)
	Local $aimageflags[13][2] = [["Pixel data Cacheable", $gdip_imageflags_caching], ["Pixel data read-only", $gdip_imageflags_readonly], ["Pixel size in image", $gdip_imageflags_hasrealpixelsize], ["DPI info in image", $gdip_imageflags_hasrealdpi], ["YCCK color space", $gdip_imageflags_colorspace_ycck], ["YCBCR color space", $gdip_imageflags_colorspace_ycbcr], ["Grayscale image", $gdip_imageflags_colorspace_gray], ["CMYK color space", $gdip_imageflags_colorspace_cmyk], ["RGB color space", $gdip_imageflags_colorspace_rgb], ["Partially scalable", $gdip_imageflags_partiallyscalable], ["Alpha values other than 0 (transparent) and 255 (opaque)", $gdip_imageflags_hastranslucent], ["Alpha values", $gdip_imageflags_hasalpha], ["Scalable", $gdip_imageflags_scalable]]
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageFlags", "handle", $himage, "long*", 0)
	If @error Then Return SetError(@error, @extended, $aflag)
	If $aresult[0] Then Return SetError(10, $aresult[0], $aflag)
	If $aresult[2] = $gdip_imageflags_none Then
		$aflag[1] = "No pixel data"
		Return SetError(12, $aresult[2], $aflag)
	EndIf
	$aflag[0] = $aresult[2]
	For $i = 0 To 12
		If BitAND($aresult[2], $aimageflags[$i][1]) = $aimageflags[$i][1] Then
			If StringLen($aflag[1]) Then $aflag[1] &= "|"
			$aresult[2] -= $aimageflags[$i][1]
			$aflag[1] &= $aimageflags[$i][0]
		EndIf
	Next
	Return $aflag
EndFunc

Func _gdiplus_imagegetframecount($himage, $sdimensionid)
	Local $tguid = _winapi_guidfromstring($sdimensionid)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipImageGetFrameCount", "handle", $himage, "struct*", $tguid, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[3]
EndFunc

Func _gdiplus_imagegetgraphicscontext($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageGraphicsContext", "handle", $himage, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_imagegetheight($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageHeight", "handle", $himage, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_imagegethorizontalresolution($himage)
	If ($himage = -1) OR (NOT $himage) Then Return SetError(11, 0, 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageHorizontalResolution", "handle", $himage, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return Round($aresult[2])
EndFunc

Func _gdiplus_imagegetpixelformat($himage)
	Local $aformat[2] = [0, ""]
	If ($himage = -1) OR (NOT $himage) Then Return SetError(11, 0, $aformat)
	Local $apixelformat[14][2] = [["1 Bpp Indexed", $gdip_pxf01indexed], ["4 Bpp Indexed", $gdip_pxf04indexed], ["8 Bpp Indexed", $gdip_pxf08indexed], ["16 Bpp Grayscale", $gdip_pxf16grayscale], ["16 Bpp RGB 555", $gdip_pxf16rgb555], ["16 Bpp RGB 565", $gdip_pxf16rgb565], ["16 Bpp ARGB 1555", $gdip_pxf16argb1555], ["24 Bpp RGB", $gdip_pxf24rgb], ["32 Bpp RGB", $gdip_pxf32rgb], ["32 Bpp ARGB", $gdip_pxf32argb], ["32 Bpp PARGB", $gdip_pxf32pargb], ["48 Bpp RGB", $gdip_pxf48rgb], ["64 Bpp ARGB", $gdip_pxf64argb], ["64 Bpp PARGB", $gdip_pxf64pargb]]
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImagePixelFormat", "handle", $himage, "int*", 0)
	If @error Then Return SetError(@error, @extended, $aformat)
	If $aresult[0] Then Return SetError(10, $aresult[0], $aformat)
	For $i = 0 To 13
		If $apixelformat[$i][1] = $aresult[2] Then
			$aformat[0] = $apixelformat[$i][1]
			$aformat[1] = $apixelformat[$i][0]
			Return $aformat
		EndIf
	Next
	Return SetError(12, 0, $aformat)
EndFunc

Func __gdiplus_imagegetpropertycount($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPropertyCount", "handle", $himage, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_imagegetpropertyidlist($himage)
	Local $icount = __gdiplus_imagegetpropertycount($himage)
	If @error Then Return SetError(@error, @extended, False)
	Local $tproperties = DllStructCreate("uint[" & $icount & "]")
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPropertyIdList", "handle", $himage, "int", $icount, "struct*", $tproperties)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Local $spropertytaginfo = "0x0000=GpsVer;0x0001=GpsLatitudeRef;0x0002=GpsLatitude;0x0003=GpsLongitudeRef;0x0004=GpsLongitude;0x0005=GpsAltitudeRef;0x0006=GpsAltitude;0x0007=GpsGpsTime;0x0008=GpsGpsSatellites;0x0009=GpsGpsStatus;0x000A=GpsGpsMeasureMode;0x000B=GpsGpsDop;0x000C=GpsSpeedRef;0x000D=GpsSpeed;0x000E=GpsTrackRef;0x000F=GpsTrack;0x0010=GpsImgDirRef;0x0011=GpsImgDir;0x0012=GpsMapDatum;0x0013=GpsDestLatRef;0x0014=GpsDestLat;0x0015=GpsDestLongRef;0x0016=GpsDestLong;0x0017=GpsDestBearRef;0x0018=GpsDestBear;0x0019=GpsDestDistRef;0x001A=GpsDestDist;0x00FE=NewSubfileType;0x00FF=SubfileType;0x0100=ImageWidth;0x0101=ImageHeight;0x0102=BitsPerSample;0x0103=Compression;0x0106=PhotometricInterp;0x0107=ThreshHolding;0x0108=CellWidth;0x0109=CellHeight;0x010A=FillOrder;0x010D=DocumentName;0x010E=ImageDescription;0x010F=EquipMake;0x0110=EquipModel;0x0111=StripOffsets;0x0112=Orientation;0x0115=SamplesPerPixel;0x0116=RowsPerStrip;0x0117=StripBytesCount;0x0118=MinSampleValue;0x0119=MaxSampleValue;0x011A=XResolution;0x011B=YResolution;0x011C=PlanarConfig;0x011D=PageName;0x011E=XPosition;0x011F=YPosition;0x0120=FreeOffset;0x0121=FreeByteCounts;0x0122=GrayResponseUnit;0x0123=GrayResponseCurve;0x0124=T4Option;0x0125=T6Option;0x0128=ResolutionUnit;0x0129=PageNumber;0x012D=TransferFunction;0x0131=SoftwareUsed;0x0132=DateTime;0x013B=Artist;0x013C=HostComputer;0x013D=Predictor;0x013E=WhitePoint;0x013F=PrimaryChromaticities;0x0140=ColorMap;0x0141=HalftoneHints;0x0142=TileWidth;0x0143=TileLength;0x0144=TileOffset;0x0145=TileByteCounts;0x014C=InkSet;0x014D=InkNames;0x014E=NumberOfInks;0x0150=DotRange;0x0151=TargetPrinter;0x0152=ExtraSamples;0x0153=SampleFormat;0x0154=SMinSampleValue;0x0155=SMaxSampleValue;0x0156=TransferRange;0x0200=JPEGProc;0x0201=JPEGInterFormat;0x0202=JPEGInterLength;0x0203=JPEGRestartInterval;0x0205=JPEGLosslessPredictors;0x0206=JPEGPointTransforms;0x0207=JPEGQTables;0x0208=JPEGDCTables;0x0209=JPEGACTables;0x0211=YCbCrCoefficients;0x0212=YCbCrSubsampling;0x0213=YCbCrPositioning;0x0214=REFBlackWhite;0x0301=Gamma;0x0302=ICCProfileDescriptor;0x0303=SRGBRenderingIntent;0x0320=ImageTitle;0x5001=ResolutionXUnit;0x5002=ResolutionYUnit;0x5003=ResolutionXLengthUnit;0x5004=ResolutionYLengthUnit;0x5005=PrintFlags;0x5006=PrintFlagsVersion;0x5007=PrintFlagsCrop;0x5008=PrintFlagsBleedWidth;0x5009=PrintFlagsBleedWidthScale;0x500A=HalftoneLPI;0x500B=HalftoneLPIUnit;0x500C=HalftoneDegree;" & "0x500D=HalftoneShape;0x500E=HalftoneMisc;0x500F=HalftoneScreen;0x5010=JPEGQuality;0x5011=GridSize;0x5012=ThumbnailFormat;0x5013=ThumbnailWidth;0x5014=ThumbnailHeight;0x5015=ThumbnailColorDepth;0x5016=ThumbnailPlanes;0x5017=ThumbnailRawBytes;0x5018=ThumbnailSize;0x5019=ThumbnailCompressedSize;0x501A=ColorTransferFunction;0x501B=ThumbnailData;0x5020=ThumbnailImageWidth;0x5021=ThumbnailImageHeight;0x5022=ThumbnailBitsPerSample;0x5023=ThumbnailCompression;0x5024=ThumbnailPhotometricInterp;0x5025=ThumbnailImageDescription;0x5026=ThumbnailEquipMake;0x5027=ThumbnailEquipModel;0x5028=ThumbnailStripOffsets;0x5029=ThumbnailOrientation;0x502A=ThumbnailSamplesPerPixel;0x502B=ThumbnailRowsPerStrip;0x502C=ThumbnailStripBytesCount;0x502D=ThumbnailResolutionX;0x502E=ThumbnailResolutionY;0x502F=ThumbnailPlanarConfig;0x5030=ThumbnailResolutionUnit;0x5031=ThumbnailTransferFunction;0x5032=ThumbnailSoftwareUsed;0x5033=ThumbnailDateTime;0x5034=ThumbnailArtist;0x5035=ThumbnailWhitePoint;0x5036=ThumbnailPrimaryChromaticities;0x5037=ThumbnailYCbCrCoefficients;0x5038=ThumbnailYCbCrSubsampling;0x5039=ThumbnailYCbCrPositioning;0x503A=ThumbnailRefBlackWhite;0x503B=ThumbnailCopyRight;0x5090=LuminanceTable;0x5091=ChrominanceTable;0x5100=FrameDelay;0x5101=LoopCount;0x5102=GlobalPalette;0x5103=IndexBackground;0x5104=IndexTransparent;0x5110=PixelUnit;0x5111=PixelPerUnitX;0x5112=PixelPerUnitY;0x5113=PaletteHistogram;0x8298=Copyright;0x829A=ExifExposureTime;0x829D=ExifFNumber;0x8769=ExifIFD;0x8773=ICCProfile;0x8822=ExifExposureProg;0x8824=ExifSpectralSense;0x8825=GpsIFD;0x8827=ExifISOSpeed;0x8828=ExifOECF;0x9000=ExifVer;0x9003=ExifDTOrig;0x9004=ExifDTDigitized;0x9101=ExifCompConfig;0x9102=ExifCompBPP;0x9201=ExifShutterSpeed;0x9202=ExifAperture;0x9203=ExifBrightness;0x9204=ExifExposureBias;0x9205=ExifMaxAperture;0x9206=ExifSubjectDist;0x9207=ExifMeteringMode;0x9208=ExifLightSource;0x9209=ExifFlash;0x920A=ExifFocalLength;0x927C=ExifMakerNote;0x9286=ExifUserComment;0x9290=ExifDTSubsec;0x9291=ExifDTOrigSS;0x9292=ExifDTDigSS;0xA000=ExifFPXVer;0xA001=ExifColorSpace;0xA002=ExifPixXDim;0xA003=ExifPixYDim;0xA004=ExifRelatedWav;0xA005=ExifInterop;0xA20B=ExifFlashEnergy;0xA20C=ExifSpatialFR;0xA20E=ExifFocalXRes;0xA20F=ExifFocalYRes;0xA210=ExifFocalResUnit;0xA214=ExifSubjectLoc;0xA215=ExifExposureIndex;0xA217=ExifSensingMethod;0xA300=ExifFileSource;0xA301=ExifSceneType;0xA302=ExifCfaPattern"
	Local $aproperties[$icount + 1][2] = [[$icount]]
	Local $aregexp
	For $i = 1 To $icount
		$aproperties[$i][0] = DllStructGetData($tproperties, 1, $i)
		$aregexp = StringRegExp($spropertytaginfo, "(?i)" & Hex(DllStructGetData($tproperties, 1, $i), 4) & "=(\w+)", 3)
		Switch IsArray($aregexp)
			Case True
				$aproperties[$i][1] = $aregexp[0]
			Case Else
				$aproperties[$i][1] = "PropertyTagUnKnown"
		EndSwitch
	Next
	Return $aproperties
EndFunc

Func __gdiplus_imagegetpropertyitemsize($himage, $ipropid)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPropertyItemSize", "handle", $himage, "uint", $ipropid, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[3]
EndFunc

Func _gdiplus_imagegetpropertyitem($himage, $ipropid)
	Local $isize = __gdiplus_imagegetpropertyitemsize($himage, $ipropid)
	If @error Then Return SetError(@error, @extended, False)
	Local $tbuffer = DllStructCreate("byte[" & $isize & "];")
	Local $pbuffer = DllStructGetPtr($tbuffer)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPropertyItem", "handle", $himage, "uint", $ipropid, "uint", $isize, "struct*", $tbuffer)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Local $tpropertyitem = DllStructCreate("int id; int length; short type; ptr value;", $pbuffer)
	Local $ibytes = DllStructGetData($tpropertyitem, "length")
	Local $pvalue = DllStructGetData($tpropertyitem, "value")
	Local $tvalues, $ivalues
	Switch DllStructGetData($tpropertyitem, "type")
		Case 2
			$ivalues = 1
			$tvalues = DllStructCreate("char[" & $ibytes & "];", $pvalue)
		Case 3
			$ivalues = Int($ibytes / 2)
			$tvalues = DllStructCreate("ushort[" & $ivalues & "];", $pvalue)
		Case 4, 5
			$ivalues = Int($ibytes / 4)
			$tvalues = DllStructCreate("uint[" & $ivalues & "];", $pvalue)
		Case 9, 10
			$ivalues = Int($ibytes / 4)
			$tvalues = DllStructCreate("int[" & $ivalues & "];", $pvalue)
		Case Else
			$ivalues = 1
			$tvalues = DllStructCreate("byte[" & $ibytes & "];", $pvalue)
	EndSwitch
	Local $avalues[$ivalues + 1] = [$ivalues]
	Switch DllStructGetData($tpropertyitem, "type")
		Case 5, 10
			$ivalues = Int($ivalues / 2)
			ReDim $avalues[$ivalues + 1]
			$avalues[0] = $ivalues
			For $j = 1 To $ivalues
				$avalues[$j] = DllStructGetData($tvalues, 1, ($j - 1) * 2 + 1) / DllStructGetData($tvalues, 1, ($j - 1) * 2 + 2)
			Next
		Case 3, 4, 9
			For $j = 1 To $ivalues
				$avalues[$j] = DllStructGetData($tvalues, 1, $j)
			Next
		Case Else
			$avalues[1] = DllStructGetData($tvalues, 1)
	EndSwitch
	Return $avalues
EndFunc

Func _gdiplus_imagegetrawformat($himage)
	Local $aguid[2]
	If ($himage = -1) OR (NOT $himage) Then Return SetError(11, 0, $aguid)
	Local $aimagetype[11][2] = [["UNDEFINED", $gdip_imageformat_undefined], ["MEMORYBMP", $gdip_imageformat_memorybmp], ["BMP", $gdip_imageformat_bmp], ["EMF", $gdip_imageformat_emf], ["WMF", $gdip_imageformat_wmf], ["JPEG", $gdip_imageformat_jpeg], ["PNG", $gdip_imageformat_png], ["GIF", $gdip_imageformat_gif], ["TIFF", $gdip_imageformat_tiff], ["EXIF", $gdip_imageformat_exif], ["ICON", $gdip_imageformat_icon]]
	Local $tstruct = DllStructCreate("byte[16]")
	Local $aresult1 = DllCall($__g_hgdipdll, "int", "GdipGetImageRawFormat", "handle", $himage, "struct*", $tstruct)
	If @error Then Return SetError(@error, @extended, $aguid)
	If $aresult1[0] Then Return SetError(10, $aresult1[0], $aguid)
	Local $sresult2 = _winapi_stringfromguid($aresult1[2])
	If @error Then Return SetError(@error + 20, @extended, $aguid)
	If $sresult2 = "" Then Return SetError(12, 0, $aguid)
	For $i = 0 To 10
		If $aimagetype[$i][1] == $sresult2 Then
			$aguid[0] = $aimagetype[$i][1]
			$aguid[1] = $aimagetype[$i][0]
			Return $aguid
		EndIf
	Next
	Return SetError(13, 0, $aguid)
EndFunc

Func _gdiplus_imagegetthumbnail($himage, $iwidth = 0, $iheight = 0, $bkeepratio = True, $hcallback = NULL , $hcallbackdata = NULL )
	If $bkeepratio Then
		Local $aimgdim = _gdiplus_imagegetdimension($himage)
		If @error Then Return SetError(@error + 20, @extended, False)
		Local $f
		If $iwidth < 1 OR $iheight < 1 Then
			$iwidth = 0
			$iheight = 0
		Else
			If ($aimgdim[0] / $aimgdim[1]) > 1 Then
				$f = $aimgdim[0] / $iwidth
			Else
				$f = $aimgdim[1] / $iheight
			EndIf
			$iwidth = Int($aimgdim[0] / $f)
			$iheight = Int($aimgdim[1] / $f)
		EndIf
	EndIf
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageThumbnail", "handle", $himage, "uint", $iwidth, "uint", $iheight, "ptr*", 0, "ptr", $hcallback, "ptr", $hcallbackdata)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return $aresult[4]
EndFunc

Func _gdiplus_imagegettype($himage)
	If ($himage = -1) OR (NOT $himage) Then Return SetError(11, 0, -1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageType", "handle", $himage, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_imagegetverticalresolution($himage)
	If ($himage = -1) OR (NOT $himage) Then Return SetError(11, 0, 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageVerticalResolution", "handle", $himage, "float*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return Round($aresult[2])
EndFunc

Func _gdiplus_imagegetwidth($himage)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetImageWidth", "handle", $himage, "uint*", -1)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_imageloadfromfile($sfilename)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipLoadImageFromFile", "wstr", $sfilename, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_imageloadfromstream($pstream)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipLoadImageFromStream", "ptr", $pstream, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_imagerotateflip($himage, $irotatefliptype)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipImageRotateFlip", "handle", $himage, "int", $irotatefliptype)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imagesaveadd($himage, $tparams)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSaveAdd", "handle", $himage, "struct*", $tparams)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imagesaveaddimage($himage, $himagenew, $tparams)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSaveAddImage", "handle", $himage, "handle", $himagenew, "struct*", $tparams)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imagesavetofile($himage, $sfilename)
	Local $sext = __gdiplus_extractfileext($sfilename)
	Local $sclsid = _gdiplus_encodersgetclsid($sext)
	If $sclsid = "" Then Return SetError(-1, 0, False)
	Local $bret = _gdiplus_imagesavetofileex($himage, $sfilename, $sclsid, 0)
	Return SetError(@error, @extended, $bret)
EndFunc

Func _gdiplus_imagesavetofileex($himage, $sfilename, $sencoder, $tparams = 0)
	Local $tguid = _winapi_guidfromstring($sencoder)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSaveImageToFile", "handle", $himage, "wstr", $sfilename, "struct*", $tguid, "struct*", $tparams)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imagesavetostream($himage, $pstream, $tencoder, $tparams = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSaveImageToStream", "handle", $himage, "ptr", $pstream, "struct*", $tencoder, "struct*", $tparams)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imagescale($himage, $iscalew, $iscaleh, $iinterpolationmode = $gdip_interpolationmode_highqualitybicubic)
	Local $iwidth = _gdiplus_imagegetwidth($himage) * $iscalew
	If @error Then Return SetError(1, 0, 0)
	Local $iheight = _gdiplus_imagegetheight($himage) * $iscaleh
	If @error Then Return SetError(2, 0, 0)
	Local $hbitmap = _gdiplus_bitmapcreatefromscan0($iwidth, $iheight)
	If @error Then Return SetError(3, 0, 0)
	Local $hbmpctxt = _gdiplus_imagegetgraphicscontext($hbitmap)
	If @error Then
		_gdiplus_bitmapdispose($hbitmap)
		Return SetError(4, 0, 0)
	EndIf
	_gdiplus_graphicssetinterpolationmode($hbmpctxt, $iinterpolationmode)
	If @error Then
		_gdiplus_graphicsdispose($hbmpctxt)
		_gdiplus_bitmapdispose($hbitmap)
		Return SetError(5, 0, 0)
	EndIf
	_gdiplus_graphicsdrawimagerect($hbmpctxt, $himage, 0, 0, $iwidth, $iheight)
	If @error Then
		_gdiplus_graphicsdispose($hbmpctxt)
		_gdiplus_bitmapdispose($hbitmap)
		Return SetError(6, 0, 0)
	EndIf
	_gdiplus_graphicsdispose($hbmpctxt)
	Return $hbitmap
EndFunc

Func _gdiplus_imageselectactiveframe($himage, $sdimensionid, $iframeindex)
	Local $tguid = _winapi_guidfromstring($sdimensionid)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipImageSelectActiveFrame", "handle", $himage, "struct*", $tguid, "uint", $iframeindex)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_imageresize($himage, $inewwidth, $inewheight, $iinterpolationmode = $gdip_interpolationmode_highqualitybicubic)
	Local $hbitmap = _gdiplus_bitmapcreatefromscan0($inewwidth, $inewheight)
	If @error Then Return SetError(1, 0, 0)
	Local $hbmpctxt = _gdiplus_imagegetgraphicscontext($hbitmap)
	If @error Then
		_gdiplus_bitmapdispose($hbitmap)
		Return SetError(2, @extended, 0)
	EndIf
	_gdiplus_graphicssetinterpolationmode($hbmpctxt, $iinterpolationmode)
	If @error Then
		_gdiplus_graphicsdispose($hbmpctxt)
		_gdiplus_bitmapdispose($hbitmap)
		Return SetError(3, @extended, 0)
	EndIf
	_gdiplus_graphicsdrawimagerect($hbmpctxt, $himage, 0, 0, $inewwidth, $inewheight)
	If @error Then
		_gdiplus_graphicsdispose($hbmpctxt)
		_gdiplus_bitmapdispose($hbitmap)
		Return SetError(4, @extended, 0)
	EndIf
	_gdiplus_graphicsdispose($hbmpctxt)
	Return $hbitmap
EndFunc

Func _gdiplus_linebrushcreate($nx1, $ny1, $nx2, $ny2, $iargbclr1, $iargbclr2, $iwrapmode = 0)
	Local $tpointf1, $tpointf2, $aresult
	$tpointf1 = DllStructCreate("float;float")
	$tpointf2 = DllStructCreate("float;float")
	DllStructSetData($tpointf1, 1, $nx1)
	DllStructSetData($tpointf1, 2, $ny1)
	DllStructSetData($tpointf2, 1, $nx2)
	DllStructSetData($tpointf2, 2, $ny2)
	$aresult = DllCall($__g_hgdipdll, "int", "GdipCreateLineBrush", "struct*", $tpointf1, "struct*", $tpointf2, "uint", $iargbclr1, "uint", $iargbclr2, "int", $iwrapmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[6]
EndFunc

Func _gdiplus_linebrushcreatefromrect($trectf, $iargbclr1, $iargbclr2, $igradientmode = 0, $iwrapmode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateLineBrushFromRect", "struct*", $trectf, "uint", $iargbclr1, "uint", $iargbclr2, "int", $igradientmode, "int", $iwrapmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[6]
EndFunc

Func _gdiplus_linebrushcreatefromrectwithangle($trectf, $iargbclr1, $iargbclr2, $fangle, $bisanglescalable = True, $iwrapmode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateLineBrushFromRectWithAngle", "struct*", $trectf, "uint", $iargbclr1, "uint", $iargbclr2, "float", $fangle, "int", $bisanglescalable, "int", $iwrapmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[7]
EndFunc

Func _gdiplus_linebrushgetcolors($hlinegradientbrush)
	Local $targbs, $aargbs[2], $aresult
	$targbs = DllStructCreate("uint;uint")
	$aresult = DllCall($__g_hgdipdll, "uint", "GdipGetLineColors", "handle", $hlinegradientbrush, "struct*", $targbs)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	$aargbs[0] = DllStructGetData($targbs, 1)
	$aargbs[1] = DllStructGetData($targbs, 2)
	Return $aargbs
EndFunc

Func _gdiplus_linebrushgetrect($hlinegradientbrush)
	Local $trectf = DllStructCreate($taggdiprectf)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetLineRect", "handle", $hlinegradientbrush, "struct*", $trectf)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $arectf[4]
	For $ii = 1 To 4
		$arectf[$ii - 1] = DllStructGetData($trectf, $ii)
	Next
	Return $arectf
EndFunc

Func _gdiplus_linebrushmultiplytransform($hlinegradientbrush, $hmatrix, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipMultiplyLineTransform", "handle", $hlinegradientbrush, "handle", $hmatrix, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushresettransform($hlinegradientbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipResetLineTransform", "handle", $hlinegradientbrush)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsetblend($hlinegradientbrush, $ablends)
	Local $ii, $icount, $tfactors, $tpositions, $aresult
	$icount = $ablends[0][0]
	$tfactors = DllStructCreate("float[" & $icount & "]")
	$tpositions = DllStructCreate("float[" & $icount & "]")
	For $ii = 1 To $icount
		DllStructSetData($tfactors, 1, $ablends[$ii][0], $ii)
		DllStructSetData($tpositions, 1, $ablends[$ii][1], $ii)
	Next
	$aresult = DllCall($__g_hgdipdll, "int", "GdipSetLineBlend", "handle", $hlinegradientbrush, "struct*", $tfactors, "struct*", $tpositions, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsetcolors($hlinegradientbrush, $iargbstart, $iargbend)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetLineColors", "handle", $hlinegradientbrush, "uint", $iargbstart, "uint", $iargbend)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsetgammacorrection($hlinegradientbrush, $busegammacorrection = True)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetLineGammaCorrection", "handle", $hlinegradientbrush, "int", $busegammacorrection)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsetlinearblend($hlinegradientbrush, $ffocus, $fscale = 1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetLineLinearBlend", "handle", $hlinegradientbrush, "float", $ffocus, "float", $fscale)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsetpresetblend($hlinegradientbrush, $ainterpolations)
	Local $ii, $icount, $tcolors, $tpositions, $aresult
	$icount = $ainterpolations[0][0]
	$tcolors = DllStructCreate("uint[" & $icount & "]")
	$tpositions = DllStructCreate("float[" & $icount & "]")
	For $ii = 1 To $icount
		DllStructSetData($tcolors, 1, $ainterpolations[$ii][0], $ii)
		DllStructSetData($tpositions, 1, $ainterpolations[$ii][1], $ii)
	Next
	$aresult = DllCall($__g_hgdipdll, "int", "GdipSetLinePresetBlend", "handle", $hlinegradientbrush, "struct*", $tcolors, "struct*", $tpositions, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsetsigmablend($hlinegradientbrush, $ffocus, $fscale = 1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetLineSigmaBlend", "handle", $hlinegradientbrush, "float", $ffocus, "float", $fscale)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_linebrushsettransform($hlinegradientbrush, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetLineTransform", "handle", $hlinegradientbrush, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixcreate()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateMatrix", "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[1]
EndFunc

Func _gdiplus_matrixcreate2($nm11 = 1, $nm12 = 1, $nm21 = 1, $nm22 = 1, $ndx = 0, $ndy = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateMatrix2", "float", $nm11, "float", $nm12, "float", $nm21, "float", $nm22, "float", $ndx, "float", $ndy, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[7]
EndFunc

Func _gdiplus_matrixclone($hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCloneMatrix", "handle", $hmatrix, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_matrixdispose($hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteMatrix", "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixgetelements($hmatrix)
	Local $telements = DllStructCreate("float[6]")
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetMatrixElements", "handle", $hmatrix, "struct*", $telements)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $aelements[6]
	For $ii = 1 To 6
		$aelements[$ii - 1] = DllStructGetData($telements, 1, $ii)
	Next
	Return $aelements
EndFunc

Func _gdiplus_matrixinvert($hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipInvertMatrix", "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixmultiply($hmatrix1, $hmatrix2, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipMultiplyMatrix", "handle", $hmatrix1, "handle", $hmatrix2, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixrotate($hmatrix, $fangle, $bappend = False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipRotateMatrix", "handle", $hmatrix, "float", $fangle, "int", $bappend)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixscale($hmatrix, $fscalex, $fscaley, $border = False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipScaleMatrix", "handle", $hmatrix, "float", $fscalex, "float", $fscaley, "int", $border)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixsetelements($hmatrix, $nm11 = 1, $nm12 = 0, $nm21 = 0, $nm22 = 1, $ndx = 0, $ndy = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetMatrixElements", "handle", $hmatrix, "float", $nm11, "float", $nm12, "float", $nm21, "float", $nm22, "float", $ndx, "float", $ndy)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixshear($hmatrix, $fshearx, $fsheary, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipShearMatrix", "handle", $hmatrix, "float", $fshearx, "float", $fsheary, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_matrixtransformpoints($hmatrix, ByRef $apoints)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], ($ii - 1) * 2 + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], ($ii - 1) * 2 + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTransformMatrixPoints", "handle", $hmatrix, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	For $ii = 1 To $icount
		$apoints[$ii][0] = DllStructGetData($tpoints, 1, ($ii - 1) * 2 + 1)
		$apoints[$ii][1] = DllStructGetData($tpoints, 1, ($ii - 1) * 2 + 2)
	Next
	Return True
EndFunc

Func _gdiplus_matrixtranslate($hmatrix, $foffsetx, $foffsety, $bappend = False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTranslateMatrix", "handle", $hmatrix, "float", $foffsetx, "float", $foffsety, "int", $bappend)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_paramadd(ByRef $tparams, $sguid, $inbofvalues, $itype, $pvalues)
	Local $icount = DllStructGetData($tparams, "Count")
	Local $pguid = DllStructGetPtr($tparams, "GUID") + ($icount * _gdiplus_paramsize())
	Local $tparam = DllStructCreate($taggdipencoderparam, $pguid)
	_winapi_guidfromstringex($sguid, $pguid)
	DllStructSetData($tparam, "Type", $itype)
	DllStructSetData($tparam, "NumberOfValues", $inbofvalues)
	DllStructSetData($tparam, "Values", $pvalues)
	DllStructSetData($tparams, "Count", $icount + 1)
EndFunc

Func _gdiplus_paraminit($icount)
	Local $sstruct = $taggdipencoderparams
	For $i = 2 To $icount
		$sstruct &= ";struct;byte[16];ulong;ulong;ptr;endstruct"
	Next
	Return DllStructCreate($sstruct)
EndFunc

Func _gdiplus_paramsize()
	Local $tparam = DllStructCreate($taggdipencoderparam)
	Return DllStructGetSize($tparam)
EndFunc

Func _gdiplus_pathaddarc($hpath, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathArc", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddbezier($hpath, $nx1, $ny1, $nx2, $ny2, $nx3, $ny3, $nx4, $ny4)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathBezier", "handle", $hpath, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2, "float", $nx3, "float", $ny3, "float", $nx4, "float", $ny4)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddclosedcurve($hpath, $apoints)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathClosedCurve", "handle", $hpath, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddclosedcurve2($hpath, $apoints, $ntension = 0.5)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathClosedCurve2", "handle", $hpath, "struct*", $tpoints, "int", $icount, "float", $ntension)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddcurve($hpath, $apoints)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathCurve", "handle", $hpath, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddcurve2($hpath, $apoints, $ntension = 0.5)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathCurve2", "handle", $hpath, "struct*", $tpoints, "int", $icount, "float", $ntension)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddcurve3($hpath, $apoints, $ioffset, $inumofsegments, $ntension = 0.5)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathCurve3", "handle", $hpath, "struct*", $tpoints, "int", $icount, "int", $ioffset, "int", $inumofsegments, "float", $ntension)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddellipse($hpath, $nx, $ny, $nwidth, $nheight)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathEllipse", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddline($hpath, $nx1, $ny1, $nx2, $ny2)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathLine", "handle", $hpath, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddline2($hpath, $apoints)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathLine2", "handle", $hpath, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddpath($hpath1, $hpath2, $bconnect = True)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathPath", "handle", $hpath1, "handle", $hpath2, "int", $bconnect)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddpie($hpath, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathPie", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddpolygon($hpath, $apoints)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathPolygon", "handle", $hpath, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddrectangle($hpath, $nx, $ny, $nwidth, $nheight)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathRectangle", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathaddstring($hpath, $sstring, $tlayout, $hfamily, $istyle = 0, $fsize = 8.5, $hformat = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipAddPathString", "handle", $hpath, "wstr", $sstring, "int", -1, "handle", $hfamily, "int", $istyle, "float", $fsize, "struct*", $tlayout, "handle", $hformat)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushcreate($apoints, $iwrapmode = 0)
	Local $icount = $apoints[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePathGradient", "struct*", $tpoints, "int", $icount, "int", $iwrapmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_pathbrushcreatefrompath($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePathGradientFromPath", "handle", $hpath, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathbrushgetcenterpoint($hpathgradientbrush)
	Local $tpointf = DllStructCreate("float;float")
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathGradientCenterPoint", "handle", $hpathgradientbrush, "struct*", $tpointf)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $apointf[2]
	$apointf[0] = DllStructGetData($tpointf, 1)
	$apointf[1] = DllStructGetData($tpointf, 2)
	Return $apointf
EndFunc

Func _gdiplus_pathbrushgetfocusscales($hpathgradientbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathGradientFocusScales", "handle", $hpathgradientbrush, "float*", 0, "float*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $ascales[2]
	$ascales[0] = $aresult[2]
	$ascales[1] = $aresult[3]
	Return $ascales
EndFunc

Func _gdiplus_pathbrushgetpointcount($hpathgradientbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathGradientPointCount", "handle", $hpathgradientbrush, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathbrushgetrect($hpathgradientbrush)
	Local $trectf = DllStructCreate($taggdiprectf)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathGradientRect", "handle", $hpathgradientbrush, "struct*", $trectf)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $arectf[4]
	For $ii = 1 To 4
		$arectf[$ii - 1] = DllStructGetData($trectf, $ii)
	Next
	Return $arectf
EndFunc

Func _gdiplus_pathbrushgetwrapmode($hpathgradientbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathGradientWrapMode", "handle", $hpathgradientbrush, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathbrushmultiplytransform($hpathgradientbrush, $hmatrix, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipMultiplyPathGradientTransform", "handle", $hpathgradientbrush, "handle", $hmatrix, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushresettransform($hpathgradientbrush)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipResetPathGradientTransform", "handle", $hpathgradientbrush)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetblend($hpathgradientbrush, $ablends)
	Local $icount = $ablends[0][0]
	Local $tfactors = DllStructCreate("float[" & $icount & "]")
	Local $tpositions = DllStructCreate("float[" & $icount & "]")
	For $ii = 1 To $icount
		DllStructSetData($tfactors, 1, $ablends[$ii][0], $ii)
		DllStructSetData($tpositions, 1, $ablends[$ii][1], $ii)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientBlend", "handle", $hpathgradientbrush, "struct*", $tfactors, "struct*", $tpositions, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetcentercolor($hpathgradientbrush, $iargb)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientCenterColor", "handle", $hpathgradientbrush, "uint", $iargb)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetcenterpoint($hpathgradientbrush, $nx, $ny)
	Local $tpointf = DllStructCreate("float;float")
	DllStructSetData($tpointf, 1, $nx)
	DllStructSetData($tpointf, 2, $ny)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientCenterPoint", "handle", $hpathgradientbrush, "struct*", $tpointf)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetfocusscales($hpathgradientbrush, $fscalex, $fscaley)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientFocusScales", "handle", $hpathgradientbrush, "float", $fscalex, "float", $fscaley)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetgammacorrection($hpathgradientbrush, $busegammacorrection)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientGammaCorrection", "handle", $hpathgradientbrush, "int", $busegammacorrection)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetlinearblend($hpathgradientbrush, $ffocus, $fscale = 1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientLinearBlend", "handle", $hpathgradientbrush, "float", $ffocus, "float", $fscale)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetpresetblend($hpathgradientbrush, $ainterpolations)
	Local $icount = $ainterpolations[0][0]
	Local $tcolors = DllStructCreate("uint[" & $icount & "]")
	Local $tpositions = DllStructCreate("float[" & $icount & "]")
	For $ii = 1 To $icount
		DllStructSetData($tcolors, 1, $ainterpolations[$ii][0], $ii)
		DllStructSetData($tpositions, 1, $ainterpolations[$ii][1], $ii)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientPresetBlend", "handle", $hpathgradientbrush, "struct*", $tcolors, "struct*", $tpositions, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetsigmablend($hpathgradientbrush, $ffocus, $fscale = 1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientSigmaBlend", "handle", $hpathgradientbrush, "float", $ffocus, "float", $fscale)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetsurroundcolor($hpathgradientbrush, $iargb)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientSurroundColorsWithCount", "handle", $hpathgradientbrush, "uint*", $iargb, "int*", 1)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetsurroundcolorswithcount($hpathgradientbrush, $acolors)
	Local $icount = $acolors[0]
	Local $icolors = _gdiplus_pathbrushgetpointcount($hpathgradientbrush)
	If $icolors < $icount Then $icount = $icolors
	Local $tcolors = DllStructCreate("uint[" & $icount & "]")
	For $ii = 1 To $icount
		DllStructSetData($tcolors, 1, $acolors[$ii], $ii)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientSurroundColorsWithCount", "handle", $hpathgradientbrush, "struct*", $tcolors, "int*", $icount)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_pathbrushsettransform($hpathgradientbrush, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientTransform", "handle", $hpathgradientbrush, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathbrushsetwrapmode($hpathgradientbrush, $iwrapmode)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathGradientWrapMode", "handle", $hpathgradientbrush, "int", $iwrapmode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathclone($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipClonePath", "handle", $hpath, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathclosefigure($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipClosePathFigure", "handle", $hpath)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathcreate($ifillmode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePath", "int", $ifillmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathcreate2($apathdata, $ifillmode = 0)
	Local $icount = $apathdata[0][0]
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	Local $ttypes = DllStructCreate("byte[" & $icount & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apathdata[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tpoints, 1, $apathdata[$ii][1], (($ii - 1) * 2) + 2)
		DllStructSetData($ttypes, 1, $apathdata[$ii][2], $ii)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePath2", "struct*", $tpoints, "struct*", $ttypes, "int", $icount, "int", $ifillmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[5]
EndFunc

Func _gdiplus_pathdispose($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeletePath", "handle", $hpath)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathflatten($hpath, $fflatness = 0.25, $hmatrix = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipFlattenPath", "handle", $hpath, "handle", $hmatrix, "float", $fflatness)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathgetdata($hpath)
	Local $icount = _gdiplus_pathgetpointcount($hpath)
	Local $tpathdata = DllStructCreate("int Count; ptr Points; ptr Types;")
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	Local $ttypes = DllStructCreate("byte[" & $icount & "]")
	DllStructSetData($tpathdata, "Count", $icount)
	DllStructSetData($tpathdata, "Points", DllStructGetPtr($tpoints))
	DllStructSetData($tpathdata, "Types", DllStructGetPtr($ttypes))
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathData", "handle", $hpath, "struct*", $tpathdata)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError($aresult[0], $aresult[0], -1)
	Local $adata[$icount + 1][3]
	$adata[0][0] = $icount
	For $ii = 1 To $icount
		$adata[$ii][0] = DllStructGetData($tpoints, 1, (($ii - 1) * 2) + 1)
		$adata[$ii][1] = DllStructGetData($tpoints, 1, (($ii - 1) * 2) + 2)
		$adata[$ii][2] = DllStructGetData($ttypes, 1, $ii)
	Next
	Return $adata
EndFunc

Func _gdiplus_pathgetfillmode($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathFillMode", "handle", $hpath, "int*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathgetlastpoint($hpath)
	Local $tpointf = DllStructCreate("float;float")
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathLastPoint", "handle", $hpath, "struct*", $tpointf)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $apointf[2]
	$apointf[0] = DllStructGetData($tpointf, 1)
	$apointf[1] = DllStructGetData($tpointf, 2)
	Return $apointf
EndFunc

Func _gdiplus_pathgetpointcount($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPointCount", "handle", $hpath, "int*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathgetpoints($hpath)
	Local $ii, $icount, $tpoints, $apoints[1][1], $aresult
	$icount = _gdiplus_pathgetpointcount($hpath)
	If @error Then Return SetError(@error + 10, @extended, -1)
	$tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	$aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathPoints", "handle", $hpath, "struct*", $tpoints, "int", $icount)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $apoints[$icount + 1][2]
	$apoints[0][0] = $icount
	For $ii = 1 To $icount
		$apoints[$ii][0] = DllStructGetData($tpoints, 1, (($ii - 1) * 2) + 1)
		$apoints[$ii][1] = DllStructGetData($tpoints, 1, (($ii - 1) * 2) + 2)
	Next
	Return $apoints
EndFunc

Func _gdiplus_pathgetworldbounds($hpath, $hmatrix = 0, $hpen = 0)
	Local $trectf = DllStructCreate($taggdiprectf)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPathWorldBounds", "handle", $hpath, "struct*", $trectf, "handle", $hmatrix, "handle", $hpen)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $arectf[4]
	For $ii = 1 To 4
		$arectf[$ii - 1] = DllStructGetData($trectf, $ii)
	Next
	Return $arectf
EndFunc

Func _gdiplus_pathisoutlinevisiblepoint($hpath, $nx, $ny, $hpen = 0, $hgraphics = 0)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipIsOutlineVisiblePathPoint", "handle", $hpath, "float", $nx, "float", $ny, "handle", $hpen, "handle", $hgraphics, "int*", 0)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return $aresult[6] <> 0
EndFunc

Func _gdiplus_pathisvisiblepoint($hpath, $nx, $ny, $hgraphics = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipIsVisiblePathPoint", "handle", $hpath, "float", $nx, "float", $ny, "handle", $hgraphics, "int*", 0)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return $aresult[5] <> 0
EndFunc

Func _gdiplus_pathitercreate($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePathIter", "handle*", 0, "handle", $hpath)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[1]
EndFunc

Func _gdiplus_pathiterdispose($hpathiter)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeletePathIter", "handle", $hpathiter)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathitergetsubpathcount($hpathiter)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipPathIterGetSubpathCount", "handle", $hpathiter, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathiternextmarkerpath($hpathiter, $hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipPathIterNextMarkerPath", "handle", $hpathiter, "int*", 0, "handle", $hpath)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pathiternextsubpathpath($hpathiter, $hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipPathIterNextSubpathPath", "handle", $hpathiter, "int*", 0, "handle", $hpath, "bool*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $areturn[2]
	$areturn[0] = $aresult[2]
	$areturn[1] = $aresult[4]
	Return $areturn
EndFunc

Func _gdiplus_pathiterrewind($hpathiter)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipPathIterRewind", "handle", $hpathiter)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathreset($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipResetPath", "handle", $hpath)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathreverse($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipReversePath", "handle", $hpath)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathsetfillmode($hpath, $ifillmode)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathFillMode", "handle", $hpath, "int", $ifillmode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathsetmarker($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPathMarker", "handle", $hpath)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathstartfigure($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipStartPathFigure", "handle", $hpath)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathtransform($hpath, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTransformPath", "handle", $hpath, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathwarp($hpath, $hmatrix, $apoints, $nx, $ny, $nwidth, $nheight, $iwarpmode = 0, $fflatness = 0.25)
	Local $icount = $apoints[0][0]
	If $icount <> 3 AND $icount <> 4 Then Return SetError(11, 0, False)
	Local $tpoints = DllStructCreate("float[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tpoints, 1, $apoints[$ii][0], ($ii - 1) * 2 + 1)
		DllStructSetData($tpoints, 1, $apoints[$ii][1], ($ii - 1) * 2 + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipWarpPath", "handle", $hpath, "handle", $hmatrix, "struct*", $tpoints, "int", $icount, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "int", $iwarpmode, "float", $fflatness)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathwiden($hpath, $hpen, $hmatrix = 0, $fflatness = 0.25)
	__gdiplus_pendefcreate($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipWidenPath", "handle", $hpath, "handle", $hpen, "handle", $hmatrix, "float", $fflatness)
	__gdiplus_pendefdispose()
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pathwindingmodeoutline($hpath, $hmatrix = 0, $fflatness = 0.25)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipWindingModeOutline", "handle", $hpath, "handle", $hmatrix, "float", $fflatness)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pencreate($iargb = -16777216, $nwidth = 1, $iunit = 2)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePen1", "dword", $iargb, "float", $nwidth, "int", $iunit, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_pencreate2($hbrush, $nwidth = 1, $iunit = 2)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreatePen2", "handle", $hbrush, "float", $nwidth, "int", $iunit, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[4]
EndFunc

Func _gdiplus_pendispose($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeletePen", "handle", $hpen)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pengetalignment($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenMode", "handle", $hpen, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetcolor($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenColor", "handle", $hpen, "dword*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetcustomendcap($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenCustomEndCap", "handle", $hpen, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetdashcap($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenDashCap197819", "handle", $hpen, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetdashstyle($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenDashStyle", "handle", $hpen, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetendcap($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenEndCap", "handle", $hpen, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetmiterlimit($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenMiterLimit", "handle", $hpen, "float*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_pengetwidth($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetPenWidth", "handle", $hpen, "float*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_penresettransform($hpen)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipResetPenTransform", "handle", $hpen)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_penrotatetransform($hpen, $fangle, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipRotatePenTransform", "handle", $hpen, "float", $fangle, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_penscaletransform($hpen, $fscalex, $fscaley, $iorder = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipScalePenTransform", "handle", $hpen, "float", $fscalex, "float", $fscaley, "int", $iorder)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetalignment($hpen, $ialignment = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenMode", "handle", $hpen, "int", $ialignment)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetcolor($hpen, $iargb)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenColor", "handle", $hpen, "dword", $iargb)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetcompound($hpen, $acompounds)
	Local $icount = $acompounds[0]
	Local $tcompounds = DllStructCreate("float[" & $icount & "];")
	For $i = 1 To $icount
		DllStructSetData($tcompounds, 1, $acompounds[$i], $i)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenCompoundArray", "handle", $hpen, "struct*", $tcompounds, "int", $icount)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetcustomendcap($hpen, $hendcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenCustomEndCap", "handle", $hpen, "handle", $hendcap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetdashcap($hpen, $idash = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenDashCap197819", "handle", $hpen, "int", $idash)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetdashstyle($hpen, $istyle = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenDashStyle", "handle", $hpen, "int", $istyle)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetendcap($hpen, $iendcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenEndCap", "handle", $hpen, "int", $iendcap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetlinecap($hpen, $istartcap, $iendcap, $idashcap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenLineCap197819", "handle", $hpen, "int", $istartcap, "int", $iendcap, "int", $idashcap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetlinejoin($hpen, $ilinejoin)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenLineJoin", "handle", $hpen, "int", $ilinejoin)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetmiterlimit($hpen, $fmiterlimit)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenMiterLimit", "handle", $hpen, "float", $fmiterlimit)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetstartcap($hpen, $ilinecap)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenStartCap", "handle", $hpen, "int", $ilinecap)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensettransform($hpen, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenTransform", "handle", $hpen, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_pensetwidth($hpen, $fwidth)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetPenWidth", "handle", $hpen, "float", $fwidth)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_rectfcreate($nx = 0, $ny = 0, $nwidth = 0, $nheight = 0)
	Local $trectf = DllStructCreate($taggdiprectf)
	DllStructSetData($trectf, "X", $nx)
	DllStructSetData($trectf, "Y", $ny)
	DllStructSetData($trectf, "Width", $nwidth)
	DllStructSetData($trectf, "Height", $nheight)
	Return $trectf
EndFunc

Func _gdiplus_regionclone($hregion)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCloneRegion", "handle", $hregion, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_regioncombinepath($hregion, $hpath, $icombinemode = 2)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCombineRegionPath", "handle", $hregion, "handle", $hpath, "int", $icombinemode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regioncombinerect($hregion, $nx, $ny, $nwidth, $nheight, $icombinemode = 2)
	Local $trectf = _gdiplus_rectfcreate($nx, $ny, $nwidth, $nheight)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCombineRegionRect", "handle", $hregion, "struct*", $trectf, "int", $icombinemode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regioncombineregion($hregiondst, $hregionsrc, $icombinemode = 2)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCombineRegionRegion", "handle", $hregiondst, "handle", $hregionsrc, "int", $icombinemode)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regioncreate()
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateRegion", "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[1]
EndFunc

Func _gdiplus_regioncreatefrompath($hpath)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateRegionPath", "handle", $hpath, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_regioncreatefromrect($nx, $ny, $nwidth, $nheight)
	Local $trectf = _gdiplus_rectfcreate($nx, $ny, $nwidth, $nheight)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateRegionRect", "struct*", $trectf, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_regiondispose($hregion)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteRegion", "handle", $hregion)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regiongetbounds($hregion, $hgraphics)
	Local $trectf = DllStructCreate($taggdiprectf)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetRegionBounds", "handle", $hregion, "handle", $hgraphics, "struct*", $trectf)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Local $abounds[4]
	For $ii = 1 To 4
		$abounds[$ii - 1] = DllStructGetData($trectf, $ii)
	Next
	Return $abounds
EndFunc

Func _gdiplus_regiongethrgn($hregion, $hgraphics = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetRegionHRgn", "handle", $hregion, "handle", $hgraphics, "handle*", 0)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return $aresult[3]
EndFunc

Func _gdiplus_regionsetempty($hregion)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetEmpty", "handle", $hregion)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regionsetinfinite($hregion)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetInfinite", "handle", $hregion)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regiontransform($hregion, $hmatrix)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTransformRegion", "handle", $hregion, "handle", $hmatrix)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_regiontranslate($hregion, $ndx, $ndy)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipTranslateRegion", "handle", $hregion, "float", $ndx, "float", $ndy)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_shutdown()
	If $__g_hgdipdll = 0 Then Return SetError(-1, -1, False)
	$__g_igdipref -= 1
	If $__g_igdipref = 0 Then
		DllCall($__g_hgdipdll, "none", "GdiplusShutdown", "ulong_ptr", $__g_igdiptoken)
		DllClose($__g_hgdipdll)
		$__g_hgdipdll = 0
	EndIf
	Return True
EndFunc

Func _gdiplus_startup($sgdipdll = Default, $bretdllhandle = False)
	$__g_igdipref += 1
	If $__g_igdipref > 1 Then Return True
	If $sgdipdll = Default Then $sgdipdll = "gdiplus.dll"
	$__g_hgdipdll = DllOpen($sgdipdll)
	If $__g_hgdipdll = -1 Then
		$__g_igdipref = 0
		Return SetError(1, 2, False)
	EndIf
	Local $sver = FileGetVersion($sgdipdll)
	$sver = StringSplit($sver, ".")
	If $sver[1] > 5 Then $__g_bgdip_v1_0 = False
	Local $tinput = DllStructCreate($taggdipstartupinput)
	Local $ttoken = DllStructCreate("ulong_ptr Data")
	DllStructSetData($tinput, "Version", 1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdiplusStartup", "struct*", $ttoken, "struct*", $tinput, "ptr", 0)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	$__g_igdiptoken = DllStructGetData($ttoken, "Data")
	If $bretdllhandle Then Return $__g_hgdipdll
	Return SetExtended($sver[1], True)
EndFunc

Func _gdiplus_stringformatcreate($iformat = 0, $ilangid = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateStringFormat", "int", $iformat, "word", $ilangid, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_stringformatdispose($hformat)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteStringFormat", "handle", $hformat)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_stringformatgetmeasurablecharacterrangecount($hstringformat)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetStringFormatMeasurableCharacterRangeCount", "handle", $hstringformat, "int*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_stringformatsetalign($hstringformat, $iflag)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetStringFormatAlign", "handle", $hstringformat, "int", $iflag)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_stringformatsetlinealign($hstringformat, $istringalign)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetStringFormatLineAlign", "handle", $hstringformat, "int", $istringalign)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_stringformatsetmeasurablecharacterranges($hstringformat, $aranges)
	Local $icount = $aranges[0][0]
	Local $tcharacterranges = DllStructCreate("int[" & $icount * 2 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tcharacterranges, 1, $aranges[$ii][0], (($ii - 1) * 2) + 1)
		DllStructSetData($tcharacterranges, 1, $aranges[$ii][1], (($ii - 1) * 2) + 2)
	Next
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetStringFormatMeasurableCharacterRanges", "handle", $hstringformat, "int", $icount, "struct*", $tcharacterranges)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_texturecreate($himage, $iwrapmode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateTexture", "handle", $himage, "int", $iwrapmode, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_texturecreate2($himage, $nx, $ny, $nwidth, $nheight, $iwrapmode = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateTexture2", "handle", $himage, "int", $iwrapmode, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[7]
EndFunc

Func _gdiplus_texturecreateia($himage, $nx, $ny, $nwidth, $nheight, $pimageattributes = 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipCreateTextureIA", "handle", $himage, "handle", $pimageattributes, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "ptr*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[7]
EndFunc

Func __gdiplus_brushdefcreate(ByRef $hbrush)
	If $hbrush = 0 Then
		$__g_hgdipbrush = _gdiplus_brushcreatesolid()
		$hbrush = $__g_hgdipbrush
	EndIf
EndFunc

Func __gdiplus_brushdefdispose($icurerror = @error, $icurextended = @extended)
	If $__g_hgdipbrush <> 0 Then
		_gdiplus_brushdispose($__g_hgdipbrush)
		$__g_hgdipbrush = 0
	EndIf
	Return SetError($icurerror, $icurextended)
EndFunc

Func __gdiplus_extractfileext($sfilename, $bnodot = True)
	Local $iindex = __gdiplus_lastdelimiter(".\:", $sfilename)
	If ($iindex > 0) AND (StringMid($sfilename, $iindex, 1) = ".") Then
		If $bnodot Then
			Return StringMid($sfilename, $iindex + 1)
		Else
			Return StringMid($sfilename, $iindex)
		EndIf
	Else
		Return ""
	EndIf
EndFunc

Func __gdiplus_lastdelimiter($sdelimiters, $sstring)
	Local $sdelimiter, $in
	For $ii = 1 To StringLen($sdelimiters)
		$sdelimiter = StringMid($sdelimiters, $ii, 1)
		$in = StringInStr($sstring, $sdelimiter, $str_nocasesensebasic, -1)
		If $in > 0 Then Return $in
	Next
EndFunc

Func __gdiplus_pendefcreate(ByRef $hpen)
	If $hpen = 0 Then
		$__g_hgdippen = _gdiplus_pencreate()
		$hpen = $__g_hgdippen
	EndIf
EndFunc

Func __gdiplus_pendefdispose($icurerror = @error, $icurextended = @extended)
	If $__g_hgdippen <> 0 Then
		_gdiplus_pendispose($__g_hgdippen)
		$__g_hgdippen = 0
	EndIf
	Return SetError($icurerror, $icurextended)
EndFunc

Func _gdiplus_bitmapapplyeffect($hbitmap, $heffect, $trect = NULL )
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	If NOT IsPtr($heffect) Then Return SetError(10, 0, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapApplyEffect", "handle", $hbitmap, "handle", $heffect, "struct*", $trect, "int", 0, "ptr*", 0, "int*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapapplyeffectex($hbitmap, $heffect, $ix = 0, $iy = 0, $iw = 0, $ih = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $trect = 0
	If BitOR($ix, $iy, $iw, $ih) Then
		$trect = DllStructCreate("int Left; int Top; int Right; int Bottom;")
		DllStructSetData($trect, "Right", $iw + DllStructSetData($trect, "Left", $ix))
		DllStructSetData($trect, "Bottom", $ih + DllStructSetData($trect, "Top", $iy))
	EndIf
	Local $istatus = _gdiplus_bitmapapplyeffect($hbitmap, $heffect, $trect)
	If NOT $istatus Then Return SetError(@error, @extended, False)
	Return True
EndFunc

Func _gdiplus_bitmapconvertformat($hbitmap, $ipixelformat, $idithertype, $ipalettetype, $tpalette, $falphathresholdpercent = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapConvertFormat", "handle", $hbitmap, "uint", $ipixelformat, "uint", $idithertype, "uint", $ipalettetype, "struct*", $tpalette, "float", $falphathresholdpercent)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapcreateapplyeffect($hbitmap, $heffect, $trect = NULL , $toutrect = NULL )
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapCreateApplyEffect", "handle*", $hbitmap, "int", 1, "handle", $heffect, "struct*", $trect, "struct*", $toutrect, "handle*", 0, "int", 0, "ptr*", 0, "int*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[6]
EndFunc

Func _gdiplus_bitmapcreateapplyeffectex($hbitmap, $heffect, $ix = 0, $iy = 0, $iw = 0, $ih = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $trect = 0
	If BitOR($ix, $iy, $iw, $ih) Then
		$trect = DllStructCreate("int Left; int Top; int Right; int Bottom;")
		DllStructSetData($trect, "Right", $iw + DllStructSetData($trect, "Left", $ix))
		DllStructSetData($trect, "Bottom", $ih + DllStructSetData($trect, "Top", $iy))
	EndIf
	Local $hbitmap_fx = _gdiplus_bitmapcreateapplyeffect($hbitmap, $heffect, $trect, NULL )
	Return SetError(@error, @extended, $hbitmap_fx)
EndFunc

Func _gdiplus_bitmapgethistogram($hbitmap, $ihistogramformat, $ihistogramsize, $tchannel_0, $tchannel_1 = 0, $tchannel_2 = 0, $tchannel_3 = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapGetHistogram", "handle", $hbitmap, "uint", $ihistogramformat, "uint", $ihistogramsize, "struct*", $tchannel_0, "struct*", $tchannel_1, "struct*", $tchannel_2, "struct*", $tchannel_3)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_bitmapgethistogramex($hbitmap)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $isize = _gdiplus_bitmapgethistogramsize($gdip_histogramformatargb)
	Local $thistogram = DllStructCreate("int Size; uint Red[" & $isize & "]; uint MaxRed; uint Green[" & $isize & "]; uint MaxGreen; uint Blue[" & $isize & "]; uint MaxBlue; uint Alpha[" & $isize & "]; uint MaxAlpha; uint Grey[" & $isize & "]; uint MaxGrey;")
	DllStructSetData($thistogram, "Size", $isize)
	Local $istatus = _gdiplus_bitmapgethistogram($hbitmap, $gdip_histogramformatargb, $isize, DllStructGetPtr($thistogram, "Alpha"), DllStructGetPtr($thistogram, "Red"), DllStructGetPtr($thistogram, "Green"), DllStructGetPtr($thistogram, "Blue"))
	If NOT $istatus Then Return SetError(@error, @extended, 0)
	$istatus = _gdiplus_bitmapgethistogram($hbitmap, $gdip_histogramformatgray, $isize, DllStructGetPtr($thistogram, "Grey"))
	If NOT $istatus Then Return SetError(@error + 10, @extended, 0)
	Local $imaxred = 0, $imaxgreen = 0, $imaxblue = 0, $imaxalpha = 0, $imaxgrey = 0
	For $i = 1 To $isize
		If DllStructGetData($thistogram, "Red", $i) > $imaxred Then $imaxred = DllStructGetData($thistogram, "Red", $i)
		If DllStructGetData($thistogram, "Green", $i) > $imaxgreen Then $imaxgreen = DllStructGetData($thistogram, "Green", $i)
		If DllStructGetData($thistogram, "Blue", $i) > $imaxblue Then $imaxblue = DllStructGetData($thistogram, "Blue", $i)
		If DllStructGetData($thistogram, "Alpha", $i) > $imaxalpha Then $imaxalpha = DllStructGetData($thistogram, "Alpha", $i)
		If DllStructGetData($thistogram, "Grey", $i) > $imaxgrey Then $imaxgrey = DllStructGetData($thistogram, "Grey", $i)
	Next
	DllStructSetData($thistogram, "MaxRed", $imaxred)
	DllStructSetData($thistogram, "MaxGreen", $imaxgreen)
	DllStructSetData($thistogram, "MaxBlue", $imaxblue)
	DllStructSetData($thistogram, "MaxAlpha", $imaxalpha)
	DllStructSetData($thistogram, "MaxGrey", $imaxgrey)
	Return $thistogram
EndFunc

Func _gdiplus_bitmapgethistogramsize($iformat)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipBitmapGetHistogramSize", "uint", $iformat, "uint*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[2]
EndFunc

Func _gdiplus_drawimagefx($hgraphics, $himage, $heffect, $trectf = 0, $hmatrix = 0, $himgattributes = 0, $iunit = 2)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDrawImageFX", "handle", $hgraphics, "handle", $himage, "struct*", $trectf, "handle", $hmatrix, "handle", $heffect, "handle", $himgattributes, "uint", $iunit)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_drawimagefxex($hgraphics, $himage, $heffect, $nx = 0, $ny = 0, $nw = 0, $nh = 0, $hmatrix = 0, $himgattributes = 0, $iunit = 2)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $trectf = 0
	If BitOR($nx, $ny, $nw, $nh) Then $trectf = _gdiplus_rectfcreate($nx, $ny, $nw, $nh)
	Local $istatus = _gdiplus_drawimagefx($hgraphics, $himage, $heffect, $trectf, $hmatrix, $himgattributes, $iunit)
	Return SetError(@error, @extended, $istatus)
EndFunc

Func _gdiplus_effectcreate($seffectguid)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $tguid = _winapi_guidfromstring($seffectguid)
	Local $aresult = 0
	If @AutoItX64 Then
		$aresult = DllCall($__g_hgdipdll, "int", "GdipCreateEffect", "struct*", $tguid, "handle*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		If $aresult[0] Then Return SetError(10, $aresult[0], 0)
		Return $aresult[2]
	EndIf
	Local $telem = DllStructCreate("uint64[2];", DllStructGetPtr($tguid))
	$aresult = DllCall($__g_hgdipdll, "int", "GdipCreateEffect", "uint64", DllStructGetData($telem, 1, 1), "uint64", DllStructGetData($telem, 1, 2), "handle*", 0)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $aresult[3]
EndFunc

Func _gdiplus_effectcreateblur($fradius = 10, $bexpandedge = False)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_blur)
	DllStructSetData($teffectparameters, "Radius", $fradius)
	DllStructSetData($teffectparameters, "ExpandEdge", $bexpandedge)
	Local $heffect = _gdiplus_effectcreate($gdip_blureffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatebrightnesscontrast($ibrightnesslevel = 0, $icontrastlevel = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_brightnesscontrast)
	DllStructSetData($teffectparameters, "BrightnessLevel", $ibrightnesslevel)
	DllStructSetData($teffectparameters, "ContrastLevel", $icontrastlevel)
	Local $heffect = _gdiplus_effectcreate($gdip_brightnesscontrasteffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatecolorbalance($icyanred = 0, $imagentagreen = 0, $iyellowblue = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_colorbalance)
	DllStructSetData($teffectparameters, "CyanRed", $icyanred)
	DllStructSetData($teffectparameters, "MagentaGreen", $imagentagreen)
	DllStructSetData($teffectparameters, "YellowBlue", $iyellowblue)
	Local $heffect = _gdiplus_effectcreate($gdip_colorbalanceeffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatecolorcurve($iadjustment, $ichannel, $iadjustvalue)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_colorcurve)
	DllStructSetData($teffectparameters, "Adjustment", $iadjustment)
	DllStructSetData($teffectparameters, "Channel", $ichannel)
	DllStructSetData($teffectparameters, "AdjustValue", $iadjustvalue)
	Local $heffect = _gdiplus_effectcreate($gdip_colorcurveeffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatecolorlut($acolorlut)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_colorlut)
	For $ii = 0 To 255
		DllStructSetData($teffectparameters, "LutA", $acolorlut[$ii][0], $ii + 1)
		DllStructSetData($teffectparameters, "LutR", $acolorlut[$ii][1], $ii + 1)
		DllStructSetData($teffectparameters, "LutG", $acolorlut[$ii][2], $ii + 1)
		DllStructSetData($teffectparameters, "LutB", $acolorlut[$ii][3], $ii + 1)
	Next
	Local $heffect = _gdiplus_effectcreate($gdip_colorluteffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatecolormatrix($tcolormatrix)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $heffect = _gdiplus_effectcreate($gdip_colormatrixeffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $tcolormatrix)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatehuesaturationlightness($ihuelevel = 0, $isaturationlevel = 0, $ilightnesslevel = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_huesaturationlightness)
	DllStructSetData($teffectparameters, "HueLevel", $ihuelevel)
	DllStructSetData($teffectparameters, "SaturationLevel", $isaturationlevel)
	DllStructSetData($teffectparameters, "LightnessLevel", $ilightnesslevel)
	Local $heffect = _gdiplus_effectcreate($gdip_huesaturationlightnesseffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatelevels($ihighlight = 100, $imidtone = 0, $ishadow = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_levels)
	DllStructSetData($teffectparameters, "Highlight", $ihighlight)
	DllStructSetData($teffectparameters, "Midtone", $imidtone)
	DllStructSetData($teffectparameters, "Shadow", $ishadow)
	Local $heffect = _gdiplus_effectcreate($gdip_levelseffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreateredeyecorrection($aareas)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $icount = $aareas[0][0]
	Local $tareas = DllStructCreate("long[" & $icount * 4 & "]")
	For $ii = 1 To $icount
		DllStructSetData($tareas, 1, DllStructSetData($tareas, 1, $aareas[$ii][0], (($ii - 1) * 4) + 1) + $aareas[$ii][2], (($ii - 1) * 4) + 3)
		DllStructSetData($tareas, 1, DllStructSetData($tareas, 1, $aareas[$ii][1], (($ii - 1) * 4) + 2) + $aareas[$ii][3], (($ii - 1) * 4) + 4)
	Next
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_redeyecorrection)
	DllStructSetData($teffectparameters, "NumberOfAreas", $icount)
	DllStructSetData($teffectparameters, "Areas", DllStructGetPtr($tareas))
	Local $heffect = _gdiplus_effectcreate($gdip_redeyecorrectioneffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters, (DllStructGetSize($tareas) + DllStructGetSize($teffectparameters)) / DllStructGetSize($teffectparameters))
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatesharpen($fradius = 10, $famount = 50)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_sharpen)
	DllStructSetData($teffectparameters, "Radius", $fradius)
	DllStructSetData($teffectparameters, "Amount", $famount)
	Local $heffect = _gdiplus_effectcreate($gdip_sharpeneffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectcreatetint($ihue = 0, $iamount = 0)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	Local $teffectparameters = DllStructCreate($taggdip_effectparams_tint)
	DllStructSetData($teffectparameters, "Hue", $ihue)
	DllStructSetData($teffectparameters, "Amount", $iamount)
	Local $heffect = _gdiplus_effectcreate($gdip_tinteffectguid)
	If @error Then Return SetError(@error, @extended, 0)
	_gdiplus_effectsetparameters($heffect, $teffectparameters)
	If @error Then Return SetError(@error + 10, @extended, 0)
	Return $heffect
EndFunc

Func _gdiplus_effectdispose($heffect)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipDeleteEffect", "handle", $heffect)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_effectgetparameters($heffect, $teffectparameters)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	If DllStructGetSize($teffectparameters) < __gdiplus_effectgetparametersize($heffect) Then Return SetError(2, 5, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetEffectParameters", "handle", $heffect, "uint*", DllStructGetSize($teffectparameters), "struct*", $teffectparameters)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func __gdiplus_effectgetparametersize($heffect)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, -1)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipGetEffectParameterSize", "handle", $heffect, "uint*", 0)
	If @error Then Return SetError(@error, @extended, -1)
	If $aresult[0] Then Return SetError(10, $aresult[0], -1)
	Return $aresult[2]
EndFunc

Func _gdiplus_effectsetparameters($heffect, $teffectparameters, $isizeadjust = 1)
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, False)
	Local $isize = __gdiplus_effectgetparametersize($heffect)
	If @error Then Return SetError(@error, @extended, False)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipSetEffectParameters", "handle", $heffect, "struct*", $teffectparameters, "uint", $isize * $isizeadjust)
	If @error Then Return SetError(@error, @extended, False)
	If $aresult[0] Then Return SetError(10, $aresult[0], False)
	Return True
EndFunc

Func _gdiplus_paletteinitialize($ientries, $ipalettetype = $gdip_palettetypeoptimal, $ioptimalcolors = 0, $busetransparentcolor = True, $hbitmap = NULL )
	If $__g_bgdip_v1_0 Then Return SetError(-1, 0, 0)
	If $ioptimalcolors > 0 Then $ipalettetype = $gdip_palettetypeoptimal
	Local $tpalette = DllStructCreate("uint Flags; uint Count; uint ARGB[" & $ientries & "];")
	DllStructSetData($tpalette, "Flags", $ipalettetype)
	DllStructSetData($tpalette, "Count", $ientries)
	Local $aresult = DllCall($__g_hgdipdll, "int", "GdipInitializePalette", "struct*", $tpalette, "uint", $ipalettetype, "uint", $ioptimalcolors, "bool", $busetransparentcolor, "handle", $hbitmap)
	If @error Then Return SetError(@error, @extended, 0)
	If $aresult[0] Then Return SetError(10, $aresult[0], 0)
	Return $tpalette
EndFunc

Global $pic_map, $pic_flag

Func _create_guiinfo()
	#Region ### START Koda GUI section ### Form=
		$width = 584
		$height = 560
		$info_lb_width = 205
		$info_lb_height = 25
		Global $guiinfo = GUICreate("GuiInfo", $width, $height, (@DesktopWidth - $width) / 2, (@DesktopHeight - $height) / 2, $ws_popup)
		_gui_roundcorners($guiinfo, 10, 10)
		GUISetBkColor(13423868)
		GUISetFont(13, 400, 0, "Segoe UI")
		$pic_map = _gdiplus_createpic("", 5, 80, 240, 240)
		$pic_flag = _gdiplus_createpic("", 180, 272, 68, 68)
		Global $lb_name = GUICtrlCreateLabel("", 0, 0, $width, 41, BitOR($ss_center, $ss_centerimage), $gui_ws_ex_parentdrag)
		GUICtrlSetBkColor(-1, 4149685)
		GUICtrlSetColor(-1, 16777215)
		GUICtrlSetFont(-1, 14, 700)
		GUICtrlCreateLabel("Diện tích:", 263, 88, -1, 25, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetFont(-1, 13, 700, 0, "Segoe UI")
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		Global $lb_square = GUICtrlCreateLabel("", 366, 88, $info_lb_width, $info_lb_height, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		GUICtrlCreateLabel("Dân số:", 263, 128, -1, 25, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetFont(-1, 13, 700, 0, "Segoe UI")
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		Global $lb_population = GUICtrlCreateLabel("", 366, 128, $info_lb_width, $info_lb_height, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		GUICtrlCreateLabel("Tiền tệ:", 263, 168, -1, 25, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetFont(-1, 13, 700, 0, "Segoe UI")
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		Global $lb_currency = GUICtrlCreateLabel("", 366, 168, $info_lb_width, $info_lb_height, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		GUICtrlCreateLabel("Thủ đô:", 263, 208, -1, 25, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetFont(-1, 13, 700, 0, "Segoe UI")
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		Global $lb_capital = GUICtrlCreateLabel("", 366, 208, $info_lb_width, $info_lb_height, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		GUICtrlCreateLabel("Múi giờ:", 263, 248, -1, -1, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetFont(-1, 13, 700, 0, "Segoe UI")
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		Global $lb_timezone = GUICtrlCreateLabel("", 366, 248, $info_lb_width, $info_lb_height, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetColor(-1, 2301728)
		GUICtrlSetBkColor(-1, $gui_bkcolor_transparent)
		Global $btn_close = GUICtrlCreateLabel("Đóng", 248, 490, 90, 33, BitOR($ss_center, $ss_centerimage))
		GUICtrlSetBkColor(-1, 370)
		GUICtrlSetColor(-1, 16777215)
		GUICtrlSetFont(-1, 14, 400, 0, "Segoe UI", 5)
		GUICtrlSetCursor(-1, 0)
	EndFunc

	Func _setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
		GUICtrlSetData($lb_name, StringUpper($fullname))
		GUICtrlSetData($lb_square, $square)
		GUICtrlDelete($pic_map)
		GUICtrlDelete($pic_flag)
		$pic_map = _gdiplus_createpic($dir_picmap, 5, 80, 220, 220)
		$pic_flag = _gdiplus_createpic($dir_picflag, 180, 272, 100, 100)
		GUICtrlSetData($lb_population, $population)
		GUICtrlSetData($lb_currency, $currency)
		GUICtrlSetData($lb_capital, $capital)
		GUICtrlSetData($lb_timezone, $timezone)
		WinSetTrans($guiinfo, "", 247)
		WinSetOnTop($guiinfo, "", 1)
		GUISetState(@SW_SHOW, $guiinfo)
		While 1
			$nmsg = GUIGetMsg()
			Switch $nmsg
				Case $gui_event_close, $btn_close
					GUISetState(@SW_HIDE, $guiinfo)
					ExitLoop
			EndSwitch
		WEnd
	EndFunc

	Func _gdiplus_createpic($filename, $left, $top, $width, $heigth)
		Local $hpicctrl, $himage, $iheight, $hgdibitmap
		_gdiplus_startup()
		$himage = _gdiplus_imageresize(_gdiplus_imageloadfromfile($filename), $width, $heigth)
		$iwidth = _gdiplus_imagegetwidth($himage)
		$iheight = _gdiplus_imagegetheight($himage)
		$hgdibitmap = _gdiplus_bitmapcreatehbitmapfrombitmap($himage)
		_gdiplus_imagedispose($himage)
		$hpicctrl = GUICtrlCreatePic("", $left, $top, $width, $heigth)
		_winapi_deleteobject(GUICtrlSendMsg($hpicctrl, 370, $image_bitmap, $hgdibitmap))
		_winapi_deleteobject($hgdibitmap)
		_gdiplus_shutdown()
		Return $hpicctrl
	EndFunc

	Func _gdiplus_setpic($filename)
	EndFunc

	_winapi_addfontresourceex(@ScriptDir & "\font\segoeui.ttf", $fr_private)
	_winapi_addfontresourceex(@ScriptDir & "\font\fontawesome.ttf", $fr_private)
	#Region Header
	#EndRegion Header
	#Region Global Variables
		Global $__g_iieloadwaittimeout = 300000
		Global $__g_bieau3debug = False
		Global $__g_bieerrornotify = True
		Global $__g_oieerrorhandler, $__g_sieusererrorhandler
	#EndRegion Global Variables
	#Region Global Constants
		Global Const $__gaieau3versioninfo[6] = ["T", 3, 0, 2, "20140819", "T3.0-2"]
		Global Const $lsfw_lock = 1, $lsfw_unlock = 2
		Global Enum $_iestatus_success = 0, $_iestatus_generalerror, $_iestatus_comerror, $_iestatus_invaliddatatype, $_iestatus_invalidobjecttype, $_iestatus_invalidvalue, $_iestatus_loadwaittimeout, $_iestatus_nomatch, $_iestatus_accessisdenied, $_iestatus_clientdisconnected
	#EndRegion Global Constants
	#Region Core functions

		Func _iecreate($surl = "about:blank", $itryattach = 0, $ivisible = 1, $iwait = 1, $itakefocus = 1)
			If NOT $ivisible Then $itakefocus = 0
			If $itryattach Then
				Local $oresult = _ieattach($surl, "url")
				If IsObj($oresult) Then
					If $itakefocus Then WinActivate(HWnd($oresult.hwnd))
					Return SetError($_iestatus_success, 1, $oresult)
				EndIf
			EndIf
			Local $imustunlock = 0
			If NOT $ivisible AND __ielocksetforegroundwindow($lsfw_lock) Then $imustunlock = 1
			Local $oobject = ObjCreate("InternetExplorer.Application")
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IECreate", "", "Browser Object Creation Failed")
				If $imustunlock Then __ielocksetforegroundwindow($lsfw_unlock)
				Return SetError($_iestatus_generalerror, 0, 0)
			EndIf
			$oobject.visible = $ivisible
			If $imustunlock AND NOT __ielocksetforegroundwindow($lsfw_unlock) Then __ieconsolewriteerror("Warning", "_IECreate", "", "Foreground Window Unlock Failed!")
			_ienavigate($oobject, $surl, $iwait)
			Local $ierror = @error
			If NOT $ierror AND StringLeft($surl, 6) = "about:" Then
				Local $odocument = $oobject.document
				_ieaction($odocument, "focus")
			EndIf
			Return SetError($ierror, 0, $oobject)
		EndFunc

		Func _iecreateembedded()
			Local $oobject = ObjCreate("Shell.Explorer.2")
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IECreateEmbedded", "", "WebBrowser Object Creation Failed")
				Return SetError($_iestatus_generalerror, 0, 0)
			EndIf
			Return SetError($_iestatus_success, 0, $oobject)
		EndFunc

		Func _ienavigate(ByRef $oobject, $surl, $iwait = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IENavigate", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "documentContainer") Then
				__ieconsolewriteerror("Error", "_IENavigate", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.navigate($surl)
			If @error Then
				__ieconsolewriteerror("Error", "_IENavigate", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			If $iwait Then
				_ieloadwait($oobject)
				Return SetError(@error, 0, -1)
			EndIf
			Return SetError($_iestatus_success, 0, -1)
		EndFunc

		Func _ieattach($sstring, $smode = "title", $iinstance = 1)
			$smode = StringLower($smode)
			$iinstance = Int($iinstance)
			If $iinstance < 1 Then
				__ieconsolewriteerror("Error", "_IEAttach", "$_IESTATUS_InvalidValue", "$iInstance < 1")
				Return SetError($_iestatus_invalidvalue, 3, 0)
			EndIf
			If $smode = "embedded" OR $smode = "dialogbox" Then
				Local $iwintitlematchmode = Opt("WinTitleMatchMode", $opt_matchany)
				If $smode = "dialogbox" AND $iinstance > 1 Then
					If IsHWnd($sstring) Then
						$iinstance = 1
						__ieconsolewriteerror("Warning", "_IEAttach", "$_IESTATUS_GeneralError", "$iInstance > 1 invalid with HWnd and DialogBox.  Setting to 1.")
					Else
						Local $awinlist = WinList($sstring, "")
						If $iinstance <= $awinlist[0][0] Then
							$sstring = $awinlist[$iinstance][1]
							$iinstance = 1
						Else
							__ieconsolewriteerror("Warning", "_IEAttach", "$_IESTATUS_NoMatch")
							Opt("WinTitleMatchMode", $iwintitlematchmode)
							Return SetError($_iestatus_nomatch, 1, 0)
						EndIf
					EndIf
				EndIf
				Local $hcontrol = ControlGetHandle($sstring, "", "[CLASS:Internet Explorer_Server; INSTANCE:" & $iinstance & "]")
				Local $oresult = __iecontrolgetobjfromhwnd($hcontrol)
				Opt("WinTitleMatchMode", $iwintitlematchmode)
				If IsObj($oresult) Then
					Return SetError($_iestatus_success, 0, $oresult)
				Else
					__ieconsolewriteerror("Warning", "_IEAttach", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 1, 0)
				EndIf
			EndIf
			Local $oshell = ObjCreate("Shell.Application")
			Local $oshellwindows = $oshell.windows()
			Local $itmp = 1
			Local $inotifystatus, $bisbrowser, $stmp
			Local $bstatus
			For $owindow In $oshellwindows
				$bisbrowser = True
				$bstatus = __ieinternalerrorhandlerregister()
				If NOT $bstatus Then __ieconsolewriteerror("Warning", "_IEAttach", "Cannot register internal error handler, cannot trap COM errors", "Use _IEErrorHandlerRegister() to register a user error handler")
				$inotifystatus = _ieerrornotify()
				_ieerrornotify(False)
				If $bisbrowser Then
					$stmp = $owindow.type
					If @error Then $bisbrowser = False
				EndIf
				If $bisbrowser Then
					$stmp = $owindow.document.title
					If @error Then $bisbrowser = False
				EndIf
				_ieerrornotify($inotifystatus)
				__ieinternalerrorhandlerderegister()
				If $bisbrowser Then
					Switch $smode
						Case "title"
							If StringInStr($owindow.document.title, $sstring) > 0 Then
								If $iinstance = $itmp Then
									Return SetError($_iestatus_success, 0, $owindow)
								Else
									$itmp += 1
								EndIf
							EndIf
						Case "instance"
							If $iinstance = $itmp Then
								Return SetError($_iestatus_success, 0, $owindow)
							Else
								$itmp += 1
							EndIf
						Case "windowtitle"
							Local $bfound = False
							$stmp = RegRead("HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\", "Window Title")
							If NOT @error Then
								If StringInStr($owindow.document.title & " - " & $stmp, $sstring) Then $bfound = True
							Else
								If StringInStr($owindow.document.title & " - Microsoft Internet Explorer", $sstring) Then $bfound = True
								If StringInStr($owindow.document.title & " - Windows Internet Explorer", $sstring) Then $bfound = True
							EndIf
							If $bfound Then
								If $iinstance = $itmp Then
									Return SetError($_iestatus_success, 0, $owindow)
								Else
									$itmp += 1
								EndIf
							EndIf
						Case "url"
							If StringInStr($owindow.locationurl, $sstring) > 0 Then
								If $iinstance = $itmp Then
									Return SetError($_iestatus_success, 0, $owindow)
								Else
									$itmp += 1
								EndIf
							EndIf
						Case "text"
							If StringInStr($owindow.document.body.innertext, $sstring) > 0 Then
								If $iinstance = $itmp Then
									Return SetError($_iestatus_success, 0, $owindow)
								Else
									$itmp += 1
								EndIf
							EndIf
						Case "html"
							If StringInStr($owindow.document.body.innerhtml, $sstring) > 0 Then
								If $iinstance = $itmp Then
									Return SetError($_iestatus_success, 0, $owindow)
								Else
									$itmp += 1
								EndIf
							EndIf
						Case "hwnd"
							If $iinstance > 1 Then
								$iinstance = 1
								__ieconsolewriteerror("Warning", "_IEAttach", "$_IESTATUS_GeneralError", "$iInstance > 1 invalid with HWnd.  Setting to 1.")
							EndIf
							If _iepropertyget($owindow, "hwnd") = $sstring Then
								Return SetError($_iestatus_success, 0, $owindow)
							EndIf
						Case Else
							__ieconsolewriteerror("Error", "_IEAttach", "$_IESTATUS_InvalidValue", "Invalid Mode Specified")
							Return SetError($_iestatus_invalidvalue, 2, 0)
					EndSwitch
				EndIf
			Next
			__ieconsolewriteerror("Warning", "_IEAttach", "$_IESTATUS_NoMatch")
			Return SetError($_iestatus_nomatch, 1, 0)
		EndFunc

		Func _ieloadwait(ByRef $oobject, $idelay = 0, $itimeout = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IELoadWait", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IELoadWait", "$_IESTATUS_InvalidObjectType", ObjName($oobject))
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $otemp, $babort = False, $ierrorstatuscode = $_iestatus_success
			Local $bstatus = __ieinternalerrorhandlerregister()
			If NOT $bstatus Then __ieconsolewriteerror("Warning", "_IELoadWait", "Cannot register internal error handler, cannot trap COM errors", "Use _IEErrorHandlerRegister() to register a user error handler")
			Local $inotifystatus = _ieerrornotify()
			_ieerrornotify(False)
			Sleep($idelay)
			Local $ierror
			Local $hieloadwaittimer = TimerInit()
			If $itimeout = -1 Then $itimeout = $__g_iieloadwaittimeout
			Select 
				Case __ieisobjtype($oobject, "browser", False)
					While NOT (String($oobject.readystate) = "complete" OR $oobject.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
					While NOT (String($oobject.document.readystate) = "complete" OR $oobject.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
				Case __ieisobjtype($oobject, "window", False)
					While NOT (String($oobject.document.readystate) = "complete" OR $oobject.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
					While NOT (String($oobject.top.document.readystate) = "complete" OR $oobject.top.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
				Case __ieisobjtype($oobject, "document", False)
					$otemp = $oobject.parentwindow
					While NOT (String($otemp.document.readystate) = "complete" OR $otemp.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
					While NOT (String($otemp.top.document.readystate) = "complete" OR $otemp.top.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
				Case Else
					$otemp = $oobject.document.parentwindow
					While NOT (String($otemp.document.readystate) = "complete" OR $otemp.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
					While NOT (String($otemp.top.document.readystate) = "complete" OR $oobject.top.document.readystate = 4 OR $babort)
						If @error Then
							$ierror = @error
							If __iecomerrorunrecoverable($ierror) Then
								$ierrorstatuscode = __iecomerrorunrecoverable($ierror)
								$babort = True
							EndIf
						ElseIf (TimerDiff($hieloadwaittimer) > $itimeout) Then
							$ierrorstatuscode = $_iestatus_loadwaittimeout
							$babort = True
						EndIf
						Sleep(100)
					WEnd
			EndSelect
			_ieerrornotify($inotifystatus)
			__ieinternalerrorhandlerderegister()
			Switch $ierrorstatuscode
				Case $_iestatus_success
					Return SetError($_iestatus_success, 0, 1)
				Case $_iestatus_loadwaittimeout
					__ieconsolewriteerror("Warning", "_IELoadWait", "$_IESTATUS_LoadWaitTimeout")
					Return SetError($_iestatus_loadwaittimeout, 3, 0)
				Case $_iestatus_accessisdenied
					__ieconsolewriteerror("Warning", "_IELoadWait", "$_IESTATUS_AccessIsDenied", "Cannot verify readyState.  Likely casue: cross-domain scripting security restriction. (" & $ierror & ")")
					Return SetError($_iestatus_accessisdenied, 0, 0)
				Case $_iestatus_clientdisconnected
					__ieconsolewriteerror("Error", "_IELoadWait", "$_IESTATUS_ClientDisconnected", $ierror & ", Browser has been deleted prior to operation.")
					Return SetError($_iestatus_clientdisconnected, 0, 0)
				Case Else
					__ieconsolewriteerror("Error", "_IELoadWait", "$_IESTATUS_GeneralError", "Invalid Error Status - Notify IE.au3 developer")
					Return SetError($_iestatus_generalerror, 0, 0)
			EndSwitch
		EndFunc

		Func _ieloadwaittimeout($itimeout = -1)
			If $itimeout = -1 Then
				Return SetError($_iestatus_success, 0, $__g_iieloadwaittimeout)
			Else
				$__g_iieloadwaittimeout = $itimeout
				Return SetError($_iestatus_success, 0, 1)
			EndIf
		EndFunc

	#EndRegion Core functions
	#Region Frame Functions

		Func _ieisframeset(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEIsFrameSet", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If String($oobject.document.body.tagname) = "frameset" Then
				Return SetError($_iestatus_success, 0, 1)
			Else
				If @error Then
					__ieconsolewriteerror("Error", "_IEIsFrameSet", "$_IESTATUS_COMError", @error)
					Return SetError($_iestatus_comerror, @error, 0)
				EndIf
				Return SetError($_iestatus_success, 0, 0)
			EndIf
		EndFunc

		Func _ieframegetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFrameGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $oobject.document.parentwindow.frames.length, $oobject.document.parentwindow.frames)
				Case $iindex > -1 AND $iindex < $oobject.document.parentwindow.frames.length
					Return SetError($_iestatus_success, $oobject.document.parentwindow.frames.length, $oobject.document.parentwindow.frames.item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IEFrameGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					__ieconsolewriteerror("Warning", "_IEFrameGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 2, 0)
			EndSelect
		EndFunc

		Func _ieframegetobjbyname(ByRef $oobject, $sname)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFrameGetObjByName", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $otemp, $oframes
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEFrameGetObjByName", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			If __ieisobjtype($oobject, "document") Then
				$otemp = $oobject.parentwindow
			Else
				$otemp = $oobject.document.parentwindow
			EndIf
			If _ieisframeset($otemp) Then
				$oframes = _ietagnamegetcollection($otemp, "frame")
			Else
				$oframes = _ietagnamegetcollection($otemp, "iframe")
			EndIf
			If $oframes.length Then
				For $oframe In $oframes
					If String($oframe.name) = $sname Then Return SetError($_iestatus_success, 0, $otemp.frames($sname))
				Next
				__ieconsolewriteerror("Warning", "_IEFrameGetObjByName", "$_IESTATUS_NoMatch", "No frames matching name")
				Return SetError($_iestatus_nomatch, 2, 0)
			Else
				__ieconsolewriteerror("Warning", "_IEFrameGetObjByName", "$_IESTATUS_NoMatch", "No Frames found")
				Return SetError($_iestatus_nomatch, 2, 0)
			EndIf
		EndFunc

	#EndRegion Frame Functions
	#Region Link functions

		Func _ielinkclickbytext(ByRef $oobject, $slinktext, $iindex = 0, $iwait = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IELinkClickByText", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $ifound = 0, $smodelinktext, $olinks = $oobject.document.links
			$iindex = Number($iindex)
			For $olink In $olinks
				$smodelinktext = String($olink.outertext)
				If $smodelinktext = $slinktext Then
					If ($ifound = $iindex) Then
						$olink.click()
						If @error Then
							__ieconsolewriteerror("Error", "_IELinkClickByText", "$_IESTATUS_COMError", @error)
							Return SetError($_iestatus_comerror, @error, 0)
						EndIf
						If $iwait Then
							_ieloadwait($oobject)
							Return SetError(@error, 0, -1)
						EndIf
						Return SetError($_iestatus_success, 0, -1)
					EndIf
					$ifound = $ifound + 1
				EndIf
			Next
			__ieconsolewriteerror("Warning", "_IELinkClickByText", "$_IESTATUS_NoMatch")
			Return SetError($_iestatus_nomatch, 0, 0)
		EndFunc

		Func _ielinkclickbyindex(ByRef $oobject, $iindex, $iwait = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IELinkClickByIndex", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $olinks = $oobject.document.links, $olink
			$iindex = Number($iindex)
			If ($iindex >= 0) AND ($iindex <= $olinks.length - 1) Then
				$olink = $olinks($iindex)
				$olink.click()
				If @error Then
					__ieconsolewriteerror("Error", "_IELinkClickByIndex", "$_IESTATUS_COMError", @error)
					Return SetError($_iestatus_comerror, @error, 0)
				EndIf
				If $iwait Then
					_ieloadwait($oobject)
					Return SetError(@error, 0, -1)
				EndIf
				Return SetError($_iestatus_success, 0, -1)
			Else
				__ieconsolewriteerror("Warning", "_IELinkClickByIndex", "$_IESTATUS_NoMatch")
				Return SetError($_iestatus_nomatch, 2, 0)
			EndIf
		EndFunc

		Func _ielinkgetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IELinkGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $oobject.document.links.length, $oobject.document.links)
				Case $iindex > -1 AND $iindex < $oobject.document.links.length
					Return SetError($_iestatus_success, $oobject.document.links.length, $oobject.document.links.item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IELinkGetCollection", "$_IESTATUS_InvalidValue")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					__ieconsolewriteerror("Warning", "_IELinkGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 2, 0)
			EndSelect
		EndFunc

	#EndRegion Link functions
	#Region Image functions

		Func _ieimgclick(ByRef $oobject, $slinktext, $smode = "src", $iindex = 0, $iwait = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEImgClick", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $smodelinktext, $ifound = 0, $oimgs = $oobject.document.images
			$smode = StringLower($smode)
			$iindex = Number($iindex)
			For $oimg In $oimgs
				Select 
					Case $smode = "alt"
						$smodelinktext = $oimg.alt
					Case $smode = "name"
						$smodelinktext = $oimg.name
						If NOT IsString($smodelinktext) Then $smodelinktext = $oimg.id
					Case $smode = "id"
						$smodelinktext = $oimg.id
					Case $smode = "src"
						$smodelinktext = $oimg.src
					Case Else
						__ieconsolewriteerror("Error", "_IEImgClick", "$_IESTATUS_InvalidValue", "Invalid mode: " & $smode)
						Return SetError($_iestatus_invalidvalue, 3, 0)
				EndSelect
				If StringInStr($smodelinktext, $slinktext) Then
					If ($ifound = $iindex) Then
						$oimg.click()
						If @error Then
							__ieconsolewriteerror("Error", "_IEImgClick", "$_IESTATUS_COMError", @error)
							Return SetError($_iestatus_comerror, @error, 0)
						EndIf
						If $iwait Then
							_ieloadwait($oobject)
							Return SetError(@error, 0, -1)
						EndIf
						Return SetError($_iestatus_success, 0, -1)
					EndIf
					$ifound = $ifound + 1
				EndIf
			Next
			__ieconsolewriteerror("Warning", "_IEImgClick", "$_IESTATUS_NoMatch")
			Return SetError($_iestatus_nomatch, 0, 0)
		EndFunc

		Func _ieimggetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEImgGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $otemp = _iedocgetobj($oobject)
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $otemp.images.length, $otemp.images)
				Case $iindex > -1 AND $iindex < $otemp.images.length
					Return SetError($_iestatus_success, $otemp.images.length, $otemp.images.item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IEImgGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					__ieconsolewriteerror("Warning", "_IEImgGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 1, 0)
			EndSelect
		EndFunc

	#EndRegion Image functions
	#Region Form functions

		Func _ieformgetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $otemp = _iedocgetobj($oobject)
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $otemp.forms.length, $otemp.forms)
				Case $iindex > -1 AND $iindex < $otemp.forms.length
					Return SetError($_iestatus_success, $otemp.forms.length, $otemp.forms.item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IEFormGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					__ieconsolewriteerror("Warning", "_IEFormGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 1, 0)
			EndSelect
		EndFunc

		Func _ieformgetobjbyname(ByRef $oobject, $sname, $iindex = 0)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormGetObjByName", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $ilength = 0
			Local $ocol = $oobject.document.forms.item($sname)
			If IsObj($ocol) Then
				If __ieisobjtype($ocol, "elementcollection") Then
					$ilength = $ocol.length
				Else
					$ilength = 1
				EndIf
			EndIf
			$iindex = Number($iindex)
			If $iindex = -1 Then
				Return SetError($_iestatus_success, $ilength, $oobject.document.forms.item($sname))
			Else
				If IsObj($oobject.document.forms.item($sname, $iindex)) Then
					Return SetError($_iestatus_success, $ilength, $oobject.document.forms.item($sname, $iindex))
				Else
					__ieconsolewriteerror("Warning", "_IEFormGetObjByName", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 0, 0)
				EndIf
			EndIf
		EndFunc

		Func _ieformelementgetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "form") Then
				__ieconsolewriteerror("Error", "_IEFormElementGetCollection", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $oobject.elements.length, $oobject.elements)
				Case $iindex > -1 AND $iindex < $oobject.elements.length
					Return SetError($_iestatus_success, $oobject.elements.length, $oobject.elements.item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IEFormElementGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					Return SetError($_iestatus_nomatch, 1, 0)
			EndSelect
		EndFunc

		Func _ieformelementgetobjbyname(ByRef $oobject, $sname, $iindex = 0)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementGetObjByName", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "form") Then
				__ieconsolewriteerror("Error", "_IEFormElementGetObjByName", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $ilength = 0
			Local $ocol = $oobject.elements.item($sname)
			If IsObj($ocol) Then
				If __ieisobjtype($ocol, "elementcollection") Then
					$ilength = $ocol.length
				Else
					$ilength = 1
				EndIf
			EndIf
			$iindex = Number($iindex)
			If $iindex = -1 Then
				Return SetError($_iestatus_success, $ilength, $oobject.elements.item($sname))
			Else
				If IsObj($oobject.elements.item($sname, $iindex)) Then
					Return SetError($_iestatus_success, $ilength, $oobject.elements.item($sname, $iindex))
				Else
					__ieconsolewriteerror("Warning", "_IEFormElementGetObjByName", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 0, 0)
				EndIf
			EndIf
		EndFunc

		Func _ieformelementgetvalue(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementGetValue", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "forminputelement") Then
				__ieconsolewriteerror("Error", "_IEFormElementGetValue", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $sreturn = String($oobject.value)
			If @error Then
				__ieconsolewriteerror("Error", "_IEFormElementGetValue", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			SetError($_iestatus_success)
			Return $sreturn
		EndFunc

		Func _ieformelementsetvalue(ByRef $oobject, $snewvalue, $ifireevent = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementSetValue", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "forminputelement") Then
				__ieconsolewriteerror("Error", "_IEFormElementSetValue", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			If String($oobject.type) = "file" Then
				__ieconsolewriteerror("Error", "_IEFormElementSetValue", "$_IESTATUS_InvalidObjectType", "Browser security prevents SetValue of TYPE=FILE")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.value = $snewvalue
			If @error Then
				__ieconsolewriteerror("Error", "_IEFormElementSetValue", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			If $ifireevent Then
				$oobject.fireevent("OnChange")
				$oobject.fireevent("OnClick")
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func _ieformelementoptionselect(ByRef $oobject, $sstring, $iselect = 1, $smode = "byValue", $ifireevent = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "formselectelement") Then
				__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $oitem, $oitems = $oobject.options, $inumitems = $oobject.options.length, $bismultiple = $oobject.multiple
			Switch $smode
				Case "byValue"
					For $oitem In $oitems
						If $oitem.value = $sstring Then
							Switch $iselect
								Case -1
									Return SetError($_iestatus_success, 0, $oitem.selected)
								Case 0
									If NOT $bismultiple Then
										__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "$iSelect=0 only valid for type=select multiple")
										Return SetError($_iestatus_invalidvalue, 3)
									EndIf
									If $oitem.selected Then
										$oitem.selected = False
										If $ifireevent Then
											$oobject.fireevent("onChange")
											$oobject.fireevent("OnClick")
										EndIf
									EndIf
									Return SetError($_iestatus_success, 0, 1)
								Case 1
									If NOT $oitem.selected Then
										$oitem.selected = True
										If $ifireevent Then
											$oobject.fireevent("onChange")
											$oobject.fireevent("OnClick")
										EndIf
									EndIf
									Return SetError($_iestatus_success, 0, 1)
								Case Else
									__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "Invalid $iSelect value")
									Return SetError($_iestatus_invalidvalue, 3, 0)
							EndSwitch
						EndIf
					Next
					__ieconsolewriteerror("Warning", "_IEFormElementOptionSelect", "$_IESTATUS_NoMatch", "Value not matched")
					Return SetError($_iestatus_nomatch, 2, 0)
				Case "byText"
					For $oitem In $oitems
						If String($oitem.text) = $sstring Then
							Switch $iselect
								Case -1
									Return SetError($_iestatus_success, 0, $oitem.selected)
								Case 0
									If NOT $bismultiple Then
										__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "$iSelect=0 only valid for type=select multiple")
										Return SetError($_iestatus_invalidvalue, 3)
									EndIf
									If $oitem.selected Then
										$oitem.selected = False
										If $ifireevent Then
											$oobject.fireevent("onChange")
											$oobject.fireevent("OnClick")
										EndIf
									EndIf
									Return SetError($_iestatus_success, 0, 1)
								Case 1
									If NOT $oitem.selected Then
										$oitem.selected = True
										If $ifireevent Then
											$oobject.fireevent("onChange")
											$oobject.fireevent("OnClick")
										EndIf
									EndIf
									Return SetError($_iestatus_success, 0, 1)
								Case Else
									__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "Invalid $iSelect value")
									Return SetError($_iestatus_invalidvalue, 3, 0)
							EndSwitch
						EndIf
					Next
					__ieconsolewriteerror("Warning", "_IEFormElementOptionSelect", "$_IESTATUS_NoMatch", "Text not matched")
					Return SetError($_iestatus_nomatch, 2, 0)
				Case "byIndex"
					Local $iindex = Number($sstring)
					If $iindex < 0 OR $iindex >= $inumitems Then
						__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "Invalid index value, " & $iindex)
						Return SetError($_iestatus_invalidvalue, 2, 0)
					EndIf
					$oitem = $oitems.item($iindex)
					Switch $iselect
						Case -1
							Return SetError($_iestatus_success, 0, $oitems.item($iindex).selected)
						Case 0
							If NOT $bismultiple Then
								__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "$iSelect=0 only valid for type=select multiple")
								Return SetError($_iestatus_invalidvalue, 3)
							EndIf
							If $oitem.selected Then
								$oitems.item($iindex).selected = False
								If $ifireevent Then
									$oobject.fireevent("onChange")
									$oobject.fireevent("OnClick")
								EndIf
							EndIf
							Return SetError($_iestatus_success, 0, 1)
						Case 1
							If NOT $oitem.selected Then
								$oitems.item($iindex).selected = True
								If $ifireevent Then
									$oobject.fireevent("onChange")
									$oobject.fireevent("OnClick")
								EndIf
							EndIf
							Return SetError($_iestatus_success, 0, 1)
						Case Else
							__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "Invalid $iSelect value")
							Return SetError($_iestatus_invalidvalue, 3, 0)
					EndSwitch
				Case Else
					__ieconsolewriteerror("Error", "_IEFormElementOptionSelect", "$_IESTATUS_InvalidValue", "Invalid Mode")
					Return SetError($_iestatus_invalidvalue, 4, 0)
			EndSwitch
		EndFunc

		Func _ieformelementcheckboxselect(ByRef $oobject, $sstring, $sname = "", $iselect = 1, $smode = "byValue", $ifireevent = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementCheckBoxSelect", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "form") Then
				__ieconsolewriteerror("Error", "_IEFormElementCheckBoxSelect", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$sstring = String($sstring)
			$sname = String($sname)
			Local $oitems
			If $sname = "" Then
				$oitems = _ietagnamegetcollection($oobject, "input")
			Else
				$oitems = Execute("$oObject.elements('" & $sname & "')")
			EndIf
			If NOT IsObj($oitems) Then
				__ieconsolewriteerror("Warning", "_IEFormElementCheckBoxSelect", "$_IESTATUS_NoMatch")
				Return SetError($_iestatus_nomatch, 3, 0)
			EndIf
			Local $oitem, $bfound = False
			Switch $smode
				Case "byValue"
					If __ieisobjtype($oitems, "forminputelement") Then
						$oitem = $oitems
						If String($oitem.type) = "checkbox" AND String($oitem.value) = $sstring Then $bfound = True
					Else
						For $oitem In $oitems
							If String($oitem.type) = "checkbox" AND String($oitem.value) = $sstring Then
								$bfound = True
								ExitLoop
							EndIf
						Next
					EndIf
				Case "byIndex"
					If __ieisobjtype($oitems, "forminputelement") Then
						$oitem = $oitems
						If String($oitem.type) = "checkbox" AND Number($sstring) = 0 Then $bfound = True
					Else
						Local $icount = 0
						For $oitem In $oitems
							If String($oitem.type) = "checkbox" AND Number($sstring) = $icount Then
								$bfound = True
								ExitLoop
							Else
								If String($oitem.type) = "checkbox" Then $icount += 1
							EndIf
						Next
					EndIf
				Case Else
					__ieconsolewriteerror("Error", "_IEFormElementCheckBoxSelect", "$_IESTATUS_InvalidValue", "Invalid Mode")
					Return SetError($_iestatus_invalidvalue, 5, 0)
			EndSwitch
			If NOT $bfound Then
				__ieconsolewriteerror("Warning", "_IEFormElementCheckBoxSelect", "$_IESTATUS_NoMatch")
				Return SetError($_iestatus_nomatch, 2, 0)
			EndIf
			Switch $iselect
				Case -1
					Return SetError($_iestatus_success, 0, $oitem.checked)
				Case 0
					If $oitem.checked Then
						$oitem.checked = False
						If $ifireevent Then
							$oitem.fireevent("onChange")
							$oitem.fireevent("OnClick")
						EndIf
					EndIf
					Return SetError($_iestatus_success, 0, 1)
				Case 1
					If NOT $oitem.checked Then
						$oitem.checked = True
						If $ifireevent Then
							$oitem.fireevent("onChange")
							$oitem.fireevent("OnClick")
						EndIf
					EndIf
					Return SetError($_iestatus_success, 0, 1)
				Case Else
					__ieconsolewriteerror("Error", "_IEFormElementCheckBoxSelect", "$_IESTATUS_InvalidValue", "Invalid $iSelect value")
					Return SetError($_iestatus_invalidvalue, 3, 0)
			EndSwitch
		EndFunc

		Func _ieformelementradioselect(ByRef $oobject, $sstring, $sname, $iselect = 1, $smode = "byValue", $ifireevent = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormElementRadioSelect", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "form") Then
				__ieconsolewriteerror("Error", "_IEFormElementRadioSelect", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$sstring = String($sstring)
			$sname = String($sname)
			Local $oitems = Execute("$oObject.elements('" & $sname & "')")
			If NOT IsObj($oitems) Then
				__ieconsolewriteerror("Warning", "_IEFormElementRadioSelect", "$_IESTATUS_NoMatch")
				Return SetError($_iestatus_nomatch, 3, 0)
			EndIf
			Local $oitem, $bfound = False
			Switch $smode
				Case "byValue"
					If __ieisobjtype($oitems, "forminputelement") Then
						$oitem = $oitems
						If String($oitem.type) = "radio" AND String($oitem.value) = $sstring Then $bfound = True
					Else
						For $oitem In $oitems
							If String($oitem.type) = "radio" AND String($oitem.value) = $sstring Then
								$bfound = True
								ExitLoop
							EndIf
						Next
					EndIf
				Case "byIndex"
					If __ieisobjtype($oitems, "forminputelement") Then
						$oitem = $oitems
						If String($oitem.type) = "radio" AND Number($sstring) = 0 Then $bfound = True
					Else
						Local $icount = 0
						For $oitem In $oitems
							If String($oitem.type) = "radio" AND Number($sstring) = $icount Then
								$bfound = True
								ExitLoop
							Else
								$icount += 1
							EndIf
						Next
					EndIf
				Case Else
					__ieconsolewriteerror("Error", "_IEFormElementRadioSelect", "$_IESTATUS_InvalidValue", "Invalid Mode")
					Return SetError($_iestatus_invalidvalue, 5, 0)
			EndSwitch
			If NOT $bfound Then
				__ieconsolewriteerror("Warning", "_IEFormElementRadioSelect", "$_IESTATUS_NoMatch")
				Return SetError($_iestatus_nomatch, 2, 0)
			EndIf
			Switch $iselect
				Case -1
					Return SetError($_iestatus_success, 0, $oitem.checked)
				Case 0
					If $oitem.checked Then
						$oitem.checked = False
						If $ifireevent Then
							$oitem.fireevent("onChange")
							$oitem.fireevent("OnClick")
						EndIf
					EndIf
					Return SetError($_iestatus_success, 0, 1)
				Case 1
					If NOT $oitem.checked Then
						$oitem.checked = True
						If $ifireevent Then
							$oitem.fireevent("onChange")
							$oitem.fireevent("OnClick")
						EndIf
					EndIf
					Return SetError($_iestatus_success, 0, 1)
				Case Else
					__ieconsolewriteerror("Error", "_IEFormElementRadioSelect", "$_IESTATUS_InvalidValue", "$iSelect value invalid")
					Return SetError($_iestatus_invalidvalue, 4, 0)
			EndSwitch
		EndFunc

		Func _ieformimageclick(ByRef $oobject, $slinktext, $smode = "src", $iindex = 0, $iwait = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormImageClick", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $smodelinktext, $ifound = 0
			Local $otemp = _iedocgetobj($oobject)
			Local $oimgs = _ietagnamegetcollection($otemp, "input")
			$smode = StringLower($smode)
			$iindex = Number($iindex)
			For $oimg In $oimgs
				If String($oimg.type) = "image" Then
					Select 
						Case $smode = "alt"
							$smodelinktext = $oimg.alt
						Case $smode = "name"
							$smodelinktext = $oimg.name
							If NOT IsString($smodelinktext) Then $smodelinktext = $oimg.id
						Case $smode = "id"
							$smodelinktext = $oimg.id
						Case $smode = "src"
							$smodelinktext = $oimg.src
						Case Else
							__ieconsolewriteerror("Error", "_IEFormImageClick", "$_IESTATUS_InvalidValue", "Invalid mode: " & $smode)
							Return SetError($_iestatus_invalidvalue, 3, 0)
					EndSelect
					If StringInStr($smodelinktext, $slinktext) Then
						If ($ifound = $iindex) Then
							$oimg.click()
							If @error Then
								__ieconsolewriteerror("Error", "_IEFormImageClick", "$_IESTATUS_COMError", @error)
								Return SetError($_iestatus_comerror, @error, 0)
							EndIf
							If $iwait Then
								_ieloadwait($oobject)
								Return SetError(@error, 0, -1)
							EndIf
							Return SetError($_iestatus_success, 0, -1)
						EndIf
						$ifound = $ifound + 1
					EndIf
				EndIf
			Next
			__ieconsolewriteerror("Warning", "_IEFormImageClick", "$_IESTATUS_NoMatch")
			Return SetError($_iestatus_nomatch, 2, 0)
		EndFunc

		Func _ieformsubmit(ByRef $oobject, $iwait = 1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormSubmit", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "form") Then
				__ieconsolewriteerror("Error", "_IEFormSubmit", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $owindow = $oobject.document.parentwindow
			$oobject.submit()
			If @error Then
				__ieconsolewriteerror("Error", "_IEFormSubmit", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			If $iwait Then
				_ieloadwait($owindow)
				Return SetError(@error, 0, -1)
			EndIf
			Return SetError($_iestatus_success, 0, -1)
		EndFunc

		Func _ieformreset(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEFormReset", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "form") Then
				__ieconsolewriteerror("Error", "_IEFormReset", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.reset()
			If @error Then
				__ieconsolewriteerror("Error", "_IEFormReset", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

	#EndRegion Form functions
	#Region Table functions

		Func _ietablegetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IETableGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $oobject.document.getelementsbytagname("table").length, $oobject.document.getelementsbytagname("table"))
				Case $iindex > -1 AND $iindex < $oobject.document.getelementsbytagname("table").length
					Return SetError($_iestatus_success, $oobject.document.getelementsbytagname("table").length, $oobject.document.getelementsbytagname("table").item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IETableGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					__ieconsolewriteerror("Warning", "_IETableGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 1, 0)
			EndSelect
		EndFunc

		Func _ietablewritetoarray(ByRef $oobject, $btranspose = False)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IETableWriteToArray", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "table") Then
				__ieconsolewriteerror("Error", "_IETableWriteToArray", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $icols = 0, $otds, $icol
			Local $otrs = $oobject.rows
			For $otr In $otrs
				$otds = $otr.cells
				$icol = 0
				For $otd In $otds
					$icol = $icol + $otd.colspan
				Next
				If $icol > $icols Then $icols = $icol
			Next
			Local $irows = $otrs.length
			Local $atablecells[$icols][$irows]
			Local $irow = 0
			For $otr In $otrs
				$otds = $otr.cells
				$icol = 0
				For $otd In $otds
					$atablecells[$icol][$irow] = String($otd.innertext)
					If @error Then
						__ieconsolewriteerror("Error", "_IETableWriteToArray", "$_IESTATUS_COMError", @error)
						Return SetError($_iestatus_comerror, @error, 0)
					EndIf
					$icol = $icol + $otd.colspan
				Next
				$irow = $irow + 1
			Next
			If $btranspose Then
				Local $id1 = UBound($atablecells, $ubound_rows), $id2 = UBound($atablecells, $ubound_columns), $atmp[$id2][$id1]
				For $i = 0 To $id2 - 1
					For $j = 0 To $id1 - 1
						$atmp[$i][$j] = $atablecells[$j][$i]
					Next
				Next
				$atablecells = $atmp
			EndIf
			Return SetError($_iestatus_success, 0, $atablecells)
		EndFunc

	#EndRegion Table functions
	#Region Read/Write functions

		Func _iebodyreadhtml(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEBodyReadHTML", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Return SetError($_iestatus_success, 0, $oobject.document.body.innerhtml)
		EndFunc

		Func _iebodyreadtext(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEBodyReadText", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEBodyReadText", "$_IESTATUS_InvalidObjectType", "Expected document element")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Return SetError($_iestatus_success, 0, $oobject.document.body.innertext)
		EndFunc

		Func _iebodywritehtml(ByRef $oobject, $shtml)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEBodyWriteHTML", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEBodyWriteHTML", "$_IESTATUS_InvalidObjectType", "Expected document element")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.document.body.innerhtml = $shtml
			If @error Then
				__ieconsolewriteerror("Error", "_IEBodyWriteHTML", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Local $otemp = $oobject.document
			_ieloadwait($otemp)
			Return SetError(@error, 0, -1)
		EndFunc

		Func _iedocreadhtml(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEDocReadHTML", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEDocReadHTML", "$_IESTATUS_InvalidObjectType", "Expected document element")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Return SetError($_iestatus_success, 0, $oobject.document.documentelement.outerhtml)
		EndFunc

		Func _iedocwritehtml(ByRef $oobject, $shtml)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEDocWriteHTML", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEDocWriteHTML", "$_IESTATUS_InvalidObjectType", "Expected document element")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.document.write($shtml)
			$oobject.document.close()
			Local $otemp = $oobject.document
			If @error Then
				__ieconsolewriteerror("Error", "_IEDocWriteHTML", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			_ieloadwait($otemp)
			Return SetError(@error, 0, -1)
		EndFunc

		Func _iedocinserttext(ByRef $oobject, $sstring, $swhere = "beforeend")
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEDocInsertText", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") OR __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
				__ieconsolewriteerror("Error", "_IEDocInsertText", "$_IESTATUS_InvalidObjectType", "Expected document element")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$swhere = StringLower($swhere)
			Select 
				Case $swhere = "beforebegin"
					$oobject.insertadjacenttext($swhere, $sstring)
				Case $swhere = "afterbegin"
					$oobject.insertadjacenttext($swhere, $sstring)
				Case $swhere = "beforeend"
					$oobject.insertadjacenttext($swhere, $sstring)
				Case $swhere = "afterend"
					$oobject.insertadjacenttext($swhere, $sstring)
				Case Else
					__ieconsolewriteerror("Error", "_IEDocInsertText", "$_IESTATUS_InvalidValue", "Invalid where value")
					Return SetError($_iestatus_invalidvalue, 3, 0)
			EndSelect
			If @error Then
				__ieconsolewriteerror("Error", "_IEDocInsertText", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func _iedocinserthtml(ByRef $oobject, $sstring, $swhere = "beforeend")
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEDocInsertHTML", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") OR __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
				__ieconsolewriteerror("Error", "_IEDocInsertHTML", "$_IESTATUS_InvalidObjectType", "Expected document element")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$swhere = StringLower($swhere)
			Select 
				Case $swhere = "beforebegin"
					$oobject.insertadjacenthtml($swhere, $sstring)
				Case $swhere = "afterbegin"
					$oobject.insertadjacenthtml($swhere, $sstring)
				Case $swhere = "beforeend"
					$oobject.insertadjacenthtml($swhere, $sstring)
				Case $swhere = "afterend"
					$oobject.insertadjacenthtml($swhere, $sstring)
				Case Else
					__ieconsolewriteerror("Error", "_IEDocInsertHTML", "$_IESTATUS_InvalidValue", "Invalid where value")
					Return SetError($_iestatus_invalidvalue, 3, 0)
			EndSelect
			If @error Then
				__ieconsolewriteerror("Error", "_IEDocInsertHTML", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func _ieheadinserteventscript(ByRef $oobject, $shtmlfor, $sevent, $sscript)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEHeadInsertEventScript", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $ohead = $oobject.document.all.tags("HEAD").item(0)
			Local $oscript = $oobject.document.createelement("script")
			If @error Then
				__ieconsolewriteerror("Error", "_IEHeadInsertEventScript(script)", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			With $oscript
				.defer = True
				.language = "jscript"
				.type = "text/javascript"
				.htmlfor = $shtmlfor
				.event = $sevent
				.text = $sscript
			EndWith
			$ohead.appendchild($oscript)
			If @error Then
				__ieconsolewriteerror("Error", "_IEHeadInsertEventScript", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

	#EndRegion Read/Write functions
	#Region Utility functions

		Func _iedocgetobj(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEDocGetObj", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If __ieisobjtype($oobject, "document") Then
				Return SetError($_iestatus_success, 0, $oobject)
			EndIf
			Return SetError($_iestatus_success, 0, $oobject.document)
		EndFunc

		Func _ietagnamegetcollection(ByRef $oobject, $stagname, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IETagNameGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IETagNameGetCollection", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $otemp
			If __ieisobjtype($oobject, "documentcontainer") Then
				$otemp = _iedocgetobj($oobject)
			Else
				$otemp = $oobject
			EndIf
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $otemp.getelementsbytagname($stagname).length, $otemp.getelementsbytagname($stagname))
				Case $iindex > -1 AND $iindex < $otemp.getelementsbytagname($stagname).length
					Return SetError($_iestatus_success, $otemp.getelementsbytagname($stagname).length, $otemp.getelementsbytagname($stagname).item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IETagNameGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 3, 0)
				Case Else
					__ieconsolewriteerror("Error", "_IETagNameGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 0, 0)
			EndSelect
		EndFunc

		Func _ietagnameallgetcollection(ByRef $oobject, $iindex = -1)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IETagNameAllGetCollection", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IETagNameAllGetCollection", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $otemp
			If __ieisobjtype($oobject, "documentcontainer") Then
				$otemp = _iedocgetobj($oobject)
			Else
				$otemp = $oobject
			EndIf
			$iindex = Number($iindex)
			Select 
				Case $iindex = -1
					Return SetError($_iestatus_success, $otemp.all.length, $otemp.all)
				Case $iindex > -1 AND $iindex < $otemp.all.length
					Return SetError($_iestatus_success, $otemp.all.length, $otemp.all.item($iindex))
				Case $iindex < -1
					__ieconsolewriteerror("Error", "_IETagNameAllGetCollection", "$_IESTATUS_InvalidValue", "$iIndex < -1")
					Return SetError($_iestatus_invalidvalue, 2, 0)
				Case Else
					__ieconsolewriteerror("Error", "_IETagNameAllGetCollection", "$_IESTATUS_NoMatch")
					Return SetError($_iestatus_nomatch, 1, 0)
			EndSelect
		EndFunc

		Func _iegetobjbyname(ByRef $oobject, $sname, $iindex = 0)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEGetObjByName", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			$iindex = Number($iindex)
			If $iindex = -1 Then
				Return SetError($_iestatus_success, $oobject.document.getelementsbyname($sname).length, $oobject.document.getelementsbyname($sname))
			Else
				If IsObj($oobject.document.getelementsbyname($sname).item($iindex)) Then
					Return SetError($_iestatus_success, $oobject.document.getelementsbyname($sname).length, $oobject.document.getelementsbyname($sname).item($iindex))
				Else
					__ieconsolewriteerror("Warning", "_IEGetObjByName", "$_IESTATUS_NoMatch", "Name: " & $sname & ", Index: " & $iindex)
					Return SetError($_iestatus_nomatch, 0, 0)
				EndIf
			EndIf
		EndFunc

		Func _iegetobjbyid(ByRef $oobject, $sid)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEGetObjById", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEGetObById", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			If IsObj($oobject.document.getelementbyid($sid)) Then
				Return SetError($_iestatus_success, 0, $oobject.document.getelementbyid($sid))
			Else
				__ieconsolewriteerror("Warning", "_IEGetObjById", "$_IESTATUS_NoMatch", $sid)
				Return SetError($_iestatus_nomatch, 2, 0)
			EndIf
		EndFunc

		Func _ieaction(ByRef $oobject, $saction)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEAction(" & $saction & ")", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			$saction = StringLower($saction)
			Select 
				Case $saction = "click"
					If __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(click)", " $_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.click()
				Case $saction = "disable"
					If __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(disable)", " $_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.disabled = True
				Case $saction = "enable"
					If __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(enable)", " $_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.disabled = False
				Case $saction = "focus"
					If __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(focus)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.focus()
				Case $saction = "scrollintoview"
					If __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(scrollintoview)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.scrollintoview()
				Case $saction = "copy"
					$oobject.document.execcommand("Copy")
				Case $saction = "cut"
					$oobject.document.execcommand("Cut")
				Case $saction = "paste"
					$oobject.document.execcommand("Paste")
				Case $saction = "delete"
					$oobject.document.execcommand("Delete")
				Case $saction = "saveas"
					$oobject.document.execcommand("SaveAs")
				Case $saction = "refresh"
					$oobject.document.execcommand("Refresh")
					If @error Then
						__ieconsolewriteerror("Error", "_IEAction(refresh)", "$_IESTATUS_COMError", @error)
						Return SetError($_iestatus_comerror, @error, 0)
					EndIf
					_ieloadwait($oobject)
				Case $saction = "selectall"
					$oobject.document.execcommand("SelectAll")
				Case $saction = "unselect"
					$oobject.document.execcommand("Unselect")
				Case $saction = "print"
					$oobject.document.parentwindow.print()
				Case $saction = "printdefault"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEAction(printdefault)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.execwb(6, 2)
				Case $saction = "back"
					If NOT __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(back)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.goback()
				Case $saction = "blur"
					$oobject.blur()
				Case $saction = "forward"
					If NOT __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(forward)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.goforward()
				Case $saction = "home"
					If NOT __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(home)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.gohome()
				Case $saction = "invisible"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEAction(invisible)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.visible = 0
				Case $saction = "visible"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEAction(visible)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.visible = 1
				Case $saction = "search"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEAction(search)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.gosearch()
				Case $saction = "stop"
					If NOT __ieisobjtype($oobject, "documentContainer") Then
						__ieconsolewriteerror("Error", "_IEAction(stop)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.stop()
				Case $saction = "quit"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEAction(quit)", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.quit()
					If @error Then
						__ieconsolewriteerror("Error", "_IEAction(" & $saction & ")", "$_IESTATUS_COMError", @error)
						Return SetError($_iestatus_comerror, @error, 0)
					EndIf
					$oobject = 0
					Return SetError($_iestatus_success, 0, 1)
				Case Else
					__ieconsolewriteerror("Error", "_IEAction(" & $saction & ")", "$_IESTATUS_InvalidValue", "Invalid Action")
					Return SetError($_iestatus_invalidvalue, 2, 0)
			EndSelect
			If @error Then
				__ieconsolewriteerror("Error", "_IEAction(" & $saction & ")", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func _iepropertyget(ByRef $oobject, $sproperty)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browserdom") Then
				__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			Local $otemp, $itemp
			$sproperty = StringLower($sproperty)
			Select 
				Case $sproperty = "browserx"
					If __ieisobjtype($oobject, "browsercontainer") OR __ieisobjtype($oobject, "document") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$otemp = $oobject
					$itemp = 0
					While IsObj($otemp)
						$itemp += $otemp.offsetleft
						$otemp = $otemp.offsetparent
					WEnd
					Return SetError($_iestatus_success, 0, $itemp)
				Case $sproperty = "browsery"
					If __ieisobjtype($oobject, "browsercontainer") OR __ieisobjtype($oobject, "document") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$otemp = $oobject
					$itemp = 0
					While IsObj($otemp)
						$itemp += $otemp.offsettop
						$otemp = $otemp.offsetparent
					WEnd
					Return SetError($_iestatus_success, 0, $itemp)
				Case $sproperty = "screenx"
					If __ieisobjtype($oobject, "window") OR __ieisobjtype($oobject, "document") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If __ieisobjtype($oobject, "browser") Then
						Return SetError($_iestatus_success, 0, $oobject.left())
					Else
						$otemp = $oobject
						$itemp = 0
						While IsObj($otemp)
							$itemp += $otemp.offsetleft
							$otemp = $otemp.offsetparent
						WEnd
					EndIf
					Return SetError($_iestatus_success, 0, $itemp + $oobject.document.parentwindow.screenleft)
				Case $sproperty = "screeny"
					If __ieisobjtype($oobject, "window") OR __ieisobjtype($oobject, "document") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If __ieisobjtype($oobject, "browser") Then
						Return SetError($_iestatus_success, 0, $oobject.top())
					Else
						$otemp = $oobject
						$itemp = 0
						While IsObj($otemp)
							$itemp += $otemp.offsettop
							$otemp = $otemp.offsetparent
						WEnd
					EndIf
					Return SetError($_iestatus_success, 0, $itemp + $oobject.document.parentwindow.screentop)
				Case $sproperty = "height"
					If __ieisobjtype($oobject, "window") OR __ieisobjtype($oobject, "document") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If __ieisobjtype($oobject, "browser") Then
						Return SetError($_iestatus_success, 0, $oobject.height())
					Else
						Return SetError($_iestatus_success, 0, $oobject.offsetheight)
					EndIf
				Case $sproperty = "width"
					If __ieisobjtype($oobject, "window") OR __ieisobjtype($oobject, "document") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If __ieisobjtype($oobject, "browser") Then
						Return SetError($_iestatus_success, 0, $oobject.width())
					Else
						Return SetError($_iestatus_success, 0, $oobject.offsetwidth)
					EndIf
				Case $sproperty = "isdisabled"
					Return SetError($_iestatus_success, 0, $oobject.isdisabled())
				Case $sproperty = "addressbar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.addressbar())
				Case $sproperty = "busy"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.busy())
				Case $sproperty = "fullscreen"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.fullscreen())
				Case $sproperty = "hwnd"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, HWnd($oobject.hwnd()))
				Case $sproperty = "left"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.left())
				Case $sproperty = "locationname"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.locationname())
				Case $sproperty = "locationurl"
					If __ieisobjtype($oobject, "browser") Then
						Return SetError($_iestatus_success, 0, $oobject.locationurl())
					EndIf
					If __ieisobjtype($oobject, "window") Then
						Return SetError($_iestatus_success, 0, $oobject.location.href())
					EndIf
					If __ieisobjtype($oobject, "document") Then
						Return SetError($_iestatus_success, 0, $oobject.parentwindow.location.href())
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.location.href())
				Case $sproperty = "menubar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.menubar())
				Case $sproperty = "offline"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.offline())
				Case $sproperty = "readystate"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.readystate())
				Case $sproperty = "resizable"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.resizable())
				Case $sproperty = "silent"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.silent())
				Case $sproperty = "statusbar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.statusbar())
				Case $sproperty = "statustext"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.statustext())
				Case $sproperty = "top"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.top())
				Case $sproperty = "visible"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.visible())
				Case $sproperty = "appcodename"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.appcodename())
				Case $sproperty = "appminorversion"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.appminorversion())
				Case $sproperty = "appname"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.appname())
				Case $sproperty = "appversion"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.appversion())
				Case $sproperty = "browserlanguage"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.browserlanguage())
				Case $sproperty = "cookieenabled"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.cookieenabled())
				Case $sproperty = "cpuclass"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.cpuclass())
				Case $sproperty = "javaenabled"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.javaenabled())
				Case $sproperty = "online"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.online())
				Case $sproperty = "platform"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.platform())
				Case $sproperty = "systemlanguage"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.systemlanguage())
				Case $sproperty = "useragent"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.useragent())
				Case $sproperty = "userlanguage"
					Return SetError($_iestatus_success, 0, $oobject.document.parentwindow.top.navigator.userlanguage())
				Case $sproperty = "referrer"
					Return SetError($_iestatus_success, 0, $oobject.document.referrer)
				Case $sproperty = "theatermode"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.theatermode)
				Case $sproperty = "toolbar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					Return SetError($_iestatus_success, 0, $oobject.toolbar)
				Case $sproperty = "contenteditable"
					If __ieisobjtype($oobject, "browser") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					Return SetError($_iestatus_success, 0, $otemp.iscontenteditable)
				Case $sproperty = "innertext"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					Return SetError($_iestatus_success, 0, $otemp.innertext)
				Case $sproperty = "outertext"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					Return SetError($_iestatus_success, 0, $otemp.outertext)
				Case $sproperty = "innerhtml"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					Return SetError($_iestatus_success, 0, $otemp.innerhtml)
				Case $sproperty = "outerhtml"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					Return SetError($_iestatus_success, 0, $otemp.outerhtml)
				Case $sproperty = "title"
					Return SetError($_iestatus_success, 0, $oobject.document.title)
				Case $sproperty = "uniqueid"
					If __ieisobjtype($oobject, "window") Then
						__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					Else
						Return SetError($_iestatus_success, 0, $oobject.uniqueid)
					EndIf
				Case Else
					__ieconsolewriteerror("Error", "_IEPropertyGet", "$_IESTATUS_InvalidValue", "Invalid Property")
					Return SetError($_iestatus_invalidvalue, 2, 0)
			EndSelect
		EndFunc

		Func _iepropertyset(ByRef $oobject, $sproperty, $vvalue)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $otemp
			#forceref $oTemp
			$sproperty = StringLower($sproperty)
			Select 
				Case $sproperty = "addressbar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.addressbar = $vvalue
				Case $sproperty = "height"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.height = $vvalue
				Case $sproperty = "left"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.left = $vvalue
				Case $sproperty = "menubar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.menubar = $vvalue
				Case $sproperty = "offline"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.offline = $vvalue
				Case $sproperty = "resizable"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.resizable = $vvalue
				Case $sproperty = "statusbar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.statusbar = $vvalue
				Case $sproperty = "statustext"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.statustext = $vvalue
				Case $sproperty = "top"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.top = $vvalue
				Case $sproperty = "width"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					$oobject.width = $vvalue
				Case $sproperty = "theatermode"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If $vvalue Then
						$oobject.theatermode = True
					Else
						$oobject.theatermode = False
					EndIf
				Case $sproperty = "toolbar"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If $vvalue Then
						$oobject.toolbar = True
					Else
						$oobject.toolbar = False
					EndIf
				Case $sproperty = "contenteditable"
					If __ieisobjtype($oobject, "browser") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					If $vvalue Then
						$otemp.contenteditable = "true"
					Else
						$otemp.contenteditable = "false"
					EndIf
				Case $sproperty = "innertext"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					$otemp.innertext = $vvalue
				Case $sproperty = "outertext"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					$otemp.outertext = $vvalue
				Case $sproperty = "innerhtml"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					$otemp.innerhtml = $vvalue
				Case $sproperty = "outerhtml"
					If __ieisobjtype($oobject, "documentcontainer") OR __ieisobjtype($oobject, "document") Then
						$otemp = $oobject.document.body
					Else
						$otemp = $oobject
					EndIf
					$otemp.outerhtml = $vvalue
				Case $sproperty = "title"
					$oobject.document.title = $vvalue
				Case $sproperty = "silent"
					If NOT __ieisobjtype($oobject, "browser") Then
						__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidObjectType")
						Return SetError($_iestatus_invalidobjecttype, 1, 0)
					EndIf
					If $vvalue Then
						$oobject.silent = True
					Else
						$oobject.silent = False
					EndIf
				Case Else
					__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_InvalidValue", "Invalid Property")
					Return SetError($_iestatus_invalidvalue, 2, 0)
			EndSelect
			If @error Then
				__ieconsolewriteerror("Error", "_IEPropertySet", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func _ieerrornotify($vnotify = Default)
			If $vnotify = Default Then Return $__g_bieerrornotify
			If $vnotify Then
				$__g_bieerrornotify = True
			Else
				$__g_bieerrornotify = False
			EndIf
			Return 1
		EndFunc

		Func _ieerrorhandlerregister($sfunctionname = "__IEInternalErrorHandler")
			$__g_oieerrorhandler = ObjEvent("AutoIt.Error", $sfunctionname)
			If IsObj($__g_oieerrorhandler) Then
				$__g_sieusererrorhandler = $sfunctionname
				Return SetError($_iestatus_success, 0, 1)
			Else
				$__g_oieerrorhandler = ""
				__ieconsolewriteerror("Error", "_IEErrorHandlerRegister", "$_IEStatus_GeneralError", "Error Handler Not Registered - Check existance of error function")
				Return SetError($_iestatus_generalerror, 1, 0)
			EndIf
		EndFunc

		Func _ieerrorhandlerderegister()
			$__g_sieusererrorhandler = ""
			$__g_oieerrorhandler = ""
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func __ieinternalerrorhandlerregister()
			Local $scurrenterrorhandler = ObjEvent("AutoIt.Error")
			If $scurrenterrorhandler <> "" AND NOT IsObj($__g_oieerrorhandler) Then
				Return SetError($_iestatus_generalerror, 0, False)
			EndIf
			$__g_oieerrorhandler = ObjEvent("AutoIt.Error", "__IEInternalErrorHandler")
			If IsObj($__g_oieerrorhandler) Then
				Return SetError($_iestatus_success, 0, True)
			Else
				$__g_oieerrorhandler = ""
				Return SetError($_iestatus_generalerror, 0, False)
			EndIf
		EndFunc

		Func __ieinternalerrorhandlerderegister()
			$__g_oieerrorhandler = ""
			If $__g_sieusererrorhandler <> "" Then
				$__g_oieerrorhandler = ObjEvent("AutoIt.Error", $__g_sieusererrorhandler)
			EndIf
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

		Func __ieinternalerrorhandler($ocomerror)
			If $__g_bieerrornotify OR $__g_bieau3debug Then ConsoleWrite("--> " & __comerrorformating($ocomerror, "----> $IEComError") & @CRLF)
			SetError($_iestatus_comerror)
			Return 
		EndFunc

		Func _iequit(ByRef $oobject)
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "_IEQuit", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "browser") Then
				__ieconsolewriteerror("Error", "_IEQuit", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.quit()
			If @error Then
				__ieconsolewriteerror("Error", "_IEQuit", "$_IESTATUS_COMError", @error)
				Return SetError($_iestatus_comerror, @error, 0)
			EndIf
			$oobject = 0
			Return SetError($_iestatus_success, 0, 1)
		EndFunc

	#EndRegion Utility functions
	#Region General

		Func _ie_introduction($smodule = "basic")
			Local $shtml = ""
			Switch $smodule
				Case "basic"
					$shtml &= "<!DOCTYPE html>" & @CR
					$shtml &= "<html>" & @CR
					$shtml &= "<head>" & @CR
					$shtml &= '<meta content="text/html; charset=UTF-8" http-equiv="content-type">' & @CR
					$shtml &= '<title>_IE_Introduction ("basic")</title>' & @CR
					$shtml &= "<style>body {font-family: Arial}" & @CR
					$shtml &= "td {padding:6px}</style>" & @CR
					$shtml &= "</head>" & @CR
					$shtml &= "<body>" & @CR
					$shtml &= '<table border=1 id="table1" style="width:600px;border-spacing:6px;">' & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= "<h1>Welcome to IE.au3</h1>" & @CR
					$shtml &= "IE.au3 is a UDF (User Defined Function) library for the " & @CR
					$shtml &= '<a href="http://www.autoitscript.com">AutoIt</a> scripting language.' & @CR
					$shtml &= "<br>  " & @CR
					$shtml &= "IE.au3 allows you to either create or attach to an Internet Explorer browser and do " & @CR
					$shtml &= "just about anything you could do with it interactively with the mouse and " & @CR
					$shtml &= "keyboard, but do it through script." & @CR
					$shtml &= "<br>" & @CR
					$shtml &= "You can navigate to pages, click links, fill and submit forms etc. You can " & @CR
					$shtml &= "also do things you cannot do interactively like change or rewrite page " & @CR
					$shtml &= "content and JavaScripts, read, parse and save page content and monitor and act " & @CR
					$shtml &= 'upon browser "events".<br>' & @CR
					$shtml &= "IE.au3 uses the COM interface in AutoIt to interact with the Internet Explorer " & @CR
					$shtml &= "object model and the DOM (Document Object Model) supported by the browser." & @CR
					$shtml &= "<br>" & @CR
					$shtml &= "Here are some links for more information and helpful tools:<br>" & @CR
					$shtml &= "Reference Material: " & @CR
					$shtml &= "<ul>" & @CR
					$shtml &= '<li><a href="http://msdn1.microsoft.com/">MSDN (Microsoft Developer Network)</a></li>' & @CR
					$shtml &= '<li><a href="http://msdn2.microsoft.com/en-us/library/aa752084.aspx" target="_blank">InternetExplorer Object</a></li>' & @CR
					$shtml &= '<li><a href="http://msdn2.microsoft.com/en-us/library/ms531073.aspx" target="_blank">Document Object</a></li>' & @CR
					$shtml &= '<li><a href="http://msdn2.microsoft.com/en-us/ie/aa740473.aspx" target="_blank">Overviews and Tutorials</a></li>' & @CR
					$shtml &= '<li><a href="http://msdn2.microsoft.com/en-us/library/ms533029.aspx" target="_blank">DHTML Objects</a></li>' & @CR
					$shtml &= '<li><a href="http://msdn2.microsoft.com/en-us/library/ms533051.aspx" target="_blank">DHTML Events</a></li>' & @CR
					$shtml &= "</ul><br>" & @CR
					$shtml &= "Helpful Tools: " & @CR
					$shtml &= "<ul>" & @CR
					$shtml &= '<li><a href="http://www.autoitscript.com/forum/index.php?showtopic=19368" target="_blank">AutoIt IE Builder</a> (build IE scripts interactively)</li>' & @CR
					$shtml &= '<li><a href="http://www.debugbar.com/" target="_blank">DebugBar</a> (DOM inspector, HTTP inspector, HTML validator and more - free for personal use) Recommended</li>' & @CR
					$shtml &= '<li><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=e59c3964-672d-4511-bb3e-2d5e1db91038&amp;displaylang=en" target="_blank">IE Developer Toolbar</a> (comprehensive DOM analysis tool)</li>' & @CR
					$shtml &= '<li><a href="http://slayeroffice.com/tools/modi/v2.0/modi_help.html" target="_blank">MODIV2</a> (view the DOM of a web page by mousing around)</li>' & @CR
					$shtml &= '<li><a href="http://validator.w3.org/" target="_blank">HTML Validator</a> (verify HTML follows format rules)</li>' & @CR
					$shtml &= '<li><a href="http://www.fiddlertool.com/fiddler/" target="_blank">Fiddler</a> (examine HTTP traffic)</li>' & @CR
					$shtml &= "</ul>" & @CR
					$shtml &= "</td>" & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "</table>" & @CR
					$shtml &= "</body>" & @CR
					$shtml &= "</html>"
				Case Else
					__ieconsolewriteerror("Error", "_IE_Introduction", "$_IESTATUS_InvalidValue")
					Return SetError($_iestatus_invalidvalue, 1, 0)
			EndSwitch
			Local $oobject = _iecreate()
			_iedocwritehtml($oobject, $shtml)
			Return SetError($_iestatus_success, 0, $oobject)
		EndFunc

		Func _ie_example($smodule = "basic")
			Local $shtml = "", $oobject
			Switch $smodule
				Case "basic"
					$shtml &= "<!DOCTYPE html>" & @CR
					$shtml &= "<html>" & @CR
					$shtml &= "<head>" & @CR
					$shtml &= '<meta content="text/html; charset=UTF-8" http-equiv="content-type">' & @CR
					$shtml &= '<title>_IE_Example("basic")</title>' & @CR
					$shtml &= "<style>body {font-family: Arial}</style>" & @CR
					$shtml &= "</head>" & @CR
					$shtml &= "<body>" & @CR
					$shtml &= '<a href="http://www.autoitscript.com"><img src="http://www.autoitscript.com/images/logo_autoit_210x72.png" id="AutoItImage" alt="AutoIt Homepage Image" style="background: #204080;"></a>' & @CR
					$shtml &= "<p></p>" & @CR
					$shtml &= '<div id="line1">This is a simple HTML page with text, links and images.</div>' & @CR
					$shtml &= "<br>" & @CR
					$shtml &= '<div id="line2"><a href="http://www.autoitscript.com">AutoIt</a> is a wonderful automation scripting language.</div>' & @CR
					$shtml &= "<br>" & @CR
					$shtml &= '<div id="line3">It is supported by a very active and supporting <a href="http://www.autoitscript.com/forum/">user forum</a>.</div>' & @CR
					$shtml &= "<br>" & @CR
					$shtml &= '<div id="IEAu3Data"></div>' & @CR
					$shtml &= "</body>" & @CR
					$shtml &= "</html>"
					$oobject = _iecreate()
					_iedocwritehtml($oobject, $shtml)
				Case "table"
					$shtml &= "<!DOCTYPE html>" & @CR
					$shtml &= "<html>" & @CR
					$shtml &= "<head>" & @CR
					$shtml &= '<meta content="text/html; charset=utf-8" http-equiv="content-type">' & @CR
					$shtml &= '<title>_IE_Example("table")</title>' & @CR
					$shtml &= "<style>body {font-family: Arial}</style>" & @CR
					$shtml &= "</head>" & @CR
					$shtml &= "<body>" & @CR
					$shtml &= '$oTableOne = _IETableGetObjByName($oIE, "tableOne")<br>' & @CR
					$shtml &= '&lt;table border=1 id="tableOne"&gt;<br>' & @CR
					$shtml &= '<table border=1 id="tableOne">' & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>AutoIt</td>" & @CR
					$shtml &= "		<td>is</td>" & @CR
					$shtml &= "		<td>really</td>" & @CR
					$shtml &= "		<td>great</td>" & @CR
					$shtml &= "		<td>with</td>" & @CR
					$shtml &= "		<td>IE.au3</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>1</td>" & @CR
					$shtml &= "		<td>2</td>" & @CR
					$shtml &= "		<td>3</td>" & @CR
					$shtml &= "		<td>4</td>" & @CR
					$shtml &= "		<td>5</td>" & @CR
					$shtml &= "		<td>6</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>the</td>" & @CR
					$shtml &= "		<td>quick</td>" & @CR
					$shtml &= "		<td>red</td>" & @CR
					$shtml &= "		<td>fox</td>" & @CR
					$shtml &= "		<td>jumped</td>" & @CR
					$shtml &= "		<td>over</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>the</td>" & @CR
					$shtml &= "		<td>lazy</td>" & @CR
					$shtml &= "		<td>brown</td>" & @CR
					$shtml &= "		<td>dog</td>" & @CR
					$shtml &= "		<td>the</td>" & @CR
					$shtml &= "		<td>time</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>has</td>" & @CR
					$shtml &= "		<td>come</td>" & @CR
					$shtml &= "		<td>for</td>" & @CR
					$shtml &= "		<td>all</td>" & @CR
					$shtml &= "		<td>good</td>" & @CR
					$shtml &= "		<td>men</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>to</td>" & @CR
					$shtml &= "		<td>come</td>" & @CR
					$shtml &= "		<td>to</td>" & @CR
					$shtml &= "		<td>the</td>" & @CR
					$shtml &= "		<td>aid</td>" & @CR
					$shtml &= "		<td>of</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "</table>" & @CR
					$shtml &= "<br>" & @CR
					$shtml &= '$oTableTwo = _IETableGetObjByName($oIE, "tableTwo")<br>' & @CR
					$shtml &= '&lt;table border="1" id="tableTwo"&gt;<br>' & @CR
					$shtml &= '<table border=1 id="tableTwo">' & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= '		<td colspan="4">Table Top</td>' & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>One</td>" & @CR
					$shtml &= '		<td colspan="3">Two</td>' & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>Three</td>" & @CR
					$shtml &= "		<td>Four</td>" & @CR
					$shtml &= '		<td colspan="2">Five</td>' & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>Six</td>" & @CR
					$shtml &= '		<td colspan="3">Seven</td>' & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "	<tr>" & @CR
					$shtml &= "		<td>Eight</td>" & @CR
					$shtml &= "		<td>Nine</td>" & @CR
					$shtml &= "		<td>Ten</td>" & @CR
					$shtml &= "		<td>Eleven</td>" & @CR
					$shtml &= "	</tr>" & @CR
					$shtml &= "</table>" & @CR
					$shtml &= "</body>" & @CR
					$shtml &= "</html>"
					$oobject = _iecreate()
					_iedocwritehtml($oobject, $shtml)
				Case "form"
					$shtml &= "<!DOCTYPE html>" & @CR
					$shtml &= "<html>" & @CR
					$shtml &= "<head>" & @CR
					$shtml &= '<meta content="text/html; charset=UTF-8" http-equiv="content-type">' & @CR
					$shtml &= '<title>_IE_Example("form")</title>' & @CR
					$shtml &= "<style>body {font-family: Arial}" & @CR
					$shtml &= "td {padding:6px}</style>" & @CR
					$shtml &= "</head>" & @CR
					$shtml &= "<body>" & @CR
					$shtml &= "<form name=""ExampleForm"" onSubmit=""javascript:alert('ExampleFormSubmitted');"" method=""post"">" & @CR
					$shtml &= '<table style="border-spacing:6px 6px;" border=1>' & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>ExampleForm</td>" & @CR
					$shtml &= "<td>&lt;form name=""ExampleForm"" onSubmit=""javascript:alert('ExampleFormSubmitted');"" method=""post""&gt;</td>" & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= '<td>Hidden Input Element<input type="hidden" name="hiddenExample" value="secret value"></td>' & @CR
					$shtml &= '<td>&lt;input type="hidden" name="hiddenExample" value="secret value"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input type="text" name="textExample" value="http://" size="20" maxlength="30">' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;input type="text" name="textExample" value="http://" size="20" maxlength="30"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input type="password" name="passwordExample" size="10">' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;input type="password" name="passwordExample" size="10"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input type="file" name="fileExample">' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;input type="file" name="fileExample"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input type="image" name="imageExample" alt="AutoIt Homepage" src="http://www.autoitscript.com/images/logo_autoit_210x72.png" style="background: #204080;>' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;input type="image" name="imageExample" alt="AutoIt Homepage" src="http://www.autoitscript.com/images/logo_autoit_210x72.png"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<textarea name="textareaExample" rows="5" cols="15">Hello!</textarea>' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;textarea name="textareaExample" rows="5" cols="15"&gt;Hello!&lt;/textarea&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input type="checkbox" name="checkboxG1Example" value="gameBasketball">Basketball<br>' & @CR
					$shtml &= '<input type="checkbox" name="checkboxG1Example" value="gameFootball">Football<br>' & @CR
					$shtml &= '<input type="checkbox" name="checkboxG2Example" value="gameTennis" checked>Tennis<br>' & @CR
					$shtml &= '<input type="checkbox" name="checkboxG2Example" value="gameBaseball">Baseball' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;input type="checkbox" name="checkboxG1Example" value="gameBasketball"&gt;Basketball&lt;br&gt;<br>' & @CR
					$shtml &= '&lt;input type="checkbox" name="checkboxG1Example" value="gameFootball"&gt;Football&lt;br&gt;<br>' & @CR
					$shtml &= '&lt;input type="checkbox" name="checkboxG2Example" value="gameTennis" checked&gt;Tennis&lt;br&gt;<br>' & @CR
					$shtml &= '&lt;input type="checkbox" name="checkboxG2Example" value="gameBaseball"&gt;Baseball</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input type="radio" name="radioExample" value="vehicleAirplane">Airplane<br>' & @CR
					$shtml &= '<input type="radio" name="radioExample" value="vehicleTrain" checked>Train<br>' & @CR
					$shtml &= '<input type="radio" name="radioExample" value="vehicleBoat">Boat<br>' & @CR
					$shtml &= '<input type="radio" name="radioExample" value="vehicleCar">Car</td>' & @CR
					$shtml &= '<td>&lt;input type="radio" name="radioExample" value="vehicleAirplane"&gt;Airplane&lt;br&gt;<br>' & @CR
					$shtml &= '&lt;input type="radio" name="radioExample" value="vehicleTrain" checked&gt;Train&lt;br&gt;<br>' & @CR
					$shtml &= '&lt;input type="radio" name="radioExample" value="vehicleBoat"&gt;Boat&lt;br&gt;<br>' & @CR
					$shtml &= '&lt;input type="radio" name="radioExample" value="vehicleCar"&gt;Car&lt;br&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<select name="selectExample">' & @CR
					$shtml &= '<option value="homepage.html">Homepage' & @CR
					$shtml &= '<option value="midipage.html">Midipage' & @CR
					$shtml &= '<option value="freepage.html">Freepage' & @CR
					$shtml &= "</select>" & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;select name="selectExample"&gt;<br>' & @CR
					$shtml &= '&lt;option value="homepage.html"&gt;Homepage<br>' & @CR
					$shtml &= '&lt;option value="midipage.html"&gt;Midipage<br>' & @CR
					$shtml &= '&lt;option value="freepage.html"&gt;Freepage<br>' & @CR
					$shtml &= "&lt;/select&gt;</td>" & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<select name="multipleSelectExample" size="6" multiple>' & @CR
					$shtml &= '<option value="Name1">Aaron' & @CR
					$shtml &= '<option value="Name2">Bruce' & @CR
					$shtml &= '<option value="Name3">Carlos' & @CR
					$shtml &= '<option value="Name4">Denis' & @CR
					$shtml &= '<option value="Name5">Ed' & @CR
					$shtml &= '<option value="Name6">Freddy' & @CR
					$shtml &= "</select>" & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;select name="multipleSelectExample" size="6" multiple&gt;<br>' & @CR
					$shtml &= '&lt;option value="Name1"&gt;Aaron<br>' & @CR
					$shtml &= '&lt;option value="Name2"&gt;Bruce<br>' & @CR
					$shtml &= '&lt;option value="Name3"&gt;Carlos<br>' & @CR
					$shtml &= '&lt;option value="Name4"&gt;Denis<br>' & @CR
					$shtml &= '&lt;option value="Name5"&gt;Ed<br>' & @CR
					$shtml &= '&lt;option value="Name6"&gt;Freddy<br>' & @CR
					$shtml &= "&lt;/select&gt;</td>" & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= "<td>" & @CR
					$shtml &= '<input name="submitExample" type="submit" value="Submit">' & @CR
					$shtml &= '<input name="resetExample" type="reset" value="Reset">' & @CR
					$shtml &= "</td>" & @CR
					$shtml &= '<td>&lt;input name="submitExample" type="submit" value="Submit"&gt;<br>' & @CR
					$shtml &= '&lt;input name="resetExample" type="reset" value="Reset"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "</table>" & @CR
					$shtml &= '<input type="hidden" name="hiddenExample" value="secret value">' & @CR
					$shtml &= "</form>" & @CR
					$shtml &= "</body>" & @CR
					$shtml &= "</html>"
					$oobject = _iecreate()
					_iedocwritehtml($oobject, $shtml)
				Case "frameset"
					$shtml &= "<!DOCTYPE html>" & @CR
					$shtml &= "<html>" & @CR
					$shtml &= "<head>" & @CR
					$shtml &= '<meta content="text/html; charset=UTF-8" http-equiv="content-type">' & @CR
					$shtml &= '<title>_IE_Example("frameset")</title>' & @CR
					$shtml &= "</head>" & @CR
					$shtml &= '<frameset rows="25,200">' & @CR
					$shtml &= "	<frame name=Top SRC=about:blank>" & @CR
					$shtml &= '	<frameset cols="100,500">' & @CR
					$shtml &= "		<frame name=Menu SRC=about:blank>" & @CR
					$shtml &= "		<frame name=Main SRC=about:blank>" & @CR
					$shtml &= "	</frameset>" & @CR
					$shtml &= "</frameset>" & @CR
					$shtml &= "</html>"
					$oobject = _iecreate()
					_iedocwritehtml($oobject, $shtml)
					_ieaction($oobject, "refresh")
					Local $oframetop = _ieframegetobjbyname($oobject, "Top")
					Local $oframemenu = _ieframegetobjbyname($oobject, "Menu")
					Local $oframemain = _ieframegetobjbyname($oobject, "Main")
					_iebodywritehtml($oframetop, '$oFrameTop = _IEFrameGetObjByName($oIE, "Top")')
					_iebodywritehtml($oframemenu, '$oFrameMenu = _IEFrameGetObjByName($oIE, "Menu")')
					_iebodywritehtml($oframemain, '$oFrameMain = _IEFrameGetObjByName($oIE, "Main")')
				Case "iframe"
					$shtml &= "<!DOCTYPE html>" & @CR
					$shtml &= "<html>" & @CR
					$shtml &= "<head>" & @CR
					$shtml &= '<meta content="text/html; charset=UTF-8" http-equiv="content-type">' & @CR
					$shtml &= '<title>_IE_Example("iframe")</title>' & @CR
					$shtml &= "<style>td {padding:6px}</style>" & @CR
					$shtml &= "</head>" & @CR
					$shtml &= "<body>" & @CR
					$shtml &= '<table style="border-spacing:6px" border=1>' & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= '<td><iframe name="iFrameOne" src="about:blank" title="iFrameOne"></iframe></td>' & @CR
					$shtml &= '<td>&lt;iframe name="iFrameOne" src="about:blank" title="iFrameOne"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "<tr>" & @CR
					$shtml &= '<td><iframe name="iFrameTwo" src="about:blank" title="iFrameTwo"></iframe></td>' & @CR
					$shtml &= '<td>&lt;iframe name="iFrameTwo" src="about:blank" title="iFrameTwo"&gt;</td>' & @CR
					$shtml &= "</tr>" & @CR
					$shtml &= "</table>" & @CR
					$shtml &= "</body>" & @CR
					$shtml &= "</html>"
					$oobject = _iecreate()
					_iedocwritehtml($oobject, $shtml)
					_ieaction($oobject, "refresh")
					Local $oiframeone = _ieframegetobjbyname($oobject, "iFrameOne")
					Local $oiframetwo = _ieframegetobjbyname($oobject, "iFrameTwo")
					_iebodywritehtml($oiframeone, '$oIFrameOne = _IEFrameGetObjByName($oIE, "iFrameOne")')
					_iebodywritehtml($oiframetwo, '$oIFrameTwo = _IEFrameGetObjByName($oIE, "iFrameTwo")')
				Case Else
					__ieconsolewriteerror("Error", "_IE_Example", "$_IESTATUS_InvalidValue")
					Return SetError($_iestatus_invalidvalue, 1, 0)
			EndSwitch
			Sleep(500)
			Return SetError($_iestatus_success, 0, $oobject)
		EndFunc

		Func _ie_versioninfo()
			__ieconsolewriteerror("Information", "_IE_VersionInfo", "version " & $__gaieau3versioninfo[0] & $__gaieau3versioninfo[1] & "." & $__gaieau3versioninfo[2] & "-" & $__gaieau3versioninfo[3], "Release date: " & $__gaieau3versioninfo[4])
			Return SetError($_iestatus_success, 0, $__gaieau3versioninfo)
		EndFunc

	#EndRegion General
	#Region Internal functions

		Func __ielocksetforegroundwindow($ilockcode)
			Local $aret = DllCall("user32.dll", "bool", "LockSetForegroundWindow", "uint", $ilockcode)
			If @error OR NOT $aret[0] Then Return SetError(1, _winapi_getlasterror(), 0)
			Return $aret[0]
		EndFunc

		Func __iecontrolgetobjfromhwnd(ByRef $hwin)
			DllCall("ole32.dll", "long", "CoInitialize", "ptr", 0)
			If @error Then Return SetError(2, @error, 0)
			Local Const $wm_html_getobject = __ieregisterwindowmessage("WM_HTML_GETOBJECT")
			Local Const $smto_abortifhung = 2
			Local $iresult
			__iesendmessagetimeout($hwin, $wm_html_getobject, 0, 0, $smto_abortifhung, 1000, $iresult)
			Local $tuuid = DllStructCreate("int;short;short;byte[8]")
			DllStructSetData($tuuid, 1, 1651492128)
			DllStructSetData($tuuid, 2, 42014)
			DllStructSetData($tuuid, 3, 4559)
			DllStructSetData($tuuid, 4, 167, 1)
			DllStructSetData($tuuid, 4, 49, 2)
			DllStructSetData($tuuid, 4, 0, 3)
			DllStructSetData($tuuid, 4, 160, 4)
			DllStructSetData($tuuid, 4, 201, 5)
			DllStructSetData($tuuid, 4, 8, 6)
			DllStructSetData($tuuid, 4, 38, 7)
			DllStructSetData($tuuid, 4, 55, 8)
			Local $aret = DllCall("oleacc.dll", "long", "ObjectFromLresult", "lresult", $iresult, "struct*", $tuuid, "wparam", 0, "idispatch*", 0)
			If @error Then Return SetError(3, @error, 0)
			If IsObj($aret[4]) Then
				Local $oie = $aret[4].script()
				Return $oie.document.parentwindow
			Else
				Return SetError(1, $aret[0], 0)
			EndIf
		EndFunc

		Func __ieregisterwindowmessage($smsg)
			Local $aret = DllCall("user32.dll", "uint", "RegisterWindowMessageW", "wstr", $smsg)
			If @error Then Return SetError(@error, @extended, 0)
			If $aret[0] = 0 Then Return SetError(10, _winapi_getlasterror(), 0)
			Return $aret[0]
		EndFunc

		Func __iesendmessagetimeout($hwnd, $imsg, $wparam, $lparam, $iflags, $itimeout, ByRef $vout, $r = 0, $st1 = "int", $st2 = "int")
			Local $aret = DllCall("user32.dll", "lresult", "SendMessageTimeout", "hwnd", $hwnd, "uint", $imsg, $st1, $wparam, $st2, $lparam, "uint", $iflags, "uint", $itimeout, "dword_ptr*", "")
			If @error OR $aret[0] = 0 Then
				$vout = 0
				Return SetError(1, _winapi_getlasterror(), 0)
			EndIf
			$vout = $aret[7]
			If $r >= 0 AND $r <= 4 Then Return $aret[$r]
			Return $aret
		EndFunc

		Func __ieisobjtype(ByRef $oobject, $stype, $bregister = True)
			If NOT IsObj($oobject) Then
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			Local $bstatus = $bregister
			If $bregister Then
				$bstatus = __ieinternalerrorhandlerregister()
				If NOT $bstatus Then __ieconsolewriteerror("Warning", "internal function __IEIsObjType", "Cannot register internal error handler, cannot trap COM errors", "Use _IEErrorHandlerRegister() to register a user error handler")
			EndIf
			Local $inotifystatus = _ieerrornotify()
			_ieerrornotify(False)
			Local $sname = String(ObjName($oobject)), $ierrorstatus = $_iestatus_invalidobjecttype
			Switch $stype
				Case "browserdom"
					If __ieisobjtype($oobject, "documentcontainer", False) Then
						$ierrorstatus = $_iestatus_success
					ElseIf __ieisobjtype($oobject, "document", False) Then
						$ierrorstatus = $_iestatus_success
					Else
						Local $otemp = $oobject.document
						If __ieisobjtype($otemp, "document", False) Then
							$ierrorstatus = $_iestatus_success
						EndIf
					EndIf
				Case "browser"
					If ($sname = "IWebBrowser2") OR ($sname = "IWebBrowser") OR ($sname = "WebBrowser") Then $ierrorstatus = $_iestatus_success
				Case "window"
					If $sname = "HTMLWindow2" Then $ierrorstatus = $_iestatus_success
				Case "documentContainer"
					If __ieisobjtype($oobject, "window", False) OR __ieisobjtype($oobject, "browser", False) Then $ierrorstatus = $_iestatus_success
				Case "document"
					If $sname = "HTMLDocument" Then $ierrorstatus = $_iestatus_success
				Case "table"
					If $sname = "HTMLTable" Then $ierrorstatus = $_iestatus_success
				Case "form"
					If $sname = "HTMLFormElement" Then $ierrorstatus = $_iestatus_success
				Case "forminputelement"
					If ($sname = "HTMLInputElement") OR ($sname = "HTMLSelectElement") OR ($sname = "HTMLTextAreaElement") Then $ierrorstatus = $_iestatus_success
				Case "elementcollection"
					If ($sname = "HTMLElementCollection") Then $ierrorstatus = $_iestatus_success
				Case "formselectelement"
					If $sname = "HTMLSelectElement" Then $ierrorstatus = $_iestatus_success
				Case Else
					$ierrorstatus = $_iestatus_invalidvalue
			EndSwitch
			_ieerrornotify($inotifystatus)
			If $bregister Then
				__ieinternalerrorhandlerderegister()
			EndIf
			If $ierrorstatus = $_iestatus_success Then
				Return SetError($_iestatus_success, 0, 1)
			Else
				Return SetError($ierrorstatus, 1, 0)
			EndIf
		EndFunc

		Func __ieconsolewriteerror($sseverity, $sfunc, $smessage = Default, $sstatus = Default)
			If $__g_bieerrornotify OR $__g_bieau3debug Then
				Local $sstr = "--> IE.au3 " & $__gaieau3versioninfo[5] & " " & $sseverity & " from function " & $sfunc
				If NOT ($smessage = Default) Then $sstr &= ", " & $smessage
				If NOT ($sstatus = Default) Then $sstr &= " (" & $sstatus & ")"
				ConsoleWrite($sstr & @CRLF)
			EndIf
			Return SetError($sstatus, 0, 1)
		EndFunc

		Func __iecomerrorunrecoverable($ierror)
			Switch $ierror
				Case -2147352567
					Return $_iestatus_accessisdenied
				Case -2147024891
					Return $_iestatus_accessisdenied
				Case -2147417848
					Return $_iestatus_clientdisconnected
				Case -2147023174
					Return $_iestatus_clientdisconnected
				Case -2147023179
					Return $_iestatus_clientdisconnected
				Case Else
					Return $_iestatus_success
			EndSwitch
		EndFunc

	#EndRegion Internal functions
	#Region ProtoType Functions

		Func __ienavigate(ByRef $oobject, $surl, $iwait = 1, $ifags = 0, $starget = "", $spostdata = "", $sheaders = "")
			__ieconsolewriteerror("Warning", "__IENavigate", "Unsupported function called. Not fully tested.")
			If NOT IsObj($oobject) Then
				__ieconsolewriteerror("Error", "__IENavigate", "$_IESTATUS_InvalidDataType")
				Return SetError($_iestatus_invaliddatatype, 1, 0)
			EndIf
			If NOT __ieisobjtype($oobject, "documentContainer") Then
				__ieconsolewriteerror("Error", "__IENavigate", "$_IESTATUS_InvalidObjectType")
				Return SetError($_iestatus_invalidobjecttype, 1, 0)
			EndIf
			$oobject.navigate($surl, $ifags, $starget, $spostdata, $sheaders)
			If $iwait Then
				_ieloadwait($oobject)
				Return SetError(@error, 0, $oobject)
			EndIf
			Return SetError($_iestatus_success, 0, $oobject)
		EndFunc

		Func __iestringtobstr($sstring, $scharset = "us-ascii")
			Local Const $itypebinary = 1, $itypetext = 2
			Local $ostream = ObjCreate("ADODB.Stream")
			$ostream.type = $itypetext
			$ostream.charset = $scharset
			$ostream.open
			$ostream.writetext($sstring)
			$ostream.position = 0
			$ostream.type = $itypebinary
			$ostream.position = 0
			Return $ostream.read()
		EndFunc

		Func __iebstrtostring($obstr, $scharset = "us-ascii")
			Local Const $itypebinary = 1, $itypetext = 2
			Local $ostream = ObjCreate("ADODB.Stream")
			$ostream.type = $itypebinary
			$ostream.open
			$ostream.write($obstr)
			$ostream.position = 0
			$ostream.type = $itypetext
			$ostream.charset = $scharset
			$ostream.position = 0
			Return $ostream.readtext()
		EndFunc

		Func __iecreatenewie($stitle, $shead = "", $sbody = "")
			Local $stemp = __ietempfile("", "~IE~", ".htm")
			If @error Then
				__ieconsolewriteerror("Error", "_IECreateHTA", "", "Error creating temporary file in @TempDir or @ScriptDir")
				Return SetError($_iestatus_generalerror, 1, 0)
			EndIf
			Local $shtml = ""
			$shtml &= "<!DOCTYPE html>" & @CR
			$shtml &= "<html>" & @CR
			$shtml &= "<head>" & @CR
			$shtml &= '<meta content="text/html; charset=UTF-8" http-equiv="content-type">' & @CR
			$shtml &= "<title>" & $stemp & "</title>" & @CR & $shead & @CR
			$shtml &= "</head>" & @CR
			$shtml &= "<body>" & @CR & $sbody & @CR
			$shtml &= "</body>" & @CR
			$shtml &= "</html>"
			Local $hfile = FileOpen($stemp, $fo_overwrite)
			FileWrite($hfile, $shtml)
			FileClose($hfile)
			If @error Then
				__ieconsolewriteerror("Error", "_IECreateNewIE", "", "Error creating temporary file in @TempDir or @ScriptDir")
				Return SetError($_iestatus_generalerror, 2, 0)
			EndIf
			Run(@ProgramFilesDir & "\Internet Explorer\iexplore.exe " & $stemp)
			Local $ipid
			If WinWait($stemp, "", 60) Then
				$ipid = WinGetProcess($stemp)
			Else
				__ieconsolewriteerror("Error", "_IECreateNewIE", "", "Timeout waiting for new IE window creation")
				Return SetError($_iestatus_generalerror, 3, 0)
			EndIf
			If NOT FileDelete($stemp) Then
				__ieconsolewriteerror("Warning", "_IECreateNewIE", "", "Could not delete temporary file " & FileGetLongName($stemp))
			EndIf
			Local $oobject = _ieattach($stemp)
			_ieloadwait($oobject)
			_iepropertyset($oobject, "title", $stitle)
			Return SetError($_iestatus_success, $ipid, $oobject)
		EndFunc

		Func __ietempfile($sdirectoryname = @TempDir, $sfileprefix = "~", $sfileextension = ".tmp", $irandomlength = 7)
			Local $stempname, $itmp = 0
			If NOT FileExists($sdirectoryname) Then $sdirectoryname = @TempDir
			If NOT FileExists($sdirectoryname) Then $sdirectoryname = @ScriptDir
			If StringRight($sdirectoryname, 1) <> "\" Then $sdirectoryname = $sdirectoryname & "\"
			Do
				$stempname = ""
				While StringLen($stempname) < $irandomlength
					$stempname = $stempname & Chr(Random(97, 122, 1))
				WEnd
				$stempname = $sdirectoryname & $sfileprefix & $stempname & $sfileextension
				$itmp += 1
				If $itmp > 200 Then
					Return SetError($_iestatus_generalerror, 1, 0)
				EndIf
			Until NOT FileExists($stempname)
			Return $stempname
		EndFunc

	#EndRegion ProtoType Functions
	Local $__title = ""
	Local $__bgcolor = 0
	Local $__fontcolor = 16777215
	Local $__drag = 0
	Local $__ie = _iecreateembedded()
	If @error Then MsgBox(16, "ERROR", "Create IE Embedded failed")

	Func html_load($init, $w, $h, $left = 0, $top = 0, $mode = 0)
		_html_iecheckcompatible(True)
		If $__drag = 0 Then $__drag = GUICtrlCreateLabel("", 0, 0, $w - 141, 32, -1, $gui_ws_ex_parentdrag)
		GUICtrlSetState($__drag, $gui_disable)
		$obj = GUICtrlCreateObj($__ie, $left, $top, $w, $h)
		_ienavigate($__ie, $init, 1)
		If $mode = 0 Then
			GUICtrlSetState($__drag, $gui_enable)
			_iebodywritehtml($__ie, "<style> body { margin: 0 !important; } .ui-titlebar { display: flex; background: " & "#" & Hex($__bgcolor, 6) & ';} .ui-titleicon { flex-grow: 1; max-width: 32px; max-height: 32px; } .ui-titletext { flex-grow: 2; max-height: 32px; width: auto; font: 15px/32px "Segoe UI", Arial, sans-serif; color: ' & "#" & Hex($__fontcolor, 6) & '; text-indent: 10px; } .ui-titlecontrols { max-width: 144px; max-height: 32px; flex-grow: 1; } .ui-btn { width: 48px; height:32px; border: 0; outline: 0; background: transparent; } .ui-btn:hover { background: rgba(255,255,255,.20); } .ui-btn.closeccc:hover { background: red; } .ui-btn svg path, .ui-btn svg rect, .ui-btn svg polygon { fill: #fff; } .ui-btn svg { width: 10px; height: 10px; } </style> <div id="__bgcolor" class="ui-titlebar"> <!--<div class="ui-titleicon"></div>--> <div id="__title" class="ui-titletext">' & $__title & '</div> <div class="ui-titlecontrols"> <button id="-4" class="ui-btn minimize"> <svg x="0px" y="0px" viewBox="0 0 10.2 1"><rect x="0" y="50%" width="10.2" height="1" /></svg> </button><button class="ui-btn maximize"> <svg viewBox="0 0 10 10"><path d="M0,0v10h10V0H0z M9,9H1V1h8V9z" /></svg> </button><button id="-3" class="ui-btn closeccc"> <svg viewBox="0 0 10 10"><polygon points="10.2,0.7 9.5,0 5.1,4.4 0.7,0 0,0.7 4.4,5.1 0,9.5 0.7,10.2 5.1,5.8 9.5,10.2 10.2,9.5 5.8,5.1" /></svg> </button> </div> </div> ' & _iebodyreadhtml($__ie))
			html_settitlebar()
		Else
			GUICtrlSetState($__drag, $gui_disable)
			_iebodywritehtml($__ie, _iebodyreadhtml($__ie))
		EndIf
		html_evaljs('__evalscript = null;function execscript(code){__evalscript = code;} __click = "null"; document.addEventListener("click", function(event) { name = event.target.id; if (name != ""){ __click = name; } event.preventDefault(); }, true);')
		Return $obj
	EndFunc

	Func html_settitlebar($title = $__title, $bgcolor = $__bgcolor, $fontcolor = $__fontcolor)
		html_evaljs('document.getElementById("__title").innerHTML = "' & $title & '";')
		html_evaljs('document.getElementById("__bgcolor").style.background = "' & "#" & Hex($bgcolor, 6) & '";')
		html_evaljs('document.getElementsByClassName("ui-titletext")[0].style.color = "' & "#" & Hex($fontcolor, 6) & '";')
		$__title = $title
		$__bgcolor = $bgcolor
		$__fontcolor = $fontcolor
	EndFunc

	Func html_evaljs($code)
		Return $__ie.document.parentwindow.eval($code)
	EndFunc

	Func html_guigetmsg()
		$guihtmlmsg = html_evaljs("__click;")
		$guievalmsg = html_evaljs("__evalscript;")
		$guimsg = GUIGetMsg()
		If $guihtmlmsg <> "null" Then
			html_evaljs('__click = "null";')
		ElseIf $guievalmsg <> "null" Then
			Execute($guievalmsg)
			html_evaljs('__evalscript = "null";')
		ElseIf $guimsg <> 0 Then
			Return $guimsg
		EndIf
		Return $guihtmlmsg
	EndFunc

	Func html_guictrlread($id)
		Return html_evaljs('document.getElementById("' & $id & '").value;')
	EndFunc

	Func html_guictrlgetsize()
		$iw = html_evaljs("document.body.clientWidth ;")
		$ih = html_evaljs("document.body.clientHeight;")
		Local $return = [$iw, $ih]
		Return $return
	EndFunc

	Func html_guictrlsetbkcolor($color)
		$color = "#" & Hex($color, 6)
		html_evaljs("document.body.style.background = '" & $color & "';")
	EndFunc

	Func html_guictrlsetdata($id, $data)
		$tagname = html_evaljs('document.getElementById("' & $id & '").tagName;')
		Switch $tagname
			Case "BUTTON"
				$nodename = "innerHTML"
			Case "IMG", "SOURCE"
				$nodename = "src"
			Case Else
				$nodename = "value"
		EndSwitch
		html_evaljs('document.getElementById("' & $id & '").' & $nodename & '= "' & $data & '";')
	EndFunc

	Func _gui_roundcorners($h_win, $i_x3, $i_y3, $i_x1 = 0, $i_y1 = 0)
		Local $xs_pos, $xs_ret, $xs_ret2
		$xs_pos = WinGetPos($h_win)
		$xs_ret = DllCall("gdi32.dll", "long", "CreateRoundRectRgn", "long", $i_x1, "long", $i_y1, "long", $xs_pos[2], "long", $xs_pos[3], "long", $i_x3, "long", $i_y3)
		If $xs_ret[0] Then
			$xs_ret2 = DllCall("user32.dll", "long", "SetWindowRgn", "hwnd", $h_win, "long", $xs_ret[0], "int", 1)
		EndIf
	EndFunc

	Func _html_iecheckcompatible($vcheckmode = True)
		Local $_reg_browser_emulation = "\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION"
		Local $_reg_hkcu_browser_emulation = "HKCU\SOFTWARE" & $_reg_browser_emulation
		Local $_reg_hklm_browser_emulation = "HKLM\SOFTWARE" & $_reg_browser_emulation
		Local $_reg_hklmx64_browser_emulation = "HKLM\SOFTWARE\WOW6432Node" & $_reg_browser_emulation
		Local $_ie_mode, $_autoitexe = StringRegExp(@AutoItExe, "\\([^\\]+.exe)$", 1)[0]
		Local $_ie_version = StringRegExp(FileGetVersion(@ProgramFilesDir & "\Internet Explorer\iexplore.exe"), "^\d+", 1)
		If @error Then Return SetError(1, "Không lấy được version của IE")
		$_ie_version = $_ie_version[0]
		Switch $_ie_version
			Case 10
				$_ie_mode = 10001
			Case 11
				$_ie_mode = 11001
			Case Else
				MsgBox(4096, "Error", "!!! Phiên bản Internet Explorer hiện tại trên máy bạn đã cũ (IE" & $_ie_version & ")." & @CRLF & "!!! Điều này khiến giao diện không thể hiển thị được." & @CRLF & "!!! Máy tính của bạn cần trình duyệt IE ở phiên bản cao hơn..")
				Exit
		EndSwitch
		If $vcheckmode Then
			If RegRead($_reg_hkcu_browser_emulation, $_autoitexe) <> $_ie_mode Then RegWrite($_reg_hkcu_browser_emulation, $_autoitexe, "REG_DWORD", $_ie_mode)
			If RegRead($_reg_hklm_browser_emulation, $_autoitexe) <> $_ie_mode Then RegWrite($_reg_hklm_browser_emulation, $_autoitexe, "REG_DWORD", $_ie_mode)
			If @AutoItX64 AND RegRead($_reg_hklmx64_browser_emulation, $_autoitexe) <> $_ie_mode Then RegWrite($_reg_hklmx64_browser_emulation, $_autoitexe, "REG_DWORD", $_ie_mode)
		Else
			If RegRead($_reg_hkcu_browser_emulation, $_autoitexe) <> $_ie_mode Then RegDelete($_reg_hkcu_browser_emulation, $_autoitexe)
			If RegRead($_reg_hklm_browser_emulation, $_autoitexe) <> $_ie_mode Then RegDelete($_reg_hklm_browser_emulation, $_autoitexe)
			If @AutoItX64 AND RegRead($_reg_hklmx64_browser_emulation, $_autoitexe) <> $_ie_mode Then RegDelete($_reg_hklmx64_browser_emulation, $_autoitexe)
		EndIf
	EndFunc

	#Region ### START Koda GUI section ### Form=

		Func _creategdpgui()
			$gdp_width = 270
			$gdp_height = 220
			Global $gui_datepicker = GUICreate("CHỌN NGÀY", $gdp_width, $gdp_height, (@DesktopWidth - $gdp_width) / 2, (@DesktopHeight - $gdp_height) / 2, $ws_popup, $ws_ex_topmost)
			GUISetBkColor(6553501, $gui_datepicker)
			Global $gdp_datepicker = GUICtrlCreateDate(-1, ($gdp_width - 170) / 2, 88, 170, 38, $dts_rightalign)
			GUICtrlSendMsg($gdp_datepicker, $dtm_setformatw, 0, "dd/MM/yyyy")
			GUICtrlSetFont(-1, 16, 400, 0, "Segoe UI")
			Global $gdp_btn_accept = GUICtrlCreateLabel("ENTER", ($gdp_width - 64) / 2, 152, 64, 34, BitOR($ss_center, $ss_centerimage))
			GUICtrlSetFont(-1, 12, 400, 0, "Segoe UI")
			GUICtrlSetBkColor(-1, 2971888)
			GUICtrlSetColor(-1, 16777215)
			GUICtrlSetCursor(-1, 0)
			GUICtrlCreateLabel("CHỌN NGÀY", 0, 0, 268, 33, BitOR($ss_center, $ss_centerimage), $gui_ws_ex_parentdrag)
			GUICtrlSetFont(-1, 15, 700, 0, "Segoe UI")
			GUICtrlSetBkColor(-1, 4380281)
			GUICtrlSetColor(-1, 16777215)
		EndFunc

	#EndRegion ### END Koda GUI section ###

	Func _showgdpgui()
		GUISetState(@SW_SHOW, $gui_datepicker)
		While 1
			$imsg = GUIGetMsg()
			Switch $imsg
				Case $gdp_btn_accept
					Local $date = GUICtrlRead($gdp_datepicker)
					html_evaljs('document.getElementById("' & "datepicker_input" & '").value=' & '"' & $date & '"')
					html_evaljs("TakeTime()")
					GUISetState(@SW_HIDE, $gui_datepicker)
					ExitLoop
			EndSwitch
		WEnd
	EndFunc

	Func _hextostring($shex)
		If NOT (StringLeft($shex, 2) == "0x") Then $shex = "0x" & $shex
		Return BinaryToString($shex, $sb_utf8)
	EndFunc

	Func _stringbetween($sstring, $sstart, $send, $imode = $str_endisstart, $bcase = False)
		$sstart = $sstart ? "\Q" & $sstart & "\E" : "\A"
		If $imode <> $str_endnotstart Then $imode = $str_endisstart
		If $imode = $str_endisstart Then
			$send = $send ? "(?=\Q" & $send & "\E)" : "\z"
		Else
			$send = $send ? "\Q" & $send & "\E" : "\z"
		EndIf
		If $bcase = Default Then
			$bcase = False
		EndIf
		Local $areturn = StringRegExp($sstring, "(?s" & (NOT $bcase ? "i" : "") & ")" & $sstart & "(.*?)" & $send, $str_regexparrayglobalmatch)
		If @error Then Return SetError(1, 0, 0)
		Return $areturn
	EndFunc

	Func _stringexplode($sstring, $sdelimiter, $ilimit = 0)
		If $ilimit = Default Then $ilimit = 0
		If $ilimit > 0 Then
			Local Const $null = Chr(0)
			$sstring = StringReplace($sstring, $sdelimiter, $null, $ilimit)
			$sdelimiter = $null
		ElseIf $ilimit < 0 Then
			Local $iindex = StringInStr($sstring, $sdelimiter, $str_nocasesensebasic, $ilimit)
			If $iindex Then
				$sstring = StringLeft($sstring, $iindex - 1)
			EndIf
		EndIf
		Return StringSplit($sstring, $sdelimiter, BitOR($str_entiresplit, $str_nocount))
	EndFunc

	Func _stringinsert($sstring, $sinsertion, $iposition)
		Local $ilength = StringLen($sstring)
		$iposition = Int($iposition)
		If $iposition < 0 Then $iposition = $ilength + $iposition
		If $ilength < $iposition OR $iposition < 0 Then Return SetError(1, 0, $sstring)
		Return StringLeft($sstring, $iposition) & $sinsertion & StringRight($sstring, $ilength - $iposition)
	EndFunc

	Func _stringproper($sstring)
		Local $bcapnext = True, $schr = "", $sreturn = ""
		For $i = 1 To StringLen($sstring)
			$schr = StringMid($sstring, $i, 1)
			Select 
				Case $bcapnext = True
					If StringRegExp($schr, "[a-zA-ZÀ-ÿšœžŸ]") Then
						$schr = StringUpper($schr)
						$bcapnext = False
					EndIf
				Case NOT StringRegExp($schr, "[a-zA-ZÀ-ÿšœžŸ]")
					$bcapnext = True
				Case Else
					$schr = StringLower($schr)
			EndSelect
			$sreturn &= $schr
		Next
		Return $sreturn
	EndFunc

	Func _stringrepeat($sstring, $irepeatcount)
		$irepeatcount = Int($irepeatcount)
		If $irepeatcount = 0 Then Return ""
		If StringLen($sstring) < 1 OR $irepeatcount < 0 Then Return SetError(1, 0, "")
		Local $sresult = ""
		While $irepeatcount > 1
			If BitAND($irepeatcount, 1) Then $sresult &= $sstring
			$sstring &= $sstring
			$irepeatcount = BitShift($irepeatcount, 1)
		WEnd
		Return $sstring & $sresult
	EndFunc

	Func _stringtitlecase($sstring)
		Local $bcapnext = True, $schr = "", $sreturn = ""
		For $i = 1 To StringLen($sstring)
			$schr = StringMid($sstring, $i, 1)
			Select 
				Case $bcapnext = True
					If StringRegExp($schr, "[a-zA-Z\xC0-\xFF0-9]") Then
						$schr = StringUpper($schr)
						$bcapnext = False
					EndIf
				Case NOT StringRegExp($schr, "[a-zA-Z\xC0-\xFF'0-9]")
					$bcapnext = True
				Case Else
					$schr = StringLower($schr)
			EndSelect
			$sreturn &= $schr
		Next
		Return $sreturn
	EndFunc

	Func _stringtohex($sstring)
		Return Hex(StringToBinary($sstring, $sb_utf8))
	EndFunc

	Global Const $gmem_fixed = 0
	Global Const $gmem_moveable = 2
	Global Const $gmem_nocompact = 16
	Global Const $gmem_nodiscard = 32
	Global Const $gmem_zeroinit = 64
	Global Const $gmem_modify = 128
	Global Const $gmem_discardable = 256
	Global Const $gmem_not_banked = 4096
	Global Const $gmem_share = 8192
	Global Const $gmem_ddeshare = 8192
	Global Const $gmem_notify = 16384
	Global Const $gmem_lower = 4096
	Global Const $gmem_valid_flags = 32626
	Global Const $gmem_invalid_handle = 32768
	Global Const $gptr = BitOR($gmem_fixed, $gmem_zeroinit)
	Global Const $ghnd = BitOR($gmem_moveable, $gmem_zeroinit)
	Global Const $mem_commit = 4096
	Global Const $mem_reserve = 8192
	Global Const $mem_top_down = 1048576
	Global Const $mem_shared = 134217728
	Global Const $page_noaccess = 1
	Global Const $page_readonly = 2
	Global Const $page_readwrite = 4
	Global Const $page_execute = 16
	Global Const $page_execute_read = 32
	Global Const $page_execute_readwrite = 64
	Global Const $page_execute_writecopy = 128
	Global Const $page_guard = 256
	Global Const $page_nocache = 512
	Global Const $page_writecombine = 1024
	Global Const $page_writecopy = 8
	Global Const $mem_decommit = 16384
	Global Const $mem_release = 32768
	Global Enum $mem_load, $mem_totalphysram, $mem_availphysram, $mem_totalpagefile, $mem_availpagefile, $mem_totalvirtual, $mem_availvirtual
	Global Const $process_terminate = 1
	Global Const $process_create_thread = 2
	Global Const $process_set_sessionid = 4
	Global Const $process_vm_operation = 8
	Global Const $process_vm_read = 16
	Global Const $process_vm_write = 32
	Global Const $process_dup_handle = 64
	Global Const $process_create_process = 128
	Global Const $process_set_quota = 256
	Global Const $process_set_information = 512
	Global Const $process_query_information = 1024
	Global Const $process_query_limited_information = 4096
	Global Const $process_suspend_resume = 2048
	Global Const $process_all_access = 2035711
	Global Const $se_assignprimarytoken_name = "SeAssignPrimaryTokenPrivilege"
	Global Const $se_audit_name = "SeAuditPrivilege"
	Global Const $se_backup_name = "SeBackupPrivilege"
	Global Const $se_change_notify_name = "SeChangeNotifyPrivilege"
	Global Const $se_create_global_name = "SeCreateGlobalPrivilege"
	Global Const $se_create_pagefile_name = "SeCreatePagefilePrivilege"
	Global Const $se_create_permanent_name = "SeCreatePermanentPrivilege"
	Global Const $se_create_symbolic_link_name = "SeCreateSymbolicLinkPrivilege"
	Global Const $se_create_token_name = "SeCreateTokenPrivilege"
	Global Const $se_debug_name = "SeDebugPrivilege"
	Global Const $se_enable_delegation_name = "SeEnableDelegationPrivilege"
	Global Const $se_impersonate_name = "SeImpersonatePrivilege"
	Global Const $se_inc_base_priority_name = "SeIncreaseBasePriorityPrivilege"
	Global Const $se_inc_working_set_name = "SeIncreaseWorkingSetPrivilege"
	Global Const $se_increase_quota_name = "SeIncreaseQuotaPrivilege"
	Global Const $se_load_driver_name = "SeLoadDriverPrivilege"
	Global Const $se_lock_memory_name = "SeLockMemoryPrivilege"
	Global Const $se_machine_account_name = "SeMachineAccountPrivilege"
	Global Const $se_manage_volume_name = "SeManageVolumePrivilege"
	Global Const $se_prof_single_process_name = "SeProfileSingleProcessPrivilege"
	Global Const $se_relabel_name = "SeRelabelPrivilege"
	Global Const $se_remote_shutdown_name = "SeRemoteShutdownPrivilege"
	Global Const $se_restore_name = "SeRestorePrivilege"
	Global Const $se_security_name = "SeSecurityPrivilege"
	Global Const $se_shutdown_name = "SeShutdownPrivilege"
	Global Const $se_sync_agent_name = "SeSyncAgentPrivilege"
	Global Const $se_system_environment_name = "SeSystemEnvironmentPrivilege"
	Global Const $se_system_profile_name = "SeSystemProfilePrivilege"
	Global Const $se_systemtime_name = "SeSystemtimePrivilege"
	Global Const $se_take_ownership_name = "SeTakeOwnershipPrivilege"
	Global Const $se_tcb_name = "SeTcbPrivilege"
	Global Const $se_time_zone_name = "SeTimeZonePrivilege"
	Global Const $se_trusted_credman_access_name = "SeTrustedCredManAccessPrivilege"
	Global Const $se_unsolicited_input_name = "SeUnsolicitedInputPrivilege"
	Global Const $se_undock_name = "SeUndockPrivilege"
	Global Const $se_privilege_enabled_by_default = 1
	Global Const $se_privilege_enabled = 2
	Global Const $se_privilege_removed = 4
	Global Const $se_privilege_used_for_access = -2147483648
	Global Const $se_group_mandatory = 1
	Global Const $se_group_enabled_by_default = 2
	Global Const $se_group_enabled = 4
	Global Const $se_group_owner = 8
	Global Const $se_group_use_for_deny_only = 16
	Global Const $se_group_integrity = 32
	Global Const $se_group_integrity_enabled = 64
	Global Const $se_group_resource = 536870912
	Global Const $se_group_logon_id = -1073741824
	Global Enum $tokenprimary = 1, $tokenimpersonation
	Global Enum $securityanonymous = 0, $securityidentification, $securityimpersonation, $securitydelegation
	Global Enum $tokenuser = 1, $tokengroups, $tokenprivileges, $tokenowner, $tokenprimarygroup, $tokendefaultdacl, $tokensource, $tokentype, $tokenimpersonationlevel, $tokenstatistics, $tokenrestrictedsids, $tokensessionid, $tokengroupsandprivileges, $tokensessionreference, $tokensandboxinert, $tokenauditpolicy, $tokenorigin, $tokenelevationtype, $tokenlinkedtoken, $tokenelevation, $tokenhasrestrictions, $tokenaccessinformation, $tokenvirtualizationallowed, $tokenvirtualizationenabled, $tokenintegritylevel, $tokenuiaccess, $tokenmandatorypolicy, $tokenlogonsid
	Global Const $token_assign_primary = 1
	Global Const $token_duplicate = 2
	Global Const $token_impersonate = 4
	Global Const $token_query = 8
	Global Const $token_query_source = 16
	Global Const $token_adjust_privileges = 32
	Global Const $token_adjust_groups = 64
	Global Const $token_adjust_default = 128
	Global Const $token_adjust_sessionid = 256
	Global Const $token_all_access = 983551
	Global Const $token_read = 131080
	Global Const $token_write = 131296
	Global Const $token_execute = 131072
	Global Const $token_has_traverse_privilege = 1
	Global Const $token_has_backup_privilege = 2
	Global Const $token_has_restore_privilege = 4
	Global Const $token_has_admin_group = 8
	Global Const $token_is_restricted = 16
	Global Const $token_session_not_referenced = 32
	Global Const $token_sandbox_inert = 64
	Global Const $token_has_impersonate_privilege = 128
	Global Const $rights_delete = 65536
	Global Const $read_control = 131072
	Global Const $write_dac = 262144
	Global Const $write_owner = 524288
	Global Const $synchronize = 1048576
	Global Const $access_system_security = 16777216
	Global Const $standard_rights_required = 983040
	Global Const $standard_rights_read = $read_control
	Global Const $standard_rights_write = $read_control
	Global Const $standard_rights_execute = $read_control
	Global Const $standard_rights_all = 2031616
	Global Const $specific_rights_all = 65535
	Global Enum $not_used_access = 0, $grant_access, $set_access, $deny_access, $revoke_access, $set_audit_success, $set_audit_failure
	Global Enum $trustee_is_unknown = 0, $trustee_is_user, $trustee_is_group, $trustee_is_domain, $trustee_is_alias, $trustee_is_well_known_group, $trustee_is_deleted, $trustee_is_invalid, $trustee_is_computer
	Global Const $logon_with_profile = 1
	Global Const $logon_netcredentials_only = 2
	Global Enum $sidtypeuser = 1, $sidtypegroup, $sidtypedomain, $sidtypealias, $sidtypewellknowngroup, $sidtypedeletedaccount, $sidtypeinvalid, $sidtypeunknown, $sidtypecomputer, $sidtypelabel
	Global Const $sid_administrators = "S-1-5-32-544"
	Global Const $sid_users = "S-1-5-32-545"
	Global Const $sid_guests = "S-1-5-32-546"
	Global Const $sid_account_operators = "S-1-5-32-548"
	Global Const $sid_server_operators = "S-1-5-32-549"
	Global Const $sid_print_operators = "S-1-5-32-550"
	Global Const $sid_backup_operators = "S-1-5-32-551"
	Global Const $sid_replicator = "S-1-5-32-552"
	Global Const $sid_owner = "S-1-3-0"
	Global Const $sid_everyone = "S-1-1-0"
	Global Const $sid_network = "S-1-5-2"
	Global Const $sid_interactive = "S-1-5-4"
	Global Const $sid_system = "S-1-5-18"
	Global Const $sid_authenticated_users = "S-1-5-11"
	Global Const $sid_schannel_authentication = "S-1-5-64-14"
	Global Const $sid_digest_authentication = "S-1-5-64-21"
	Global Const $sid_nt_service = "S-1-5-80"
	Global Const $sid_untrusted_mandatory_level = "S-1-16-0"
	Global Const $sid_low_mandatory_level = "S-1-16-4096"
	Global Const $sid_medium_mandatory_level = "S-1-16-8192"
	Global Const $sid_medium_plus_mandatory_level = "S-1-16-8448"
	Global Const $sid_high_mandatory_level = "S-1-16-12288"
	Global Const $sid_system_mandatory_level = "S-1-16-16384"
	Global Const $sid_protected_process_mandatory_level = "S-1-16-20480"
	Global Const $sid_secure_process_mandatory_level = "S-1-16-28672"
	Global Const $sid_all_services = "S-1-5-80-0"

	Func _security__adjusttokenprivileges($htoken, $bdisableall, $tnewstate, $ibufferlen, $tprevstate = 0, $prequired = 0)
		Local $acall = DllCall("advapi32.dll", "bool", "AdjustTokenPrivileges", "handle", $htoken, "bool", $bdisableall, "struct*", $tnewstate, "dword", $ibufferlen, "struct*", $tprevstate, "struct*", $prequired)
		If @error Then Return SetError(@error, @extended, False)
		Return NOT ($acall[0] = 0)
	EndFunc

	Func _security__createprocesswithtoken($htoken, $ilogonflags, $scommandline, $icreationflags, $scurdir, $tstartupinfo, $tprocess_information)
		Local $acall = DllCall("advapi32.dll", "bool", "CreateProcessWithTokenW", "handle", $htoken, "dword", $ilogonflags, "ptr", 0, "wstr", $scommandline, "dword", $icreationflags, "struct*", 0, "wstr", $scurdir, "struct*", $tstartupinfo, "struct*", $tprocess_information)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, False)
		Return True
	EndFunc

	Func _security__duplicatetokenex($hexistingtoken, $idesiredaccess, $iimpersonationlevel, $itokentype)
		Local $acall = DllCall("advapi32.dll", "bool", "DuplicateTokenEx", "handle", $hexistingtoken, "dword", $idesiredaccess, "struct*", 0, "int", $iimpersonationlevel, "int", $itokentype, "handle*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Return $acall[6]
	EndFunc

	Func _security__getaccountsid($saccount, $ssystem = "")
		Local $aacct = _security__lookupaccountname($saccount, $ssystem)
		If @error Then Return SetError(@error, @extended, 0)
		If IsArray($aacct) Then Return _security__stringsidtosid($aacct[0])
		Return ""
	EndFunc

	Func _security__getlengthsid($psid)
		If NOT _security__isvalidsid($psid) Then Return SetError(@error + 10, @extended, 0)
		Local $acall = DllCall("advapi32.dll", "dword", "GetLengthSid", "struct*", $psid)
		If @error Then Return SetError(@error, @extended, 0)
		Return $acall[0]
	EndFunc

	Func _security__gettokeninformation($htoken, $iclass)
		Local $acall = DllCall("advapi32.dll", "bool", "GetTokenInformation", "handle", $htoken, "int", $iclass, "struct*", 0, "dword", 0, "dword*", 0)
		If @error OR NOT $acall[5] Then Return SetError(@error + 10, @extended, 0)
		Local $ilen = $acall[5]
		Local $tbuffer = DllStructCreate("byte[" & $ilen & "]")
		$acall = DllCall("advapi32.dll", "bool", "GetTokenInformation", "handle", $htoken, "int", $iclass, "struct*", $tbuffer, "dword", DllStructGetSize($tbuffer), "dword*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Return $tbuffer
	EndFunc

	Func _security__impersonateself($ilevel = $securityimpersonation)
		Local $acall = DllCall("advapi32.dll", "bool", "ImpersonateSelf", "int", $ilevel)
		If @error Then Return SetError(@error, @extended, False)
		Return NOT ($acall[0] = 0)
	EndFunc

	Func _security__isvalidsid($psid)
		Local $acall = DllCall("advapi32.dll", "bool", "IsValidSid", "struct*", $psid)
		If @error Then Return SetError(@error, @extended, False)
		Return NOT ($acall[0] = 0)
	EndFunc

	Func _security__lookupaccountname($saccount, $ssystem = "")
		Local $tdata = DllStructCreate("byte SID[256]")
		Local $acall = DllCall("advapi32.dll", "bool", "LookupAccountNameW", "wstr", $ssystem, "wstr", $saccount, "struct*", $tdata, "dword*", DllStructGetSize($tdata), "wstr", "", "dword*", DllStructGetSize($tdata), "int*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Local $aacct[3]
		$aacct[0] = _security__sidtostringsid(DllStructGetPtr($tdata, "SID"))
		$aacct[1] = $acall[5]
		$aacct[2] = $acall[7]
		Return $aacct
	EndFunc

	Func _security__lookupaccountsid($vsid, $ssystem = "")
		Local $psid, $aacct[3]
		If IsString($vsid) Then
			$psid = _security__stringsidtosid($vsid)
		Else
			$psid = $vsid
		EndIf
		If NOT _security__isvalidsid($psid) Then Return SetError(@error + 10, @extended, 0)
		Local $stypesystem = "ptr"
		If $ssystem Then $stypesystem = "wstr"
		Local $acall = DllCall("advapi32.dll", "bool", "LookupAccountSidW", $stypesystem, $ssystem, "struct*", $psid, "wstr", "", "dword*", 65536, "wstr", "", "dword*", 65536, "int*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Local $aacct[3]
		$aacct[0] = $acall[3]
		$aacct[1] = $acall[5]
		$aacct[2] = $acall[7]
		Return $aacct
	EndFunc

	Func _security__lookupprivilegevalue($ssystem, $sname)
		Local $acall = DllCall("advapi32.dll", "bool", "LookupPrivilegeValueW", "wstr", $ssystem, "wstr", $sname, "int64*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Return $acall[3]
	EndFunc

	Func _security__openprocesstoken($hprocess, $iaccess)
		Local $acall = DllCall("advapi32.dll", "bool", "OpenProcessToken", "handle", $hprocess, "dword", $iaccess, "handle*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Return $acall[3]
	EndFunc

	Func _security__openthreadtoken($iaccess, $hthread = 0, $bopenasself = False)
		If $hthread = 0 Then
			Local $aresult = DllCall("kernel32.dll", "handle", "GetCurrentThread")
			If @error Then Return SetError(@error + 10, @extended, 0)
			$hthread = $aresult[0]
		EndIf
		Local $acall = DllCall("advapi32.dll", "bool", "OpenThreadToken", "handle", $hthread, "dword", $iaccess, "bool", $bopenasself, "handle*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Return $acall[4]
	EndFunc

	Func _security__openthreadtokenex($iaccess, $hthread = 0, $bopenasself = False)
		Local $htoken = _security__openthreadtoken($iaccess, $hthread, $bopenasself)
		If $htoken = 0 Then
			Local Const $error_no_token = 1008
			If _winapi_getlasterror() <> $error_no_token Then Return SetError(20, _winapi_getlasterror(), 0)
			If NOT _security__impersonateself() Then Return SetError(@error + 10, _winapi_getlasterror(), 0)
			$htoken = _security__openthreadtoken($iaccess, $hthread, $bopenasself)
			If $htoken = 0 Then Return SetError(@error, _winapi_getlasterror(), 0)
		EndIf
		Return $htoken
	EndFunc

	Func _security__setprivilege($htoken, $sprivilege, $benable)
		Local $iluid = _security__lookupprivilegevalue("", $sprivilege)
		If $iluid = 0 Then Return SetError(@error + 10, @extended, False)
		Local Const $tagtoken_privileges = "dword Count;align 4;int64 LUID;dword Attributes"
		Local $tcurrstate = DllStructCreate($tagtoken_privileges)
		Local $icurrstate = DllStructGetSize($tcurrstate)
		Local $tprevstate = DllStructCreate($tagtoken_privileges)
		Local $iprevstate = DllStructGetSize($tprevstate)
		Local $trequired = DllStructCreate("int Data")
		DllStructSetData($tcurrstate, "Count", 1)
		DllStructSetData($tcurrstate, "LUID", $iluid)
		If NOT _security__adjusttokenprivileges($htoken, False, $tcurrstate, $icurrstate, $tprevstate, $trequired) Then Return SetError(2, @error, False)
		DllStructSetData($tprevstate, "Count", 1)
		DllStructSetData($tprevstate, "LUID", $iluid)
		Local $iattributes = DllStructGetData($tprevstate, "Attributes")
		If $benable Then
			$iattributes = BitOR($iattributes, $se_privilege_enabled)
		Else
			$iattributes = BitAND($iattributes, BitNOT($se_privilege_enabled))
		EndIf
		DllStructSetData($tprevstate, "Attributes", $iattributes)
		If NOT _security__adjusttokenprivileges($htoken, False, $tprevstate, $iprevstate, $tcurrstate, $trequired) Then Return SetError(3, @error, False)
		Return True
	EndFunc

	Func _security__settokeninformation($htoken, $itokeninformation, $vtokeninformation, $itokeninformationlength)
		Local $acall = DllCall("advapi32.dll", "bool", "SetTokenInformation", "handle", $htoken, "int", $itokeninformation, "struct*", $vtokeninformation, "dword", $itokeninformationlength)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, False)
		Return True
	EndFunc

	Func _security__sidtostringsid($psid)
		If NOT _security__isvalidsid($psid) Then Return SetError(@error + 10, 0, "")
		Local $acall = DllCall("advapi32.dll", "bool", "ConvertSidToStringSidW", "struct*", $psid, "ptr*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, "")
		Local $pstringsid = $acall[2]
		Local $alen = DllCall("kernel32.dll", "int", "lstrlenW", "struct*", $pstringsid)
		Local $ssid = DllStructGetData(DllStructCreate("wchar Text[" & $alen[0] + 1 & "]", $pstringsid), "Text")
		DllCall("kernel32.dll", "handle", "LocalFree", "handle", $pstringsid)
		Return $ssid
	EndFunc

	Func _security__sidtypestr($itype)
		Switch $itype
			Case $sidtypeuser
				Return "User"
			Case $sidtypegroup
				Return "Group"
			Case $sidtypedomain
				Return "Domain"
			Case $sidtypealias
				Return "Alias"
			Case $sidtypewellknowngroup
				Return "Well Known Group"
			Case $sidtypedeletedaccount
				Return "Deleted Account"
			Case $sidtypeinvalid
				Return "Invalid"
			Case $sidtypeunknown
				Return "Unknown Type"
			Case $sidtypecomputer
				Return "Computer"
			Case $sidtypelabel
				Return "A mandatory integrity label SID"
			Case Else
				Return "Unknown SID Type"
		EndSwitch
	EndFunc

	Func _security__stringsidtosid($ssid)
		Local $acall = DllCall("advapi32.dll", "bool", "ConvertStringSidToSidW", "wstr", $ssid, "ptr*", 0)
		If @error OR NOT $acall[0] Then Return SetError(@error, @extended, 0)
		Local $psid = $acall[2]
		Local $tbuffer = DllStructCreate("byte Data[" & _security__getlengthsid($psid) & "]", $psid)
		Local $tsid = DllStructCreate("byte Data[" & DllStructGetSize($tbuffer) & "]")
		DllStructSetData($tsid, "Data", DllStructGetData($tbuffer, "Data"))
		DllCall("kernel32.dll", "handle", "LocalFree", "handle", $psid)
		Return $tsid
	EndFunc

	Global Const $tagmemmap = "handle hProc;ulong_ptr Size;ptr Mem"

	Func _memfree(ByRef $tmemmap)
		Local $pmemory = DllStructGetData($tmemmap, "Mem")
		Local $hprocess = DllStructGetData($tmemmap, "hProc")
		Local $bresult = _memvirtualfreeex($hprocess, $pmemory, 0, $mem_release)
		DllCall("kernel32.dll", "bool", "CloseHandle", "handle", $hprocess)
		If @error Then Return SetError(@error, @extended, False)
		Return $bresult
	EndFunc

	Func _memglobalalloc($ibytes, $iflags = 0)
		Local $aresult = DllCall("kernel32.dll", "handle", "GlobalAlloc", "uint", $iflags, "ulong_ptr", $ibytes)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _memglobalfree($hmemory)
		Local $aresult = DllCall("kernel32.dll", "ptr", "GlobalFree", "handle", $hmemory)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _memgloballock($hmemory)
		Local $aresult = DllCall("kernel32.dll", "ptr", "GlobalLock", "handle", $hmemory)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _memglobalsize($hmemory)
		Local $aresult = DllCall("kernel32.dll", "ulong_ptr", "GlobalSize", "handle", $hmemory)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _memglobalunlock($hmemory)
		Local $aresult = DllCall("kernel32.dll", "bool", "GlobalUnlock", "handle", $hmemory)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _meminit($hwnd, $isize, ByRef $tmemmap)
		Local $aresult = DllCall("user32.dll", "dword", "GetWindowThreadProcessId", "hwnd", $hwnd, "dword*", 0)
		If @error Then Return SetError(@error + 10, @extended, 0)
		Local $iprocessid = $aresult[2]
		If $iprocessid = 0 Then Return SetError(1, 0, 0)
		Local $iaccess = BitOR($process_vm_operation, $process_vm_read, $process_vm_write)
		Local $hprocess = __mem_openprocess($iaccess, False, $iprocessid, True)
		Local $ialloc = BitOR($mem_reserve, $mem_commit)
		Local $pmemory = _memvirtualallocex($hprocess, 0, $isize, $ialloc, $page_readwrite)
		If $pmemory = 0 Then Return SetError(2, 0, 0)
		$tmemmap = DllStructCreate($tagmemmap)
		DllStructSetData($tmemmap, "hProc", $hprocess)
		DllStructSetData($tmemmap, "Size", $isize)
		DllStructSetData($tmemmap, "Mem", $pmemory)
		Return $pmemory
	EndFunc

	Func _memmovememory($psource, $pdest, $ilength)
		DllCall("kernel32.dll", "none", "RtlMoveMemory", "struct*", $pdest, "struct*", $psource, "ulong_ptr", $ilength)
		If @error Then Return SetError(@error, @extended)
	EndFunc

	Func _memread(ByRef $tmemmap, $psrce, $pdest, $isize)
		Local $aresult = DllCall("kernel32.dll", "bool", "ReadProcessMemory", "handle", DllStructGetData($tmemmap, "hProc"), "ptr", $psrce, "struct*", $pdest, "ulong_ptr", $isize, "ulong_ptr*", 0)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _memwrite(ByRef $tmemmap, $psrce, $pdest = 0, $isize = 0, $ssrce = "struct*")
		If $pdest = 0 Then $pdest = DllStructGetData($tmemmap, "Mem")
		If $isize = 0 Then $isize = DllStructGetData($tmemmap, "Size")
		Local $aresult = DllCall("kernel32.dll", "bool", "WriteProcessMemory", "handle", DllStructGetData($tmemmap, "hProc"), "ptr", $pdest, $ssrce, $psrce, "ulong_ptr", $isize, "ulong_ptr*", 0)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _memvirtualalloc($paddress, $isize, $iallocation, $iprotect)
		Local $aresult = DllCall("kernel32.dll", "ptr", "VirtualAlloc", "ptr", $paddress, "ulong_ptr", $isize, "dword", $iallocation, "dword", $iprotect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _memvirtualallocex($hprocess, $paddress, $isize, $iallocation, $iprotect)
		Local $aresult = DllCall("kernel32.dll", "ptr", "VirtualAllocEx", "handle", $hprocess, "ptr", $paddress, "ulong_ptr", $isize, "dword", $iallocation, "dword", $iprotect)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _memvirtualfree($paddress, $isize, $ifreetype)
		Local $aresult = DllCall("kernel32.dll", "bool", "VirtualFree", "ptr", $paddress, "ulong_ptr", $isize, "dword", $ifreetype)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _memvirtualfreeex($hprocess, $paddress, $isize, $ifreetype)
		Local $aresult = DllCall("kernel32.dll", "bool", "VirtualFreeEx", "handle", $hprocess, "ptr", $paddress, "ulong_ptr", $isize, "dword", $ifreetype)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func __mem_openprocess($iaccess, $binherit, $ipid, $bdebugpriv = False)
		Local $aresult = DllCall("kernel32.dll", "handle", "OpenProcess", "dword", $iaccess, "bool", $binherit, "dword", $ipid)
		If @error Then Return SetError(@error, @extended, 0)
		If $aresult[0] Then Return $aresult[0]
		If NOT $bdebugpriv Then Return SetError(100, 0, 0)
		Local $htoken = _security__openthreadtokenex(BitOR($token_adjust_privileges, $token_query))
		If @error Then Return SetError(@error + 10, @extended, 0)
		_security__setprivilege($htoken, "SeDebugPrivilege", True)
		Local $ierror = @error
		Local $iextended = @extended
		Local $iret = 0
		If NOT @error Then
			$aresult = DllCall("kernel32.dll", "handle", "OpenProcess", "dword", $iaccess, "bool", $binherit, "dword", $ipid)
			$ierror = @error
			$iextended = @extended
			If $aresult[0] Then $iret = $aresult[0]
			_security__setprivilege($htoken, "SeDebugPrivilege", False)
			If @error Then
				$ierror = @error + 20
				$iextended = @extended
			EndIf
		Else
			$ierror = @error + 30
		EndIf
		DllCall("kernel32.dll", "bool", "CloseHandle", "handle", $htoken)
		Return SetError($ierror, $iextended, $iret)
	EndFunc

	Global Const $linguistic_ignorecase = 16
	Global Const $linguistic_ignorediacritic = 32
	Global Const $norm_ignorecase = 1
	Global Const $norm_ignorekanatype = 65536
	Global Const $norm_ignorenonspace = 2
	Global Const $norm_ignoresymbols = 4
	Global Const $norm_ignorewidth = 131072
	Global Const $norm_linguistic_casing = 134217728
	Global Const $sort_digitsasnumbers = 8
	Global Const $sort_stringsort = 4096
	Global Const $cstr_less_than = 1
	Global Const $cstr_equal = 2
	Global Const $cstr_greater_than = 3
	Global Const $mui_language_id = 4
	Global Const $mui_language_name = 8
	Global Const $date_autolayout = 64
	Global Const $date_longdate = 2
	Global Const $date_ltrreading = 16
	Global Const $date_shortdate = 1
	Global Const $date_rtlreading = 32
	Global Const $date_use_alt_calendar = 4
	Global Const $date_yearmonth = 8
	Global Const $geo_nation = 1
	Global Const $geo_latitude = 2
	Global Const $geo_longitude = 3
	Global Const $geo_iso2 = 4
	Global Const $geo_iso3 = 5
	Global Const $geo_rfc1766 = 6
	Global Const $geo_lcid = 7
	Global Const $geo_friendlyname = 8
	Global Const $geo_officialname = 9
	Global Const $geo_timezones = 10
	Global Const $geo_officiallanguages = 11
	Global Const $geo_iso_un_number = 12
	Global Const $geo_parent = 13
	Global Const $locale_ilanguage = 1
	Global Const $locale_slanguage = 2
	Global Const $locale_senglanguage = 4097
	Global Const $locale_sabbrevlangname = 3
	Global Const $locale_snativelangname = 4
	Global Const $locale_icountry = 5
	Global Const $locale_scountry = 6
	Global Const $locale_sengcountry = 4098
	Global Const $locale_sabbrevctryname = 7
	Global Const $locale_snativectryname = 8
	Global Const $locale_idefaultlanguage = 9
	Global Const $locale_idefaultcountry = 10
	Global Const $locale_idefaultcodepage = 11
	Global Const $locale_idefaultansicodepage = 4100
	Global Const $locale_idefaultmaccodepage = 4113
	Global Const $locale_slist = 12
	Global Const $locale_imeasure = 13
	Global Const $locale_sdecimal = 14
	Global Const $locale_sthousand = 15
	Global Const $locale_sgrouping = 16
	Global Const $locale_idigits = 17
	Global Const $locale_ilzero = 18
	Global Const $locale_inegnumber = 4112
	Global Const $locale_snativedigits = 19
	Global Const $locale_scurrency = 20
	Global Const $locale_sintlsymbol = 21
	Global Const $locale_smondecimalsep = 22
	Global Const $locale_smonthousandsep = 23
	Global Const $locale_smongrouping = 24
	Global Const $locale_icurrdigits = 25
	Global Const $locale_iintlcurrdigits = 26
	Global Const $locale_icurrency = 27
	Global Const $locale_inegcurr = 28
	Global Const $locale_sdate = 29
	Global Const $locale_stime = 30
	Global Const $locale_sshortdate = 31
	Global Const $locale_slongdate = 32
	Global Const $locale_stimeformat = 4099
	Global Const $locale_idate = 33
	Global Const $locale_ildate = 34
	Global Const $locale_itime = 35
	Global Const $locale_itimemarkposn = 4101
	Global Const $locale_icentury = 36
	Global Const $locale_itlzero = 37
	Global Const $locale_idaylzero = 38
	Global Const $locale_imonlzero = 39
	Global Const $locale_s1159 = 40
	Global Const $locale_s2359 = 41
	Global Const $locale_icalendartype = 4105
	Global Const $locale_ioptionalcalendar = 4107
	Global Const $locale_ifirstdayofweek = 4108
	Global Const $locale_ifirstweekofyear = 4109
	Global Const $locale_sdayname1 = 42
	Global Const $locale_sdayname2 = 43
	Global Const $locale_sdayname3 = 44
	Global Const $locale_sdayname4 = 45
	Global Const $locale_sdayname5 = 46
	Global Const $locale_sdayname6 = 47
	Global Const $locale_sdayname7 = 48
	Global Const $locale_sabbrevdayname1 = 49
	Global Const $locale_sabbrevdayname2 = 50
	Global Const $locale_sabbrevdayname3 = 51
	Global Const $locale_sabbrevdayname4 = 52
	Global Const $locale_sabbrevdayname5 = 53
	Global Const $locale_sabbrevdayname6 = 54
	Global Const $locale_sabbrevdayname7 = 55
	Global Const $locale_smonthname1 = 56
	Global Const $locale_smonthname2 = 57
	Global Const $locale_smonthname3 = 58
	Global Const $locale_smonthname4 = 59
	Global Const $locale_smonthname5 = 60
	Global Const $locale_smonthname6 = 61
	Global Const $locale_smonthname7 = 62
	Global Const $locale_smonthname8 = 63
	Global Const $locale_smonthname9 = 64
	Global Const $locale_smonthname10 = 65
	Global Const $locale_smonthname11 = 66
	Global Const $locale_smonthname12 = 67
	Global Const $locale_smonthname13 = 4110
	Global Const $locale_sabbrevmonthname1 = 68
	Global Const $locale_sabbrevmonthname2 = 69
	Global Const $locale_sabbrevmonthname3 = 70
	Global Const $locale_sabbrevmonthname4 = 71
	Global Const $locale_sabbrevmonthname5 = 72
	Global Const $locale_sabbrevmonthname6 = 73
	Global Const $locale_sabbrevmonthname7 = 74
	Global Const $locale_sabbrevmonthname8 = 75
	Global Const $locale_sabbrevmonthname9 = 76
	Global Const $locale_sabbrevmonthname10 = 77
	Global Const $locale_sabbrevmonthname11 = 78
	Global Const $locale_sabbrevmonthname12 = 79
	Global Const $locale_sabbrevmonthname13 = 4111
	Global Const $locale_spositivesign = 80
	Global Const $locale_snegativesign = 81
	Global Const $locale_ipossignposn = 82
	Global Const $locale_inegsignposn = 83
	Global Const $locale_ipossymprecedes = 84
	Global Const $locale_ipossepbyspace = 85
	Global Const $locale_inegsymprecedes = 86
	Global Const $locale_inegsepbyspace = 87
	Global Const $locale_fontsignature = 88
	Global Const $locale_siso639langname = 89
	Global Const $locale_siso3166ctryname = 90
	Global Const $locale_idefaultebcdiccodepage = 4114
	Global Const $locale_ipapersize = 4106
	Global Const $locale_sengcurrname = 4103
	Global Const $locale_snativecurrname = 4104
	Global Const $locale_syearmonth = 4102
	Global Const $locale_ssortname = 4115
	Global Const $locale_idigitsubstitution = 4116
	Global Const $locale_custom_default = 3072
	Global Const $locale_custom_ui_default = 5120
	Global Const $locale_custom_unspecified = 4096
	Global Const $locale_invariant = 127
	Global Const $locale_system_default = 2048
	Global Const $locale_user_default = 1024
	Global Const $time_force24hourformat = 8
	Global Const $time_nominutesorseconds = 1
	Global Const $time_noseconds = 2
	Global Const $time_notimemarker = 4
	Global Const $lcid_installed = 1
	Global Const $lcid_supported = 2
	#Region Global Variables and Constants
		Global Const $tagnumberfmt = "uint NumDigits;uint LeadingZero;uint Grouping;ptr DecimalSep;ptr ThousandSep;uint NegativeOrder"
	#EndRegion Global Variables and Constants
	#Region Functions list
	#EndRegion Functions list
	#Region Public Functions

		Func _winapi_comparestring($ilcid, $sstring1, $sstring2, $iflags = 0)
			Local $aret = DllCall("kernel32.dll", "int", "CompareStringW", "dword", $ilcid, "dword", $iflags, "wstr", $sstring1, "int", -1, "wstr", $sstring2, "int", -1)
			If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_createnumberformatinfo($inumdigits, $ileadingzero, $igrouping, $sdecimalsep, $sthousandsep, $inegativeorder)
			Local $tfmt = DllStructCreate($tagnumberfmt & ";wchar[" & (StringLen($sdecimalsep) + 1) & "];wchar[" & (StringLen($sthousandsep) + 1) & "]")
			DllStructSetData($tfmt, 1, $inumdigits)
			DllStructSetData($tfmt, 2, $ileadingzero)
			DllStructSetData($tfmt, 3, $igrouping)
			DllStructSetData($tfmt, 4, DllStructGetPtr($tfmt, 7))
			DllStructSetData($tfmt, 5, DllStructGetPtr($tfmt, 8))
			DllStructSetData($tfmt, 6, $inegativeorder)
			DllStructSetData($tfmt, 7, $sdecimalsep)
			DllStructSetData($tfmt, 8, $sthousandsep)
			Return $tfmt
		EndFunc

		Func _winapi_enumsystemgeoid()
			Local $henumproc = DllCallbackRegister("__EnumGeoIDProc", "bool", "long")
			Dim $__g_venum[101] = [0]
			Local $aret = DllCall("kernel32.dll", "bool", "EnumSystemGeoID", "dword", 16, "long", 0, "ptr", DllCallbackGetPtr($henumproc))
			If @error OR NOT $aret[0] OR NOT $__g_venum[0] Then
				$__g_venum = @error + 10
			EndIf
			DllCallbackFree($henumproc)
			If $__g_venum Then Return SetError($__g_venum, 0, 0)
			__inc($__g_venum, -1)
			Return $__g_venum
		EndFunc

		Func _winapi_enumsystemlocales($iflag)
			Local $henumproc = DllCallbackRegister("__EnumLocalesProc", "bool", "ptr")
			Dim $__g_venum[101] = [0]
			Local $aret = DllCall("kernel32.dll", "bool", "EnumSystemLocalesW", "ptr", DllCallbackGetPtr($henumproc), "dword", $iflag)
			If @error OR NOT $aret[0] OR NOT $__g_venum[0] Then
				$__g_venum = @error + 10
			EndIf
			DllCallbackFree($henumproc)
			If $__g_venum Then Return SetError($__g_venum, 0, 0)
			__inc($__g_venum, -1)
			Return $__g_venum
		EndFunc

		Func _winapi_enumuilanguages($iflag = 0)
			Local $henumproc = DllCallbackRegister("__EnumUILanguagesProc", "bool", "ptr;long_ptr")
			Local $iid = 1
			If $__winver >= 1536 Then
				If BitAND($iflag, 8) Then
					$iid = 0
				EndIf
			Else
				$iflag = 0
			EndIf
			Dim $__g_venum[101] = [0]
			Local $aret = DllCall("kernel32.dll", "bool", "EnumUILanguagesW", "ptr", DllCallbackGetPtr($henumproc), "dword", $iflag, "long_ptr", $iid)
			If @error OR NOT $aret[0] OR NOT $__g_venum[0] Then
				$__g_venum = @error + 10
			EndIf
			DllCallbackFree($henumproc)
			If $__g_venum Then Return SetError($__g_venum, 0, 0)
			__inc($__g_venum, -1)
			Return $__g_venum
		EndFunc

		Func _winapi_getdateformat($ilcid = 0, $tsystemtime = 0, $iflags = 0, $sformat = "")
			If NOT $ilcid Then $ilcid = 1024
			Local $stypeofformat = "wstr"
			If NOT StringStripWS($sformat, $str_stripleading + $str_striptrailing) Then
				$stypeofformat = "ptr"
				$sformat = 0
			EndIf
			Local $aret = DllCall("kernel32.dll", "int", "GetDateFormatW", "dword", $ilcid, "dword", $iflags, "struct*", $tsystemtime, $stypeofformat, $sformat, "wstr", "", "int", 2048)
			If @error OR NOT $aret[0] Then Return SetError(@error, @extended, "")
			Return $aret[5]
		EndFunc

		Func _winapi_getdurationformat($ilcid, $iduration, $sformat = "")
			If NOT $ilcid Then $ilcid = 1024
			Local $pst, $ival
			If IsDllStruct($iduration) Then
				$pst = DllStructGetPtr($iduration)
				$ival = 0
			Else
				$pst = 0
				$ival = $iduration
			EndIf
			Local $stypeofformat = "wstr"
			If NOT StringStripWS($sformat, $str_stripleading + $str_striptrailing) Then
				$stypeofformat = "ptr"
				$sformat = 0
			EndIf
			Local $aret = DllCall("kernel32.dll", "int", "GetDurationFormat", "dword", $ilcid, "dword", 0, "ptr", $pst, "uint64", $ival, $stypeofformat, $sformat, "wstr", "", "int", 2048)
			If @error OR NOT $aret[0] Then Return SetError(@error, @extended, "")
			Return $aret[6]
		EndFunc

		Func _winapi_getgeoinfo($igeoid, $itype, $ilanguage = 0)
			Local $aret = DllCall("kernel32.dll", "int", "GetGeoInfoW", "long", $igeoid, "dword", $itype, "wstr", "", "int", 4096, "word", $ilanguage)
			If @error OR NOT $aret[0] Then Return SetError(@error, @extended, 0)
			Return $aret[3]
		EndFunc

		Func _winapi_getlocaleinfo($ilcid, $itype)
			Local $aret = DllCall("kernel32.dll", "int", "GetLocaleInfoW", "dword", $ilcid, "dword", $itype, "wstr", "", "int", 2048)
			If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
			Return $aret[3]
		EndFunc

		Func _winapi_getnumberformat($ilcid, $snumber, $tnumberfmt = 0)
			If NOT $ilcid Then $ilcid = 1024
			Local $aret = DllCall("kernel32.dll", "int", "GetNumberFormatW", "dword", $ilcid, "dword", 0, "wstr", $snumber, "struct*", $tnumberfmt, "wstr", "", "int", 2048)
			If @error OR NOT $aret[0] Then Return SetError(@error, @extended, "")
			Return $aret[5]
		EndFunc

		Func _winapi_getsystemdefaultlangid()
			Local $aret = DllCall("kernel32.dll", "word", "GetSystemDefaultLangID")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getsystemdefaultlcid()
			Local $aret = DllCall("kernel32.dll", "dword", "GetSystemDefaultLCID")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getsystemdefaultuilanguage()
			Local $aret = DllCall("kernel32.dll", "word", "GetSystemDefaultUILanguage")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getthreadlocale()
			Local $aret = DllCall("kernel32.dll", "dword", "GetThreadLocale")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getthreaduilanguage()
			Local $aret = DllCall("kernel32.dll", "word", "GetThreadUILanguage")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_gettimeformat($ilcid = 0, $tsystemtime = 0, $iflags = 0, $sformat = "")
			If NOT $ilcid Then $ilcid = 1024
			Local $stypeofformat = "wstr"
			If NOT StringStripWS($sformat, $str_stripleading + $str_striptrailing) Then
				$stypeofformat = "ptr"
				$sformat = 0
			EndIf
			Local $aret = DllCall("kernel32.dll", "int", "GetTimeFormatW", "dword", $ilcid, "dword", $iflags, "struct*", $tsystemtime, $stypeofformat, $sformat, "wstr", "", "int", 2048)
			If @error OR NOT $aret[0] Then Return SetError(@error + 10, @extended, "")
			Return $aret[5]
		EndFunc

		Func _winapi_getuserdefaultlangid()
			Local $aret = DllCall("kernel32.dll", "word", "GetUserDefaultLangID")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getuserdefaultlcid()
			Local $aret = DllCall("kernel32.dll", "dword", "GetUserDefaultLCID")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getuserdefaultuilanguage()
			Local $aret = DllCall("kernel32.dll", "word", "GetUserDefaultUILanguage")
			If @error Then Return SetError(@error, @extended, 0)
			Return $aret[0]
		EndFunc

		Func _winapi_getusergeoid()
			Local $aret = DllCall("kernel32.dll", "long", "GetUserGeoID", "uint", 16)
			If @error Then Return SetError(@error, @extended, -1)
			Return $aret[0]
		EndFunc

		Func _winapi_isvalidlocale($ilcid, $iflag = 0)
			Local $aret = DllCall("kernel32.dll", "bool", "IsValidLocale", "dword", $ilcid, "dword", $iflag)
			If @error Then Return SetError(@error, @extended, False)
			Return $aret[0]
		EndFunc

		Func _winapi_setlocaleinfo($ilcid, $itype, $sdata)
			Local $aret = DllCall("kernel32.dll", "bool", "SetLocaleInfoW", "dword", $ilcid, "dword", $itype, "wstr", $sdata)
			If @error Then Return SetError(@error, @extended, False)
			Return $aret[0]
		EndFunc

		Func _winapi_setthreadlocale($ilcid)
			Local $aret = DllCall("kernel32.dll", "bool", "SetThreadLocale", "dword", $ilcid)
			If @error Then Return SetError(@error, @extended, False)
			Return $aret[0]
		EndFunc

		Func _winapi_setthreaduilanguage($ilanguage)
			Local $aret = DllCall("kernel32.dll", "word", "SetThreadUILanguage", "word", $ilanguage)
			If @error Then Return SetError(@error, @extended, False)
			Return ($aret[0] = $aret[1])
		EndFunc

		Func _winapi_setusergeoid($igeoid)
			Local $aret = DllCall("kernel32.dll", "bool", "SetUserGeoID", "long", $igeoid)
			If @error Then Return SetError(@error, @extended, False)
			Return $aret[0]
		EndFunc

	#EndRegion Public Functions
	#Region Internal Functions

		Func __enumgeoidproc($iid)
			__inc($__g_venum)
			$__g_venum[$__g_venum[0]] = $iid
			Return 1
		EndFunc

		Func __enumlocalesproc($plocale)
			__inc($__g_venum)
			$__g_venum[$__g_venum[0]] = Dec(DllStructGetData(DllStructCreate("wchar[" & (_winapi_strlen($plocale) + 1) & "]", $plocale), 1))
			Return 1
		EndFunc

		Func __enumuilanguagesproc($planguage, $iid)
			__inc($__g_venum)
			$__g_venum[$__g_venum[0]] = DllStructGetData(DllStructCreate("wchar[" & (_winapi_strlen($planguage) + 1) & "]", $planguage), 1)
			If $iid Then
				$__g_venum[$__g_venum[0]] = Dec($__g_venum[$__g_venum[0]])
			EndIf
			Return 1
		EndFunc

	#EndRegion Internal Functions

	Func _dateadd($stype, $inumber, $sdate)
		Local $astimepart[4]
		Local $asdatepart[4]
		Local $ijuliandate
		$stype = StringLeft($stype, 1)
		If StringInStr("D,M,Y,w,h,n,s", $stype) = 0 OR $stype = "" Then
			Return SetError(1, 0, 0)
		EndIf
		If NOT StringIsInt($inumber) Then
			Return SetError(2, 0, 0)
		EndIf
		If NOT _dateisvalid($sdate) Then
			Return SetError(3, 0, 0)
		EndIf
		_datetimesplit($sdate, $asdatepart, $astimepart)
		If $stype = "d" OR $stype = "w" Then
			If $stype = "w" Then $inumber = $inumber * 7
			$ijuliandate = _datetodayvalue($asdatepart[1], $asdatepart[2], $asdatepart[3]) + $inumber
			_dayvaluetodate($ijuliandate, $asdatepart[1], $asdatepart[2], $asdatepart[3])
		EndIf
		If $stype = "m" Then
			$asdatepart[2] = $asdatepart[2] + $inumber
			While $asdatepart[2] > 12
				$asdatepart[2] = $asdatepart[2] - 12
				$asdatepart[1] = $asdatepart[1] + 1
			WEnd
			While $asdatepart[2] < 1
				$asdatepart[2] = $asdatepart[2] + 12
				$asdatepart[1] = $asdatepart[1] - 1
			WEnd
		EndIf
		If $stype = "y" Then
			$asdatepart[1] = $asdatepart[1] + $inumber
		EndIf
		If $stype = "h" OR $stype = "n" OR $stype = "s" Then
			Local $itimeval = _timetoticks($astimepart[1], $astimepart[2], $astimepart[3]) / 1000
			If $stype = "h" Then $itimeval = $itimeval + $inumber * 3600
			If $stype = "n" Then $itimeval = $itimeval + $inumber * 60
			If $stype = "s" Then $itimeval = $itimeval + $inumber
			Local $iday2add = Int($itimeval / (24 * 60 * 60))
			$itimeval = $itimeval - $iday2add * 24 * 60 * 60
			If $itimeval < 0 Then
				$iday2add = $iday2add - 1
				$itimeval = $itimeval + 24 * 60 * 60
			EndIf
			$ijuliandate = _datetodayvalue($asdatepart[1], $asdatepart[2], $asdatepart[3]) + $iday2add
			_dayvaluetodate($ijuliandate, $asdatepart[1], $asdatepart[2], $asdatepart[3])
			_tickstotime($itimeval * 1000, $astimepart[1], $astimepart[2], $astimepart[3])
		EndIf
		Local $inumdays = _daysinmonth($asdatepart[1])
		If $inumdays[$asdatepart[2]] < $asdatepart[3] Then $asdatepart[3] = $inumdays[$asdatepart[2]]
		$sdate = $asdatepart[1] & "/" & StringRight("0" & $asdatepart[2], 2) & "/" & StringRight("0" & $asdatepart[3], 2)
		If $astimepart[0] > 0 Then
			If $astimepart[0] > 2 Then
				$sdate = $sdate & " " & StringRight("0" & $astimepart[1], 2) & ":" & StringRight("0" & $astimepart[2], 2) & ":" & StringRight("0" & $astimepart[3], 2)
			Else
				$sdate = $sdate & " " & StringRight("0" & $astimepart[1], 2) & ":" & StringRight("0" & $astimepart[2], 2)
			EndIf
		EndIf
		Return $sdate
	EndFunc

	Func _datedayofweek($idaynum, $iformat = Default)
		Local Const $monday_is_no1 = 128
		If $iformat = Default Then $iformat = 0
		$idaynum = Int($idaynum)
		If $idaynum < 1 OR $idaynum > 7 Then Return SetError(1, 0, "")
		Local $tsystemtime = DllStructCreate($tagsystemtime)
		DllStructSetData($tsystemtime, "Year", BitAND($iformat, $monday_is_no1) ? 2007 : 2006)
		DllStructSetData($tsystemtime, "Month", 1)
		DllStructSetData($tsystemtime, "Day", $idaynum)
		Return _winapi_getdateformat(BitAND($iformat, $dmw_locale_longname) ? $locale_user_default : $locale_invariant, $tsystemtime, 0, BitAND($iformat, $dmw_shortname) ? "ddd" : "dddd")
	EndFunc

	Func _datedaysinmonth($iyear, $imonthnum)
		$imonthnum = Int($imonthnum)
		$iyear = Int($iyear)
		Return __dateismonth($imonthnum) AND __dateisyear($iyear) ? _daysinmonth($iyear)[$imonthnum] : SetError(1, 0, 0)
	EndFunc

	Func _datediff($stype, $sstartdate, $senddate)
		$stype = StringLeft($stype, 1)
		If StringInStr("d,m,y,w,h,n,s", $stype) = 0 OR $stype = "" Then
			Return SetError(1, 0, 0)
		EndIf
		If NOT _dateisvalid($sstartdate) Then
			Return SetError(2, 0, 0)
		EndIf
		If NOT _dateisvalid($senddate) Then
			Return SetError(3, 0, 0)
		EndIf
		Local $asstartdatepart[4], $asstarttimepart[4], $asenddatepart[4], $asendtimepart[4]
		_datetimesplit($sstartdate, $asstartdatepart, $asstarttimepart)
		_datetimesplit($senddate, $asenddatepart, $asendtimepart)
		Local $adaysdiff = _datetodayvalue($asenddatepart[1], $asenddatepart[2], $asenddatepart[3]) - _datetodayvalue($asstartdatepart[1], $asstartdatepart[2], $asstartdatepart[3])
		Local $itimediff, $iyeardiff, $istarttimeinsecs, $iendtimeinsecs
		If $asstarttimepart[0] > 1 AND $asendtimepart[0] > 1 Then
			$istarttimeinsecs = $asstarttimepart[1] * 3600 + $asstarttimepart[2] * 60 + $asstarttimepart[3]
			$iendtimeinsecs = $asendtimepart[1] * 3600 + $asendtimepart[2] * 60 + $asendtimepart[3]
			$itimediff = $iendtimeinsecs - $istarttimeinsecs
			If $itimediff < 0 Then
				$adaysdiff = $adaysdiff - 1
				$itimediff = $itimediff + 24 * 60 * 60
			EndIf
		Else
			$itimediff = 0
		EndIf
		Select 
			Case $stype = "d"
				Return $adaysdiff
			Case $stype = "m"
				$iyeardiff = $asenddatepart[1] - $asstartdatepart[1]
				Local $imonthdiff = $asenddatepart[2] - $asstartdatepart[2] + $iyeardiff * 12
				If $asenddatepart[3] < $asstartdatepart[3] Then $imonthdiff = $imonthdiff - 1
				$istarttimeinsecs = $asstarttimepart[1] * 3600 + $asstarttimepart[2] * 60 + $asstarttimepart[3]
				$iendtimeinsecs = $asendtimepart[1] * 3600 + $asendtimepart[2] * 60 + $asendtimepart[3]
				$itimediff = $iendtimeinsecs - $istarttimeinsecs
				If $asenddatepart[3] = $asstartdatepart[3] AND $itimediff < 0 Then $imonthdiff = $imonthdiff - 1
				Return $imonthdiff
			Case $stype = "y"
				$iyeardiff = $asenddatepart[1] - $asstartdatepart[1]
				If $asenddatepart[2] < $asstartdatepart[2] Then $iyeardiff = $iyeardiff - 1
				If $asenddatepart[2] = $asstartdatepart[2] AND $asenddatepart[3] < $asstartdatepart[3] Then $iyeardiff = $iyeardiff - 1
				$istarttimeinsecs = $asstarttimepart[1] * 3600 + $asstarttimepart[2] * 60 + $asstarttimepart[3]
				$iendtimeinsecs = $asendtimepart[1] * 3600 + $asendtimepart[2] * 60 + $asendtimepart[3]
				$itimediff = $iendtimeinsecs - $istarttimeinsecs
				If $asenddatepart[2] = $asstartdatepart[2] AND $asenddatepart[3] = $asstartdatepart[3] AND $itimediff < 0 Then $iyeardiff = $iyeardiff - 1
				Return $iyeardiff
			Case $stype = "w"
				Return Int($adaysdiff / 7)
			Case $stype = "h"
				Return $adaysdiff * 24 + Int($itimediff / 3600)
			Case $stype = "n"
				Return $adaysdiff * 24 * 60 + Int($itimediff / 60)
			Case $stype = "s"
				Return $adaysdiff * 24 * 60 * 60 + $itimediff
		EndSelect
	EndFunc

	Func _dateisleapyear($iyear)
		If StringIsInt($iyear) Then
			Select 
				Case Mod($iyear, 4) = 0 AND Mod($iyear, 100) <> 0
					Return 1
				Case Mod($iyear, 400) = 0
					Return 1
				Case Else
					Return 0
			EndSelect
		EndIf
		Return SetError(1, 0, 0)
	EndFunc

	Func __dateismonth($inumber)
		$inumber = Int($inumber)
		Return $inumber >= 1 AND $inumber <= 12
	EndFunc

	Func _dateisvalid($sdate)
		Local $asdatepart[4], $astimepart[4]
		_datetimesplit($sdate, $asdatepart, $astimepart)
		If NOT StringIsInt($asdatepart[1]) Then Return 0
		If NOT StringIsInt($asdatepart[2]) Then Return 0
		If NOT StringIsInt($asdatepart[3]) Then Return 0
		$asdatepart[1] = Int($asdatepart[1])
		$asdatepart[2] = Int($asdatepart[2])
		$asdatepart[3] = Int($asdatepart[3])
		Local $inumdays = _daysinmonth($asdatepart[1])
		If $asdatepart[1] < 1000 OR $asdatepart[1] > 2999 Then Return 0
		If $asdatepart[2] < 1 OR $asdatepart[2] > 12 Then Return 0
		If $asdatepart[3] < 1 OR $asdatepart[3] > $inumdays[$asdatepart[2]] Then Return 0
		If $astimepart[0] < 1 Then Return 1
		If $astimepart[0] < 2 Then Return 0
		If $astimepart[0] = 2 Then $astimepart[3] = "00"
		If NOT StringIsInt($astimepart[1]) Then Return 0
		If NOT StringIsInt($astimepart[2]) Then Return 0
		If NOT StringIsInt($astimepart[3]) Then Return 0
		$astimepart[1] = Int($astimepart[1])
		$astimepart[2] = Int($astimepart[2])
		$astimepart[3] = Int($astimepart[3])
		If $astimepart[1] < 0 OR $astimepart[1] > 23 Then Return 0
		If $astimepart[2] < 0 OR $astimepart[2] > 59 Then Return 0
		If $astimepart[3] < 0 OR $astimepart[3] > 59 Then Return 0
		Return 1
	EndFunc

	Func __dateisyear($inumber)
		Return StringLen($inumber) = 4
	EndFunc

	Func _datelastweekdaynum($iweekdaynum)
		Select 
			Case NOT StringIsInt($iweekdaynum)
				Return SetError(1, 0, 0)
			Case $iweekdaynum < 1 OR $iweekdaynum > 7
				Return SetError(2, 0, 0)
			Case Else
				Local $ilastweekdaynum
				If $iweekdaynum = 1 Then
					$ilastweekdaynum = 7
				Else
					$ilastweekdaynum = $iweekdaynum - 1
				EndIf
				Return $ilastweekdaynum
		EndSelect
	EndFunc

	Func _datelastmonthnum($imonthnum)
		Select 
			Case NOT StringIsInt($imonthnum)
				Return SetError(1, 0, 0)
			Case NOT __dateismonth($imonthnum)
				Return SetError(2, 0, 0)
			Case Else
				Local $ilastmonthnum
				If $imonthnum = 1 Then
					$ilastmonthnum = 12
				Else
					$ilastmonthnum = $imonthnum - 1
				EndIf
				$ilastmonthnum = StringFormat("%02d", $ilastmonthnum)
				Return $ilastmonthnum
		EndSelect
	EndFunc

	Func _datelastmonthyear($imonthnum, $iyear)
		Select 
			Case NOT StringIsInt($imonthnum) OR NOT StringIsInt($iyear)
				Return SetError(1, 0, 0)
			Case NOT __dateismonth($imonthnum)
				Return SetError(2, 0, 0)
			Case Else
				Local $ilastyear
				If $imonthnum = 1 Then
					$ilastyear = $iyear - 1
				Else
					$ilastyear = $iyear
				EndIf
				$ilastyear = StringFormat("%04d", $ilastyear)
				Return $ilastyear
		EndSelect
	EndFunc

	Func _datenextweekdaynum($iweekdaynum)
		Select 
			Case NOT StringIsInt($iweekdaynum)
				Return SetError(1, 0, 0)
			Case $iweekdaynum < 1 OR $iweekdaynum > 7
				Return SetError(2, 0, 0)
			Case Else
				Local $inextweekdaynum
				If $iweekdaynum = 7 Then
					$inextweekdaynum = 1
				Else
					$inextweekdaynum = $iweekdaynum + 1
				EndIf
				Return $inextweekdaynum
		EndSelect
	EndFunc

	Func _datenextmonthnum($imonthnum)
		Select 
			Case NOT StringIsInt($imonthnum)
				Return SetError(1, 0, 0)
			Case NOT __dateismonth($imonthnum)
				Return SetError(2, 0, 0)
			Case Else
				Local $inextmonthnum
				If $imonthnum = 12 Then
					$inextmonthnum = 1
				Else
					$inextmonthnum = $imonthnum + 1
				EndIf
				$inextmonthnum = StringFormat("%02d", $inextmonthnum)
				Return $inextmonthnum
		EndSelect
	EndFunc

	Func _datenextmonthyear($imonthnum, $iyear)
		Select 
			Case NOT StringIsInt($imonthnum) OR NOT StringIsInt($iyear)
				Return SetError(1, 0, 0)
			Case NOT __dateismonth($imonthnum)
				Return SetError(2, 0, 0)
			Case Else
				Local $inextyear
				If $imonthnum = 12 Then
					$inextyear = $iyear + 1
				Else
					$inextyear = $iyear
				EndIf
				$inextyear = StringFormat("%04d", $inextyear)
				Return $inextyear
		EndSelect
	EndFunc

	Func _datetimeformat($sdate, $stype)
		Local $asdatepart[4], $astimepart[4]
		Local $stempdate = "", $stemptime = ""
		Local $sam, $spm, $stempstring = ""
		If NOT _dateisvalid($sdate) Then
			Return SetError(1, 0, "")
		EndIf
		If $stype < 0 OR $stype > 5 OR NOT IsInt($stype) Then
			Return SetError(2, 0, "")
		EndIf
		_datetimesplit($sdate, $asdatepart, $astimepart)
		Switch $stype
			Case 0
				$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_sshortdate)
				If NOT @error AND NOT ($stempstring = "") Then
					$stempdate = $stempstring
				Else
					$stempdate = "M/d/yyyy"
				EndIf
				If $astimepart[0] > 1 Then
					$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_stimeformat)
					If NOT @error AND NOT ($stempstring = "") Then
						$stemptime = $stempstring
					Else
						$stemptime = "h:mm:ss tt"
					EndIf
				EndIf
			Case 1
				$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_slongdate)
				If NOT @error AND NOT ($stempstring = "") Then
					$stempdate = $stempstring
				Else
					$stempdate = "dddd, MMMM dd, yyyy"
				EndIf
			Case 2
				$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_sshortdate)
				If NOT @error AND NOT ($stempstring = "") Then
					$stempdate = $stempstring
				Else
					$stempdate = "M/d/yyyy"
				EndIf
			Case 3
				If $astimepart[0] > 1 Then
					$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_stimeformat)
					If NOT @error AND NOT ($stempstring = "") Then
						$stemptime = $stempstring
					Else
						$stemptime = "h:mm:ss tt"
					EndIf
				EndIf
			Case 4
				If $astimepart[0] > 1 Then
					$stemptime = "hh:mm"
				EndIf
			Case 5
				If $astimepart[0] > 1 Then
					$stemptime = "hh:mm:ss"
				EndIf
		EndSwitch
		If $stempdate <> "" Then
			$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_sdate)
			If NOT @error AND NOT ($stempstring = "") Then
				$stempdate = StringReplace($stempdate, "/", $stempstring)
			EndIf
			Local $iwday = _datetodayofweek($asdatepart[1], $asdatepart[2], $asdatepart[3])
			$asdatepart[3] = StringRight("0" & $asdatepart[3], 2)
			$asdatepart[2] = StringRight("0" & $asdatepart[2], 2)
			$stempdate = StringReplace($stempdate, "d", "@")
			$stempdate = StringReplace($stempdate, "m", "#")
			$stempdate = StringReplace($stempdate, "y", "&")
			$stempdate = StringReplace($stempdate, "@@@@", _datedayofweek($iwday, 0))
			$stempdate = StringReplace($stempdate, "@@@", _datedayofweek($iwday, 1))
			$stempdate = StringReplace($stempdate, "@@", $asdatepart[3])
			$stempdate = StringReplace($stempdate, "@", StringReplace(StringLeft($asdatepart[3], 1), "0", "") & StringRight($asdatepart[3], 1))
			$stempdate = StringReplace($stempdate, "####", _datetomonth($asdatepart[2], 0))
			$stempdate = StringReplace($stempdate, "###", _datetomonth($asdatepart[2], 1))
			$stempdate = StringReplace($stempdate, "##", $asdatepart[2])
			$stempdate = StringReplace($stempdate, "#", StringReplace(StringLeft($asdatepart[2], 1), "0", "") & StringRight($asdatepart[2], 1))
			$stempdate = StringReplace($stempdate, "&&&&", $asdatepart[1])
			$stempdate = StringReplace($stempdate, "&&", StringRight($asdatepart[1], 2))
		EndIf
		If $stemptime <> "" Then
			$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_s1159)
			If NOT @error AND NOT ($stempstring = "") Then
				$sam = $stempstring
			Else
				$sam = "AM"
			EndIf
			$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_s2359)
			If NOT @error AND NOT ($stempstring = "") Then
				$spm = $stempstring
			Else
				$spm = "PM"
			EndIf
			$stempstring = _winapi_getlocaleinfo($locale_user_default, $locale_stime)
			If NOT @error AND NOT ($stempstring = "") Then
				$stemptime = StringReplace($stemptime, ":", $stempstring)
			EndIf
			If StringInStr($stemptime, "tt") Then
				If $astimepart[1] < 12 Then
					$stemptime = StringReplace($stemptime, "tt", $sam)
					If $astimepart[1] = 0 Then $astimepart[1] = 12
				Else
					$stemptime = StringReplace($stemptime, "tt", $spm)
					If $astimepart[1] > 12 Then $astimepart[1] = $astimepart[1] - 12
				EndIf
			EndIf
			$astimepart[1] = StringRight("0" & $astimepart[1], 2)
			$astimepart[2] = StringRight("0" & $astimepart[2], 2)
			$astimepart[3] = StringRight("0" & $astimepart[3], 2)
			$stemptime = StringReplace($stemptime, "hh", StringFormat("%02d", $astimepart[1]))
			$stemptime = StringReplace($stemptime, "h", StringReplace(StringLeft($astimepart[1], 1), "0", "") & StringRight($astimepart[1], 1))
			$stemptime = StringReplace($stemptime, "mm", StringFormat("%02d", $astimepart[2]))
			$stemptime = StringReplace($stemptime, "ss", StringFormat("%02d", $astimepart[3]))
			$stempdate = StringStripWS($stempdate & " " & $stemptime, $str_stripleading + $str_striptrailing)
		EndIf
		Return $stempdate
	EndFunc

	Func _datetimesplit($sdate, ByRef $adatepart, ByRef $itimepart)
		Local $sdatetime = StringSplit($sdate, " T")
		If $sdatetime[0] > 0 Then $adatepart = StringSplit($sdatetime[1], "/-.")
		If $sdatetime[0] > 1 Then
			$itimepart = StringSplit($sdatetime[2], ":")
			If UBound($itimepart) < 4 Then ReDim $itimepart[4]
		Else
			Dim $itimepart[4]
		EndIf
		If UBound($adatepart) < 4 Then ReDim $adatepart[4]
		For $x = 1 To 3
			If StringIsInt($adatepart[$x]) Then
				$adatepart[$x] = Int($adatepart[$x])
			Else
				$adatepart[$x] = -1
			EndIf
			If StringIsInt($itimepart[$x]) Then
				$itimepart[$x] = Int($itimepart[$x])
			Else
				$itimepart[$x] = 0
			EndIf
		Next
		Return 1
	EndFunc

	Func _datetodayofweek($iyear, $imonth, $iday)
		If NOT _dateisvalid($iyear & "/" & $imonth & "/" & $iday) Then
			Return SetError(1, 0, "")
		EndIf
		Local $i_factora = Int((14 - $imonth) / 12)
		Local $i_factory = $iyear - $i_factora
		Local $i_factorm = $imonth + (12 * $i_factora) - 2
		Local $i_factord = Mod($iday + $i_factory + Int($i_factory / 4) - Int($i_factory / 100) + Int($i_factory / 400) + Int((31 * $i_factorm) / 12), 7)
		Return $i_factord + 1
	EndFunc

	Func _datetodayofweekiso($iyear, $imonth, $iday)
		Local $idow = _datetodayofweek($iyear, $imonth, $iday)
		If @error Then
			Return SetError(1, 0, "")
		EndIf
		If $idow >= 2 Then Return $idow - 1
		Return 7
	EndFunc

	Func _datetodayvalue($iyear, $imonth, $iday)
		If NOT _dateisvalid(StringFormat("%04d/%02d/%02d", $iyear, $imonth, $iday)) Then
			Return SetError(1, 0, "")
		EndIf
		If $imonth < 3 Then
			$imonth = $imonth + 12
			$iyear = $iyear - 1
		EndIf
		Local $i_factora = Int($iyear / 100)
		Local $i_factorb = Int($i_factora / 4)
		Local $i_factorc = 2 - $i_factora + $i_factorb
		Local $i_factore = Int(1461 * ($iyear + 4716) / 4)
		Local $i_factorf = Int(153 * ($imonth + 1) / 5)
		Local $ijuliandate = $i_factorc + $iday + $i_factore + $i_factorf - 1524.5
		Return $ijuliandate
	EndFunc

	Func _datetomonth($imonnum, $iformat = Default)
		If $iformat = Default Then $iformat = 0
		$imonnum = Int($imonnum)
		If NOT __dateismonth($imonnum) Then Return SetError(1, 0, "")
		Local $tsystemtime = DllStructCreate($tagsystemtime)
		DllStructSetData($tsystemtime, "Year", @YEAR)
		DllStructSetData($tsystemtime, "Month", $imonnum)
		DllStructSetData($tsystemtime, "Day", 1)
		Return _winapi_getdateformat(BitAND($iformat, $dmw_locale_longname) ? $locale_user_default : $locale_invariant, $tsystemtime, 0, BitAND($iformat, $dmw_shortname) ? "MMM" : "MMMM")
	EndFunc

	Func _dayvaluetodate($ijuliandate, ByRef $iyear, ByRef $imonth, ByRef $iday)
		If $ijuliandate < 0 OR NOT IsNumber($ijuliandate) Then
			Return SetError(1, 0, 0)
		EndIf
		Local $i_factorz = Int($ijuliandate + 0.5)
		Local $i_factorw = Int(($i_factorz - 1867216.25) / 36524.25)
		Local $i_factorx = Int($i_factorw / 4)
		Local $i_factora = $i_factorz + 1 + $i_factorw - $i_factorx
		Local $i_factorb = $i_factora + 1524
		Local $i_factorc = Int(($i_factorb - 122.1) / 365.25)
		Local $i_factord = Int(365.25 * $i_factorc)
		Local $i_factore = Int(($i_factorb - $i_factord) / 30.6001)
		Local $i_factorf = Int(30.6001 * $i_factore)
		$iday = $i_factorb - $i_factord - $i_factorf
		If $i_factore - 1 < 13 Then
			$imonth = $i_factore - 1
		Else
			$imonth = $i_factore - 13
		EndIf
		If $imonth < 3 Then
			$iyear = $i_factorc - 4715
		Else
			$iyear = $i_factorc - 4716
		EndIf
		$iyear = StringFormat("%04d", $iyear)
		$imonth = StringFormat("%02d", $imonth)
		$iday = StringFormat("%02d", $iday)
		Return $iyear & "/" & $imonth & "/" & $iday
	EndFunc

	Func _date_juliandayno($iyear, $imonth, $iday)
		Local $sfulldate = StringFormat("%04d/%02d/%02d", $iyear, $imonth, $iday)
		If NOT _dateisvalid($sfulldate) Then
			Return SetError(1, 0, "")
		EndIf
		Local $ijday = 0
		Local $aidaysinmonth = _daysinmonth($iyear)
		For $icntr = 1 To $imonth - 1
			$ijday = $ijday + $aidaysinmonth[$icntr]
		Next
		$ijday = ($iyear * 1000) + ($ijday + $iday)
		Return $ijday
	EndFunc

	Func _juliantodate($ijday, $ssep = "/")
		Local $iyear = Int($ijday / 1000)
		Local $idays = Mod($ijday, 1000)
		Local $imaxdays = 365
		If _dateisleapyear($iyear) Then $imaxdays = 366
		If $idays > $imaxdays Then
			Return SetError(1, 0, "")
		EndIf
		Local $aidaysinmonth = _daysinmonth($iyear)
		Local $imonth = 1
		While $idays > $aidaysinmonth[$imonth]
			$idays = $idays - $aidaysinmonth[$imonth]
			$imonth = $imonth + 1
		WEnd
		Return StringFormat("%04d%s%02d%s%02d", $iyear, $ssep, $imonth, $ssep, $idays)
	EndFunc

	Func _now()
		Return _datetimeformat(@YEAR & "/" & @MON & "/" & @MDAY & " " & @HOUR & ":" & @MIN & ":" & @SEC, 0)
	EndFunc

	Func _nowcalc()
		Return @YEAR & "/" & @MON & "/" & @MDAY & " " & @HOUR & ":" & @MIN & ":" & @SEC
	EndFunc

	Func _nowcalcdate()
		Return @YEAR & "/" & @MON & "/" & @MDAY
	EndFunc

	Func _nowdate()
		Return _datetimeformat(@YEAR & "/" & @MON & "/" & @MDAY, 0)
	EndFunc

	Func _nowtime($stype = 3)
		If $stype < 3 OR $stype > 5 Then $stype = 3
		Return _datetimeformat(@YEAR & "/" & @MON & "/" & @MDAY & " " & @HOUR & ":" & @MIN & ":" & @SEC, $stype)
	EndFunc

	Func _setdate($iday, $imonth = 0, $iyear = 0)
		If $iyear = 0 Then $iyear = @YEAR
		If $imonth = 0 Then $imonth = @MON
		If NOT _dateisvalid($iyear & "/" & $imonth & "/" & $iday) Then Return 1
		Local $tsystemtime = DllStructCreate($tagsystemtime)
		DllCall("kernel32.dll", "none", "GetLocalTime", "struct*", $tsystemtime)
		If @error Then Return SetError(@error, @extended, 0)
		DllStructSetData($tsystemtime, "Day", $iday)
		If $imonth > 0 Then DllStructSetData($tsystemtime, "Month", $imonth)
		If $iyear > 0 Then DllStructSetData($tsystemtime, "Year", $iyear)
		Local $ireturn = _date_time_setlocaltime($tsystemtime)
		If @error Then Return SetError(@error + 10, @extended, 0)
		Return Int($ireturn)
	EndFunc

	Func _settime($ihour, $iminute, $isecond = 0, $imseconds = 0)
		If $ihour < 0 OR $ihour > 23 Then Return 1
		If $iminute < 0 OR $iminute > 59 Then Return 1
		If $isecond < 0 OR $isecond > 59 Then Return 1
		If $imseconds < 0 OR $imseconds > 999 Then Return 1
		Local $tsystemtime = DllStructCreate($tagsystemtime)
		DllCall("kernel32.dll", "none", "GetLocalTime", "struct*", $tsystemtime)
		If @error Then Return SetError(@error, @extended, 0)
		DllStructSetData($tsystemtime, "Hour", $ihour)
		DllStructSetData($tsystemtime, "Minute", $iminute)
		If $isecond > 0 Then DllStructSetData($tsystemtime, "Second", $isecond)
		If $imseconds > 0 Then DllStructSetData($tsystemtime, "MSeconds", $imseconds)
		Local $ireturn = _date_time_setlocaltime($tsystemtime)
		If @error Then Return SetError(@error + 10, @extended, 0)
		Return Int($ireturn)
	EndFunc

	Func _tickstotime($iticks, ByRef $ihours, ByRef $imins, ByRef $isecs)
		If Number($iticks) > 0 Then
			$iticks = Int($iticks / 1000)
			$ihours = Int($iticks / 3600)
			$iticks = Mod($iticks, 3600)
			$imins = Int($iticks / 60)
			$isecs = Mod($iticks, 60)
			Return 1
		ElseIf Number($iticks) = 0 Then
			$ihours = 0
			$iticks = 0
			$imins = 0
			$isecs = 0
			Return 1
		Else
			Return SetError(1, 0, 0)
		EndIf
	EndFunc

	Func _timetoticks($ihours = @HOUR, $imins = @MIN, $isecs = @SEC)
		If StringIsInt($ihours) AND StringIsInt($imins) AND StringIsInt($isecs) Then
			Local $iticks = 1000 * ((3600 * $ihours) + (60 * $imins) + $isecs)
			Return $iticks
		Else
			Return SetError(1, 0, 0)
		EndIf
	EndFunc

	Func _weeknumberiso($iyear = @YEAR, $imonth = @MON, $iday = @MDAY)
		If $iday > 31 OR $iday < 1 Then
			Return SetError(1, 0, -1)
		ElseIf NOT __dateismonth($imonth) Then
			Return SetError(2, 0, -1)
		ElseIf $iyear < 1 OR $iyear > 2999 Then
			Return SetError(3, 0, -1)
		EndIf
		Local $idow = _datetodayofweekiso($iyear, $imonth, $iday) - 1
		Local $idow0101 = _datetodayofweekiso($iyear, 1, 1) - 1
		If ($imonth = 1 AND 3 < $idow0101 AND $idow0101 < 7 - ($iday - 1)) Then
			$idow = $idow0101 - 1
			$idow0101 = _datetodayofweekiso($iyear - 1, 1, 1) - 1
			$imonth = 12
			$iday = 31
			$iyear = $iyear - 1
		ElseIf ($imonth = 12 AND 30 - ($iday - 1) < _datetodayofweekiso($iyear + 1, 1, 1) - 1 AND _datetodayofweekiso($iyear + 1, 1, 1) - 1 < 4) Then
			Return 1
		EndIf
		Return Int((_datetodayofweekiso($iyear, 1, 1) - 1 < 4) + 4 * ($imonth - 1) + (2 * ($imonth - 1) + ($iday - 1) + $idow0101 - $idow + 6) * 36 / 256)
	EndFunc

	Func _weeknumber($iyear = @YEAR, $imonth = @MON, $iday = @MDAY, $iweekstart = 1)
		If $iday > 31 OR $iday < 1 Then
			Return SetError(1, 0, -1)
		ElseIf NOT __dateismonth($imonth) Then
			Return SetError(3, 0, -1)
		ElseIf $iyear < 1 OR $iyear > 2999 Then
			Return SetError(4, 0, -1)
		ElseIf $iweekstart < 1 OR $iweekstart > 2 Then
			Return SetError(2, 0, -1)
		EndIf
		Local $istartweek1, $iendweek1
		Local $idow0101 = _datetodayofweekiso($iyear, 1, 1)
		Local $idate = $iyear & "/" & $imonth & "/" & $iday
		If $iweekstart = 1 Then
			If $idow0101 = 6 Then
				$istartweek1 = 0
			Else
				$istartweek1 = -1 * $idow0101 - 1
			EndIf
			$iendweek1 = $istartweek1 + 6
		Else
			$istartweek1 = $idow0101 * -1
			$iendweek1 = $istartweek1 + 6
		EndIf
		Local $istartweek1ny
		Local $iendweek1date = _dateadd("d", $iendweek1, $iyear & "/01/01")
		Local $idow0101ny = _datetodayofweekiso($iyear + 1, 1, 1)
		If $iweekstart = 1 Then
			If $idow0101ny = 6 Then
				$istartweek1ny = 0
			Else
				$istartweek1ny = -1 * $idow0101ny - 1
			EndIf
		Else
			$istartweek1ny = $idow0101ny * -1
		EndIf
		Local $istartweek1dateny = _dateadd("d", $istartweek1ny, $iyear + 1 & "/01/01")
		Local $icurrdatediff = _datediff("d", $iendweek1date, $idate) - 1
		Local $icurrdatediffny = _datediff("d", $istartweek1dateny, $idate)
		If $icurrdatediff >= 0 AND $icurrdatediffny < 0 Then Return 2 + Int($icurrdatediff / 7)
		If $icurrdatediff < 0 OR $icurrdatediffny >= 0 Then Return 1
	EndFunc

	Func _daysinmonth($iyear)
		Local $adays = [12, 31, (_dateisleapyear($iyear) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]
		Return $adays
	EndFunc

	Func __date_time_clonesystemtime($psystemtime)
		Local $tsystemtime1 = DllStructCreate($tagsystemtime, $psystemtime)
		Local $tsystemtime2 = DllStructCreate($tagsystemtime)
		DllStructSetData($tsystemtime2, "Month", DllStructGetData($tsystemtime1, "Month"))
		DllStructSetData($tsystemtime2, "Day", DllStructGetData($tsystemtime1, "Day"))
		DllStructSetData($tsystemtime2, "Year", DllStructGetData($tsystemtime1, "Year"))
		DllStructSetData($tsystemtime2, "Hour", DllStructGetData($tsystemtime1, "Hour"))
		DllStructSetData($tsystemtime2, "Minute", DllStructGetData($tsystemtime1, "Minute"))
		DllStructSetData($tsystemtime2, "Second", DllStructGetData($tsystemtime1, "Second"))
		DllStructSetData($tsystemtime2, "MSeconds", DllStructGetData($tsystemtime1, "MSeconds"))
		DllStructSetData($tsystemtime2, "DOW", DllStructGetData($tsystemtime1, "DOW"))
		Return $tsystemtime2
	EndFunc

	Func _date_time_comparefiletime($tfiletime1, $tfiletime2)
		Local $aresult = DllCall("kernel32.dll", "long", "CompareFileTime", "struct*", $tfiletime1, "struct*", $tfiletime2)
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _date_time_dosdatetimetofiletime($ifatdate, $ifattime)
		Local $ttime = DllStructCreate($tagfiletime)
		Local $aresult = DllCall("kernel32.dll", "bool", "DosDateTimeToFileTime", "word", $ifatdate, "word", $ifattime, "struct*", $ttime)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $ttime)
	EndFunc

	Func _date_time_dosdatetoarray($idosdate)
		Local $adate[3]
		$adate[0] = BitAND($idosdate, 31)
		$adate[1] = BitAND(BitShift($idosdate, 5), 15)
		$adate[2] = BitAND(BitShift($idosdate, 9), 63) + 1980
		Return $adate
	EndFunc

	Func _date_time_dosdatetimetoarray($idosdate, $idostime)
		Local $adate[6]
		$adate[0] = BitAND($idosdate, 31)
		$adate[1] = BitAND(BitShift($idosdate, 5), 15)
		$adate[2] = BitAND(BitShift($idosdate, 9), 63) + 1980
		$adate[5] = BitAND($idostime, 31) * 2
		$adate[4] = BitAND(BitShift($idostime, 5), 63)
		$adate[3] = BitAND(BitShift($idostime, 11), 31)
		Return $adate
	EndFunc

	Func _date_time_dosdatetimetostr($idosdate, $idostime)
		Local $adate = _date_time_dosdatetimetoarray($idosdate, $idostime)
		Return StringFormat("%02d/%02d/%04d %02d:%02d:%02d", $adate[0], $adate[1], $adate[2], $adate[3], $adate[4], $adate[5])
	EndFunc

	Func _date_time_dosdatetostr($idosdate)
		Local $adate = _date_time_dosdatetoarray($idosdate)
		Return StringFormat("%02d/%02d/%04d", $adate[0], $adate[1], $adate[2])
	EndFunc

	Func _date_time_dostimetoarray($idostime)
		Local $atime[3]
		$atime[2] = BitAND($idostime, 31) * 2
		$atime[1] = BitAND(BitShift($idostime, 5), 63)
		$atime[0] = BitAND(BitShift($idostime, 11), 31)
		Return $atime
	EndFunc

	Func _date_time_dostimetostr($idostime)
		Local $atime = _date_time_dostimetoarray($idostime)
		Return StringFormat("%02d:%02d:%02d", $atime[0], $atime[1], $atime[2])
	EndFunc

	Func _date_time_encodefiletime($imonth, $iday, $iyear, $ihour = 0, $iminute = 0, $isecond = 0, $imseconds = 0)
		Local $tsystemtime = _date_time_encodesystemtime($imonth, $iday, $iyear, $ihour, $iminute, $isecond, $imseconds)
		Return _date_time_systemtimetofiletime($tsystemtime)
	EndFunc

	Func _date_time_encodesystemtime($imonth, $iday, $iyear, $ihour = 0, $iminute = 0, $isecond = 0, $imseconds = 0)
		Local $tsystemtime = DllStructCreate($tagsystemtime)
		DllStructSetData($tsystemtime, "Month", $imonth)
		DllStructSetData($tsystemtime, "Day", $iday)
		DllStructSetData($tsystemtime, "Year", $iyear)
		DllStructSetData($tsystemtime, "Hour", $ihour)
		DllStructSetData($tsystemtime, "Minute", $iminute)
		DllStructSetData($tsystemtime, "Second", $isecond)
		DllStructSetData($tsystemtime, "MSeconds", $imseconds)
		Return $tsystemtime
	EndFunc

	Func _date_time_filetimetoarray(ByRef $tfiletime)
		If ((DllStructGetData($tfiletime, 1) + DllStructGetData($tfiletime, 2)) = 0) Then Return SetError(10, 0, 0)
		Local $tsystemtime = _date_time_filetimetosystemtime($tfiletime)
		If @error Then Return SetError(@error, @extended, 0)
		Return _date_time_systemtimetoarray($tsystemtime)
	EndFunc

	Func _date_time_filetimetostr(ByRef $tfiletime, $ifmt = 0)
		Local $adate = _date_time_filetimetoarray($tfiletime)
		If @error Then Return SetError(@error, @extended, "")
		If $ifmt Then
			Return StringFormat("%04d/%02d/%02d %02d:%02d:%02d", $adate[2], $adate[0], $adate[1], $adate[3], $adate[4], $adate[5])
		Else
			Return StringFormat("%02d/%02d/%04d %02d:%02d:%02d", $adate[0], $adate[1], $adate[2], $adate[3], $adate[4], $adate[5])
		EndIf
	EndFunc

	Func _date_time_filetimetodosdatetime($tfiletime)
		Local $adate[2]
		Local $aresult = DllCall("kernel32.dll", "bool", "FileTimeToDosDateTime", "struct*", $tfiletime, "word*", 0, "word*", 0)
		If @error Then Return SetError(@error, @extended, $adate)
		$adate[0] = $aresult[2]
		$adate[1] = $aresult[3]
		Return SetExtended($aresult[0], $adate)
	EndFunc

	Func _date_time_filetimetolocalfiletime($tfiletime)
		Local $tlocal = DllStructCreate($tagfiletime)
		Local $aresult = DllCall("kernel32.dll", "bool", "FileTimeToLocalFileTime", "struct*", $tfiletime, "struct*", $tlocal)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $tlocal)
	EndFunc

	Func _date_time_filetimetosystemtime($tfiletime)
		Local $tsysttime = DllStructCreate($tagsystemtime)
		Local $aresult = DllCall("kernel32.dll", "bool", "FileTimeToSystemTime", "struct*", $tfiletime, "struct*", $tsysttime)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $tsysttime)
	EndFunc

	Func _date_time_getfiletime($hfile)
		Local $adate[3]
		$adate[0] = DllStructCreate($tagfiletime)
		$adate[1] = DllStructCreate($tagfiletime)
		$adate[2] = DllStructCreate($tagfiletime)
		Local $aresult = DllCall("kernel32.dll", "bool", "GetFileTime", "handle", $hfile, "struct*", $adate[0], "struct*", $adate[1], "struct*", $adate[2])
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $adate)
	EndFunc

	Func _date_time_getlocaltime()
		Local $tsysttime = DllStructCreate($tagsystemtime)
		DllCall("kernel32.dll", "none", "GetLocalTime", "struct*", $tsysttime)
		If @error Then Return SetError(@error, @extended, 0)
		Return $tsysttime
	EndFunc

	Func _date_time_getsystemtime()
		Local $tsysttime = DllStructCreate($tagsystemtime)
		DllCall("kernel32.dll", "none", "GetSystemTime", "struct*", $tsysttime)
		If @error Then Return SetError(@error, @extended, 0)
		Return $tsysttime
	EndFunc

	Func _date_time_getsystemtimeadjustment()
		Local $ainfo[3]
		Local $aresult = DllCall("kernel32.dll", "bool", "GetSystemTimeAdjustment", "dword*", 0, "dword*", 0, "bool*", 0)
		If @error Then Return SetError(@error, @extended, 0)
		$ainfo[0] = $aresult[1]
		$ainfo[1] = $aresult[2]
		$ainfo[2] = $aresult[3] <> 0
		Return SetExtended($aresult[0], $ainfo)
	EndFunc

	Func _date_time_getsystemtimeasfiletime()
		Local $tfiletime = DllStructCreate($tagfiletime)
		DllCall("kernel32.dll", "none", "GetSystemTimeAsFileTime", "struct*", $tfiletime)
		If @error Then Return SetError(@error, @extended, 0)
		Return $tfiletime
	EndFunc

	Func _date_time_getsystemtimes()
		Local $ainfo[3]
		$ainfo[0] = DllStructCreate($tagfiletime)
		$ainfo[1] = DllStructCreate($tagfiletime)
		$ainfo[2] = DllStructCreate($tagfiletime)
		Local $aresult = DllCall("kernel32.dll", "bool", "GetSystemTimes", "struct*", $ainfo[0], "struct*", $ainfo[1], "struct*", $ainfo[2])
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $ainfo)
	EndFunc

	Func _date_time_gettickcount()
		Local $aresult = DllCall("kernel32.dll", "dword", "GetTickCount")
		If @error Then Return SetError(@error, @extended, 0)
		Return $aresult[0]
	EndFunc

	Func _date_time_gettimezoneinformation()
		Local $ttimezone = DllStructCreate($tagtime_zone_information)
		Local $aresult = DllCall("kernel32.dll", "dword", "GetTimeZoneInformation", "struct*", $ttimezone)
		If @error OR $aresult[0] = -1 Then Return SetError(@error, @extended, 0)
		Local $ainfo[8]
		$ainfo[0] = $aresult[0]
		$ainfo[1] = DllStructGetData($ttimezone, "Bias")
		$ainfo[2] = DllStructGetData($ttimezone, "StdName")
		$ainfo[3] = __date_time_clonesystemtime(DllStructGetPtr($ttimezone, "StdDate"))
		$ainfo[4] = DllStructGetData($ttimezone, "StdBias")
		$ainfo[5] = DllStructGetData($ttimezone, "DayName")
		$ainfo[6] = __date_time_clonesystemtime(DllStructGetPtr($ttimezone, "DayDate"))
		$ainfo[7] = DllStructGetData($ttimezone, "DayBias")
		Return $ainfo
	EndFunc

	Func _date_time_localfiletimetofiletime($tlocaltime)
		Local $tfiletime = DllStructCreate($tagfiletime)
		Local $aresult = DllCall("kernel32.dll", "bool", "LocalFileTimeToFileTime", "struct*", $tlocaltime, "struct*", $tfiletime)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $tfiletime)
	EndFunc

	Func _date_time_setfiletime($hfile, $tcreatetime, $tlastaccess, $tlastwrite)
		Local $aresult = DllCall("kernel32.dll", "bool", "SetFileTime", "handle", $hfile, "struct*", $tcreatetime, "struct*", $tlastaccess, "struct*", $tlastwrite)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _date_time_setlocaltime($tsystemtime)
		Local $aresult = DllCall("kernel32.dll", "bool", "SetLocalTime", "struct*", $tsystemtime)
		If @error OR NOT $aresult[0] Then Return SetError(@error + 10, @extended, False)
		$aresult = DllCall("kernel32.dll", "bool", "SetLocalTime", "struct*", $tsystemtime)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _date_time_setsystemtime($tsystemtime)
		Local $aresult = DllCall("kernel32.dll", "bool", "SetSystemTime", "struct*", $tsystemtime)
		If @error Then Return SetError(@error, @extended, False)
		Return $aresult[0]
	EndFunc

	Func _date_time_setsystemtimeadjustment($iadjustment, $bdisabled)
		Local $htoken = _security__openthreadtokenex(BitOR($token_adjust_privileges, $token_query))
		If @error Then Return SetError(@error + 10, @extended, False)
		_security__setprivilege($htoken, "SeSystemtimePrivilege", True)
		Local $ierror = @error
		Local $ilasterror = @extended
		Local $bret = False
		If NOT @error Then
			Local $aresult = DllCall("kernel32.dll", "bool", "SetSystemTimeAdjustment", "dword", $iadjustment, "bool", $bdisabled)
			If @error Then
				$ierror = @error
				$ilasterror = @extended
			ElseIf $aresult[0] Then
				$bret = True
			Else
				$ierror = 20
				$ilasterror = _winapi_getlasterror()
			EndIf
			_security__setprivilege($htoken, "SeSystemtimePrivilege", False)
			If NOT $ierror AND @error Then $ierror = 22
		EndIf
		_winapi_closehandle($htoken)
		Return SetError($ierror, $ilasterror, $bret)
	EndFunc

	Func _date_time_settimezoneinformation($ibias, $sstdname, $tstddate, $istdbias, $sdayname, $tdaydate, $idaybias)
		Local $tzoneinfo = DllStructCreate($tagtime_zone_information)
		DllStructSetData($tzoneinfo, "Bias", $ibias)
		DllStructSetData($tzoneinfo, "StdName", $sstdname)
		_memmovememory($tstddate, DllStructGetPtr($tzoneinfo, "StdDate"), DllStructGetSize($tstddate))
		DllStructSetData($tzoneinfo, "StdBias", $istdbias)
		DllStructSetData($tzoneinfo, "DayName", $sdayname)
		_memmovememory($tdaydate, DllStructGetPtr($tzoneinfo, "DayDate"), DllStructGetSize($tdaydate))
		DllStructSetData($tzoneinfo, "DayBias", $idaybias)
		Local $htoken = _security__openthreadtokenex(BitOR($token_adjust_privileges, $token_query))
		If @error Then Return SetError(@error + 10, @extended, False)
		_security__setprivilege($htoken, "SeTimeZonePrivilege", True)
		Local $ierror = @error
		Local $ilasterror = @extended
		Local $bret = False
		If NOT @error Then
			Local $aresult = DllCall("kernel32.dll", "bool", "SetTimeZoneInformation", "struct*", $tzoneinfo)
			If @error Then
				$ierror = @error
				$ilasterror = @extended
			ElseIf $aresult[0] Then
				$ilasterror = 0
				$bret = True
			Else
				$ierror = 20
				$ilasterror = _winapi_getlasterror()
			EndIf
			_security__setprivilege($htoken, "SeTimeZonePrivilege", False)
			If NOT $ierror AND @error Then $ierror = 22
		EndIf
		_winapi_closehandle($htoken)
		Return SetError($ierror, $ilasterror, $bret)
	EndFunc

	Func _date_time_systemtimetoarray(ByRef $tsystemtime)
		Local $ainfo[8]
		$ainfo[0] = DllStructGetData($tsystemtime, "Month")
		$ainfo[1] = DllStructGetData($tsystemtime, "Day")
		$ainfo[2] = DllStructGetData($tsystemtime, "Year")
		$ainfo[3] = DllStructGetData($tsystemtime, "Hour")
		$ainfo[4] = DllStructGetData($tsystemtime, "Minute")
		$ainfo[5] = DllStructGetData($tsystemtime, "Second")
		$ainfo[6] = DllStructGetData($tsystemtime, "MSeconds")
		$ainfo[7] = DllStructGetData($tsystemtime, "DOW")
		Return $ainfo
	EndFunc

	Func _date_time_systemtimetodatestr(ByRef $tsystemtime, $ifmt = 0)
		Local $ainfo = _date_time_systemtimetoarray($tsystemtime)
		If @error Then Return SetError(@error, @extended, "")
		If $ifmt Then
			Return StringFormat("%04d/%02d/%02d", $ainfo[2], $ainfo[0], $ainfo[1])
		Else
			Return StringFormat("%02d/%02d/%04d", $ainfo[0], $ainfo[1], $ainfo[2])
		EndIf
	EndFunc

	Func _date_time_systemtimetodatetimestr(ByRef $tsystemtime, $ifmt = 0)
		Local $ainfo = _date_time_systemtimetoarray($tsystemtime)
		If @error Then Return SetError(@error, @extended, "")
		If $ifmt Then
			Return StringFormat("%04d/%02d/%02d %02d:%02d:%02d", $ainfo[2], $ainfo[0], $ainfo[1], $ainfo[3], $ainfo[4], $ainfo[5])
		Else
			Return StringFormat("%02d/%02d/%04d %02d:%02d:%02d", $ainfo[0], $ainfo[1], $ainfo[2], $ainfo[3], $ainfo[4], $ainfo[5])
		EndIf
	EndFunc

	Func _date_time_systemtimetofiletime($tsystemtime)
		Local $tfiletime = DllStructCreate($tagfiletime)
		Local $aresult = DllCall("kernel32.dll", "bool", "SystemTimeToFileTime", "struct*", $tsystemtime, "struct*", $tfiletime)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $tfiletime)
	EndFunc

	Func _date_time_systemtimetotimestr(ByRef $tsystemtime)
		Local $ainfo = _date_time_systemtimetoarray($tsystemtime)
		Return StringFormat("%02d:%02d:%02d", $ainfo[3], $ainfo[4], $ainfo[5])
	EndFunc

	Func _date_time_systemtimetotzspecificlocaltime($tutc, $ttimezone = 0)
		Local $tlocaltime = DllStructCreate($tagsystemtime)
		Local $aresult = DllCall("kernel32.dll", "bool", "SystemTimeToTzSpecificLocalTime", "struct*", $ttimezone, "struct*", $tutc, "struct*", $tlocaltime)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $tlocaltime)
	EndFunc

	Func _date_time_tzspecificlocaltimetosystemtime($tlocaltime, $ttimezone = 0)
		Local $tutc = DllStructCreate($tagsystemtime)
		Local $aresult = DllCall("kernel32.dll", "bool", "TzSpecificLocalTimeToSystemTime", "struct*", $ttimezone, "struct*", $tlocaltime, "struct*", $tutc)
		If @error Then Return SetError(@error, @extended, 0)
		Return SetExtended($aresult[0], $tutc)
	EndFunc

	Global Const $inet_localcache = 0
	Global Const $inet_forcereload = 1
	Global Const $inet_ignoressl = 2
	Global Const $inet_asciitransfer = 4
	Global Const $inet_binarytransfer = 8
	Global Const $inet_forcebypass = 16
	Global Const $inet_downloadwait = 0
	Global Const $inet_downloadbackground = 1
	Global Const $inet_downloadread = 0
	Global Const $inet_downloadsize = 1
	Global Const $inet_downloadcomplete = 2
	Global Const $inet_downloadsuccess = 3
	Global Const $inet_downloaderror = 4
	Global Const $inet_downloadextended = 5

	Func _getip()
		Local Const $getip_timer = 300000
		Local Static $htimer = 0
		Local Static $slastip = 0
		If TimerDiff($htimer) < $getip_timer AND NOT $slastip Then
			Return SetExtended(1, $slastip)
		EndIf
		Local $agetipurl = ["https://api.ipify.org", "http://checkip.dyndns.org", "http://www.myexternalip.com/raw", "http://bot.whatismyipaddress.com"], $areturn = 0, $sreturn = ""
		For $i = 0 To UBound($agetipurl) - 1
			$sreturn = InetRead($agetipurl[$i])
			If @error OR $sreturn == "" Then ContinueLoop
			$areturn = StringRegExp(BinaryToString($sreturn), "((?:\d{1,3}\.){3}\d{1,3})", $str_regexparrayglobalmatch)
			If NOT @error Then
				$sreturn = $areturn[0]
				ExitLoop
			EndIf
			$sreturn = ""
		Next
		$htimer = TimerInit()
		$slastip = $sreturn
		If $sreturn == "" Then Return SetError(1, 0, -1)
		Return $sreturn
	EndFunc

	Func _inetexplorercapable($siestring)
		If StringLen($siestring) <= 0 Then Return SetError(1, 0, "")
		Local $s_iereturn
		Local $n_iechar
		For $i_iecount = 1 To StringLen($siestring)
			$n_iechar = "0x" & Hex(Asc(StringMid($siestring, $i_iecount, 1)), 2)
			If $n_iechar < 33 OR $n_iechar = 37 OR $n_iechar = 47 OR $n_iechar > 127 Then
				$s_iereturn = $s_iereturn & "%" & StringRight($n_iechar, 2)
			Else
				$s_iereturn = $s_iereturn & Chr($n_iechar)
			EndIf
		Next
		Return $s_iereturn
	EndFunc

	Func _inetgetsource($surl, $bstring = True)
		Local $sstring = InetRead($surl, $inet_forcereload)
		Local $ierror = @error, $iextended = @extended
		If $bstring = Default OR $bstring Then $sstring = BinaryToString($sstring)
		Return SetError($ierror, $iextended, $sstring)
	EndFunc

	Func _inetmail($smailto, $smailsubject, $smailbody)
		Local $iprev = Opt("ExpandEnvStrings", 1)
		Local $svar, $sdflt = RegRead("HKCU\Software\Clients\Mail", "")
		If $sdflt = "Windows Live Mail" Then
			$svar = RegRead("HKCR\WLMail.Url.Mailto\Shell\open\command", "")
		Else
			$svar = RegRead("HKCR\mailto\shell\open\command", "")
		EndIf
		Local $iret = Run(StringReplace($svar, "%1", _inetexplorercapable("mailto:" & $smailto & "?subject=" & $smailsubject & "&body=" & $smailbody)))
		Local $ierror = @error, $iextended = @extended
		Opt("ExpandEnvStrings", $iprev)
		Return SetError($ierror, $iextended, $iret)
	EndFunc

	Func _inetsmtpmail($ssmtpserver, $sfromname, $sfromaddress, $stoaddress, $ssubject = "", $abody = "", $sehlo = "", $sfirst = "", $btrace = 0)
		If $ssmtpserver = "" OR $sfromaddress = "" OR $stoaddress = "" OR $sfromname = "" OR StringLen($sfromname) > 256 Then Return SetError(1, 0, 0)
		If $sehlo = "" Then $sehlo = @ComputerName
		If TCPStartup() = 0 Then Return SetError(2, 0, 0)
		Local $s_ipaddress, $i_count
		If StringRegExp($ssmtpserver, "^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$") Then
			$s_ipaddress = $ssmtpserver
		Else
			$s_ipaddress = TCPNameToIP($ssmtpserver)
		EndIf
		If $s_ipaddress = "" Then
			TCPShutdown()
			Return SetError(3, 0, 0)
		EndIf
		Local $vsocket = TCPConnect($s_ipaddress, 25)
		If $vsocket = -1 Then
			TCPShutdown()
			Return SetError(4, 0, 0)
		EndIf
		Local $asend[6], $areplycode[6]
		$asend[0] = "HELO " & $sehlo & @CRLF
		If StringLeft($sehlo, 5) = "EHLO " Then $asend[0] = $sehlo & @CRLF
		$areplycode[0] = "250"
		$asend[1] = "MAIL FROM: <" & $sfromaddress & ">" & @CRLF
		$areplycode[1] = "250"
		$asend[2] = "RCPT TO: <" & $stoaddress & ">" & @CRLF
		$areplycode[2] = "250"
		$asend[3] = "DATA" & @CRLF
		$areplycode[3] = "354"
		Local $aresult = _date_time_gettimezoneinformation()
		Local $ibias = -$aresult[1] / 60
		Local $ibiash = Int($ibias)
		Local $ibiasm = 0
		If $ibiash <> $ibias Then $ibiasm = Abs($ibias - $ibiash) * 60
		$ibias = StringFormat(" (%+.2d%.2d)", $ibiash, $ibiasm)
		$asend[4] = "From:" & $sfromname & "<" & $sfromaddress & ">" & @CRLF & "To:" & "<" & $stoaddress & ">" & @CRLF & "Subject:" & $ssubject & @CRLF & "Mime-Version: 1.0" & @CRLF & "Date: " & _datedayofweek(@WDAY, 1) & ", " & @MDAY & " " & _datetomonth(@MON, 1) & " " & @YEAR & " " & @HOUR & ":" & @MIN & ":" & @SEC & $ibias & @CRLF & "Content-Type: text/plain; charset=US-ASCII" & @CRLF & @CRLF
		$areplycode[4] = ""
		$asend[5] = @CRLF & "." & @CRLF
		$areplycode[5] = "250"
		If __smtpsend($vsocket, $asend[0], $areplycode[0], $btrace, "220", $sfirst) Then Return SetError(50, 0, 0)
		For $i_count = 1 To UBound($asend) - 2
			If __smtpsend($vsocket, $asend[$i_count], $areplycode[$i_count], $btrace) Then Return SetError(50 + $i_count, 0, 0)
		Next
		For $i_count = 0 To UBound($abody) - 1
			If StringLeft($abody[$i_count], 1) = "." Then $abody[$i_count] = "." & $abody[$i_count]
			If __smtpsend($vsocket, $abody[$i_count] & @CRLF, "", $btrace) Then Return SetError(500 + $i_count, 0, 0)
		Next
		$i_count = UBound($asend) - 1
		If __smtpsend($vsocket, $asend[$i_count], $areplycode[$i_count], $btrace) Then Return SetError(5000, 0, 0)
		TCPCloseSocket($vsocket)
		TCPShutdown()
		Return 1
	EndFunc

	Func __smtptrace($sstr, $itimeout = 0)
		Local $sw_title = "SMTP trace"
		Local $ssmtptrace = ControlGetText($sw_title, "", "Static1")
		$sstr = StringLeft(StringReplace($sstr, @CRLF, ""), 70)
		$ssmtptrace &= @HOUR & ":" & @MIN & ":" & @SEC & " " & $sstr & @LF
		If WinExists($sw_title) Then
			ControlSetText($sw_title, "", "Static1", $ssmtptrace)
		Else
			SplashTextOn($sw_title, $ssmtptrace, 400, 500, 500, 100, 4 + 16, "", 8)
		EndIf
		If $itimeout Then Sleep($itimeout * 1000)
	EndFunc

	Func __smtpsend($vsocket, $ssend, $sreplycode, $btrace, $sintreply = "", $sfirst = "")
		Local $sreceive, $i, $htimer
		If $btrace Then __smtptrace($ssend)
		If $sintreply <> "" Then
			If $sfirst <> -1 Then
				If TCPSend($vsocket, $sfirst) = 0 Then
					TCPCloseSocket($vsocket)
					TCPShutdown()
					Return 1
				EndIf
			EndIf
			$sreceive = ""
			$htimer = TimerInit()
			While StringLeft($sreceive, StringLen($sintreply)) <> $sintreply AND TimerDiff($htimer) < 45000
				$sreceive = TCPRecv($vsocket, 1000)
				If $btrace AND $sreceive <> "" Then __smtptrace("intermediate->" & $sreceive)
			WEnd
		EndIf
		If TCPSend($vsocket, $ssend) = 0 Then
			TCPCloseSocket($vsocket)
			TCPShutdown()
			Return 1
		EndIf
		$htimer = TimerInit()
		$sreceive = ""
		While $sreceive = "" AND TimerDiff($htimer) < 45000
			$i += 1
			$sreceive = TCPRecv($vsocket, 1000)
			If $sreplycode = "" Then ExitLoop
		WEnd
		If $sreplycode <> "" Then
			If $btrace Then __smtptrace($i & " <- " & $sreceive)
			If StringLeft($sreceive, StringLen($sreplycode)) <> $sreplycode Then
				TCPCloseSocket($vsocket)
				TCPShutdown()
				If $btrace Then __smtptrace("<-> " & $sreplycode, 5)
				Return 2
			EndIf
		EndIf
		Return 0
	EndFunc

	Func _tcpiptoname($sip, $ioption = Default, $hdll = Default)
		Local $iinaddr_none = -1, $iaf_inet = 2, $sseparator = @CR
		If $ioption = Default Then $ioption = 0
		If $hdll = Default Then $hdll = "ws2_32.dll"
		Local $avdllcall = DllCall($hdll, "ulong", "inet_addr", "STR", $sip)
		If @error Then Return SetError(1, 0, "")
		Local $vbinip = $avdllcall[0]
		If $vbinip = $iinaddr_none Then Return SetError(2, 0, "")
		$avdllcall = DllCall($hdll, "ptr", "gethostbyaddr", "ptr*", $vbinip, "int", 4, "int", $iaf_inet)
		If @error Then Return SetError(3, 0, "")
		Local $pvhostent = $avdllcall[0]
		If $pvhostent = 0 Then
			$avdllcall = DllCall($hdll, "int", "WSAGetLastError")
			If @error Then Return SetError(5, 0, "")
			Return SetError(4, $avdllcall[0], "")
		EndIf
		Local $thostent = DllStructCreate("ptr;ptr;short;short;ptr", $pvhostent)
		Local $shostnames = __tcpiptoname_szstringread(DllStructGetData($thostent, 1))
		If @error Then Return SetError(6, 0, $shostnames)
		If $ioption = 1 Then
			Local $taliases
			$shostnames &= $sseparator
			For $i = 0 To 63
				$taliases = DllStructCreate("ptr", DllStructGetData($thostent, 2) + ($i * 4))
				If DllStructGetData($taliases, 1) = 0 Then ExitLoop
				$shostnames &= __tcpiptoname_szstringread(DllStructGetData($taliases, 1))
				If @error Then
					SetError(7)
					ExitLoop
				EndIf
			Next
			Return StringSplit(StringStripWS($shostnames, $str_striptrailing), @CR)
		Else
			Return $shostnames
		EndIf
	EndFunc

	Func __tcpiptoname_szstringread($pstr, $ilen = -1)
		Local $tstring
		If $pstr < 1 Then Return ""
		If $ilen < 0 Then $ilen = _winapi_strlen($pstr, False)
		$tstring = DllStructCreate("char[" & $ilen & "]", $pstr)
		If @error Then Return SetError(2, 0, "")
		Return SetExtended($ilen, DllStructGetData($tstring, 1))
	EndFunc

	Global $__binarycall_kernel32dll = DllOpen("kernel32.dll")
	Global $__binarycall_msvcrtdll = DllOpen("msvcrt.dll")
	Global $__binarycall_lasterror = ""

	Func _binarycall_getprocaddress($module, $proc)
		Local $ret = DllCall($__binarycall_kernel32dll, "ptr", "GetProcAddress", "ptr", $module, "str", $proc)
		If @error OR NOT $ret[0] Then Return SetError(1, @error, 0)
		Return $ret[0]
	EndFunc

	Func _binarycall_loadlibrary($filename)
		Local $ret = DllCall($__binarycall_kernel32dll, "handle", "LoadLibraryW", "wstr", $filename)
		If @error Then Return SetError(1, @error, 0)
		Return $ret[0]
	EndFunc

	Func _binarycall_lstrlena($ptr)
		Local $ret = DllCall($__binarycall_kernel32dll, "int", "lstrlenA", "ptr", $ptr)
		If @error Then Return SetError(1, @error, 0)
		Return $ret[0]
	EndFunc

	Func _binarycall_alloc($code, $padding = 0)
		Local $length = BinaryLen($code) + $padding
		Local $ret = DllCall($__binarycall_kernel32dll, "ptr", "VirtualAlloc", "ptr", 0, "ulong_ptr", $length, "dword", 4096, "dword", 64)
		If @error OR NOT $ret[0] Then Return SetError(1, @error, 0)
		If BinaryLen($code) Then
			Local $buffer = DllStructCreate("byte[" & $length & "]", $ret[0])
			DllStructSetData($buffer, 1, $code)
		EndIf
		Return $ret[0]
	EndFunc

	Func _binarycall_regionsize($ptr)
		Local $buffer = DllStructCreate("ptr;ptr;dword;uint_ptr;dword;dword;dword")
		Local $ret = DllCall($__binarycall_kernel32dll, "int", "VirtualQuery", "ptr", $ptr, "ptr", DllStructGetPtr($buffer), "uint_ptr", DllStructGetSize($buffer))
		If @error OR $ret[0] = 0 Then Return SetError(1, @error, 0)
		Return DllStructGetData($buffer, 4)
	EndFunc

	Func _binarycall_free($ptr)
		Local $ret = DllCall($__binarycall_kernel32dll, "bool", "VirtualFree", "ptr", $ptr, "ulong_ptr", 0, "dword", 32768)
		If @error OR $ret[0] = 0 Then
			$ret = DllCall($__binarycall_kernel32dll, "bool", "GlobalFree", "ptr", $ptr)
			If @error OR $ret[0] <> 0 Then Return SetError(1, @error, False)
		EndIf
		Return True
	EndFunc

	Func _binarycall_release($codebase)
		Local $ret = _binarycall_free($codebase)
		Return SetError(@error, @extended, $ret)
	EndFunc

	Func _binarycall_memorysearch($ptr, $length, $binary)
		Static $codebase
		If NOT $codebase Then
			If @AutoItX64 Then
				$codebase = _binarycall_create("0x4883EC084D85C94889C8742C4C39CA72254C29CA488D141131C9EB0848FFC14C39C97414448A1408453A140874EE48FFC04839D076E231C05AC3", "", 0, True, False)
			Else
				$codebase = _binarycall_create("0x5589E58B4D14578B4508568B550C538B7D1085C9742139CA721B29CA8D341031D2EB054239CA740F8A1C17381C1074F34039F076EA31C05B5E5F5DC3", "", 0, True, False)
			EndIf
			If NOT $codebase Then Return SetError(1, 0, 0)
		EndIf
		$binary = Binary($binary)
		Local $buffer = DllStructCreate("byte[" & BinaryLen($binary) & "]")
		DllStructSetData($buffer, 1, $binary)
		Local $ret = DllCallAddress("ptr:cdecl", $codebase, "ptr", $ptr, "uint", $length, "ptr", DllStructGetPtr($buffer), "uint", DllStructGetSize($buffer))
		Return $ret[0]
	EndFunc

	Func _binarycall_base64decode($src)
		Static $codebase
		If NOT $codebase Then
			If @AutoItX64 Then
				$codebase = _binarycall_create("0x41544989CAB9FF000000555756E8BE000000534881EC000100004889E7F3A44C89D6E98A0000004439C87E0731C0E98D0000000FB66E01440FB626FFC00FB65E020FB62C2C460FB62424408A3C1C0FB65E034189EB41C1E4024183E3308A1C1C41C1FB044509E34080FF634189CC45881C08744C440FB6DFC1E5044489DF4088E883E73CC1FF0209C7418D44240241887C08014883C10380FB63742488D841C1E3064883C60483E03F4409D841884408FF89F389C84429D339D30F8C67FFFFFF4881C4000100005B5E5F5D415CC35EC3E8F9FFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E0000003F3435363738393A3B3C3D00000063000000000102030405060708090A0B0C0D0E0F101112131415161718190000000000001A1B1C1D1E1F202122232425262728292A2B2C2D2E2F30313233", "", 132, True, False)
			Else
				$codebase = _binarycall_create("0x55B9FF00000089E531C05756E8F10000005381EC0C0100008B55088DBDF5FEFFFFF3A4E9C00000003B45140F8FC20000000FB65C0A028A9C1DF5FEFFFF889DF3FEFFFF0FB65C0A038A9C1DF5FEFFFF889DF2FEFFFF0FB65C0A018985E8FEFFFF0FB69C1DF5FEFFFF899DECFEFFFF0FB63C0A89DE83E630C1FE040FB6BC3DF5FEFFFFC1E70209FE8B7D1089F3881C074080BDF3FEFFFF63745C0FB6B5F3FEFFFF8BBDECFEFFFF8B9DE8FEFFFF89F083E03CC1E704C1F80209F88B7D1088441F0189D883C00280BDF2FEFFFF6374278A85F2FEFFFFC1E60683C10483E03F09F088441F0289D883C0033B4D0C0F8C37FFFFFFEB0231C081C40C0100005B5E5F5DC35EC3E8F9FFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E0000003F3435363738393A3B3C3D00000063000000000102030405060708090A0B0C0D0E0F101112131415161718190000000000001A1B1C1D1E1F202122232425262728292A2B2C2D2E2F30313233", "", 132, True, False)
			EndIf
			If NOT $codebase Then Return SetError(1, 0, Binary(""))
		EndIf
		$src = String($src)
		Local $srclen = StringLen($src)
		Local $srcbuf = DllStructCreate("char[" & $srclen & "]")
		DllStructSetData($srcbuf, 1, $src)
		Local $dstlen = Int(($srclen + 2) / 4) * 3 + 1
		Local $dstbuf = DllStructCreate("byte[" & $dstlen & "]")
		Local $ret = DllCallAddress("uint:cdecl", $codebase, "ptr", DllStructGetPtr($srcbuf), "uint", $srclen, "ptr", DllStructGetPtr($dstbuf), "uint", $dstlen)
		If $ret[0] = 0 Then Return SetError(2, 0, Binary(""))
		Return BinaryMid(DllStructGetData($dstbuf, 1), 1, $ret[0])
	EndFunc

	Func _binarycall_base64encode($src)
		Static $codebase
		If NOT $codebase Then
			If @AutoItX64 Then
				$codebase = _binarycall_create("AwAAAARiAQAAAAAAAAArkuFQDAlvIp0qAgbDnjr76UDZs1EPNIP2K18t9s6SNTbd43IB7HfdyPM8VfD/o36z4AmSW2m2AIsC6Af3fKNsHU4BdQKGd0PQXHxPSX0iNqp1YAKovksqQna06NeKMoOYqryTUX4WgpHjokhp6zY2sEFSIjcL7dW3FDoNVz4bGPyZHRvjFwmqvr7YGlNYKwNoh+SYCXmIgVPVZ63Vz1fbT33/QFpWmWOeBRqs4J+c8Qp6zJFsK345Pjw0I8kMSsnho4F4oNzQ2OsAbmIioaQ6Ma2ziw5NH+M+t4SpEeHDnBdUTTL20sxWZ0yKruFAsBIRoHvM7LYcid2eBV2d5roSjnkwMG0g69LNjs1fHjbI/9iU/hJwpSsgl4fltXdZG659/li13UFY89M7UfckiZ9XOeBM0zadgNsy8r8M3rEAAA==")
			Else
				$codebase = _binarycall_create("AwAAAARVAQAAAAAAAAAqr7blBndrIGnmhhfXD7R1fkOTKhicg1W6MCtStbz+CsneBEg0bbHH1sqTLmLfY7A6LqZl6LYWT5ULVj6MXgugPbBn9wKsSU2ZCcBBPNkx09HVPdUaKnbqghDGj/C5SHoF+A/5g+UgE1C5zJZORjJ8ljs5lt2Y9lA4BsY7jVKX2vmDvHK1NnSR6nVwh7Pb+Po/UpNcy5sObVWDKkYSCCtCIjKIYqOe3c6k8Xsp4eritCUprXEVvCFi7K5Z6HFXdm3nZsFcE+eSJ1WkRnVQbWcmpjGMGka61C68+CI7tsQ13UnCFWNSpDrCbzUejMZh8HdPgEc5vCg3pKMKin/NavNpB6+87Y9y7HIxmKsPdjDT30u9hUKWnYiRe3nrwKyVDsiYpKU/Nse368jHag5B5or3UKA+nb2+eY8JwzgA")
			EndIf
			If NOT $codebase Then Return SetError(1, 0, Binary(""))
		EndIf
		$src = Binary($src)
		Local $srclen = BinaryLen($src)
		Local $srcbuf = DllStructCreate("byte[" & $srclen & "]")
		DllStructSetData($srcbuf, 1, $src)
		Local $dstlen = Int(($srclen + 2) / 3) * 4 + 1
		Local $dstbuf = DllStructCreate("char[" & $dstlen & "]")
		Local $ret = DllCallAddress("uint:cdecl", $codebase, "ptr", DllStructGetPtr($srcbuf), "uint", $srclen, "ptr", DllStructGetPtr($dstbuf), "uint", $dstlen)
		If $ret[0] = 0 Then Return Binary("")
		Return StringMid(DllStructGetData($dstbuf, 1), 1, $ret[0])
	EndFunc

	Func _binarycall_lzmadecompress($src)
		Static $codebase
		If NOT $codebase Then
			If @AutoItX64 Then
				$codebase = _binarycall_create(_binarycall_base64decode("QVcxwEFWQVVBVFVXSInXVkiJzlMx20iB7OgAAABEiiFBgPzgdgnpyQAAAEGD7C1BiMf/wEGA/Cx38THA6wRBg+wJQYjG/8BBgPwId/GLRglEi24FQQ+2zkyJRCQoRQ+2/0HB5xBBiQFBD7bEAcG4AAMAANPgjYQAcA4AAEhjyOjIBAAATInpSInF6L0EAABIicMxwEyJ8kSI4EyLRCQoiNQl//8A/0QJ+EiF24lFAHQoTYXtdCNIjVfzSI1MJDhIg8YNTIkEJE2J6UmJ2EiJ7+g2AAAAicbrBb4BAAAASInp6IQEAACF9nQKSInZMdvodgQAAEiJ2EiBxOgAAABbXl9dQVxBXUFeQV/DVVNBV0FWQVVBVEFQTQHBQVFNicVRVkgB8lJIieX8SYn0iwdMjX8Eik8Cg8r/0+L30olV6Ijhg8r/0+L30olV5ADBiUXsuAEAAACJReCJRdyJRdhIiUXQRSnJKfaDy/8A0bgAAwAA0+BIjYg2BwAAuAAEAARMif/R6fOrvwUAAADoUAMAAP/PdfdEie9EicgrfSDB4ARBifpEI1XoRAHQTY0cR+hAAwAAD4WTAAAAik3sI33k0+eA6Qj22dPuAfe4AQAAAEiNPH++AAEAAMHnCEGD+QdNjbR/bA4AAHI0TInvSCt90A+2P9HnQYnzIf5BAfNPjRxe6O8CAACJwcHuCIPhATnOvgABAAB1DjnGd9jrDE2J8+jQAgAAOfBy9EyJ76pEiclBg/kEcg65AwAAAEGD+QpyA4PBA0EpyelDAgAAT42cT4ABAADomgIAAHUsi0XcQYP5B4lF4BnAi1XY99CLTdCD4AOJVdxBicGJTdhNjbdkBgAA6akAAABPjZxPmAEAAOhfAgAAdUZEicjB4AREAdBNjZxH4AEAAOhHAgAAdWpBg/kHuQkAAAByA4PBAkGJyUyJ70grfdBIO30gD4L9AQAAigdIA33QqumzAQAAT42cT7ABAADoCgIAAIt12HQhT42cT8gBAADo+AEAAIt13HQJi03ci3XgiU3gi03YiU3ci03QiU3YiXXQQYP5B7kIAAAAcgODwQNBiclNjbdoCgAATYnz6LsBAAB1FESJ0CnJweADvggAAABJjXxGBOs2TY1eAuicAQAAdRpEidC5CAAAAMHgA74IAAAASY28RgQBAADrEUmNvgQCAAC5EAAAAL4AAQAAiU3MuAEAAABJifvoYQEAAInCKfJy8gNVzEGD+QSJVcwPg7kAAABBg8EHuQMAAAA50XICidHB4Qa4AQAAAEmNvE9gAwAAvkAAAABJifvoHwEAAEGJwkEp8nLwQYP6BHJ4RInWRIlV0NHug2XQAf/Og03QAkGD+g5zFYnx0mXQi0XQRCnQTY20R14FAADrLIPuBOi6AAAA0evRZdBBOdhyBv9F0EEp2P/OdedNjbdEBgAAwWXQBL4EAAAAvwEAAACJ+E2J8+ioAAAAqAF0Awl90NHn/8516+sERIlV0P9F0EyJ74tNzEiJ+IPBAkgrRSBIOUXQd1RIif5IK3XQSItVGKyqSDnXcwT/yXX1SYn9D7bwTDttGA+C9fz//+gwAAAAKcBIi1UQTCtlCESJIkiLVWBMK20gRIkqSIPEKEFcQV1BXUFfW13DXli4AQAAAOvSgfsAAAABcgHDweMITDtlAHPmQcHgCEWKBCRJg8QBwynATY0cQ4H7AAAAAXMVweMITDtlAHPBQcHgCEWKBCRJg8QBidlBD7cTwekLD6/KQTnIcxOJy7kACAAAKdHB6QVmQQELAcDDKcvB6gVBKchmQSkTAcCDwAHDSLj////////////gbXN2Y3J0LmRsbHxtYWxsb2MASLj////////////gZnJlZQA="))
			Else
				$codebase = _binarycall_create(_binarycall_base64decode("VYnlVzH/VlOD7EyLXQiKC4D54A+HxQAAADHA6wWD6S2I0ID5LI1QAXfziEXmMcDrBYPpCYjQgPkIjVABd/OIReWLRRSITeSLUwkPtsmLcwWJEA+2ReUBwbgAAwAA0+CNhABwDgAAiQQk6EcEAACJNCSJRdToPAQAAItV1InHi0Xkhf+JArgBAAAAdDaF9nQyi0UQg8MNiRQkiXQkFIl8JBCJRCQYjUXgiUQkDItFDIlcJASD6A2JRCQI6CkAAACLVdSJRdSJFCToAQQAAItF1IXAdAqJPCQx/+jwAwAAg8RMifhbXl9dw1dWU1WJ5YtFJAFFKFD8i3UYAXUcVot1FK2SUopO/oPI/9Pg99BQiPGDyP/T4PfQUADRifeD7AwpwEBQUFBQUFcp9laDy/+4AAMAANPgjYg2BwAAuAAEAATR6fOragVZ6MoCAADi+Yt9/ItF8Ct9JCH4iUXosADoywIAAA+FhQAAAIpN9CN97NPngOkI9tnT7lgB916NPH/B5wg8B1qNjH5sDgAAUVa+AAEAAFCwAXI0i338K33cD7Y/i23M0eeJ8SH+AfGNbE0A6JgCAACJwcHuCIPhATnOvgABAAB1DjnwctfrDIttzOh5AgAAOfBy9FqD+gSJ0XIJg/oKsQNyArEGKcpS60mwwOhJAgAAdRRYX1pZWln/NCRRUrpkBgAAsQDrb7DM6CwCAAB1LLDw6BMCAAB1U1g8B7AJcgKwC1CLdfwrddw7dSQPgs8BAACsi338qumOAQAAsNjo9wEAAIt12HQbsOTo6wEAAIt11HQJi3XQi03UiU3Qi03YiU3Ui03ciU3YiXXcWF9ZumgKAACxCAH6Ulc8B4jIcgIEA1CLbczovAEAAHUUi0Xoi33MweADKclqCF6NfEcE6zWLbcyDxQLomwEAAHUYi0Xoi33MweADaghZaghejbxHBAEAAOsQvwQCAAADfcxqEFm+AAEAAIlN5CnAQIn96GYBAACJwSnxcvMBTeSDfcQED4OwAAAAg0XEB4tN5IP5BHIDagNZi33IweEGKcBAakBejbxPYAMAAIn96CoBAACJwSnxcvOJTeiJTdyD+QRyc4nOg2XcAdHug03cAk6D+Q5zGbivAgAAKciJ8dJl3ANF3NHgA0XIiUXM6y2D7gToowAAANHr0WXcOV3gcgb/RdwpXeBOdei4RAYAAANFyIlFzMFl3ARqBF4p/0eJ+IttzOi0AAAAqAF0Awl93NHnTnXs6wD/RdyLTeSDwQKLffyJ+CtFJDlF3HdIif4rddyLVSisqjnXcwNJdfeJffwPtvA7fSgPgnH9///oKAAAACnAjWwkPItVIIt1+Ct1GIkyi1Usi338K30kiTrJW15fw15YKcBA69qB+wAAAAFyAcPB4whWi3X4O3Ucc+SLReDB4AisiUXgiXX4XsOLTcQPtsDB4QQDRegByOsGD7bAA0XEi23IjWxFACnAjWxFAIH7AAAAAXMci0wkOMFkJCAIO0wkXHOcihH/RCQ4weMIiFQkIInZD7dVAMHpCw+vyjlMJCBzF4nLuQAIAAAp0cHpBWYBTQABwI1sJEDDweoFKUwkICnLZilVAAHAg8ABjWwkQMO4///////gbXN2Y3J0LmRsbHxtYWxsb2MAuP//////4GZyZWUA"))
			EndIf
			If NOT $codebase Then Return SetError(1, 0, Binary(""))
		EndIf
		$src = Binary($src)
		Local $srclen = BinaryLen($src)
		Local $srcbuf = DllStructCreate("byte[" & $srclen & "]")
		DllStructSetData($srcbuf, 1, $src)
		Local $ret = DllCallAddress("ptr:cdecl", $codebase, "ptr", DllStructGetPtr($srcbuf), "uint_ptr", $srclen, "uint_ptr*", 0, "uint*", 0)
		If $ret[0] Then
			Local $dstbuf = DllStructCreate("byte[" & $ret[3] & "]", $ret[0])
			Local $output = DllStructGetData($dstbuf, 1)
			DllCall($__binarycall_msvcrtdll, "none:cdecl", "free", "ptr", $ret[0])
			Return $output
		EndIf
		Return SetError(2, 0, Binary(""))
	EndFunc

	Func _binarycall_relocation($base, $reloc)
		Local $size = Int(BinaryMid($reloc, 1, 2))
		For $i = 3 To BinaryLen($reloc) Step $size
			Local $offset = Int(BinaryMid($reloc, $i, $size))
			Local $ptr = $base + $offset
			DllStructSetData(DllStructCreate("ptr", $ptr), 1, DllStructGetData(DllStructCreate("ptr", $ptr), 1) + $base)
		Next
	EndFunc

	Func _binarycall_importlibrary($base, $length)
		Local $jmpbin, $jmpoff, $jmplen, $dllname, $procname
		If @AutoItX64 Then
			$jmpbin = Binary("0x48B8FFFFFFFFFFFFFFFFFFE0")
			$jmpoff = 2
		Else
			$jmpbin = Binary("0xB8FFFFFFFFFFE0")
			$jmpoff = 1
		EndIf
		$jmplen = BinaryLen($jmpbin)
		Do
			Local $ptr = _binarycall_memorysearch($base, $length, $jmpbin)
			If $ptr = 0 Then ExitLoop
			Local $stringptr = $ptr + $jmplen
			Local $stringlen = _binarycall_lstrlena($stringptr)
			Local $string = DllStructGetData(DllStructCreate("char[" & $stringlen & "]", $stringptr), 1)
			Local $split = StringSplit($string, "|")
			If $split[0] = 1 Then
				$procname = $split[1]
			ElseIf $split[0] = 2 Then
				If $split[1] Then $dllname = $split[1]
				$procname = $split[2]
			EndIf
			If $dllname AND $procname Then
				Local $handle = _binarycall_loadlibrary($dllname)
				If NOT $handle Then
					$__binarycall_lasterror = "LoadLibrary fail on " & $dllname
					Return SetError(1, 0, False)
				EndIf
				Local $proc = _binarycall_getprocaddress($handle, $procname)
				If NOT $proc Then
					$__binarycall_lasterror = "GetProcAddress failed on " & $procname
					Return SetError(2, 0, False)
				EndIf
				DllStructSetData(DllStructCreate("ptr", $ptr + $jmpoff), 1, $proc)
			EndIf
			Local $diff = Int($ptr - $base + $jmplen + $stringlen + 1)
			$base += $diff
			$length -= $diff
		Until $length <= $jmplen
		Return True
	EndFunc

	Func _binarycall_codeprepare($code)
		If NOT $code Then Return ""
		If IsBinary($code) Then Return $code
		$code = String($code)
		If StringLeft($code, 2) = "0x" Then Return Binary($code)
		If StringIsXDigit($code) Then Return Binary("0x" & $code)
		Return _binarycall_lzmadecompress(_binarycall_base64decode($code))
	EndFunc

	Func _binarycall_symbolfind($codebase, $identify, $length = Default)
		$identify = Binary($identify)
		If IsKeyword($length) Then
			$length = _binarycall_regionsize($codebase)
		EndIf
		Local $ptr = _binarycall_memorysearch($codebase, $length, $identify)
		If $ptr = 0 Then Return SetError(1, 0, 0)
		Return $ptr + BinaryLen($identify)
	EndFunc

	Func _binarycall_symbollist($codebase, $symbol)
		If NOT IsArray($symbol) OR $codebase = 0 Then Return SetError(1, 0, 0)
		Local $tag = ""
		For $i = 0 To UBound($symbol) - 1
			$tag &= "ptr " & $symbol[$i] & ";"
		Next
		Local $symbollist = DllStructCreate($tag)
		If @error Then Return SetError(1, 0, 0)
		For $i = 0 To UBound($symbol) - 1
			$codebase = _binarycall_symbolfind($codebase, $symbol[$i])
			DllStructSetData($symbollist, $symbol[$i], $codebase)
		Next
		Return $symbollist
	EndFunc

	Func _binarycall_create($code, $reloc = "", $padding = 0, $releaseonexit = True, $libraryimport = True)
		Local $binarycode = _binarycall_codeprepare($code)
		If NOT $binarycode Then Return SetError(1, 0, 0)
		Local $binarycodelen = BinaryLen($binarycode)
		Local $totalcodelen = $binarycodelen + $padding
		Local $codebase = _binarycall_alloc($binarycode, $padding)
		If NOT $codebase Then Return SetError(2, 0, 0)
		If $reloc Then
			$reloc = _binarycall_codeprepare($reloc)
			If NOT $reloc Then Return SetError(3, 0, 0)
			_binarycall_relocation($codebase, $reloc)
		EndIf
		If $libraryimport Then
			If NOT _binarycall_importlibrary($codebase, $binarycodelen) Then
				_binarycall_free($codebase)
				Return SetError(4, 0, 0)
			EndIf
		EndIf
		If $releaseonexit Then
			_binarycall_releaseonexit($codebase)
		EndIf
		Return SetError(0, $totalcodelen, $codebase)
	EndFunc

	Func _binarycall_commandlinetoargv($commandline, ByRef $argc, $isunicode = False)
		Static $symbollist
		If NOT IsDllStruct($symbollist) Then
			Local $code
			If @AutoItX64 Then
				$code = "AwAAAASuAgAAAAAAAAAkL48ClEB9jTEOeYv4yYTosNjFNgf81Ag4vS2VP4y4wxFa+4yMI7GDB7CG+xn4JE3cdEVvk8cMp4oIuS3DgTxlcKHGVIg94tvzG/256bizZfGtAETQUCPQjW5+JSx2C/Y4C0VNJMKTlSCHiV5AzXRZ5gw3WFghbtkCCFxWOX+RDSI2oH/vROEOnqc0jfKTo17EBjqX+dW3QxrUe45xsbyYTZ9ccIGySgcOAxetbRiSxQnz8BOMbJyfrbZbuVJyGpKrXFLh/5MlBZ09Cim9qgflbGzmkrGStT9QL1f+O2krzyOzgaWWqhWL6S+y0G32RWVi0uMLR/JOGLEW/+Yg/4bzkeC0lKELT+RmWAatNa38BRfaitROMN12moRDHM6LYD1lzPLnaiefSQRVti561sxni/AFkYoCb5Lkuyw4RIn/r/flRiUg5w48YkqBBd9rXkaXrEoKwPg6rmOvOCZadu//B6HN4+Ipq5aYNuZMxSJXmxwXVRSQZVpSfLS2ATZMd9/Y7kLqrKy1H4V76SgI/d9OKApfKSbQ8ZaKIHBCsoluEip3UDOB82Z21zd933UH5l0laGWLIrTz7xVGkecjo0NQzR7LyhhoV3xszlIuw2v8q0Q/S9LxB5G6tYbOXo7lLjNIZc0derZz7DNeeeJ9dQE9hp8unubaTBpulPxTNtRjog=="
			Else
				$code = "AwAAAAR6AgAAAAAAAABcQfD553vjya/3DmalU0BKqABevUb/60GZ55rMwmzpQfPSRUlIl04lEiS8RDrXpS0EoBUe+uzDgZd37nVu9wsJ4fykqYvLoMz3ApxQbTBKleOIRSla6I0V8dNP3P7rHeUfjH0jCho0RvhhVpf0o4ht/iZptauxaoy1zQ19TkPZ/vf5Im8ecY6qEdHNzjo2H60jVwiOJ+1J47TmQRwxJ+yKLakq8QNxtKkRIB9B9ugfo3NAL0QslDxbyU0dSgw2aOPxV+uttLzYNnWbLBZVQbchcKgLRjC/32U3Op576sOYFolB1Nj4/33c7MRgtGLjlZfTB/4yNvd4/E+u3U6/Q4MYApCfWF4R/d9CAdiwgIjCYUkGDExKjFtHbAWXfWh9kQ7Q/GWUjsfF9BtHO6924Cy1Ou+BUKksqsxmIKP4dBjvvmz9OHc1FdtR9I63XKyYtlUnqVRtKwlNrYAZVCSFsyAefMbteq1ihU33sCsLkAnp1LRZ2wofgT1/JtT8+GO2s/n52D18wM70RH2n5uJJv8tlxQc1lwbmo4XQvcbcE91U2j9glvt2wC1pkP0hF23Nr/iiIEZHIPAOAHvhervlHE830LSHyUx8yh5Tjojr0gdLvQ=="
			EndIf
			Local $codebase = _binarycall_create($code)
			If @error Then Return SetError(1, 0, 0)
			Local $symbol[] = ["ToArgvW", "ToArgvA"]
			$symbollist = _binarycall_symbollist($codebase, $symbol)
			If @error Then Return SetError(1, 0, 0)
		EndIf
		Local $ret
		If $isunicode Then
			$ret = DllCallAddress("ptr:cdecl", DllStructGetData($symbollist, "ToArgvW"), "wstr", $commandline, "int*", 0)
		Else
			$ret = DllCallAddress("ptr:cdecl", DllStructGetData($symbollist, "ToArgvA"), "str", $commandline, "int*", 0)
		EndIf
		If NOT @error AND $ret[0] <> 0 Then
			_binarycall_releaseonexit($ret[0])
			$argc = $ret[2]
			Return $ret[0]
		Else
			Return SetError(2, 0, 0)
		EndIf
	EndFunc

	Func _binarycall_stdioredirect($filename = "CON", $flag = 1 + 2 + 4)
		Static $symbollist
		If NOT IsDllStruct($symbollist) Then
			Local $code, $reloc
			If @AutoItX64 Then
				$code = "AwAAAASjAQAAAAAAAAAkL48ClEB9jTEOeYv4yYTosNjFM1rLNdMULriZUDxTj+ZdkQ01F5zKL+WDCScfQKKLn66EDmcA+gXIkPcZV4lyz8VPw8BPZlNB5KymydM15kCA+uqvmBc1V0NJfzgsF0Amhn0JhM/ZIguYCHxywMQ1SgKxUb05dxDg8WlX/2aPfSolcX47+4/72lPDNTeT7d7XRdm0ND+eCauuQcRH2YOahare9ASxuU4IMHCh2rbZYHwmTNRiQUB/8dLGtph93yhmwdHtyMPLX2x5n6sdA1mxua9htLsLTulE05LLmXbRYXylDz0A"
				$reloc = "AwAAAAQIAAAAAAAAAAABAB7T+CzGn9ScQAC="
			Else
				$code = "AwAAAASVAQAAAAAAAABcQfD553vjya/3DmalU0BKqABaUcndypZ3mTYUkHxlLV/lKZPrXYWXgNATjyiowkUQGDVYUy5THQwK4zYdU7xuGf7qfVDELc1SNbiW3NgD4D6N6ZM7auI1jPaThsPfA/ouBcx2aVQX36fjmViTZ8ZLzafjJeR7d5OG5s9sAoIzFLTZsqrFlkIJedqDAOfhA/0mMrkavTWnsio6yTbic1dER0DcEsXpLn0vBNErKHoagLzAgofHNLeFRw5yHWz5owR5CYL7rgiv2k51neHBWGx97A=="
				$reloc = "AwAAAAQgAAAAAAAAAAABABfyHS/VRkdjBBzbtGPD6vtmVH/IsGHYvPsTv2lGuqJxGlAA"
			EndIf
			Local $codebase = _binarycall_create($code, $reloc)
			If @error Then Return SetError(1, 0, 0)
			Local $symbol[] = ["StdinRedirect", "StdoutRedirect", "StderrRedirect"]
			$symbollist = _binarycall_symbollist($codebase, $symbol)
			If @error Then Return SetError(1, 0, 0)
		EndIf
		If BitAND($flag, 1) Then DllCallAddress("none:cdecl", DllStructGetData($symbollist, "StdinRedirect"), "str", $filename)
		If BitAND($flag, 2) Then DllCallAddress("none:cdecl", DllStructGetData($symbollist, "StdoutRedirect"), "str", $filename)
		If BitAND($flag, 4) Then DllCallAddress("none:cdecl", DllStructGetData($symbollist, "StderrRedirect"), "str", $filename)
	EndFunc

	Func _binarycall_stdinredirect($filename = "CON")
		Local $ret = _binarycall_stdioredirect($filename, 1)
		Return SetError(@error, @extended, $ret)
	EndFunc

	Func _binarycall_stdoutredirect($filename = "CON")
		Local $ret = _binarycall_stdioredirect($filename, 2)
		Return SetError(@error, @extended, $ret)
	EndFunc

	Func _binarycall_stderrredirect($filename = "CON")
		Local $ret = _binarycall_stdioredirect($filename, 4)
		Return SetError(@error, @extended, $ret)
	EndFunc

	Func _binarycall_releaseonexit($ptr)
		OnAutoItExitRegister("__BinaryCall_DoRelease")
		__binarycall_releaseonexit_handle($ptr)
	EndFunc

	Func __binarycall_dorelease()
		__binarycall_releaseonexit_handle()
	EndFunc

	Func __binarycall_releaseonexit_handle($ptr = Default)
		Static $ptrlist
		If @NumParams = 0 Then
			If IsArray($ptrlist) Then
				For $i = 1 To $ptrlist[0]
					_binarycall_free($ptrlist[$i])
				Next
			EndIf
		Else
			If NOT IsArray($ptrlist) Then
				Local $initarray[1] = [0]
				$ptrlist = $initarray
			EndIf
			If IsPtr($ptr) Then
				Local $array = $ptrlist
				Local $size = UBound($array)
				ReDim $array[$size + 1]
				$array[$size] = $ptr
				$array[0] += 1
				$ptrlist = $array
			EndIf
		EndIf
	EndFunc

	Global Const $json_unescaped_unicode = 1
	Global Const $json_unescaped_slashes = 2
	Global Const $json_hex_tag = 4
	Global Const $json_hex_amp = 8
	Global Const $json_hex_apos = 16
	Global Const $json_hex_quot = 32
	Global Const $json_unescaped_ascii = 64
	Global Const $json_pretty_print = 128
	Global Const $json_strict_print = 256
	Global Const $json_unquoted_string = 512
	Global Const $jsmn_error_nomem = -1
	Global Const $jsmn_error_inval = -2
	Global Const $jsmn_error_part = -3
	Global $total_json_dump_output = ""

	Func __jsmn_runtimeloader($procname = "")
		Static $symbollist
		If NOT IsDllStruct($symbollist) Then
			Local $code
			If @AutoItX64 Then
				$code = "AwAAAAQfCAAAAAAAAAA1HbEvgTNrvX54gCiWSTVmt5v7RCdoFJ/zhkKmwcm8yVqZPjJBoVhNHHAIzrHWKbZh1J0QAUaHB5zyQTilTmWa9O0OKeLrk/Jg+o7CmMzjEk74uPongdHv37nwYXvg97fiHvjP2bBzI9gxSkKq9Cqh/GxSHIlZPYyW76pXUt//25Aqs2Icfpyay/NFd50rW7eMliH5ynkrp16HM1afithVrO+LpSaz/IojowApmXnBHUncHliDqbkx6/AODUkyDm1hj+AiEZ9Me1Jy+hBQ1/wC/YnuuYSJvNAKp6XDnyc8Nwr54Uqx5SbUW2CezwQQ7aXX/HFiHSKpQcFW/gi8oSx5nsoxUXVjxeNI/L7z6GF2mfu3Tnpt7hliWEdA2r2VB+TIM7Pgwl9X3Ge0T3KJQUaRtLJZcPvVtOuKXr2Q9wy7hl80hVRrt9zYrbjBHXLrRx/HeIMkZwxhmKo/dD/vvaNgE+BdU8eeJqFBJK2alrK2rh2WkRynftyepm1WrdKrz/5KhQPp/4PqH+9IADDjoGBbfvJQXdT+yiO8DtfrVnd+JOEKsKEsdgeM3UXx5r6tEHO9rYWbzbnyEiX7WozZemry+vBZMMtHn1aA63+RcDQED73xOsnj00/9E5Z6hszM5Hi8vi6Hw3iOgf3cHwcXG44aau0JpuA2DlrUvnJOYkNnY+bECeSdAR1UQkFNyqRoH2xm4Y7gYMCPsFtPBlwwleEKI27SsUq1ZHVQvFCoef7DXgf/GwPCAvwDMIQfb3hJtIVubOkASRQZVNIJ/y4KPrn/gcASV7fvMjE34loltTVlyqprUWxpI51tN6vhTOLAp+CHseKxWaf9g1wdbVs0e/5xAiqgJbmKNi9OYbhV/blpp3SL63XKxGiHdxhK1aR+4rUY4eckNbaHfW7ob+q7aBoHSs6LVX9lWakb/xWxwQdwcX/7/C+TcQSOOg6rLoWZ8wur9qp+QwzoCbXkf04OYpvD5kqgEiwQnB90kLtcA+2XSbDRu+aq02eNNCzgkZujeL/HjVISjf2EuQKSsZkBhS15eiXoRgPaUoQ5586VS7t7rhM8ng5LiVzoUQIZ0pNKxWWqD+gXRBvOMIXY2yd0Ei4sE5KFIEhbs3u8vwP7nFLIpZ/RembPTuc0ZlguGJgJ2F5iApfia+C2tRYRNjVCqECCveWw6P2Btfaq9gw7cWWmJflIQbjxtccDqsn52cftLqXSna9zk05mYdJSV8z2W7vM1YJ5Rd82v0j3kau710A/kQrN41bdaxmKjL+gvSRlOLB1bpvkCtf9+h+eVA4XIkIXKFydr1OjMZ8wq2FIxPJXskAe4YMgwQmeWZXMK1KBbLB3yQR1YOYaaHk1fNea9KsXgs5YLbiP/noAusz76oEDo/DJh1aw7cUwdhboVPg1bNq88mRb5RGa13KDK9uEET7OA02KbSL+Q4HOtyasLUoVrZzVyd8iZPoGrV36vHnj+yvG4fq6F/fkug/sBRp186yVZQVmdAgFd+WiRLnUjxHUKJ6xBbpt4FTP42E/PzPw3JlDb0UQtXTDnIL0CWqbns2E7rZ5PBwrwQYwvBn/gaEeLVGDSh84DfW4zknIneGnYDXdVEHC+ITzejAnNxb1duB+w2aVTk64iXsKHETq53GMH6DuFi0oUeEFb/xp0HsRyNC8vBjOq3Kk7NZHxCQLh7UATFttG7sH+VIqGjjNwmraGJ0C92XhpQwSgfAb3KHucCHGTTti0sn6cgS3vb36BkjGKsRhXVuoQCFH96bvTYtl8paQQW9ufRfvxPqmU0sALdR0fIvZwd7Z8z0UoEec6b1Sul4e60REj/H4scb6N2ryHBR9ua5N1YxJu1uwgoLXUL2wT9ZPBjPjySUzeqXikUIKKYgNlWy+VlNIiWWTPtKpCTr508logA=="
			Else
				$code = "AwAAAASFBwAAAAAAAAA1HbEvgTNrvX54gCiqsa1mt5v7RCdoAFjCfVE40DZbE5UfabA9UKuHrjqOMbvjSoB2zBJTEYEQejBREnPrXL3VwpVOW+L9SSfo0rTfA8U2W+Veqo1uy0dOsPhl7vAHbBHrvJNfEUe8TT0q2eaTX2LeWpyrFEm4I3mhDJY/E9cpWf0A78e+y4c7NxewvcVvAakIHE8Xb8fgtqCTVQj3Q1eso7n1fKQj5YsQ20A86Gy9fz8dky78raeZnhYayn0b1riSUKxGVnWja2i02OvAVM3tCCvXwcbSkHTRjuIAbMu2mXF1UpKci3i/GzPmbxo9n/3aX/jpR6UvxMZuaEDEij4yzfZv7EyK9WCNBXxMmtTp3Uv6MZsK+nopXO3C0xFzZA/zQObwP3zhJ4sdatzMhFi9GAM70R4kgMzsxQDNArueXj+UFzbCCFZ89zXs22F7Ixi0FyFTk3jhH56dBaN65S+gtPztNGzEUmtk4M8IanhQSw8xCXr0x0MPDpDFDZs3aN5TtTPYmyk3psk7OrmofCQGG5cRcqEt9902qtxQDOHumfuCPMvU+oMjzLzBVEDnBbj+tY3y1jvgGbmEJguAgfB04tSeAt/2618ksnJJK+dbBkDLxjB4xrFr3uIFFadJQWUckl5vfh4MVXbsFA1hG49lqWDa7uSuPCnOhv8Yql376I4U4gfcF8LcgorkxS+64urv2nMUq6AkBEMQ8bdkI64oKLFfO7fGxh5iMNZuLoutDn2ll3nq4rPi4kOyAtfhW0UPyjvqNtXJ/h0Wik5Mi8z7BVxaURTDk81TP8y9+tzjySB/uGfHFAzjF8DUY1vqJCgn0GQ8ANtiiElX/+Wnc9HWi2bEEXItbm4yv97QrEPvJG9nPRBKWGiAQsIA5J+WryX5NrfEfRPk0QQwyl16lpHlw6l0UMuk7S21xjQgyWo0MywfzoBWW7+t4HH9sqavvP4dYAw81BxXqVHQhefUOS23en4bFUPWE98pAN6bul+kS767vDK34yTC3lA2a8wLrBEilmFhdB74fxbAl+db91PivhwF/CR4Igxr35uLdof7+jAYyACopQzmsbHpvAAwT2lapLix8H03nztAC3fBqFSPBVdIv12lsrrDw4dfhJEzq7AbL/Y7L/nIcBsQ/3UyVnZk4kZP1KzyPCBLLIQNpCVgOLJzQuyaQ6k2QCBy0eJ0ppUyfp54LjwVg0X7bwncYbAomG4ZcFwTQnC2AX3oYG5n6Bz4SLLjxrFsY+v/SVa+GqH8uePBh1TPkHVNmzjXXymEf5jROlnd+EjfQdRyitkjPrg2HiQxxDcVhCh5J2L5+6CY9eIaYgrbd8zJnzAD8KnowHwh2bi4JLgmt7ktJ1XGizox7cWf3/Dod56KAcaIrSVw9XzYybdJCf0YRA6yrwPWXbwnzc/4+UDkmegi+AoCEMoue+cC7vnYVdmlbq/YLE/DWJX383oz2Ryq8anFrZ8jYvdoh8WI+dIugYL2SwRjmBoSwn56XIaot/QpMo3pYJIa4o8aZIZrjvB7BXO5aCDeMuZdUMT6AXGAGF1AeAWxFd2XIo1coR+OplMNDuYia8YAtnSTJ9JwGYWi2dJz3xrxsTQpBONf3yn8LVf8eH+o5eXc7lzCtHlDB+YyI8V9PyMsUPOeyvpB3rr9fDfNy263Zx33zTi5jldgP2OetUqGfbwl+0+zNYnrg64bluyIN/Awt1doDCQkCKpKXxuPaem/SyCHrKjg"
			EndIf
			Local $symbol[] = ["jsmn_parse", "jsmn_init", "json_string_decode", "json_string_encode"]
			Local $codebase = _binarycall_create($code)
			If @error Then Exit MsgBox(16, "Json", "Startup Failure!")
			$symbollist = _binarycall_symbollist($codebase, $symbol)
			If @error Then Exit MsgBox(16, "Json", "Startup Failure!")
		EndIf
		If $procname Then Return DllStructGetData($symbollist, $procname)
	EndFunc

	Func json_stringencode($string, $option = 0)
		Static $json_stringencode = __jsmn_runtimeloader("json_string_encode")
		Local $length = StringLen($string) * 6 + 1
		Local $buffer = DllStructCreate("wchar[" & $length & "]")
		Local $ret = DllCallAddress("int:cdecl", $json_stringencode, "wstr", $string, "ptr", DllStructGetPtr($buffer), "uint", $length, "int", $option)
		Return SetError($ret[0], 0, DllStructGetData($buffer, 1))
	EndFunc

	Func json_stringdecode($string)
		Static $json_stringdecode = __jsmn_runtimeloader("json_string_decode")
		Local $length = StringLen($string) + 1
		Local $buffer = DllStructCreate("wchar[" & $length & "]")
		Local $ret = DllCallAddress("int:cdecl", $json_stringdecode, "wstr", $string, "ptr", DllStructGetPtr($buffer), "uint", $length)
		Return SetError($ret[0], 0, DllStructGetData($buffer, 1))
	EndFunc

	Func json_decode($json, $inittokencount = 1000)
		Static $jsmn_init = __jsmn_runtimeloader("jsmn_init"), $jsmn_parse = __jsmn_runtimeloader("jsmn_parse")
		If $json = "" Then $json = '""'
		Local $tokenlist, $ret
		Local $parser = DllStructCreate("uint pos;int toknext;int toksuper")
		Do
			DllCallAddress("none:cdecl", $jsmn_init, "ptr", DllStructGetPtr($parser))
			$tokenlist = DllStructCreate("byte[" & ($inittokencount * 20) & "]")
			$ret = DllCallAddress("int:cdecl", $jsmn_parse, "ptr", DllStructGetPtr($parser), "wstr", $json, "ptr", DllStructGetPtr($tokenlist), "uint", $inittokencount)
			$inittokencount *= 2
		Until $ret[0] <> $jsmn_error_nomem
		Local $next = 0
		Return SetError($ret[0], 0, _json_token($json, DllStructGetPtr($tokenlist), $next))
	EndFunc

	Func _json_token(ByRef $json, $ptr, ByRef $next)
		If $next = -1 Then Return NULL 
		Local $token = DllStructCreate("int;int;int;int", $ptr + ($next * 20))
		Local $type = DllStructGetData($token, 1)
		Local $start = DllStructGetData($token, 2)
		Local $end = DllStructGetData($token, 3)
		Local $size = DllStructGetData($token, 4)
		$next += 1
		If $type = 0 AND $start = 0 AND $end = 0 AND $size = 0 Then
			$next = -1
			Return NULL 
		EndIf
		Switch $type
			Case 0
				Local $primitive = StringMid($json, $start + 1, $end - $start)
				Switch $primitive
					Case "true"
						Return True
					Case "false"
						Return False
					Case "null"
						Return NULL 
					Case Else
						If StringRegExp($primitive, "^[+\-0-9]") Then
							Return Number($primitive)
						Else
							Return json_stringdecode($primitive)
						EndIf
				EndSwitch
			Case 1
				Local $object = json_objcreate()
				For $i = 0 To $size - 1 Step 2
					Local $key = _json_token($json, $ptr, $next)
					Local $value = _json_token($json, $ptr, $next)
					If NOT IsString($key) Then $key = json_encode($key)
					If $object.exists($key) Then $object.remove($key)
					$object.add($key, $value)
				Next
				Return $object
			Case 2
				Local $array[$size]
				For $i = 0 To $size - 1
					$array[$i] = _json_token($json, $ptr, $next)
				Next
				Return $array
			Case 3
				Return json_stringdecode(StringMid($json, $start + 1, $end - $start))
		EndSwitch
	EndFunc

	Func json_isobject(ByRef $object)
		Return (IsObj($object) AND ObjName($object) = "Dictionary")
	EndFunc

	Func json_isnull(ByRef $null)
		Return IsKeyword($null) OR (NOT IsObj($null) AND VarGetType($null) = "Object")
	EndFunc

	Func json_encode_compact($data, $option = 0)
		Local $json = ""
		Select 
			Case IsString($data)
				Return '"' & json_stringencode($data, $option) & '"'
			Case IsNumber($data)
				Return $data
			Case IsArray($data) AND UBound($data, 0) = 1
				$json = "["
				For $i = 0 To UBound($data) - 1
					$json &= json_encode_compact($data[$i], $option) & ","
				Next
				If StringRight($json, 1) = "," Then $json = StringTrimRight($json, 1)
				Return $json & "]"
			Case json_isobject($data)
				$json = "{"
				Local $keys = $data.keys()
				For $i = 0 To UBound($keys) - 1
					$json &= '"' & json_stringencode($keys[$i], $option) & '":' & json_encode_compact($data.item($keys[$i]), $option) & ","
				Next
				If StringRight($json, 1) = "," Then $json = StringTrimRight($json, 1)
				Return $json & "}"
			Case IsBool($data)
				Return StringLower($data)
			Case IsPtr($data)
				Return Number($data)
			Case IsBinary($data)
				Return '"' & json_stringencode(BinaryToString($data, 4), $option) & '"'
			Case Else
				Return "null"
		EndSelect
	EndFunc

	Func json_encode_pretty($data, $option, $indent, $arraysep, $objectsep, $colonsep, $arraycrlf = Default, $objectcrlf = Default, $nextident = "")
		Local $thisident = $nextident, $json = "", $string = "", $match = "", $keys = ""
		Local $length = 0
		Select 
			Case IsString($data)
				$string = json_stringencode($data, $option)
				If BitAND($option, $json_unquoted_string) AND NOT BitAND($option, $json_strict_print) AND NOT StringRegExp($string, "[\s,:]") AND NOT StringRegExp($string, "^[+\-0-9]") Then
					Return $string
				Else
					Return '"' & $string & '"'
				EndIf
			Case IsArray($data) AND UBound($data, 0) = 1
				If UBound($data) = 0 Then Return "[]"
				If IsKeyword($arraycrlf) Then
					$arraycrlf = ""
					$match = StringRegExp($arraysep, "[\r\n]+$", 3)
					If IsArray($match) Then $arraycrlf = $match[0]
				EndIf
				If $arraycrlf Then $nextident &= $indent
				$length = UBound($data) - 1
				For $i = 0 To $length
					If $arraycrlf Then $json &= $nextident
					$json &= json_encode_pretty($data[$i], $option, $indent, $arraysep, $objectsep, $colonsep, $arraycrlf, $objectcrlf, $nextident)
					If $i < $length Then $json &= $arraysep
				Next
				If $arraycrlf Then Return "[" & $arraycrlf & $json & $arraycrlf & $thisident & "]"
				Return "[" & $json & "]"
			Case json_isobject($data)
				If $data.count = 0 Then Return "{}"
				If IsKeyword($objectcrlf) Then
					$objectcrlf = ""
					$match = StringRegExp($objectsep, "[\r\n]+$", 3)
					If IsArray($match) Then $objectcrlf = $match[0]
				EndIf
				If $objectcrlf Then $nextident &= $indent
				$keys = $data.keys()
				$length = UBound($keys) - 1
				For $i = 0 To $length
					If $objectcrlf Then $json &= $nextident
					$json &= json_encode_pretty(String($keys[$i]), $option, $indent, $arraysep, $objectsep, $colonsep) & $colonsep & json_encode_pretty($data.item($keys[$i]), $option, $indent, $arraysep, $objectsep, $colonsep, $arraycrlf, $objectcrlf, $nextident)
					If $i < $length Then $json &= $objectsep
				Next
				If $objectcrlf Then Return "{" & $objectcrlf & $json & $objectcrlf & $thisident & "}"
				Return "{" & $json & "}"
			Case Else
				Return json_encode_compact($data, $option)
		EndSelect
	EndFunc

	Func json_encode($data, $option = 0, $indent = Default, $arraysep = Default, $objectsep = Default, $colonsep = Default)
		If BitAND($option, $json_pretty_print) Then
			Local $strict = BitAND($option, $json_strict_print)
			If IsKeyword($indent) Then
				$indent = @TAB
			Else
				$indent = json_stringdecode($indent)
				If StringRegExp($indent, "[^\t ]") Then $indent = @TAB
			EndIf
			If IsKeyword($arraysep) Then
				$arraysep = "," & @CRLF
			Else
				$arraysep = json_stringdecode($arraysep)
				If $arraysep = "" OR StringRegExp($arraysep, "[^\s,]|,.*,") OR ($strict AND NOT StringRegExp($arraysep, ",")) Then $arraysep = "," & @CRLF
			EndIf
			If IsKeyword($objectsep) Then
				$objectsep = "," & @CRLF
			Else
				$objectsep = json_stringdecode($objectsep)
				If $objectsep = "" OR StringRegExp($objectsep, "[^\s,]|,.*,") OR ($strict AND NOT StringRegExp($objectsep, ",")) Then $objectsep = "," & @CRLF
			EndIf
			If IsKeyword($colonsep) Then
				$colonsep = ": "
			Else
				$colonsep = json_stringdecode($colonsep)
				If $colonsep = "" OR StringRegExp($colonsep, "[^\s,:]|[,:].*[,:]") OR ($strict AND (StringRegExp($colonsep, ",") OR NOT StringRegExp($colonsep, ":"))) Then $colonsep = ": "
			EndIf
			Return json_encode_pretty($data, $option, $indent, $arraysep, $objectsep, $colonsep)
		ElseIf BitAND($option, $json_unquoted_string) Then
			Return json_encode_pretty($data, $option, "", ",", ",", ":")
		Else
			Return json_encode_compact($data, $option)
		EndIf
	EndFunc

	Func json_objcreate()
		Local $object = ObjCreate("Scripting.Dictionary")
		$object.comparemode = 0
		Return $object
	EndFunc

	Func json_objput(ByRef $object, $key, $value)
		$key = String($key)
		If $object.exists($key) Then $object.remove($key)
		$object.add($key, $value)
	EndFunc

	Func json_objget(ByRef $object, $key)
		Local $dynobject = $object
		Local $keys = StringSplit($key, ".")
		For $x = 1 To $keys[0]
			If $dynobject.exists($keys[$x]) Then
				If $x = $keys[0] Then
					Return $dynobject.item($keys[$x])
				Else
					$dynobject = json_objget($dynobject, $keys[$x])
				EndIf
			EndIf
		Next
		Return SetError(1, 0, "")
	EndFunc

	Func json_objdelete(ByRef $object, $key)
		$key = String($key)
		If $object.exists($key) Then $object.remove($key)
	EndFunc

	Func json_objexists(ByRef $object, $key)
		Local $dynobject = $object
		Local $keys = StringSplit($key, ".")
		For $x = 1 To $keys[0]
			If $dynobject.exists($keys[$x]) Then
				If $x = $keys[0] Then
					Return True
				Else
					$dynobject = json_objget($dynobject, $keys[$x])
				EndIf
			Else
				Return False
			EndIf
		Next
		Return False
	EndFunc

	Func json_objgetcount(ByRef $object)
		Return $object.count
	EndFunc

	Func json_objgetkeys(ByRef $object)
		Return $object.keys()
	EndFunc

	Func json_objgetitems(ByRef $object)
		Return $object.items()
	EndFunc

	Func json_objclear(ByRef $object)
		Return $object.removeall()
	EndFunc

	Func json_put(ByRef $var, $notation, $data, $checkexists = False)
		Local $ret = 0, $item = "", $error = 0
		Local $match = ""
		$match = StringRegExp($notation, "(^\[([^\]]+)\])|(^\.([^\.\[]+))", 3)
		If IsArray($match) Then
			Local $index
			If UBound($match) = 4 Then
				$index = String(json_decode($match[3]))
				$notation = StringTrimLeft($notation, StringLen($match[2]))
			Else
				$index = json_decode($match[1])
				$notation = StringTrimLeft($notation, StringLen($match[0]))
			EndIf
			If IsString($index) Then
				If $checkexists AND (NOT json_isobject($var) OR NOT json_objexists($var, $index)) Then
					Return SetError(1, 0, False)
				EndIf
				If NOT json_isobject($var) Then $var = json_objcreate()
				If $notation Then
					$item = json_objget($var, $index)
					$ret = json_put($item, $notation, $data, $checkexists)
					$error = @error
					If NOT $error Then json_objput($var, $index, $item)
					Return SetError($error, 0, $ret)
				Else
					json_objput($var, $index, $data)
					Return True
				EndIf
			ElseIf IsInt($index) Then
				If $index < 0 OR ($checkexists AND (NOT IsArray($var) OR UBound($var, 0) <> 1 OR $index >= UBound($var))) Then
					Return SetError(1, 0, False)
				EndIf
				If NOT IsArray($var) OR UBound($var, 0) <> 1 Then
					Dim $var[$index + 1]
				ElseIf $index >= UBound($var) Then
					ReDim $var[$index + 1]
				EndIf
				If $notation Then
					$ret = json_put($var[$index], $notation, $data, $checkexists)
					Return SetError(@error, 0, $ret)
				Else
					$var[$index] = $data
					Return True
				EndIf
			EndIf
		EndIf
		Return SetError(2, 0, False)
	EndFunc

	Func json_get(ByRef $var, $notation)
		Local $match = StringRegExp($notation, "(^\[([^\]]+)\])|(^\.([^\.\[]+))", 3)
		If IsArray($match) Then
			Local $index
			If UBound($match) = 4 Then
				$index = String(json_decode($match[3]))
				$notation = StringTrimLeft($notation, StringLen($match[2]))
			Else
				$index = json_decode($match[1])
				$notation = StringTrimLeft($notation, StringLen($match[0]))
			EndIf
			Local $item
			If IsString($index) AND json_isobject($var) AND json_objexists($var, $index) Then
				$item = json_objget($var, $index)
			ElseIf IsInt($index) AND IsArray($var) AND UBound($var, 0) = 1 AND $index >= 0 AND $index < UBound($var) Then
				$item = $var[$index]
			Else
				Return SetError(1, 0, "")
			EndIf
			If NOT $notation Then Return $item
			Local $ret = json_get($item, $notation)
			Return SetError(@error, 0, $ret)
		EndIf
		Return SetError(2, 0, "")
	EndFunc

	Func json_dump($json, $inittokencount = 1000)
		Static $jsmn_init = __jsmn_runtimeloader("jsmn_init"), $jsmn_parse = __jsmn_runtimeloader("jsmn_parse")
		If $json = "" Then $json = '""'
		Local $tokenlist, $ret
		$total_json_dump_output = ""
		Local $parser = DllStructCreate("uint pos;int toknext;int toksuper")
		Do
			DllCallAddress("none:cdecl", $jsmn_init, "ptr", DllStructGetPtr($parser))
			$tokenlist = DllStructCreate("byte[" & ($inittokencount * 20) & "]")
			$ret = DllCallAddress("int:cdecl", $jsmn_parse, "ptr", DllStructGetPtr($parser), "wstr", $json, "ptr", DllStructGetPtr($tokenlist), "uint", $inittokencount)
			$inittokencount *= 2
		Until $ret[0] <> $jsmn_error_nomem
		Local $next = 0
		_json_tokendump($json, DllStructGetPtr($tokenlist), $next)
	EndFunc

	Func _json_tokendump(ByRef $json, $ptr, ByRef $next, $objpath = "")
		If $next = -1 Then Return NULL 
		Local $token = DllStructCreate("int;int;int;int", $ptr + ($next * 20))
		Local $type = DllStructGetData($token, 1)
		Local $start = DllStructGetData($token, 2)
		Local $end = DllStructGetData($token, 3)
		Local $size = DllStructGetData($token, 4)
		Local $value
		$next += 1
		If $type = 0 AND $start = 0 AND $end = 0 AND $size = 0 Then
			$next = -1
			Return NULL 
		EndIf
		Switch $type
			Case 0
				Local $primitive = StringMid($json, $start + 1, $end - $start)
				Switch $primitive
					Case "true"
						Return "True"
					Case "false"
						Return "False"
					Case "null"
						Return "Null"
					Case Else
						If StringRegExp($primitive, "^[+\-0-9]") Then
							Return Number($primitive)
						Else
							Return json_stringdecode($primitive)
						EndIf
				EndSwitch
			Case 1
				For $i = 0 To $size - 1 Step 2
					Local $key = _json_tokendump($json, $ptr, $next)
					Local $cobjpath = $objpath & "." & $key
					$value = _json_tokendump($json, $ptr, $next, $objpath & "." & $key)
					If NOT (IsBool($value) AND $value = False) Then
						If NOT IsString($key) Then
							$key = json_encode($key)
						EndIf
						ConsoleWrite("+-> " & $cobjpath & "  =" & $value & @CRLF)
						$total_json_dump_output &= "+-> " & $cobjpath & "  =" & $value & @CRLF
					EndIf
				Next
				Return False
			Case 2
				Local $sobjpath = $objpath
				For $i = 0 To $size - 1
					$sobjpath = $objpath & "[" & $i & "]"
					$value = _json_tokendump($json, $ptr, $next, $sobjpath)
					If NOT (IsBool($value) AND $value = False) Then
						ConsoleWrite("+=> " & $sobjpath & "=>" & $value & @CRLF)
						$total_json_dump_output &= "+=> " & $sobjpath & "=>" & $value & @CRLF
					EndIf
				Next
				$objpath = $sobjpath
				Return False
			Case 3
				Local $lastkey = json_stringdecode(StringMid($json, $start + 1, $end - $start))
				Return $lastkey
		EndSwitch
	EndFunc

	$connect = _getnetworkconnect()
	If $connect Then
		$guiw = 1045
		$guih = 610
		$titlegui = "GEOLearners"
		$gui_main = GUICreate($titlegui, $guiw, $guih, (@DesktopWidth - $guiw) / 2, (@DesktopHeight - $guih) / 2, $ws_popup)
		GUICtrlCreateLabel("", 0, 0, $guiw - 78, 32, -1, $gui_ws_ex_parentdrag)
		html_load(@ScriptDir & "/index.html", $guiw, $guih, 0, 0, 1)
		Global $pathpic = @ScriptDir & "\image\"
		Global $pathinfo = @ScriptDir & "\data\info\"
		GUISetState(@SW_SHOW, $gui_main)
		_creategdpgui()
		_create_guiinfo()
		While 1
			_getevent()
		WEnd
	Else
		MsgBox(48, "Warning", "Không có kết nối mạng, vui lòng kiểm tra và mở ứng dụng lại sau!")
		Exit
	EndIf

	Func _getevent()
		$idmsg = html_guigetmsg()
		Switch $idmsg
			Case $gui_event_close
				If MsgBox(36 + 262144, "Thoát ứng dụng?", "Bạn có thực sự muốn thoát?") = 6 Then Exit
			Case $gui_event_minimize, "-4"
				GUISetState(@SW_MINIMIZE, $gui_main)
			Case "palestine", "japan", "india", "china", "indonesia", "thailand", "vietnam", "singapore", "philippines", "malaysia", "cambodia", "myanmar", "bangladesh", "israel", "uzbekistan", "oman", "mongolia", "taiwan", "afghanistan", "bhutan", "maldives", "nepal", "pakistan", "armenia", "azerbaijan", "bahrain", "georgia", "iraq", "jordan", "kuwait", "lebanon", "qatar", "cyprus", "turkey", "kazakhstan", "tajikistan", "turkmenistan"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_asia.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_asia.ini", $idmsg, "square", "deafault")
				ConsoleWrite($idmsg & @CRLF)
				If ($idmsg = "taiwan" OR $idmsg = "palestine") Then
					$population = IniRead($pathinfo & "info_asia.ini", $idmsg, "population", "deafault")
				Else
					$population = _getpopulation(_stringtitlecase($idmsg))
				EndIf
				$currency = IniRead($pathinfo & "info_asia.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_asia.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_asia.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_asia.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "germany", "france", "italy", "spain", "croatia", "switzerland", "belgium", "estonia", "denmark", "iceland", "ireland", "latvia", "lithuania", "norway", "finland", "sweden", "moldova", "poland", "bulgaria", "hungary", "romania", "ukraine", "greece", "andorra", "albania", "portugal", "malta", "montenegro", "san-marino", "serbia", "slovenia", "vatican", "austria", "liechstenstein", "luxembourg", "monaco"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "square", "deafault")
				ConsoleWrite($idmsg & @CRLF)
				If ($idmsg = "andorra" OR $idmsg = "san-marino" OR $idmsg = "vatican" OR $idmsg = "liechstenstein" OR $idmsg = "monaco") Then
					$population = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "population", "deafault")
				Else
					$population = _getpopulation(_stringtitlecase($idmsg))
				EndIf
				$currency = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "libya", "sudan", "tunisia", "zimbabwe", "niger", "algeria", "morocco", "angola", "benin", "botswana", "burundi", "cameroon", "comoros", "djibouti", "eritrea", "ethiopia", "gabon", "ghana", "guinea", "guinea-bissau", "kenya", "lesotho", "liberia", "madagascar", "malawi", "mali", "mauritania", "mauritius", "mozambique", "namibia", "nigeria", "rwanda", "chad", "senegal", "seychelles", "somalia", "swaziland", "tanzania", "uganda", "zambia", "burundi"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_africa.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_africa.ini", $idmsg, "square", "deafault")
				ConsoleWrite($idmsg & @CRLF)
				$population = _getpopulation(_stringtitlecase($idmsg))
				$currency = IniRead($pathinfo & "info_africa.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_africa.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_africa.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_africa.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "greenland", "canada", "bermuda", "argentina", "belize", "bonaire", "chile", "cuba", "ecuador", "grenada", "guatemala", "guyana", "honduras", "martinique", "montserrat", "nicaragua", "paraguay", "falkland-islands", "virgin-islands", "saint-kitts-and-nevis", "saint-martin", "dominica", "sint-maarten", "anguilla", "bolivia", "brazil", "colombia", "dominica", "guadeloupe", "haiti", "jamaica", "mexico", "panama", "peru", "caymanislands", "suriname", "uruguay", "argentina"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_america.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_america.ini", $idmsg, "square", "deafault")
				ConsoleWrite($idmsg & @CRLF)
				If ($idmsg = "bermuda" OR $idmsg = "bonaire" OR $idmsg = "montserrat" OR $idmsg = "falkland-islands" OR $idmsg = "virgin-islands" OR $idmsg = "saint-kitts-and-nevis" OR $idmsg = "saint-martin" OR $idmsg = "sint-maarten" OR $idmsg = "anguilla" OR $idmsg = "dominica" OR $idmsg = "caymanislands" OR $idmsg = "greenland") Then
					$population = IniRead($pathinfo & "info_america.ini", $idmsg, "population", "deafault")
				Else
					$population = _getpopulation(_stringtitlecase($idmsg))
				EndIf
				$currency = IniRead($pathinfo & "info_america.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_america.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_america.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_america.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "australia", "guam", "samoa"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_australia.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_australia.ini", $idmsg, "square", "deafault")
				ConsoleWrite($idmsg & @CRLF)
				If ($idmsg = "0") Then
					$population = IniRead($pathinfo & "info_australia.ini", $idmsg, "population", "deafault")
				Else
					$population = _getpopulation(_stringtitlecase($idmsg))
				EndIf
				$currency = IniRead($pathinfo & "info_australia.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_australia.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_australia.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_australia.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "iran", "south-korea", "north-korea", "laos", "east-timor", "brunei", "sri-lanka", "saudi-arabia", "united-arab-emirates", "syria", "yemen", "kyrgyzstan"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_asia.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_asia.ini", $idmsg, "square", "deafault")
				$population = _getpopulation(IniRead($pathinfo & "info_special_case_asia.ini", $idmsg, "name", "deafault"))
				$currency = IniRead($pathinfo & "info_asia.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_asia.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_asia.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_asia.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "united-kingdom", "netherlands", "belarus-country", "czech-eepublic", "russia", "slovakia", "bosnia-and-herzegovina", "macedonia"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "square", "deafault")
				$population = _getpopulation(IniRead($pathinfo & "info_special_case_euroqe.ini", $idmsg, "name", "deafault"))
				$currency = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_euroqe.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "egypt", "south-africa", "western-sahara", "burkina-faso", "cape-verde", "republic-of-the-congo", "democratic-republic-of-the-congo", "central-africa-republic", "equatorial-guinea", "gambia", "south-sudan", "sierra-leone", "tog"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_africa.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_africa.ini", $idmsg, "square", "deafault")
				$population = _getpopulation(IniRead($pathinfo & "info_special_case_africa.ini", $idmsg, "name", "deafault"))
				$currency = IniRead($pathinfo & "info_africa.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_africa.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_africa.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_africa.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "united-states", "antigua-and-barbuda", "british-virgin-islands", "bahamas", "dominican-republic", "puerto-rico", "trinidad-and-tobago", "venezuela", "costa-rica", "el-salvador", "saint-lucia", "saint-vincent-and-grenadines"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_america.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_america.ini", $idmsg, "square", "deafault")
				$population = _getpopulation(IniRead($pathinfo & "info_special_case_america.ini", $idmsg, "name", "deafault"))
				$currency = IniRead($pathinfo & "info_america.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_america.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_america.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_america.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "new-zealand"
				$dir_picmap = $pathpic & "\countries_2\" & $idmsg & ".png"
				$dir_picflag = $pathpic & "\flag\" & $idmsg & ".png"
				$fullname = IniRead($pathinfo & "info_australia.ini", $idmsg, "fullname", "deafault")
				$square = IniRead($pathinfo & "info_australia.ini", $idmsg, "square", "deafault")
				$population = _getpopulation(IniRead($pathinfo & "info_special_case_australia.ini", $idmsg, "name", "deafault"))
				$currency = IniRead($pathinfo & "info_australia.ini", $idmsg, "currency", "deafault")
				$capital = IniRead($pathinfo & "info_australia.ini", $idmsg, "capital", "deafault")
				$timezone = IniRead($pathinfo & "info_australia.ini", $idmsg, "timezone", "deafault")
				$funfact = IniRead($pathinfo & "info_australia.ini", $idmsg, "funfact", "deafault")
				_setdataforguiinfo($dir_picmap, $dir_picflag, $fullname, $square, $population, $currency, $capital, $timezone, $funfact)
			Case "datepicker_input"
				_showgdpgui()
		EndSwitch
	EndFunc

	Func _getnetworkconnect()
		Local Const $network_alive_lan = 1
		Local Const $network_alive_wan = 2
		Local Const $network_alive_aol = 4
		Local $aret, $iresult
		$aret = DllCall("sensapi.dll", "int", "IsNetworkAlive", "int*", 0)
		If BitAND($aret[1], $network_alive_lan) Then $iresult &= "LAN connected" & @LF
		If BitAND($aret[1], $network_alive_wan) Then $iresult &= "WAN connected" & @LF
		If BitAND($aret[1], $network_alive_aol) Then $iresult &= "AOL connected" & @LF
		Return $iresult
	EndFunc

	Func _getpopulation($country)
		Local $first_path_api = "http://54.72.28.201/1.0/population/"
		Local $second_path_api = "/today-and-tomorrow/?format=json"
		$url = $first_path_api & $country & $second_path_api
		$json = json_decode(_inetgetsource($url))
		$jsonobj = json_objget($json, "total_population")
		Return _formatnumberseperate(String(json_get($jsonobj, "[0].population")), ".") & " người"
	EndFunc

	Func _formatnumberseperate($number, $seperate)
		$length = StringLen($number)
		$i = 3
		While $length - $i > 0
			$number = _stringinsert($number, $seperate, $length - $i)
			$i += 3
		WEnd
		Return $number
	EndFunc
